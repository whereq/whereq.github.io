<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.whereq.com","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.21.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="WhereQ">
<meta property="og:url" content="https://www.whereq.com/page/4/index.html">
<meta property="og:site_name" content="WhereQ">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Dazhi Zhang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.whereq.com/page/4/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/4/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>WhereQ</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">WhereQ</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-articles"><a href="/articles/" rel="section"><i class="fa fa-file fa-fw"></i>Articles</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Dazhi Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">148</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">132</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">87</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2025/01/30/Managing-Environment-Specific-Logging-and-Configuration-in-a-Vite-React-Application/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/30/Managing-Environment-Specific-Logging-and-Configuration-in-a-Vite-React-Application/" class="post-title-link" itemprop="url">Managing Environment-Specific Logging and Configuration in a Vite React Application</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-01-30 18:34:06" itemprop="dateCreated datePublished" datetime="2025-01-30T18:34:06-05:00">2025-01-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/" itemprop="url" rel="index"><span itemprop="name">ReactJS</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/TypeScript/" itemprop="url" rel="index"><span itemprop="name">TypeScript</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/TypeScript/Vite/" itemprop="url" rel="index"><span itemprop="name">Vite</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/TypeScript/Vite/Yarn/" itemprop="url" rel="index"><span itemprop="name">Yarn</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ol>
<li><strong>How to show console logs according to the environment</strong>.</li>
<li><strong>How to load environment variables in your application</strong>.</li>
<li><strong>How to load the correct environment file (with Vite or Yarn)</strong>.</li>
<li><strong>How to start the application with the production build</strong>.</li>
</ol>
<hr>
<h2 id="1-Show-Console-Logs-According-to-the-Environment"><a href="#1-Show-Console-Logs-According-to-the-Environment" class="headerlink" title="1. Show Console Logs According to the Environment"></a>1. Show Console Logs According to the Environment</h2><p>To ensure that <code>console.log</code>, <code>console.warn</code>, and <code>console.error</code> only work in specific environments (e.g., test mode), you can create a utility module that conditionally logs based on the environment.</p>
<h3 id="Example-logUtil-ts"><a href="#Example-logUtil-ts" class="headerlink" title="Example: logUtil.ts"></a>Example: <code>logUtil.ts</code></h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isTestEnv = <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_ENV</span> === <span class="string">&#x27;test&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> logUtil = &#123;</span><br><span class="line">    <span class="attr">log</span>: &lt;T&gt;<span class="function">(<span class="params">...<span class="attr">args</span>: T[]</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isTestEnv) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(...args);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">warn</span>: &lt;T&gt;<span class="function">(<span class="params">...<span class="attr">args</span>: T[]</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isTestEnv) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(...args);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">error</span>: &lt;T&gt;<span class="function">(<span class="params">...<span class="attr">args</span>: T[]</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isTestEnv) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(...args);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> logUtil;</span><br></pre></td></tr></table></figure>

<h3 id="Explanation"><a href="#Explanation" class="headerlink" title="Explanation:"></a>Explanation:</h3><ul>
<li><strong>Environment Check</strong>: The <code>isTestEnv</code> variable checks if the <code>VITE_ENV</code> environment variable is set to <code>&quot;test&quot;</code>.</li>
<li><strong>Conditional Logging</strong>: The <code>logUtil</code> methods (<code>log</code>, <code>warn</code>, <code>error</code>) only execute <code>console</code> statements if the environment is <code>test</code>.</li>
<li><strong>Type Safety</strong>: The utility uses TypeScript generics (<code>&lt;T&gt;</code>) to ensure type safety for the logged arguments.</li>
</ul>
<h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage:"></a>Usage:</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logUtil <span class="keyword">from</span> <span class="string">&#x27;./utils/logUtil&#x27;</span>;</span><br><span class="line"></span><br><span class="line">logUtil.<span class="title function_">log</span>(<span class="string">&quot;This will only log in test mode&quot;</span>);</span><br><span class="line">logUtil.<span class="title function_">warn</span>(<span class="string">&quot;This warning will only appear in test mode&quot;</span>);</span><br><span class="line">logUtil.<span class="title function_">error</span>(<span class="string">&quot;This error will only appear in test mode&quot;</span>);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="2-Load-Environment-Variables-in-Your-Application"><a href="#2-Load-Environment-Variables-in-Your-Application" class="headerlink" title="2. Load Environment Variables in Your Application"></a>2. Load Environment Variables in Your Application</h2><p>Vite automatically exposes environment variables prefixed with <code>VITE_</code> to your application via <code>import.meta.env</code>. To use environment-specific variables:</p>
<h3 id="Example-env-test"><a href="#Example-env-test" class="headerlink" title="Example: .env.test"></a>Example: <code>.env.test</code></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">VITE_ENV=test</span><br><span class="line">VITE_API_URL=https://api.test.example.com</span><br></pre></td></tr></table></figure>

<h3 id="Accessing-Environment-Variables"><a href="#Accessing-Environment-Variables" class="headerlink" title="Accessing Environment Variables:"></a>Accessing Environment Variables:</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> apiUrl = <span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">env</span>.<span class="property">VITE_API_URL</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(apiUrl); <span class="comment">// Outputs: https://api.test.example.com</span></span><br></pre></td></tr></table></figure>

<h3 id="Rules"><a href="#Rules" class="headerlink" title="Rules:"></a>Rules:</h3><ul>
<li>Prefix all environment variables with <code>VITE_</code> (e.g., <code>VITE_ENV</code>, <code>VITE_API_URL</code>).</li>
<li>Access them in your application using <code>import.meta.env</code>.</li>
</ul>
<hr>
<h2 id="3-Load-the-Correct-Environment-File-with-Vite-or-Yarn"><a href="#3-Load-the-Correct-Environment-File-with-Vite-or-Yarn" class="headerlink" title="3. Load the Correct Environment File (with Vite or Yarn)"></a>3. Load the Correct Environment File (with Vite or Yarn)</h2><p>Vite loads environment variables from <code>.env</code> files based on the <code>mode</code> specified during the build or development process.</p>
<h3 id="Environment-Files"><a href="#Environment-Files" class="headerlink" title="Environment Files:"></a>Environment Files:</h3><ul>
<li><code>.env</code>: Default environment file (loaded in all modes).</li>
<li><code>.env.test</code>: Loaded when the mode is <code>test</code>.</li>
<li><code>.env.production</code>: Loaded when the mode is <code>production</code>.</li>
</ul>
<h3 id="Specifying-the-Mode"><a href="#Specifying-the-Mode" class="headerlink" title="Specifying the Mode:"></a>Specifying the Mode:</h3><ul>
<li><strong>During Development</strong>:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn dev --mode <span class="built_in">test</span></span><br></pre></td></tr></table></figure></li>
<li><strong>During Build</strong>:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn build --mode <span class="built_in">test</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Example-Workflow"><a href="#Example-Workflow" class="headerlink" title="Example Workflow:"></a>Example Workflow:</h3><ol>
<li><p>Create a <code>.env.test</code> file:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">VITE_ENV=test</span><br><span class="line">VITE_API_URL=https://api.test.example.com</span><br></pre></td></tr></table></figure>
</li>
<li><p>Build the application in test mode:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn build --mode <span class="built_in">test</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Vite will load the <code>.env.test</code> file and expose its variables via <code>import.meta.env</code>.</p>
</li>
</ol>
<hr>
<h2 id="4-Start-the-Application-with-the-Build"><a href="#4-Start-the-Application-with-the-Build" class="headerlink" title="4. Start the Application with the Build"></a>4. Start the Application with the Build</h2><p>After building your application, you need to serve the production files. Use a static server like <code>serve</code> or Vite’s built-in <code>preview</code> command.</p>
<h3 id="Option-1-Using-serve"><a href="#Option-1-Using-serve" class="headerlink" title="Option 1: Using serve"></a>Option 1: Using <code>serve</code></h3><ol>
<li><p>Install <code>serve</code> globally or locally:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn global add serve</span><br></pre></td></tr></table></figure>
<p>Or:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add serve</span><br></pre></td></tr></table></figure>
</li>
<li><p>Serve the production build:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">serve -s dist</span><br></pre></td></tr></table></figure>
<ul>
<li>The <code>-s</code> flag ensures all routes fall back to <code>index.html</code> (useful for SPAs).</li>
<li>The <code>dist</code> directory is the default output directory for Vite builds.</li>
</ul>
</li>
<li><p>Access the application at <code>http://localhost:3000</code>.</p>
</li>
</ol>
<h3 id="Option-2-Using-Vite’s-Preview-Command"><a href="#Option-2-Using-Vite’s-Preview-Command" class="headerlink" title="Option 2: Using Vite’s Preview Command"></a>Option 2: Using Vite’s Preview Command</h3><ol>
<li><p>Add a <code>preview</code> script to your <code>package.json</code>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vite build&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;preview&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vite preview&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Build the application:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn build --mode <span class="built_in">test</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Start the preview server:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn preview</span><br></pre></td></tr></table></figure>
<ul>
<li>This serves the production build at <code>http://localhost:4173</code> (or another port if specified).</li>
</ul>
</li>
</ol>
<hr>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><ol>
<li><p><strong>Environment-Specific Logging</strong>:</p>
<ul>
<li>Use a utility like <code>logUtil.ts</code> to conditionally log based on the environment.</li>
</ul>
</li>
<li><p><strong>Loading Environment Variables</strong>:</p>
<ul>
<li>Prefix variables with <code>VITE_</code> and access them via <code>import.meta.env</code>.</li>
</ul>
</li>
<li><p><strong>Loading the Correct Environment File</strong>:</p>
<ul>
<li>Use the <code>--mode</code> flag with <code>yarn dev</code> or <code>yarn build</code> to load the appropriate <code>.env</code> file.</li>
</ul>
</li>
<li><p><strong>Starting the Application with the Build</strong>:</p>
<ul>
<li>Serve the production build using <code>serve</code> or Vite’s <code>preview</code> command.</li>
</ul>
</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2025/01/24/Deep-Dive-into-the-Hook-in-React/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/24/Deep-Dive-into-the-Hook-in-React/" class="post-title-link" itemprop="url">Deep Dive into the  Hook in React</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-01-24 12:22:32" itemprop="dateCreated datePublished" datetime="2025-01-24T12:22:32-05:00">2025-01-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/" itemprop="url" rel="index"><span itemprop="name">ReactJS</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/TypeScript/" itemprop="url" rel="index"><span itemprop="name">TypeScript</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="What-is-useRef"><a href="#What-is-useRef" class="headerlink" title="What is useRef?"></a>What is <code>useRef</code>?</h2><p><code>useRef</code> is a hook provided by React that allows you to:</p>
<ol>
<li><strong>Persist a mutable value across renders without triggering re-renders.</strong></li>
<li><strong>Access a DOM element directly.</strong></li>
<li><strong>Store values similar to an instance variable in class components.</strong></li>
</ol>
<h3 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> refContainer = <span class="title function_">useRef</span>(initialValue);</span><br></pre></td></tr></table></figure>

<ul>
<li><code>refContainer</code> is an object with a <code>current</code> property.</li>
<li><code>initialValue</code> is the initial value assigned to <code>current</code>.</li>
</ul>
<p>Textual diagram of a <code>useRef</code> object:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">useRef</span><br><span class="line">   |</span><br><span class="line">   |--- current: &lt;initialValue&gt;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Scenarios-and-Use-Cases"><a href="#Scenarios-and-Use-Cases" class="headerlink" title="Scenarios and Use Cases"></a>Scenarios and Use Cases</h2><h3 id="1-Accessing-DOM-Elements"><a href="#1-Accessing-DOM-Elements" class="headerlink" title="1. Accessing DOM Elements"></a>1. <strong>Accessing DOM Elements</strong></h3><p><code>useRef</code> is commonly used to directly access DOM elements. In class components, this was done using <code>React.createRef()</code>.</p>
<h4 id="Example"><a href="#Example" class="headerlink" title="Example:"></a>Example:</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">FocusInput</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleFocus</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (inputRef.<span class="property">current</span>) &#123;</span><br><span class="line">      inputRef.<span class="property">current</span>.<span class="title function_">focus</span>(); <span class="comment">// Directly focus the input element</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Click the button to focus&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleFocus&#125;</span>&gt;</span>Focus Input<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">FocusInput</span>;</span><br></pre></td></tr></table></figure>

<p><strong>Sequence Diagram:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">User clicks the &quot;Focus Input&quot; button</span><br><span class="line">|</span><br><span class="line">|--- `handleFocus` is invoked</span><br><span class="line">     |</span><br><span class="line">     |--- `inputRef.current.focus()` focuses the input element</span><br></pre></td></tr></table></figure>

<h3 id="2-Persisting-Values-Without-Re-Renders"><a href="#2-Persisting-Values-Without-Re-Renders" class="headerlink" title="2. Persisting Values Without Re-Renders"></a>2. <strong>Persisting Values Without Re-Renders</strong></h3><p>Unlike <code>useState</code>, updating a <code>useRef</code> value does not trigger a re-render.</p>
<h4 id="Example-1"><a href="#Example-1" class="headerlink" title="Example:"></a>Example:</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useRef, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Counter</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> renderCount = <span class="title function_">useRef</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">increment</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setCount</span>(count + <span class="number">1</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  renderCount.<span class="property">current</span> += <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Count: &#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Component rendered &#123;renderCount.current&#125; times<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;increment&#125;</span>&gt;</span>Increment<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Counter</span>;</span><br></pre></td></tr></table></figure>

<p><strong>Textual Diagram of State vs Ref:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">useState (Triggers Re-render):</span><br><span class="line">   state = count: 0 -&gt; render -&gt; state = count: 1 -&gt; render</span><br><span class="line"></span><br><span class="line">useRef (No Re-render):</span><br><span class="line">   ref = renderCount: 1 -&gt; render -&gt; ref = renderCount: 2 -&gt; no re-render</span><br></pre></td></tr></table></figure>

<h3 id="3-Storing-Mutable-Values"><a href="#3-Storing-Mutable-Values" class="headerlink" title="3. Storing Mutable Values"></a>3. <strong>Storing Mutable Values</strong></h3><p>When working with mutable values, <code>useRef</code> can store data that changes over time without impacting the component lifecycle.</p>
<h4 id="Example-2"><a href="#Example-2" class="headerlink" title="Example:"></a>Example:</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Stopwatch</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> timerId = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> startTime = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">startTimer</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    startTime.<span class="property">current</span> = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    timerId.<span class="property">current</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Elapsed time:&quot;</span>, <span class="title class_">Date</span>.<span class="title function_">now</span>() - startTime.<span class="property">current</span>);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">stopTimer</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="built_in">clearInterval</span>(timerId.<span class="property">current</span>);</span><br><span class="line">    timerId.<span class="property">current</span> = <span class="literal">null</span>;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;startTimer&#125;</span>&gt;</span>Start<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;stopTimer&#125;</span>&gt;</span>Stop<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Stopwatch</span>;</span><br></pre></td></tr></table></figure>

<p><strong>Sequence Diagram:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">User clicks &quot;Start&quot;</span><br><span class="line">|</span><br><span class="line">|--- `startTimer` invoked</span><br><span class="line">     |</span><br><span class="line">     |--- `startTime.current` set to current timestamp</span><br><span class="line">     |--- `timerId.current` stores interval ID</span><br><span class="line"></span><br><span class="line">User clicks &quot;Stop&quot;</span><br><span class="line">|</span><br><span class="line">|--- `stopTimer` invoked</span><br><span class="line">     |</span><br><span class="line">     |--- `clearInterval(timerId.current)` stops the timer</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-Avoiding-Closure-Pitfalls"><a href="#4-Avoiding-Closure-Pitfalls" class="headerlink" title="4. Avoiding Closure Pitfalls"></a>4. <strong>Avoiding Closure Pitfalls</strong></h3><p>In functional components, closures can lead to stale values being captured. <code>useRef</code> can prevent this by providing a mutable reference.</p>
<h4 id="Example-3"><a href="#Example-3" class="headerlink" title="Example:"></a>Example:</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">CounterWithRef</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> countRef = <span class="title function_">useRef</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">increment</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    countRef.<span class="property">current</span> += <span class="number">1</span>; <span class="comment">// Updates ref value</span></span><br><span class="line">    <span class="title function_">setCount</span>(countRef.<span class="property">current</span>); <span class="comment">// Updates state</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Count: &#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;increment&#125;</span>&gt;</span>Increment<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">CounterWithRef</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="When-to-Use-useRef"><a href="#When-to-Use-useRef" class="headerlink" title="When to Use useRef"></a>When to Use <code>useRef</code></h2><ul>
<li>Accessing DOM elements.</li>
<li>Storing mutable values that persist across renders.</li>
<li>Avoiding re-renders caused by state updates.</li>
<li>Managing timers, intervals, or external libraries.</li>
</ul>
<hr>
<h2 id="Common-Pitfalls"><a href="#Common-Pitfalls" class="headerlink" title="Common Pitfalls"></a>Common Pitfalls</h2><h3 id="1-Overusing-useRef"><a href="#1-Overusing-useRef" class="headerlink" title="1. Overusing useRef"></a>1. <strong>Overusing <code>useRef</code></strong></h3><p>Avoid using <code>useRef</code> for state that should trigger a re-render. Use <code>useState</code> or <code>useReducer</code> instead.</p>
<h3 id="2-Directly-Manipulating-DOM"><a href="#2-Directly-Manipulating-DOM" class="headerlink" title="2. Directly Manipulating DOM"></a>2. <strong>Directly Manipulating DOM</strong></h3><p>While <code>useRef</code> can access DOM elements, it’s generally better to rely on React’s declarative approach.</p>
<hr>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>The <code>useRef</code> hook is versatile and indispensable for managing references and mutable values. By understanding its use cases and limitations, you can write cleaner, more efficient React components.</p>
<hr>
<p>Here’s an updated article snippet that includes the scenario where <code>useRef</code> is used with <code>useEffect</code> to ensure that changes to the referenced value do not trigger <code>useEffect</code>, but the effect can still access the latest value of the reference.</p>
<hr>
<h3 id="Using-useRef-with-useEffect-to-Access-the-Latest-Value-Without-Re-triggering"><a href="#Using-useRef-with-useEffect-to-Access-the-Latest-Value-Without-Re-triggering" class="headerlink" title="Using useRef with useEffect to Access the Latest Value Without Re-triggering"></a>Using <code>useRef</code> with <code>useEffect</code> to Access the Latest Value Without Re-triggering</h3><p>One of the powerful features of <code>useRef</code> is that it provides a mutable object that does <strong>not trigger re-renders</strong> when its value changes. This characteristic makes it an excellent tool for scenarios where you need to access the latest value inside a <code>useEffect</code> but do not want the <code>useEffect</code> to re-run whenever the value changes.</p>
<h4 id="Why-Use-useRef-in-This-Scenario"><a href="#Why-Use-useRef-in-This-Scenario" class="headerlink" title="Why Use useRef in This Scenario?"></a>Why Use <code>useRef</code> in This Scenario?</h4><p>When a state variable is updated, it triggers a re-render, and the <code>useEffect</code> with that state as a dependency is re-executed. However, in some cases, you may want to:</p>
<ol>
<li>Access the latest value inside the <code>useEffect</code>.</li>
<li>Avoid re-triggering the <code>useEffect</code> when the value changes.</li>
</ol>
<p>This is where <code>useRef</code> comes in handy.</p>
<hr>
<h4 id="Code-Example-Accessing-the-Latest-Value-Without-Re-triggering-useEffect"><a href="#Code-Example-Accessing-the-Latest-Value-Without-Re-triggering-useEffect" class="headerlink" title="Code Example: Accessing the Latest Value Without Re-triggering useEffect"></a>Code Example: Accessing the Latest Value Without Re-triggering <code>useEffect</code></h4><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useEffect, useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">TimerComponent</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [isRunning, setIsRunning] = <span class="title function_">useState</span>(<span class="literal">false</span>); <span class="comment">// Controls if the timer is running</span></span><br><span class="line">  <span class="keyword">const</span> countRef = <span class="title function_">useRef</span>(<span class="number">0</span>); <span class="comment">// Tracks the count value</span></span><br><span class="line">  <span class="keyword">const</span> intervalRef = useRef&lt;<span class="title class_">NodeJS</span>.<span class="property">Timer</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>); <span class="comment">// Tracks the interval ID</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Start the timer</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">startTimer</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (!intervalRef.<span class="property">current</span>) &#123;</span><br><span class="line">      intervalRef.<span class="property">current</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        countRef.<span class="property">current</span> += <span class="number">1</span>; <span class="comment">// Update the countRef without causing a re-render</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Current count:&quot;</span>, countRef.<span class="property">current</span>); <span class="comment">// Always prints the latest count</span></span><br><span class="line">      &#125;, <span class="number">1000</span>);</span><br><span class="line">      <span class="title function_">setIsRunning</span>(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Stop the timer</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">stopTimer</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (intervalRef.<span class="property">current</span>) &#123;</span><br><span class="line">      <span class="built_in">clearInterval</span>(intervalRef.<span class="property">current</span>);</span><br><span class="line">      intervalRef.<span class="property">current</span> = <span class="literal">null</span>;</span><br><span class="line">      <span class="title function_">setIsRunning</span>(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Example: Access the latest value inside useEffect without adding dependencies</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">logLatestCount</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Timer stopped. Latest count value:&quot;</span>, countRef.<span class="property">current</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!isRunning) &#123;</span><br><span class="line">      <span class="title function_">logLatestCount</span>(); <span class="comment">// Logs the latest count value without needing countRef as a dependency</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (intervalRef.<span class="property">current</span>) <span class="built_in">clearInterval</span>(intervalRef.<span class="property">current</span>); <span class="comment">// Cleanup</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, [isRunning]); <span class="comment">// Dependency only on isRunning, but we can still access countRef.current</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Count: &#123;countRef.current&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> &#123;/* Ref does not trigger re-renders */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;startTimer&#125;</span> <span class="attr">disabled</span>=<span class="string">&#123;isRunning&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        Start</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;stopTimer&#125;</span> <span class="attr">disabled</span>=<span class="string">&#123;!isRunning&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        Stop</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">TimerComponent</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="Sequence-Breakdown"><a href="#Sequence-Breakdown" class="headerlink" title="Sequence Breakdown"></a>Sequence Breakdown</h4><ol>
<li><p><strong>Initial Render:</strong></p>
<ul>
<li>The <code>countRef</code> is initialized to <code>0</code>, and the <code>intervalRef</code> is <code>null</code>.</li>
</ul>
</li>
<li><p><strong>Start Timer (<code>startTimer</code>):</strong></p>
<ul>
<li>Sets up a timer with <code>setInterval</code>.</li>
<li>Updates <code>countRef.current</code> every second without causing re-renders.</li>
<li><code>isRunning</code> is updated, which triggers a re-render to disable the “Start” button.</li>
</ul>
</li>
<li><p><strong>Stop Timer (<code>stopTimer</code>):</strong></p>
<ul>
<li>Clears the interval and resets <code>intervalRef</code> to <code>null</code>.</li>
<li>Logs the latest value of <code>countRef.current</code> using <code>useEffect</code> because <code>isRunning</code> changes.</li>
</ul>
</li>
<li><p><strong>Access Latest Value in <code>useEffect</code>:</strong></p>
<ul>
<li>Even though <code>countRef</code> is not a dependency, <code>useEffect</code> can access its latest value because <code>useRef</code> does not reinitialize between renders.</li>
</ul>
</li>
</ol>
<hr>
<h4 id="Advantages-of-Using-useRef-in-This-Scenario"><a href="#Advantages-of-Using-useRef-in-This-Scenario" class="headerlink" title="Advantages of Using useRef in This Scenario"></a>Advantages of Using <code>useRef</code> in This Scenario</h4><ul>
<li><strong>Avoiding Re-renders:</strong> Unlike <code>useState</code>, updates to <code>useRef</code> do not trigger re-renders, making it perfect for frequently updated values like a timer count.</li>
<li><strong>Accessing Latest Value in Effects:</strong> The latest value in <code>useRef</code> is always accessible, even in effects, without adding it as a dependency.</li>
</ul>
<hr>
<h4 id="Textual-Diagram-How-useRef-and-useEffect-Work-Together"><a href="#Textual-Diagram-How-useRef-and-useEffect-Work-Together" class="headerlink" title="Textual Diagram: How useRef and useEffect Work Together"></a>Textual Diagram: How <code>useRef</code> and <code>useEffect</code> Work Together</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[Initial Render]</span><br><span class="line">  |</span><br><span class="line">  |--&gt; useRef initialized: countRef = &#123; current: 0 &#125;</span><br><span class="line">  |</span><br><span class="line">[Timer Starts (setInterval)]</span><br><span class="line">  |</span><br><span class="line">  |--&gt; countRef.current updated every second</span><br><span class="line">  |    (NO re-renders triggered)</span><br><span class="line">  |</span><br><span class="line">[useEffect Triggered on isRunning Change]</span><br><span class="line">  |</span><br><span class="line">  |--&gt; Access countRef.current to log the latest value</span><br><span class="line">  |    (No dependency needed for countRef)</span><br><span class="line">  |</span><br><span class="line">[Timer Stops]</span><br><span class="line">  |</span><br><span class="line">  |--&gt; useEffect logs latest countRef.current value</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2025/01/22/Deep-Dive-into-Google-Maps-Overlay-Types-with-React-TypeScript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/22/Deep-Dive-into-Google-Maps-Overlay-Types-with-React-TypeScript/" class="post-title-link" itemprop="url">Deep Dive into Google Maps Overlay Types with React + TypeScript</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-01-22 12:05:47" itemprop="dateCreated datePublished" datetime="2025-01-22T12:05:47-05:00">2025-01-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/" itemprop="url" rel="index"><span itemprop="name">ReactJS</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/TypeScript/" itemprop="url" rel="index"><span itemprop="name">TypeScript</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/TypeScript/GIS/" itemprop="url" rel="index"><span itemprop="name">GIS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ol>
<li><a href="#introduction-to-google-maps-overlays">Introduction to Google Maps Overlays</a></li>
<li><a href="#markers">Markers</a><ul>
<li><a href="#basic-marker">Basic Marker</a></li>
<li><a href="#custom-marker-with-advancedmarkerelement">Custom Marker with <code>AdvancedMarkerElement</code></a></li>
</ul>
</li>
<li><a href="#polygons">Polygons</a><ul>
<li><a href="#drawing-a-polygon">Drawing a Polygon</a></li>
<li><a href="#handling-polygon-events">Handling Polygon Events</a></li>
</ul>
</li>
<li><a href="#polylines">Polylines</a><ul>
<li><a href="#drawing-a-polyline">Drawing a Polyline</a></li>
<li><a href="#handling-polyline-events">Handling Polyline Events</a></li>
</ul>
</li>
<li><a href="#circles">Circles</a><ul>
<li><a href="#drawing-a-circle">Drawing a Circle</a></li>
<li><a href="#handling-circle-events">Handling Circle Events</a></li>
</ul>
</li>
<li><a href="#rectangles">Rectangles</a><ul>
<li><a href="#drawing-a-rectangle">Drawing a Rectangle</a></li>
<li><a href="#handling-rectangle-events">Handling Rectangle Events</a></li>
</ul>
</li>
<li><a href="#infowindows">InfoWindows</a><ul>
<li><a href="#adding-an-infowindow">Adding an InfoWindow</a></li>
<li><a href="#handling-infowindow-events">Handling InfoWindow Events</a></li>
</ul>
</li>
<li><a href="#groundoverlay">GroundOverlay</a><ul>
<li><a href="#adding-a-groundoverlay">Adding a GroundOverlay</a></li>
</ul>
</li>
<li><a href="#custom-overlays">Custom Overlays</a><ul>
<li><a href="#creating-a-custom-overlay">Creating a Custom Overlay</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ol>
<hr>
<h2 id="Introduction-to-Google-Maps-Overlays"><a href="#Introduction-to-Google-Maps-Overlays" class="headerlink" title="Introduction to Google Maps Overlays"></a>Introduction to Google Maps Overlays</h2><p>Overlays are graphical elements that you can add to a Google Map to represent data or highlight specific areas. Google Maps supports the following overlay types:</p>
<ul>
<li><strong>Markers</strong>: Represent points of interest.</li>
<li><strong>Polygons</strong>: Represent closed shapes with multiple vertices.</li>
<li><strong>Polylines</strong>: Represent lines with multiple vertices.</li>
<li><strong>Circles</strong>: Represent circular areas.</li>
<li><strong>Rectangles</strong>: Represent rectangular areas.</li>
<li><strong>InfoWindows:</strong> Display information about a specific location when a marker is clicked.</li>
<li><strong>GroundOverlay:</strong> Displays an image or a video over a defined geographical area.</li>
<li><strong>Custom Overlays:</strong> Allows developers to create their own custom overlays using HTML elements and JavaScript.</li>
</ul>
<hr>
<h2 id="Markers"><a href="#Markers" class="headerlink" title="Markers"></a>Markers</h2><p>Markers are used to represent points of interest on the map. Google Maps provides two types of markers:</p>
<ul>
<li><strong>Basic Marker</strong>: The traditional marker with a default icon.</li>
<li><strong>AdvancedMarkerElement</strong>: A customizable marker with support for custom icons and content.</li>
</ul>
<h3 id="Basic-Marker"><a href="#Basic-Marker" class="headerlink" title="Basic Marker"></a>Basic Marker</h3><p>Here’s how to create a basic marker:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">BasicMarker</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mapRef = useRef&lt;google.<span class="property">maps</span>.<span class="property">Map</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!mapRef.<span class="property">current</span>) &#123;</span><br><span class="line">      mapRef.<span class="property">current</span> = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Map</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;map&quot;</span>) <span class="keyword">as</span> <span class="title class_">HTMLElement</span>, &#123;</span><br><span class="line">        <span class="attr">center</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">        <span class="attr">zoom</span>: <span class="number">12</span>,</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Add a basic marker</span></span><br><span class="line">      <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Marker</span>(&#123;</span><br><span class="line">        <span class="attr">position</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">        <span class="attr">map</span>: mapRef.<span class="property">current</span>,</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;San Francisco&quot;</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> &quot;<span class="attr">100vh</span>&quot;, <span class="attr">width:</span> &quot;<span class="attr">100</span>%&quot; &#125;&#125; /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">BasicMarker</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Custom-Marker-with-AdvancedMarkerElement"><a href="#Custom-Marker-with-AdvancedMarkerElement" class="headerlink" title="Custom Marker with AdvancedMarkerElement"></a>Custom Marker with <code>AdvancedMarkerElement</code></h3><p>The <code>AdvancedMarkerElement</code> allows you to create highly customizable markers. Here’s an example:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">CustomMarker</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mapRef = useRef&lt;google.<span class="property">maps</span>.<span class="property">Map</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!mapRef.<span class="property">current</span>) &#123;</span><br><span class="line">      mapRef.<span class="property">current</span> = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Map</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;map&quot;</span>) <span class="keyword">as</span> <span class="title class_">HTMLElement</span>, &#123;</span><br><span class="line">        <span class="attr">center</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">        <span class="attr">zoom</span>: <span class="number">12</span>,</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Create a custom marker</span></span><br><span class="line">      <span class="keyword">const</span> pinElement = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">      pinElement.<span class="property">innerHTML</span> = <span class="string">&quot;📍&quot;</span>; <span class="comment">// Custom icon</span></span><br><span class="line">      pinElement.<span class="property">style</span>.<span class="property">fontSize</span> = <span class="string">&quot;24px&quot;</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="property">marker</span>.<span class="title class_">AdvancedMarkerElement</span>(&#123;</span><br><span class="line">        <span class="attr">position</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">        <span class="attr">map</span>: mapRef.<span class="property">current</span>,</span><br><span class="line">        <span class="attr">content</span>: pinElement,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> &quot;<span class="attr">100vh</span>&quot;, <span class="attr">width:</span> &quot;<span class="attr">100</span>%&quot; &#125;&#125; /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">CustomMarker</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Polygons"><a href="#Polygons" class="headerlink" title="Polygons"></a>Polygons</h2><p>Polygons are used to represent closed shapes with multiple vertices. You can customize their appearance and handle user interactions.</p>
<h3 id="Drawing-a-Polygon"><a href="#Drawing-a-Polygon" class="headerlink" title="Drawing a Polygon"></a>Drawing a Polygon</h3><p>Here’s how to draw a polygon:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">PolygonOverlay</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mapRef = useRef&lt;google.<span class="property">maps</span>.<span class="property">Map</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!mapRef.<span class="property">current</span>) &#123;</span><br><span class="line">      mapRef.<span class="property">current</span> = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Map</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;map&quot;</span>) <span class="keyword">as</span> <span class="title class_">HTMLElement</span>, &#123;</span><br><span class="line">        <span class="attr">center</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">        <span class="attr">zoom</span>: <span class="number">12</span>,</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Define the polygon&#x27;s path</span></span><br><span class="line">      <span class="keyword">const</span> polygonCoords = [</span><br><span class="line">        &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">lat</span>: <span class="number">37.7849</span>, <span class="attr">lng</span>: -<span class="number">122.4294</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">lat</span>: <span class="number">37.7949</span>, <span class="attr">lng</span>: -<span class="number">122.4094</span> &#125;,</span><br><span class="line">      ];</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Draw the polygon</span></span><br><span class="line">      <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Polygon</span>(&#123;</span><br><span class="line">        <span class="attr">paths</span>: polygonCoords,</span><br><span class="line">        <span class="attr">strokeColor</span>: <span class="string">&quot;#FF0000&quot;</span>,</span><br><span class="line">        <span class="attr">strokeOpacity</span>: <span class="number">0.8</span>,</span><br><span class="line">        <span class="attr">strokeWeight</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">fillColor</span>: <span class="string">&quot;#FF0000&quot;</span>,</span><br><span class="line">        <span class="attr">fillOpacity</span>: <span class="number">0.35</span>,</span><br><span class="line">        <span class="attr">map</span>: mapRef.<span class="property">current</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> &quot;<span class="attr">100vh</span>&quot;, <span class="attr">width:</span> &quot;<span class="attr">100</span>%&quot; &#125;&#125; /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">PolygonOverlay</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Handling-Polygon-Events"><a href="#Handling-Polygon-Events" class="headerlink" title="Handling Polygon Events"></a>Handling Polygon Events</h3><p>You can handle events like <code>click</code>, <code>mouseover</code>, and <code>mouseout</code> on polygons:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> polygon = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Polygon</span>(&#123;</span><br><span class="line">  <span class="attr">paths</span>: polygonCoords,</span><br><span class="line">  <span class="attr">strokeColor</span>: <span class="string">&quot;#FF0000&quot;</span>,</span><br><span class="line">  <span class="attr">strokeOpacity</span>: <span class="number">0.8</span>,</span><br><span class="line">  <span class="attr">strokeWeight</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">fillColor</span>: <span class="string">&quot;#FF0000&quot;</span>,</span><br><span class="line">  <span class="attr">fillOpacity</span>: <span class="number">0.35</span>,</span><br><span class="line">  <span class="attr">map</span>: mapRef.<span class="property">current</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">polygon.<span class="title function_">addListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">(<span class="params"><span class="attr">event</span>: google.maps.<span class="title class_">PolyMouseEvent</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Polygon clicked at:&quot;</span>, event.<span class="property">latLng</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Polylines"><a href="#Polylines" class="headerlink" title="Polylines"></a>Polylines</h2><p>Polylines are used to represent lines with multiple vertices. They are useful for drawing routes or paths.</p>
<h3 id="Drawing-a-Polyline"><a href="#Drawing-a-Polyline" class="headerlink" title="Drawing a Polyline"></a>Drawing a Polyline</h3><p>Here’s how to draw a polyline:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">PolylineOverlay</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mapRef = useRef&lt;google.<span class="property">maps</span>.<span class="property">Map</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!mapRef.<span class="property">current</span>) &#123;</span><br><span class="line">      mapRef.<span class="property">current</span> = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Map</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;map&quot;</span>) <span class="keyword">as</span> <span class="title class_">HTMLElement</span>, &#123;</span><br><span class="line">        <span class="attr">center</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">        <span class="attr">zoom</span>: <span class="number">12</span>,</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Define the polyline&#x27;s path</span></span><br><span class="line">      <span class="keyword">const</span> polylineCoords = [</span><br><span class="line">        &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">lat</span>: <span class="number">37.7849</span>, <span class="attr">lng</span>: -<span class="number">122.4294</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">lat</span>: <span class="number">37.7949</span>, <span class="attr">lng</span>: -<span class="number">122.4094</span> &#125;,</span><br><span class="line">      ];</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Draw the polyline</span></span><br><span class="line">      <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Polyline</span>(&#123;</span><br><span class="line">        <span class="attr">path</span>: polylineCoords,</span><br><span class="line">        <span class="attr">strokeColor</span>: <span class="string">&quot;#0000FF&quot;</span>,</span><br><span class="line">        <span class="attr">strokeOpacity</span>: <span class="number">1.0</span>,</span><br><span class="line">        <span class="attr">strokeWeight</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">map</span>: mapRef.<span class="property">current</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> &quot;<span class="attr">100vh</span>&quot;, <span class="attr">width:</span> &quot;<span class="attr">100</span>%&quot; &#125;&#125; /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">PolylineOverlay</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Handling-Polyline-Events"><a href="#Handling-Polyline-Events" class="headerlink" title="Handling Polyline Events"></a>Handling Polyline Events</h3><p>You can handle events like <code>click</code> on polylines:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> polyline = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Polyline</span>(&#123;</span><br><span class="line">  <span class="attr">path</span>: polylineCoords,</span><br><span class="line">  <span class="attr">strokeColor</span>: <span class="string">&quot;#0000FF&quot;</span>,</span><br><span class="line">  <span class="attr">strokeOpacity</span>: <span class="number">1.0</span>,</span><br><span class="line">  <span class="attr">strokeWeight</span>: <span class="number">4</span>,</span><br><span class="line">  <span class="attr">map</span>: mapRef.<span class="property">current</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">polyline.<span class="title function_">addListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">(<span class="params"><span class="attr">event</span>: google.maps.<span class="title class_">PolyMouseEvent</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Polyline clicked at:&quot;</span>, event.<span class="property">latLng</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Circles"><a href="#Circles" class="headerlink" title="Circles"></a>Circles</h2><p>Circles are used to represent circular areas on the map. You can customize their radius, color, and opacity.</p>
<h3 id="Drawing-a-Circle"><a href="#Drawing-a-Circle" class="headerlink" title="Drawing a Circle"></a>Drawing a Circle</h3><p>Here’s how to draw a circle:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">CircleOverlay</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mapRef = useRef&lt;google.<span class="property">maps</span>.<span class="property">Map</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!mapRef.<span class="property">current</span>) &#123;</span><br><span class="line">      mapRef.<span class="property">current</span> = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Map</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;map&quot;</span>) <span class="keyword">as</span> <span class="title class_">HTMLElement</span>, &#123;</span><br><span class="line">        <span class="attr">center</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">        <span class="attr">zoom</span>: <span class="number">12</span>,</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Draw the circle</span></span><br><span class="line">      <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Circle</span>(&#123;</span><br><span class="line">        <span class="attr">center</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">        <span class="attr">radius</span>: <span class="number">1000</span>, <span class="comment">// Radius in meters</span></span><br><span class="line">        <span class="attr">strokeColor</span>: <span class="string">&quot;#FF0000&quot;</span>,</span><br><span class="line">        <span class="attr">strokeOpacity</span>: <span class="number">0.8</span>,</span><br><span class="line">        <span class="attr">strokeWeight</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">fillColor</span>: <span class="string">&quot;#FF0000&quot;</span>,</span><br><span class="line">        <span class="attr">fillOpacity</span>: <span class="number">0.35</span>,</span><br><span class="line">        <span class="attr">map</span>: mapRef.<span class="property">current</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> &quot;<span class="attr">100vh</span>&quot;, <span class="attr">width:</span> &quot;<span class="attr">100</span>%&quot; &#125;&#125; /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">CircleOverlay</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Handling-Circle-Events"><a href="#Handling-Circle-Events" class="headerlink" title="Handling Circle Events"></a>Handling Circle Events</h3><p>You can handle events like <code>click</code> on circles:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> circle = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Circle</span>(&#123;</span><br><span class="line">  <span class="attr">center</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">  <span class="attr">radius</span>: <span class="number">1000</span>,</span><br><span class="line">  <span class="attr">strokeColor</span>: <span class="string">&quot;#FF0000&quot;</span>,</span><br><span class="line">  <span class="attr">strokeOpacity</span>: <span class="number">0.8</span>,</span><br><span class="line">  <span class="attr">strokeWeight</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">fillColor</span>: <span class="string">&quot;#FF0000&quot;</span>,</span><br><span class="line">  <span class="attr">fillOpacity</span>: <span class="number">0.35</span>,</span><br><span class="line">  <span class="attr">map</span>: mapRef.<span class="property">current</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">circle.<span class="title function_">addListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">(<span class="params"><span class="attr">event</span>: google.maps.<span class="title class_">MapMouseEvent</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Circle clicked at:&quot;</span>, event.<span class="property">latLng</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Rectangles"><a href="#Rectangles" class="headerlink" title="Rectangles"></a>Rectangles</h2><p>Rectangles are used to represent rectangular areas on the map. You can customize their bounds, color, and opacity.</p>
<h3 id="Drawing-a-Rectangle"><a href="#Drawing-a-Rectangle" class="headerlink" title="Drawing a Rectangle"></a>Drawing a Rectangle</h3><p>Here’s how to draw a rectangle:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">RectangleOverlay</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mapRef = useRef&lt;google.<span class="property">maps</span>.<span class="property">Map</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!mapRef.<span class="property">current</span>) &#123;</span><br><span class="line">      mapRef.<span class="property">current</span> = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Map</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;map&quot;</span>) <span class="keyword">as</span> <span class="title class_">HTMLElement</span>, &#123;</span><br><span class="line">        <span class="attr">center</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">        <span class="attr">zoom</span>: <span class="number">12</span>,</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Define the rectangle&#x27;s bounds</span></span><br><span class="line">      <span class="keyword">const</span> rectangleBounds = &#123;</span><br><span class="line">        <span class="attr">north</span>: <span class="number">37.7849</span>,</span><br><span class="line">        <span class="attr">south</span>: <span class="number">37.7649</span>,</span><br><span class="line">        <span class="attr">east</span>: -<span class="number">122.4094</span>,</span><br><span class="line">        <span class="attr">west</span>: -<span class="number">122.4294</span>,</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Draw the rectangle</span></span><br><span class="line">      <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Rectangle</span>(&#123;</span><br><span class="line">        <span class="attr">bounds</span>: rectangleBounds,</span><br><span class="line">        <span class="attr">strokeColor</span>: <span class="string">&quot;#0000FF&quot;</span>,</span><br><span class="line">        <span class="attr">strokeOpacity</span>: <span class="number">0.8</span>,</span><br><span class="line">        <span class="attr">strokeWeight</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">fillColor</span>: <span class="string">&quot;#0000FF&quot;</span>,</span><br><span class="line">        <span class="attr">fillOpacity</span>: <span class="number">0.35</span>,</span><br><span class="line">        <span class="attr">map</span>: mapRef.<span class="property">current</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> &quot;<span class="attr">100vh</span>&quot;, <span class="attr">width:</span> &quot;<span class="attr">100</span>%&quot; &#125;&#125; /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">RectangleOverlay</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Handling-Rectangle-Events"><a href="#Handling-Rectangle-Events" class="headerlink" title="Handling Rectangle Events"></a>Handling Rectangle Events</h3><p>You can handle events like <code>click</code> on rectangles:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> rectangle = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Rectangle</span>(&#123;</span><br><span class="line">  <span class="attr">bounds</span>: rectangleBounds,</span><br><span class="line">  <span class="attr">strokeColor</span>: <span class="string">&quot;#0000FF&quot;</span>,</span><br><span class="line">  <span class="attr">strokeOpacity</span>: <span class="number">0.8</span>,</span><br><span class="line">  <span class="attr">strokeWeight</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">fillColor</span>: <span class="string">&quot;#0000FF&quot;</span>,</span><br><span class="line">  <span class="attr">fillOpacity</span>: <span class="number">0.35</span>,</span><br><span class="line">  <span class="attr">map</span>: mapRef.<span class="property">current</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">rectangle.<span class="title function_">addListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">(<span class="params"><span class="attr">event</span>: google.maps.<span class="title class_">MapMouseEvent</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Rectangle clicked at:&quot;</span>, event.<span class="property">latLng</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="InfoWindows"><a href="#InfoWindows" class="headerlink" title="InfoWindows"></a>InfoWindows</h2><p>InfoWindows are used to display additional information about a location on the map. They are typically attached to markers but can also be used independently.</p>
<h3 id="Adding-an-InfoWindow"><a href="#Adding-an-InfoWindow" class="headerlink" title="Adding an InfoWindow"></a>Adding an InfoWindow</h3><p>Here’s how to add an InfoWindow to a marker:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">InfoWindowExample</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mapRef = useRef&lt;google.<span class="property">maps</span>.<span class="property">Map</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!mapRef.<span class="property">current</span>) &#123;</span><br><span class="line">      mapRef.<span class="property">current</span> = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Map</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;map&quot;</span>) <span class="keyword">as</span> <span class="title class_">HTMLElement</span>, &#123;</span><br><span class="line">        <span class="attr">center</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">        <span class="attr">zoom</span>: <span class="number">12</span>,</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Create a marker</span></span><br><span class="line">      <span class="keyword">const</span> marker = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Marker</span>(&#123;</span><br><span class="line">        <span class="attr">position</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">        <span class="attr">map</span>: mapRef.<span class="property">current</span>,</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;San Francisco&quot;</span>,</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Create an InfoWindow</span></span><br><span class="line">      <span class="keyword">const</span> infoWindow = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">InfoWindow</span>(&#123;</span><br><span class="line">        <span class="attr">content</span>: <span class="string">&quot;&lt;h3&gt;San Francisco&lt;/h3&gt;&lt;p&gt;Welcome to the Golden City!&lt;/p&gt;&quot;</span>,</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Attach the InfoWindow to the marker</span></span><br><span class="line">      marker.<span class="title function_">addListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        infoWindow.<span class="title function_">open</span>(mapRef.<span class="property">current</span>, marker);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> &quot;<span class="attr">100vh</span>&quot;, <span class="attr">width:</span> &quot;<span class="attr">100</span>%&quot; &#125;&#125; /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">InfoWindowExample</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Handling-InfoWindow-Events"><a href="#Handling-InfoWindow-Events" class="headerlink" title="Handling InfoWindow Events"></a>Handling InfoWindow Events</h3><p>You can handle events like <code>closeclick</code> on InfoWindows:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">infoWindow.<span class="title function_">addListener</span>(<span class="string">&quot;closeclick&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;InfoWindow closed&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="GroundOverlay"><a href="#GroundOverlay" class="headerlink" title="GroundOverlay"></a>GroundOverlay</h2><p>GroundOverlays are used to overlay images (e.g., maps, satellite imagery) on specific areas of the map.</p>
<h3 id="Adding-a-GroundOverlay"><a href="#Adding-a-GroundOverlay" class="headerlink" title="Adding a GroundOverlay"></a>Adding a GroundOverlay</h3><p>Here’s how to add a GroundOverlay:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">GroundOverlayExample</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mapRef = useRef&lt;google.<span class="property">maps</span>.<span class="property">Map</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!mapRef.<span class="property">current</span>) &#123;</span><br><span class="line">      mapRef.<span class="property">current</span> = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Map</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;map&quot;</span>) <span class="keyword">as</span> <span class="title class_">HTMLElement</span>, &#123;</span><br><span class="line">        <span class="attr">center</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">        <span class="attr">zoom</span>: <span class="number">12</span>,</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Define the bounds for the GroundOverlay</span></span><br><span class="line">      <span class="keyword">const</span> bounds = &#123;</span><br><span class="line">        <span class="attr">north</span>: <span class="number">37.7849</span>,</span><br><span class="line">        <span class="attr">south</span>: <span class="number">37.7649</span>,</span><br><span class="line">        <span class="attr">east</span>: -<span class="number">122.4094</span>,</span><br><span class="line">        <span class="attr">west</span>: -<span class="number">122.4294</span>,</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Add a GroundOverlay</span></span><br><span class="line">      <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">GroundOverlay</span>(</span><br><span class="line">        <span class="string">&quot;https://www.example.com/image.png&quot;</span>, <span class="comment">// URL of the image</span></span><br><span class="line">        bounds,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">map</span>: mapRef.<span class="property">current</span>,</span><br><span class="line">          <span class="attr">opacity</span>: <span class="number">0.5</span>, <span class="comment">// Set the opacity of the overlay</span></span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> &quot;<span class="attr">100vh</span>&quot;, <span class="attr">width:</span> &quot;<span class="attr">100</span>%&quot; &#125;&#125; /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">GroundOverlayExample</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Custom-Overlays"><a href="#Custom-Overlays" class="headerlink" title="Custom Overlays"></a>Custom Overlays</h2><p>Custom Overlays allow you to create fully custom overlays using HTML, CSS, and JavaScript. This is useful for adding complex UI elements to the map.</p>
<h3 id="Creating-a-Custom-Overlay"><a href="#Creating-a-Custom-Overlay" class="headerlink" title="Creating a Custom Overlay"></a>Creating a Custom Overlay</h3><p>Here’s how to create a custom overlay:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CustomOverlay</span> <span class="keyword">extends</span> <span class="title class_ inherited__">google.maps.OverlayView</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">div</span>: <span class="title class_">HTMLElement</span> | <span class="literal">null</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> <span class="attr">position</span>: google.maps.<span class="title class_">LatLng</span>,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> <span class="attr">content</span>: <span class="built_in">string</span></span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onAdd</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">div</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">div</span>.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&quot;absolute&quot;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">div</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&quot;white&quot;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">div</span>.<span class="property">style</span>.<span class="property">border</span> = <span class="string">&quot;1px solid black&quot;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">div</span>.<span class="property">style</span>.<span class="property">padding</span> = <span class="string">&quot;10px&quot;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">div</span>.<span class="property">innerHTML</span> = <span class="variable language_">this</span>.<span class="property">content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> panes = <span class="variable language_">this</span>.<span class="title function_">getPanes</span>();</span><br><span class="line">    <span class="keyword">if</span> (panes) &#123;</span><br><span class="line">      panes.<span class="property">overlayLayer</span>.<span class="title function_">appendChild</span>(<span class="variable language_">this</span>.<span class="property">div</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">draw</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">div</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> projection = <span class="variable language_">this</span>.<span class="title function_">getProjection</span>();</span><br><span class="line">      <span class="keyword">const</span> point = projection.<span class="title function_">fromLatLngToDivPixel</span>(<span class="variable language_">this</span>.<span class="property">position</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (point) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">div</span>.<span class="property">style</span>.<span class="property">left</span> = <span class="string">`<span class="subst">$&#123;point.x&#125;</span>px`</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">div</span>.<span class="property">style</span>.<span class="property">top</span> = <span class="string">`<span class="subst">$&#123;point.y&#125;</span>px`</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onRemove</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">div</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">div</span>.<span class="property">parentNode</span>?.<span class="title function_">removeChild</span>(<span class="variable language_">this</span>.<span class="property">div</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">div</span> = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">CustomOverlayExample</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mapRef = useRef&lt;google.<span class="property">maps</span>.<span class="property">Map</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!mapRef.<span class="property">current</span>) &#123;</span><br><span class="line">      mapRef.<span class="property">current</span> = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Map</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;map&quot;</span>) <span class="keyword">as</span> <span class="title class_">HTMLElement</span>, &#123;</span><br><span class="line">        <span class="attr">center</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">        <span class="attr">zoom</span>: <span class="number">12</span>,</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Create a custom overlay</span></span><br><span class="line">      <span class="keyword">const</span> overlay = <span class="keyword">new</span> <span class="title class_">CustomOverlay</span>(</span><br><span class="line">        <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">LatLng</span>(<span class="number">37.7749</span>, -<span class="number">122.4194</span>),</span><br><span class="line">        <span class="string">&quot;&lt;h3&gt;Custom Overlay&lt;/h3&gt;&lt;p&gt;This is a custom overlay!&lt;/p&gt;&quot;</span></span><br><span class="line">      );</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Add the overlay to the map</span></span><br><span class="line">      overlay.<span class="title function_">setMap</span>(mapRef.<span class="property">current</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> &quot;<span class="attr">100vh</span>&quot;, <span class="attr">width:</span> &quot;<span class="attr">100</span>%&quot; &#125;&#125; /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">CustomOverlayExample</span>;</span><br></pre></td></tr></table></figure>

<h2 id="References"><a href="#References" class="headerlink" title="References:"></a>References:</h2><h3 id="Setting-Up-Google-Maps-in-React"><a href="#Setting-Up-Google-Maps-in-React" class="headerlink" title="Setting Up Google Maps in React"></a>Setting Up Google Maps in React</h3><p>Before diving into overlays, ensure you have set up the Google Maps JavaScript API in your React application. Follow the steps in the <a target="_blank" rel="noopener" href="https://developers.google.com/maps/documentation/javascript/tutorial">Google Maps Documentation</a> to obtain your API key and include it in your project.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2025/01/21/Component-Communication-in-React-A-Comprehensive-Guide/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/21/Component-Communication-in-React-A-Comprehensive-Guide/" class="post-title-link" itemprop="url">Component Communication in React: A Comprehensive Guide</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-01-21 11:05:53" itemprop="dateCreated datePublished" datetime="2025-01-21T11:05:53-05:00">2025-01-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/" itemprop="url" rel="index"><span itemprop="name">ReactJS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr>
<h2 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h2><ol>
<li><a href="#1-props-parent-to-child">Props (Parent to Child)</a></li>
<li><a href="#2-callback-functions-child-to-parent">Callback Functions (Child to Parent)</a></li>
<li><a href="#3-react-context-api-global-state">React Context API (Global State)</a></li>
<li><a href="#4-state-management-libraries-redux-zustand-etc">State Management Libraries (Redux, Zustand, etc.)</a></li>
<li><a href="#5-refs-direct-dom-manipulation-or-between-components">Refs (Direct DOM Manipulation or Between Components)</a></li>
<li><a href="#6-event-emitters-custom-events">Event Emitters (Custom Events)</a></li>
<li><a href="#7-url-parameters-react-router">URL Parameters (React Router)</a></li>
<li><a href="#8-third-party-pubsub-libraries-eg-pubsubjs-rxjs">Third-Party Pub&#x2F;Sub Libraries (e.g., PubSubJS, RxJS)</a></li>
<li><a href="#9-apiserver-communication">API&#x2F;Server Communication</a></li>
</ol>
<hr>
<h2 id="1-Props-Parent-to-Child"><a href="#1-Props-Parent-to-Child" class="headerlink" title="1. Props (Parent to Child)"></a>1. Props (Parent to Child)</h2><p>Props allow data to flow from a parent component to a child component.</p>
<h3 id="Example-Code"><a href="#Example-Code" class="headerlink" title="Example Code:"></a>Example Code:</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Parent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> message = <span class="string">&quot;Hello from Parent!&quot;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Child</span> <span class="attr">message</span>=<span class="string">&#123;message&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Child</span>(<span class="params">&#123; message &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;message&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Textual-Diagram"><a href="#Textual-Diagram" class="headerlink" title="Textual Diagram:"></a>Textual Diagram:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Parent -&gt; Props -&gt; Child</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="2-Callback-Functions-Child-to-Parent"><a href="#2-Callback-Functions-Child-to-Parent" class="headerlink" title="2. Callback Functions (Child to Parent)"></a>2. Callback Functions (Child to Parent)</h2><p>A child component can communicate with its parent by invoking a callback function passed as a prop.</p>
<h3 id="Example-Code-1"><a href="#Example-Code-1" class="headerlink" title="Example Code:"></a>Example Code:</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Parent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleChildEvent</span> = (<span class="params">data</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Received from child:&quot;</span>, data);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Child</span> <span class="attr">onSend</span>=<span class="string">&#123;handleChildEvent&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Child</span>(<span class="params">&#123; onSend &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> onSend(&quot;Hello Parent!&quot;)&#125;&gt;Send Message<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Textual-Diagram-1"><a href="#Textual-Diagram-1" class="headerlink" title="Textual Diagram:"></a>Textual Diagram:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Child -&gt; Callback Function -&gt; Parent</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="3-React-Context-API-Global-State"><a href="#3-React-Context-API-Global-State" class="headerlink" title="3. React Context API (Global State)"></a>3. React Context API (Global State)</h2><p>The Context API allows you to share data across the component tree without passing props explicitly.</p>
<h3 id="Example-Code-2"><a href="#Example-Code-2" class="headerlink" title="Example Code:"></a>Example Code:</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; createContext, useContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MyContext</span> = <span class="title function_">createContext</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Parent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">MyContext.Provider</span> <span class="attr">value</span>=<span class="string">&quot;Shared Data&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Child</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">MyContext.Provider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Child</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> data = <span class="title function_">useContext</span>(<span class="title class_">MyContext</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;data&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Textual-Diagram-2"><a href="#Textual-Diagram-2" class="headerlink" title="Textual Diagram:"></a>Textual Diagram:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Parent -&gt; Context Provider -&gt; Child</span><br><span class="line">         Context Consumer &lt;- Child</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="4-State-Management-Libraries-Redux-Zustand-etc"><a href="#4-State-Management-Libraries-Redux-Zustand-etc" class="headerlink" title="4. State Management Libraries (Redux, Zustand, etc.)"></a>4. State Management Libraries (Redux, Zustand, etc.)</h2><p>State management libraries allow you to manage the global state of an application efficiently.</p>
<h3 id="Example-Code-Redux"><a href="#Example-Code-Redux" class="headerlink" title="Example Code (Redux):"></a>Example Code (Redux):</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&quot;redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span>, useDispatch, useSelector &#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state = &#123; count: <span class="number">0</span> &#125;, action</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;INCREMENT&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Counter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> count = <span class="title function_">useSelector</span>(<span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">count</span>);</span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(&#123; type: &quot;INCREMENT&quot; &#125;)&#125;&gt;Increment<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Counter</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Textual-Diagram-3"><a href="#Textual-Diagram-3" class="headerlink" title="Textual Diagram:"></a>Textual Diagram:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">State -&gt; Redux Store -&gt; Component</span><br><span class="line">        Dispatch Action &lt;- Component</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="5-Refs-Direct-DOM-Manipulation-or-Between-Components"><a href="#5-Refs-Direct-DOM-Manipulation-or-Between-Components" class="headerlink" title="5. Refs (Direct DOM Manipulation or Between Components)"></a>5. Refs (Direct DOM Manipulation or Between Components)</h2><p>Refs allow direct interaction with DOM elements or instances of other components.</p>
<h3 id="Example-Code-3"><a href="#Example-Code-3" class="headerlink" title="Example Code:"></a>Example Code:</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Parent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> childRef = <span class="title function_">useRef</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    childRef.<span class="property">current</span>.<span class="title function_">sayHello</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Child</span> <span class="attr">ref</span>=<span class="string">&#123;childRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>Call Child Method<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Child</span> = <span class="title class_">React</span>.<span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">useImperativeHandle</span>(ref, <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">sayHello</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">alert</span>(<span class="string">&quot;Hello from Child!&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;));</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Child Component<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Textual-Diagram-4"><a href="#Textual-Diagram-4" class="headerlink" title="Textual Diagram:"></a>Textual Diagram:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Parent -&gt; Ref -&gt; Child Method</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="6-Event-Emitters-Custom-Events"><a href="#6-Event-Emitters-Custom-Events" class="headerlink" title="6. Event Emitters (Custom Events)"></a>6. Event Emitters (Custom Events)</h2><p>Custom events can be used to communicate between loosely coupled components.</p>
<h3 id="Example-Code-4"><a href="#Example-Code-4" class="headerlink" title="Example Code:"></a>Example Code:</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">EventEmitter</span> &#125; <span class="keyword">from</span> <span class="string">&quot;events&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> eventEmitter = <span class="keyword">new</span> <span class="title class_">EventEmitter</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ComponentA</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">sendMessage</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    eventEmitter.<span class="title function_">emit</span>(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;Hello from ComponentA!&quot;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;sendMessage&#125;</span>&gt;</span>Send Message<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ComponentB</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    eventEmitter.<span class="title function_">on</span>(<span class="string">&quot;message&quot;</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Received:&quot;</span>, data);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      eventEmitter.<span class="title function_">removeAllListeners</span>(<span class="string">&quot;message&quot;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Listening for messages...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Textual-Diagram-5"><a href="#Textual-Diagram-5" class="headerlink" title="Textual Diagram:"></a>Textual Diagram:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ComponentA -&gt; Event Emitter -&gt; ComponentB</span><br></pre></td></tr></table></figure>

<h3 id="Comparison-with-Callback-Based-Approach"><a href="#Comparison-with-Callback-Based-Approach" class="headerlink" title="Comparison with Callback-Based Approach"></a>Comparison with Callback-Based Approach</h3><table>
<thead>
<tr>
<th><strong>Aspect</strong></th>
<th><strong>EventEmitter</strong></th>
<th><strong>Callback-Based</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>Coupling</strong></td>
<td>Decoupled (uses events)</td>
<td>Tightly coupled (passes callbacks)</td>
</tr>
<tr>
<td><strong>Scalability</strong></td>
<td>Highly scalable for multiple events</td>
<td>Less scalable for many events</td>
</tr>
<tr>
<td><strong>Complexity</strong></td>
<td>Slightly more complex (requires setup)</td>
<td>Simpler (direct function calls)</td>
</tr>
<tr>
<td><strong>Reusability</strong></td>
<td>Reusable across the application</td>
<td>Limited to specific components</td>
</tr>
<tr>
<td><strong>Memory Management</strong></td>
<td>Requires cleanup (off method)</td>
<td>Automatically cleaned up by React</td>
</tr>
</tbody></table>
<hr>
<h2 id="7-URL-Parameters-React-Router"><a href="#7-URL-Parameters-React-Router" class="headerlink" title="7. URL Parameters (React Router)"></a>7. URL Parameters (React Router)</h2><p>React Router enables communication via route parameters or query strings.</p>
<h3 id="Example-Code-5"><a href="#Example-Code-5" class="headerlink" title="Example Code:"></a>Example Code:</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BrowserRouter</span> <span class="keyword">as</span> <span class="title class_">Router</span>, <span class="title class_">Route</span>, useParams &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Parent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/user/:id&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Child&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Router</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Child</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = <span class="title function_">useParams</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>User ID: &#123;id&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Textual-Diagram-6"><a href="#Textual-Diagram-6" class="headerlink" title="Textual Diagram:"></a>Textual Diagram:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">URL -&gt; Route Params -&gt; Child</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="8-Third-Party-Pub-Sub-Libraries-e-g-PubSubJS-RxJS"><a href="#8-Third-Party-Pub-Sub-Libraries-e-g-PubSubJS-RxJS" class="headerlink" title="8. Third-Party Pub&#x2F;Sub Libraries (e.g., PubSubJS, RxJS)"></a>8. Third-Party Pub&#x2F;Sub Libraries (e.g., PubSubJS, RxJS)</h2><p>Libraries like RxJS or PubSubJS enable event-based communication.</p>
<h3 id="Example-Code-RxJS"><a href="#Example-Code-RxJS" class="headerlink" title="Example Code (RxJS):"></a>Example Code (RxJS):</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Subject</span> &#125; <span class="keyword">from</span> <span class="string">&quot;rxjs&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> subject = <span class="keyword">new</span> <span class="title class_">Subject</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ComponentA</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">sendMessage</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    subject.<span class="title function_">next</span>(<span class="string">&quot;Hello from ComponentA!&quot;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;sendMessage&#125;</span>&gt;</span>Send Message<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ComponentB</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> subscription = subject.<span class="title function_">subscribe</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Received:&quot;</span>, data);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> subscription.<span class="title function_">unsubscribe</span>();</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Listening for messages...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Textual-Diagram-7"><a href="#Textual-Diagram-7" class="headerlink" title="Textual Diagram:"></a>Textual Diagram:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ComponentA -&gt; Subject -&gt; ComponentB</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="9-API-Server-Communication"><a href="#9-API-Server-Communication" class="headerlink" title="9. API&#x2F;Server Communication"></a>9. API&#x2F;Server Communication</h2><p>Components can exchange data through a server or API.</p>
<h3 id="Example-Code-6"><a href="#Example-Code-6" class="headerlink" title="Example Code:"></a>Example Code:</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Parent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [data, setData] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&quot;/api/data&quot;</span>)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> <span class="title function_">setData</span>(data));</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Child</span> <span class="attr">data</span>=<span class="string">&#123;data&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Child</span>(<span class="params">&#123; data &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;data ? `Fetched Data: $&#123;data&#125;` : &quot;Loading...&quot;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Textual-Diagram-8"><a href="#Textual-Diagram-8" class="headerlink" title="Textual Diagram:"></a>Textual Diagram:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Server &lt;- Fetch API -&gt; Parent -&gt; Props -&gt; Child</span><br></pre></td></tr></table></figure>

<hr>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2025/01/14/Deep-Dive-Developing-a-React-TypeScript-Application-for-Google-Maps/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/14/Deep-Dive-Developing-a-React-TypeScript-Application-for-Google-Maps/" class="post-title-link" itemprop="url">Deep Dive Developing a React TypeScript Application for Google Maps</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-01-14 17:42:46" itemprop="dateCreated datePublished" datetime="2025-01-14T17:42:46-05:00">2025-01-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/" itemprop="url" rel="index"><span itemprop="name">ReactJS</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/TypeScript/" itemprop="url" rel="index"><span itemprop="name">TypeScript</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/TypeScript/GIS/" itemprop="url" rel="index"><span itemprop="name">GIS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Choosing-the-Right-React-Library-for-Google-Maps"><a href="#Choosing-the-Right-React-Library-for-Google-Maps" class="headerlink" title="Choosing the Right React Library for Google Maps"></a>Choosing the Right React Library for Google Maps</h2><p>There are two popular libraries for integrating Google Maps into React applications:</p>
<h3 id="1-react-google-maps-api"><a href="#1-react-google-maps-api" class="headerlink" title="1. react-google-maps-api"></a>1. <a target="_blank" rel="noopener" href="https://github.com/JustFly1984/react-google-maps-api">react-google-maps-api</a></h3><h4 id="Features"><a href="#Features" class="headerlink" title="Features:"></a>Features:</h4><ul>
<li>Built with TypeScript support out of the box.</li>
<li>Highly optimized for performance.</li>
<li>Provides detailed type definitions for Google Maps API objects and events.</li>
<li>Supports SSR (Server-Side Rendering) and lazy loading of the Google Maps API.</li>
</ul>
<h4 id="Pros"><a href="#Pros" class="headerlink" title="Pros:"></a>Pros:</h4><ul>
<li>Excellent TypeScript support.</li>
<li>Well-maintained and frequently updated.</li>
<li>Extensive documentation and examples.</li>
</ul>
<h4 id="Cons"><a href="#Cons" class="headerlink" title="Cons:"></a>Cons:</h4><ul>
<li>Requires a steeper learning curve due to its focus on optimization and customization.</li>
</ul>
<h3 id="2-react-google-maps-api"><a href="#2-react-google-maps-api" class="headerlink" title="2. @react-google-maps&#x2F;api"></a>2. <a target="_blank" rel="noopener" href="https://visgl.github.io/react-google-maps/">@react-google-maps&#x2F;api</a></h3><h4 id="Features-1"><a href="#Features-1" class="headerlink" title="Features:"></a>Features:</h4><ul>
<li>A modern, lightweight alternative to <code>react-google-maps-api</code>.</li>
<li>Provides a simple and intuitive API for Google Maps integration.</li>
<li>Supports TypeScript.</li>
<li>Optimized for performance with lazy loading and minimal re-renders.</li>
</ul>
<h4 id="Pros-1"><a href="#Pros-1" class="headerlink" title="Pros:"></a>Pros:</h4><ul>
<li>Lightweight and fast.</li>
<li>Easy to use with minimal boilerplate.</li>
<li>Excellent TypeScript support.</li>
</ul>
<h4 id="Cons-1"><a href="#Cons-1" class="headerlink" title="Cons:"></a>Cons:</h4><ul>
<li>Less mature compared to <code>react-google-maps-api</code>.</li>
<li>Fewer community resources and examples.</li>
</ul>
<h3 id="Recommendation"><a href="#Recommendation" class="headerlink" title="Recommendation:"></a>Recommendation:</h3><p>For most applications, <code>react-google-maps-api</code> is the preferred choice due to its robust TypeScript support and active development. However, for simpler projects, <code>@react-google-maps/api</code> may be sufficient.</p>
<hr>
<h2 id="Key-Considerations-for-Google-Maps-Event-Handling"><a href="#Key-Considerations-for-Google-Maps-Event-Handling" class="headerlink" title="Key Considerations for Google Maps Event Handling"></a>Key Considerations for Google Maps Event Handling</h2><h3 id="1-Event-Compatibility"><a href="#1-Event-Compatibility" class="headerlink" title="1. Event Compatibility"></a>1. Event Compatibility</h3><p>Google Maps provides different event types for various objects. Ensure the event you are attaching is supported by the target object. For example:</p>
<ul>
<li><strong>Polygon</strong> and <strong>Polyline</strong> support the <code>rightclick</code> event.</li>
<li><strong>MVCArray</strong> does <strong>not</strong> support <code>rightclick</code>, making it challenging to attach such an event directly to a vertex.</li>
</ul>
<h4 id="Tip"><a href="#Tip" class="headerlink" title="Tip:"></a>Tip:</h4><p>Always consult the <a target="_blank" rel="noopener" href="https://developers.google.com/maps/documentation/javascript/reference">Google Maps JavaScript API documentation</a> to verify event compatibility.</p>
<h3 id="2-Modern-GUI-Concepts"><a href="#2-Modern-GUI-Concepts" class="headerlink" title="2. Modern GUI Concepts"></a>2. Modern GUI Concepts</h3><p>When building interactions, remember:</p>
<ul>
<li>Many devices, such as iPads and smartphones, lack traditional mouse functionality.</li>
<li>Avoid relying on events like <code>rightclick</code> for core features. Instead, design user interfaces with touch and gesture interactions in mind.</li>
</ul>
<h3 id="3-Event-Attributes"><a href="#3-Event-Attributes" class="headerlink" title="3. Event Attributes"></a>3. Event Attributes</h3><p>Google Maps events like <code>MapMouseEvent</code> or <code>PolyMouseEvent</code> lack a <code>button</code> attribute to identify the mouse button used. Instead, use the <code>domEvent</code> property for this information.</p>
<h4 id="Example"><a href="#Example" class="headerlink" title="Example:"></a>Example:</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">polygon.<span class="title function_">addListener</span>(<span class="string">&quot;mousedown&quot;</span>, <span class="function">(<span class="params"><span class="attr">event</span>: google.maps.<span class="title class_">PolyMouseEvent</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mouseEvent = event.<span class="property">domEvent</span> <span class="keyword">as</span> <span class="title class_">MouseEvent</span>;</span><br><span class="line">  <span class="keyword">if</span> (mouseEvent.<span class="property">button</span> === <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Left mouse button clicked&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mouseEvent.<span class="property">button</span> === <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Right mouse button clicked&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Example-Attaching-Event-Listeners-to-Map-Objects"><a href="#Example-Attaching-Event-Listeners-to-Map-Objects" class="headerlink" title="Example: Attaching Event Listeners to Map Objects"></a>Example: Attaching Event Listeners to Map Objects</h2><p>Below is a React component for managing drawing tools and attaching event listeners to polygons and polylines.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useRef, useCallback, useState &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">addPathListeners</span> = (<span class="params"><span class="attr">path</span>: google.maps.<span class="title class_">MVCArray</span>&lt;google.maps.<span class="title class_">LatLng</span>&gt;</span>) =&gt; &#123;</span><br><span class="line">  path.<span class="title function_">forEach</span>(<span class="function">(<span class="params">_, index</span>) =&gt;</span> &#123;</span><br><span class="line">    google.<span class="property">maps</span>.<span class="property">event</span>.<span class="title function_">addListener</span>(path, <span class="string">&quot;mouseover&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Mouse over vertex <span class="subst">$&#123;index&#125;</span>`</span>);</span><br><span class="line">      <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">cursor</span> = <span class="string">&quot;pointer&quot;</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    google.<span class="property">maps</span>.<span class="property">event</span>.<span class="title function_">addListener</span>(path, <span class="string">&quot;mouseout&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">cursor</span> = <span class="string">&quot;default&quot;</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">attachListenersToEditablePolygon</span> = (<span class="params"><span class="attr">polygon</span>: google.maps.<span class="title class_">Polygon</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> path = polygon.<span class="title function_">getPath</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">addPathListeners</span>(path);</span><br><span class="line"></span><br><span class="line">  google.<span class="property">maps</span>.<span class="property">event</span>.<span class="title function_">addListener</span>(path, <span class="string">&quot;insert_at&quot;</span>, <span class="function">() =&gt;</span> <span class="title function_">addPathListeners</span>(path));</span><br><span class="line">  google.<span class="property">maps</span>.<span class="property">event</span>.<span class="title function_">addListener</span>(path, <span class="string">&quot;remove_at&quot;</span>, <span class="function">() =&gt;</span> <span class="title function_">addPathListeners</span>(path));</span><br><span class="line">  google.<span class="property">maps</span>.<span class="property">event</span>.<span class="title function_">addListener</span>(path, <span class="string">&quot;set_at&quot;</span>, <span class="function">() =&gt;</span> <span class="title function_">addPathListeners</span>(path));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MapDrawingManager</span>: <span class="title class_">React</span>.<span class="property">FC</span>&lt;&#123; <span class="attr">mapRef</span>: <span class="title class_">React</span>.<span class="property">RefObject</span>&lt;google.<span class="property">maps</span>.<span class="property">Map</span> | <span class="literal">null</span>&gt; &#125;&gt; = <span class="function">(<span class="params">&#123; mapRef &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> drawingManagerRef = useRef&lt;google.<span class="property">maps</span>.<span class="property">drawing</span>.<span class="property">DrawingManager</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> handlePolygonComplete = <span class="title function_">useCallback</span>(<span class="function">(<span class="params"><span class="attr">polygon</span>: google.maps.<span class="title class_">Polygon</span></span>) =&gt;</span> &#123;</span><br><span class="line">    polygon.<span class="title function_">setOptions</span>(&#123;</span><br><span class="line">      <span class="attr">fillColor</span>: <span class="string">&quot;#0000FF80&quot;</span>,</span><br><span class="line">      <span class="attr">strokeColor</span>: <span class="string">&quot;#0000FF&quot;</span>,</span><br><span class="line">      <span class="attr">strokeWeight</span>: <span class="number">4</span>,</span><br><span class="line">      <span class="attr">editable</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">attachListenersToEditablePolygon</span>(polygon);</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (mapRef.<span class="property">current</span> &amp;&amp; !drawingManagerRef.<span class="property">current</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> manager = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="property">drawing</span>.<span class="title class_">DrawingManager</span>(&#123;</span><br><span class="line">        <span class="attr">drawingMode</span>: google.<span class="property">maps</span>.<span class="property">drawing</span>.<span class="property">OverlayType</span>.<span class="property">POLYGON</span>,</span><br><span class="line">        <span class="attr">drawingControl</span>: <span class="literal">true</span>,</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      google.<span class="property">maps</span>.<span class="property">event</span>.<span class="title function_">addListener</span>(manager, <span class="string">&quot;polygoncomplete&quot;</span>, handlePolygonComplete);</span><br><span class="line"></span><br><span class="line">      manager.<span class="title function_">setMap</span>(mapRef.<span class="property">current</span>);</span><br><span class="line">      drawingManagerRef.<span class="property">current</span> = manager;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        manager.<span class="title function_">setMap</span>(<span class="literal">null</span>);</span><br><span class="line">        drawingManagerRef.<span class="property">current</span> = <span class="literal">null</span>;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [mapRef, handlePolygonComplete]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">MapDrawingManager</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Migrating-from-google-maps-marker-to-advancedmarker"><a href="#Migrating-from-google-maps-marker-to-advancedmarker" class="headerlink" title="Migrating from google.maps.marker to advancedmarker"></a>Migrating from <code>google.maps.marker</code> to <code>advancedmarker</code></h2><p>Google has deprecated the <code>google.maps.marker</code> class in favor of the new <code>advancedmarker</code> class. The <code>advancedmarker</code> class offers improved performance and additional features, making it the recommended choice for new projects.</p>
<h3 id="Key-Differences"><a href="#Key-Differences" class="headerlink" title="Key Differences:"></a>Key Differences:</h3><ul>
<li><strong>Performance</strong>: <code>advancedmarker</code> is optimized for better performance, especially in applications with a large number of markers.</li>
<li><strong>Features</strong>: <code>advancedmarker</code> supports advanced features like custom HTML content and improved event handling.</li>
</ul>
<h3 id="Migration-Steps"><a href="#Migration-Steps" class="headerlink" title="Migration Steps:"></a>Migration Steps:</h3><ol>
<li><strong>Update Imports</strong>: Replace <code>google.maps.marker</code> with <code>google.maps.advancedmarker</code>.</li>
<li><strong>Refactor Code</strong>: Update your code to use the new <code>advancedmarker</code> API. This may involve changes to how you create, configure, and interact with markers.</li>
<li><strong>Test Thoroughly</strong>: Ensure that your application works as expected after the migration.</li>
</ol>
<h4 id="Example-1"><a href="#Example-1" class="headerlink" title="Example:"></a>Example:</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Old way using google.maps.marker</span></span><br><span class="line"><span class="keyword">const</span> marker = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Marker</span>(&#123;</span><br><span class="line">  <span class="attr">position</span>: &#123; <span class="attr">lat</span>: -<span class="number">34.397</span>, <span class="attr">lng</span>: <span class="number">150.644</span> &#125;,</span><br><span class="line">  <span class="attr">map</span>: mapRef.<span class="property">current</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// New way using google.maps.advancedmarker</span></span><br><span class="line"><span class="keyword">const</span> advancedMarker = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="property">advancedmarker</span>.<span class="title class_">AdvancedMarker</span>(&#123;</span><br><span class="line">  <span class="attr">position</span>: &#123; <span class="attr">lat</span>: -<span class="number">34.397</span>, <span class="attr">lng</span>: <span class="number">150.644</span> &#125;,</span><br><span class="line">  <span class="attr">map</span>: mapRef.<span class="property">current</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Best-Practices"><a href="#Best-Practices" class="headerlink" title="Best Practices"></a>Best Practices</h2><ol>
<li><strong>Design for Touch-First:</strong> Avoid interactions relying on mouse-specific events like <code>rightclick</code>.</li>
<li><strong>Event Verification:</strong> Confirm the compatibility of events with the target object.</li>
<li><strong>TypeScript Usage:</strong> Leverage TypeScript for better type safety and developer experience.</li>
<li><strong>Code Modularity:</strong> Organize logic into reusable functions, such as <code>addPathListeners</code>.</li>
<li><strong>Migrate to <code>advancedmarker</code>:</strong> Update your code to use the new <code>advancedmarker</code> class for better performance and features.</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2025/01/08/Building-a-Google-Maps-Application-with-React-and-TypeScript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/08/Building-a-Google-Maps-Application-with-React-and-TypeScript/" class="post-title-link" itemprop="url">Building a Google Maps Application with React and TypeScript</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-01-08 10:47:17" itemprop="dateCreated datePublished" datetime="2025-01-08T10:47:17-05:00">2025-01-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/" itemprop="url" rel="index"><span itemprop="name">ReactJS</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/TypeScript/" itemprop="url" rel="index"><span itemprop="name">TypeScript</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/TypeScript/GIS/" itemprop="url" rel="index"><span itemprop="name">GIS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><ul>
<li><strong>Node.js</strong> installed (version 14 or higher).</li>
<li><strong>npm</strong> or <strong>yarn</strong> for package management.</li>
<li>A Google Cloud Platform (GCP) account to obtain the API Key and set up the Map ID.</li>
</ul>
<h2 id="Project-Setup"><a href="#Project-Setup" class="headerlink" title="Project Setup"></a>Project Setup</h2><ol>
<li><p><strong>Create a React Application</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npx create-react-app google-maps-app --template typescript</span><br><span class="line"><span class="built_in">cd</span> google-maps-app</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Install Required Dependencies</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install @react-google-maps/api</span><br><span class="line">npm install react-hook-form</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Setup Google Cloud Platform</strong>:</p>
<ul>
<li><strong>Enable the Maps JavaScript API</strong>:<ol>
<li>Go to the <a target="_blank" rel="noopener" href="https://console.cloud.google.com/">Google Cloud Console</a>.</li>
<li>Create a new project or select an existing one.</li>
<li>Navigate to <code>APIs &amp; Services</code> &gt; <code>Library</code> and enable the <code>Maps JavaScript API</code>.</li>
</ol>
</li>
<li><strong>Generate an API Key</strong>:<ol>
<li>Go to <code>APIs &amp; Services</code> &gt; <code>Credentials</code> and create an API Key.</li>
<li>Restrict the API Key to ensure security by specifying HTTP referrers (your domain or <code>localhost</code>).</li>
</ol>
</li>
<li><strong>Create a Map ID</strong>:<ol>
<li>Go to <code>Google Maps Platform</code> &gt; <code>Maps</code> &gt; <code>Map Management</code>.</li>
<li>Create a new Map ID and configure it with desired styles and settings.</li>
</ol>
</li>
</ul>
</li>
</ol>
<h2 id="Project-Structure"><a href="#Project-Structure" class="headerlink" title="Project Structure"></a>Project Structure</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">google-maps-app/</span><br><span class="line">├── public/</span><br><span class="line">├── src/</span><br><span class="line">│   ├── components/</span><br><span class="line">│   │   ├── MapContainer.tsx</span><br><span class="line">│   │   ├── SearchBox.tsx</span><br><span class="line">│   ├── App.tsx</span><br><span class="line">│   ├── index.tsx</span><br><span class="line">│   ├── types/</span><br><span class="line">│   │   ├── index.d.ts</span><br><span class="line">│   ├── utils/</span><br><span class="line">│       ├── mapUtils.ts</span><br></pre></td></tr></table></figure>

<h2 id="Coding-the-Application"><a href="#Coding-the-Application" class="headerlink" title="Coding the Application"></a>Coding the Application</h2><h3 id="Step-1-Setup-TypeScript-Types"><a href="#Step-1-Setup-TypeScript-Types" class="headerlink" title="Step 1: Setup TypeScript Types"></a>Step 1: Setup TypeScript Types</h3><p>Create <code>src/types/index.d.ts</code> to define types for the Google Maps objects:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="variable language_">global</span> &#123;</span><br><span class="line">  <span class="keyword">interface</span> <span class="title class_">Window</span> &#123;</span><br><span class="line">    <span class="attr">google</span>: <span class="built_in">any</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">MarkerData</span> &#123;</span><br><span class="line">  <span class="attr">position</span>: google.<span class="property">maps</span>.<span class="property">LatLngLiteral</span>;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Step-2-Utility-Functions"><a href="#Step-2-Utility-Functions" class="headerlink" title="Step 2: Utility Functions"></a>Step 2: Utility Functions</h3><p>Create <code>src/utils/mapUtils.ts</code> to define helper functions:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> loadGoogleMapsScript = (<span class="attr">apiKey</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">    script.<span class="property">src</span> = <span class="string">`https://maps.googleapis.com/maps/api/js?key=<span class="subst">$&#123;apiKey&#125;</span>&amp;libraries=places`</span>;</span><br><span class="line">    script.<span class="property">async</span> = <span class="literal">true</span>;</span><br><span class="line">    script.<span class="property">defer</span> = <span class="literal">true</span>;</span><br><span class="line">    script.<span class="property">onload</span> = <span class="function">() =&gt;</span> <span class="title function_">resolve</span>();</span><br><span class="line">    script.<span class="property">onerror</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> <span class="title function_">reject</span>(e);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(script);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="Step-3-Map-Container"><a href="#Step-3-Map-Container" class="headerlink" title="Step 3: Map Container"></a>Step 3: Map Container</h3><p>Create <code>src/components/MapContainer.tsx</code>:</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useRef, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">MarkerData</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../types&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MapContainerProps</span> = &#123;</span><br><span class="line">  <span class="attr">apiKey</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">mapId</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MapContainer</span>: <span class="title class_">React</span>.<span class="property">FC</span>&lt;<span class="title class_">MapContainerProps</span>&gt; = <span class="function">(<span class="params">&#123; apiKey, mapId &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mapRef = useRef&lt;<span class="title class_">HTMLDivElement</span>&gt;(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [map, setMap] = useState&lt;google.<span class="property">maps</span>.<span class="property">Map</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [markers, setMarkers] = useState&lt;google.<span class="property">maps</span>.<span class="property">Marker</span>[]&gt;([]);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">initMap</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">loadGoogleMapsScript</span>(apiKey);</span><br><span class="line">        <span class="keyword">if</span> (mapRef.<span class="property">current</span>) &#123;</span><br><span class="line">          <span class="keyword">const</span> mapInstance = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Map</span>(mapRef.<span class="property">current</span>, &#123;</span><br><span class="line">            <span class="attr">center</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">            <span class="attr">zoom</span>: <span class="number">12</span>,</span><br><span class="line">            <span class="attr">mapId</span>: mapId,</span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="title function_">setMap</span>(mapInstance);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Failed to load Google Maps:&#x27;</span>, error);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">initMap</span>();</span><br><span class="line">  &#125;, [apiKey, mapId]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">addMarker</span> = (<span class="params"><span class="attr">markerData</span>: <span class="title class_">MarkerData</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (map) &#123;</span><br><span class="line">      <span class="keyword">const</span> marker = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="property">marker</span>.<span class="title class_">AdvancedMarkerElement</span>(&#123;</span><br><span class="line">        map,</span><br><span class="line">        <span class="attr">position</span>: markerData.<span class="property">position</span>,</span><br><span class="line">        <span class="attr">title</span>: markerData.<span class="property">title</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="title function_">setMarkers</span>(<span class="function">(<span class="params">prev</span>) =&gt;</span> [...prev, marker]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;mapRef&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27;, <span class="attr">height:</span> &#x27;<span class="attr">500px</span>&#x27; &#125;&#125; /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">MapContainer</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Step-4-Search-Box"><a href="#Step-4-Search-Box" class="headerlink" title="Step 4: Search Box"></a>Step 4: Search Box</h3><p>Create <code>src/components/SearchBox.tsx</code>:</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">SearchBoxProps</span> = &#123;</span><br><span class="line">  <span class="attr">onPlaceSelected</span>: <span class="function">(<span class="params"><span class="attr">place</span>: google.maps.places.<span class="title class_">PlaceResult</span></span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">SearchBox</span>: <span class="title class_">React</span>.<span class="property">FC</span>&lt;<span class="title class_">SearchBoxProps</span>&gt; = <span class="function">(<span class="params">&#123; onPlaceSelected &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> inputRef = useRef&lt;<span class="title class_">HTMLInputElement</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (inputRef.<span class="property">current</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> autocomplete = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="property">places</span>.<span class="title class_">Autocomplete</span>(inputRef.<span class="property">current</span>);</span><br><span class="line">      autocomplete.<span class="title function_">addListener</span>(<span class="string">&#x27;place_changed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> place = autocomplete.<span class="title function_">getPlace</span>();</span><br><span class="line">        <span class="keyword">if</span> (place) &#123;</span><br><span class="line">          <span class="title function_">onPlaceSelected</span>(place);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Search places...&quot;</span> /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">SearchBox</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Step-5-Combine-Components"><a href="#Step-5-Combine-Components" class="headerlink" title="Step 5: Combine Components"></a>Step 5: Combine Components</h3><p>Update <code>src/App.tsx</code>:</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MapContainer</span> <span class="keyword">from</span> <span class="string">&#x27;./components/MapContainer&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">SearchBox</span> <span class="keyword">from</span> <span class="string">&#x27;./components/SearchBox&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">MarkerData</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./types&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [markers, setMarkers] = useState&lt;<span class="title class_">MarkerData</span>[]&gt;([]);</span><br><span class="line">  <span class="keyword">const</span> apiKey = <span class="string">&#x27;YOUR_GOOGLE_MAPS_API_KEY&#x27;</span>;</span><br><span class="line">  <span class="keyword">const</span> mapId = <span class="string">&#x27;YOUR_MAP_ID&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handlePlaceSelected</span> = (<span class="params"><span class="attr">place</span>: google.maps.places.<span class="title class_">PlaceResult</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (place.<span class="property">geometry</span>?.<span class="property">location</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> markerData = &#123;</span><br><span class="line">        <span class="attr">position</span>: &#123;</span><br><span class="line">          <span class="attr">lat</span>: place.<span class="property">geometry</span>.<span class="property">location</span>.<span class="title function_">lat</span>(),</span><br><span class="line">          <span class="attr">lng</span>: place.<span class="property">geometry</span>.<span class="property">location</span>.<span class="title function_">lng</span>(),</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">title</span>: place.<span class="property">name</span> || <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="title function_">setMarkers</span>(<span class="function">(<span class="params">prev</span>) =&gt;</span> [...prev, markerData]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">SearchBox</span> <span class="attr">onPlaceSelected</span>=<span class="string">&#123;handlePlaceSelected&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">MapContainer</span> <span class="attr">apiKey</span>=<span class="string">&#123;apiKey&#125;</span> <span class="attr">mapId</span>=<span class="string">&#123;mapId&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<h2 id="Running-the-Application"><a href="#Running-the-Application" class="headerlink" title="Running the Application"></a>Running the Application</h2><ol>
<li>Replace <code>YOUR_GOOGLE_MAPS_API_KEY</code> and <code>YOUR_MAP_ID</code> in <code>App.tsx</code> with your actual values.</li>
<li>Start the application:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure></li>
<li>Open <code>http://localhost:3000</code> in your browser.</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/12/28/Resolving-Dependency-Issues-in-useEffect-for-a-React-Application/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/12/28/Resolving-Dependency-Issues-in-useEffect-for-a-React-Application/" class="post-title-link" itemprop="url">Resolving Dependency Issues in useEffect for a React Application</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-12-28 22:15:21" itemprop="dateCreated datePublished" datetime="2024-12-28T22:15:21-05:00">2024-12-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/React/" itemprop="url" rel="index"><span itemprop="name">React</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/React/useEffect/" itemprop="url" rel="index"><span itemprop="name">useEffect</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/React/useEffect/React-Hooks/" itemprop="url" rel="index"><span itemprop="name">React Hooks</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Last week, I was tasked with building a Parameters.tsx component, and let me tell you, the struggle was real! I got completely entangled in a web of useEffect dependencies. It was like trying to untangle a Christmas tree of wires! 🎄 But hey, I finally emerged victorious (mostly) and learned some valuable lessons along the way. Here’s the story…</p>
<h2 id="The-Product-Requirement"><a href="#The-Product-Requirement" class="headerlink" title="The Product Requirement"></a><strong>The Product Requirement</strong></h2><ol>
<li>Initializes a table with passed-in parameters (<code>Record&lt;string, string&gt;</code>).  </li>
<li>Allows in-place editing of table rows.  </li>
<li>Automatically persists updated parameters to local storage, using a passed-in URL as the key.</li>
</ol>
<hr>
<h2 id="Implementation"><a href="#Implementation" class="headerlink" title="Implementation"></a><strong>Implementation</strong></h2><p>The implementation involves two <code>useEffect</code> hooks:</p>
<ol>
<li><strong>First <code>useEffect</code></strong>: Loads the passed-in parameters into the table.</li>
<li><strong>Second <code>useEffect</code></strong>: Saves the updated parameters to local storage whenever the user makes changes to the table rows.</li>
</ol>
<hr>
<h2 id="The-Problem"><a href="#The-Problem" class="headerlink" title="The Problem"></a><strong>The Problem</strong></h2><p>The <strong>key issue</strong> arises from the second <code>useEffect</code>. Since the URL (used as the storage key) is passed into the component, it was added as a dependency. This caused unintended behavior when switching endpoints, leading to:</p>
<ul>
<li>Saving the parameters of a <strong>previous endpoint</strong> under the <strong>new endpoint’s URL</strong>.</li>
</ul>
<h3 id="Scenario-Details"><a href="#Scenario-Details" class="headerlink" title="Scenario Details"></a><strong>Scenario Details</strong></h3><p>When switching endpoints, the <code>restfulEndpointUrl</code> (passed-in URL) changes. Since the URL is used as the key for saving parameters to local storage, it was added as a dependency to the second <code>useEffect</code>. However, this led to incorrect behavior:</p>
<ul>
<li>When the URL changes, the <code>useEffect</code> is triggered.</li>
<li>At this point, the table still contains the parameters of the <strong>previous endpoint</strong>.</li>
<li>As a result, the parameters of the previous endpoint are saved under the <strong>new endpoint’s URL</strong>, which is incorrect.</li>
</ul>
<h3 id="Why-This-Happens"><a href="#Why-This-Happens" class="headerlink" title="Why This Happens"></a><strong>Why This Happens</strong></h3><p>The <code>useEffect</code> hook runs whenever any of its dependencies change. By including <code>restfulEndpointUrl</code> in the dependency array, the <code>useEffect</code> is triggered when the URL changes, even though the table content hasn’t been updated yet.</p>
<hr>
<h2 id="Root-Cause-Unnecessary-Dependencies-in-useEffect"><a href="#Root-Cause-Unnecessary-Dependencies-in-useEffect" class="headerlink" title="Root Cause: Unnecessary Dependencies in useEffect"></a><strong>Root Cause: Unnecessary Dependencies in <code>useEffect</code></strong></h2><p>Let’s break down why adding <code>restfulEndpointUrl</code> as a dependency caused the issue:</p>
<ol>
<li><p><strong>How <code>useEffect</code> Dependencies Work</strong><br>The dependencies in the <code>useEffect</code> array dictate when the hook is re-triggered. By including <code>restfulEndpointUrl</code>, the persistence logic was unnecessarily invoked whenever the URL changed.  </p>
</li>
<li><p><strong>Incorrect State Handling</strong><br>When the URL changed, the persistence logic was triggered prematurely, using the <strong>outdated state of <code>rows</code></strong>, leading to data being saved under the incorrect key.</p>
</li>
</ol>
<h3 id="Impact-of-This-Bug"><a href="#Impact-of-This-Bug" class="headerlink" title="Impact of This Bug"></a><strong>Impact of This Bug</strong></h3><p>Here’s a sequence of events that led to the bug:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. restfulEndpointUrl = &quot;endpoint_1&quot;</span><br><span class="line">   - Rows initialized and saved correctly under &quot;endpoint_1&quot;.</span><br><span class="line">2. restfulEndpointUrl changes to &quot;endpoint_2&quot;</span><br><span class="line">   - useEffect triggers immediately.</span><br><span class="line">   - Old rows (from &quot;endpoint_1&quot;) are saved under &quot;endpoint_2&quot;.</span><br><span class="line">3. User edits table.</span><br><span class="line">   - New rows are saved under &quot;endpoint_2&quot;, but previous data is corrupted.</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Solution-Leveraging-useRef"><a href="#Solution-Leveraging-useRef" class="headerlink" title="Solution: Leveraging useRef"></a><strong>Solution: Leveraging <code>useRef</code></strong></h2><p>To fix this, we need to ensure that the persistence logic <strong>only runs when <code>rows</code> changes</strong>, and <strong>not when the URL changes</strong>.<br>This can be achieved by:</p>
<ol>
<li>Removing <code>restfulEndpointUrl</code> from the dependency array of the <code>useEffect</code> that handles persistence.</li>
<li>Using a <code>useRef</code> to always access the latest URL without triggering the <code>useEffect</code>.</li>
</ol>
<p>The <code>useRef</code> hook provides a solution by holding a mutable reference to the latest URL without triggering re-renders or re-triggering the <code>useEffect</code>. Here’s why it works:</p>
<ul>
<li><strong>Avoiding Dependencies:</strong> By using <code>useRef</code>, we avoid adding <code>restfulEndpointUrl</code> to the dependency array. The persistence logic is now triggered only when <code>rows</code> change.  </li>
<li><strong>Always Up-to-Date:</strong> Updating the <code>useRef</code> in its own <code>useEffect</code> ensures it always holds the latest URL.</li>
</ul>
<hr>
<h2 id="Why-useRef-Fixes-the-Problem"><a href="#Why-useRef-Fixes-the-Problem" class="headerlink" title="Why useRef Fixes the Problem"></a><strong>Why <code>useRef</code> Fixes the Problem</strong></h2><p>The <code>useRef</code> hook allows us to store a mutable value that persists across renders without causing re-renders. By storing the URL in a <code>ref</code>, we can:</p>
<ul>
<li>Access the latest URL value without adding it as a dependency to <code>useEffect</code>.</li>
<li>Ensure that the persistence logic only runs when <code>rows</code> changes, avoiding incorrect saves.</li>
</ul>
<hr>
<h2 id="Code-Comparison"><a href="#Code-Comparison" class="headerlink" title="Code Comparison"></a><strong>Code Comparison</strong></h2><h3 id="Before-Fixing"><a href="#Before-Fixing" class="headerlink" title="Before Fixing"></a><strong>Before Fixing</strong></h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [rows, setRows] = useState&lt;<span class="title class_">Row</span>[]&gt;([]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Initialize rows</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> initialRows = <span class="title class_">Object</span>.<span class="title function_">entries</span>(initialParams).<span class="title function_">map</span>(<span class="function">(<span class="params">[key, value]</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">selected</span>: <span class="literal">true</span>,</span><br><span class="line">        key,</span><br><span class="line">        value,</span><br><span class="line">        <span class="attr">description</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    &#125;));</span><br><span class="line">    <span class="title function_">setRows</span>(initialRows);</span><br><span class="line">&#125;, [initialParams]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Persist changes</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (restfulEndpointUrl) &#123;</span><br><span class="line">        <span class="keyword">const</span> params = rows</span><br><span class="line">            .<span class="title function_">filter</span>(<span class="function">(<span class="params">row</span>) =&gt;</span> row.<span class="property">selected</span> &amp;&amp; row.<span class="property">key</span>)</span><br><span class="line">            .<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, row</span>) =&gt;</span> &#123;</span><br><span class="line">                acc[row.<span class="property">key</span>] = row.<span class="property">value</span>;</span><br><span class="line">                <span class="keyword">return</span> acc;</span><br><span class="line">            &#125;, &#123;&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="title class_">LocalStorageHelper</span>.<span class="title function_">setParams</span>(restfulEndpointUrl, params);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, [rows, restfulEndpointUrl]); <span class="comment">// restfulEndpointUrl as a dependency causes issues</span></span><br></pre></td></tr></table></figure>

<h3 id="After-Fixing"><a href="#After-Fixing" class="headerlink" title="After Fixing"></a><strong>After Fixing</strong></h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [rows, setRows] = useState&lt;<span class="title class_">Row</span>[]&gt;([]);</span><br><span class="line"><span class="keyword">const</span> restfulEndpointUrlRef = <span class="title function_">useRef</span>(restfulEndpointUrl);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Update ref when URL changes</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    restfulEndpointUrlRef.<span class="property">current</span> = restfulEndpointUrl;</span><br><span class="line">&#125;, [restfulEndpointUrl]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Initialize rows</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> initialRows = <span class="title class_">Object</span>.<span class="title function_">entries</span>(initialParams).<span class="title function_">map</span>(<span class="function">(<span class="params">[key, value]</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">selected</span>: <span class="literal">true</span>,</span><br><span class="line">        key,</span><br><span class="line">        value,</span><br><span class="line">        <span class="attr">description</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    &#125;));</span><br><span class="line">    <span class="title function_">setRows</span>(initialRows);</span><br><span class="line">&#125;, [initialParams]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Persist changes</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> params = rows</span><br><span class="line">        .<span class="title function_">filter</span>(<span class="function">(<span class="params">row</span>) =&gt;</span> row.<span class="property">selected</span> &amp;&amp; row.<span class="property">key</span>)</span><br><span class="line">        .<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, row</span>) =&gt;</span> &#123;</span><br><span class="line">            acc[row.<span class="property">key</span>] = row.<span class="property">value</span>;</span><br><span class="line">            <span class="keyword">return</span> acc;</span><br><span class="line">        &#125;, &#123;&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title class_">LocalStorageHelper</span>.<span class="title function_">setParams</span>(restfulEndpointUrlRef.<span class="property">current</span>, params);</span><br><span class="line">&#125;, [rows]); <span class="comment">// URL dependency removed</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Sequence-Diagram-Before-the-Fix"><a href="#Sequence-Diagram-Before-the-Fix" class="headerlink" title="Sequence Diagram: Before the Fix"></a><strong>Sequence Diagram: Before the Fix</strong></h2><pre><code class="highlight mermaid">sequenceDiagram
    participant User
    participant Component
    participant LocalStorage

    User-&gt;&gt;Component: Switches Endpoint
    Component-&gt;&gt;Component: restfulEndpointUrl changes
    Component-&gt;&gt;Component: useEffect (persistence) triggers
    Component-&gt;&gt;Component: Table still contains params of previous endpoint
    Component-&gt;&gt;LocalStorage: Incorrect params saved under new endpoint&#x27;s URL</code></pre>

<h3 id="Explanation"><a href="#Explanation" class="headerlink" title="Explanation"></a><strong>Explanation</strong></h3><ol>
<li>The user switches the endpoint.</li>
<li>The <code>restfulEndpointUrl</code> changes.</li>
<li>The <code>useEffect</code> (persistence) triggers because <code>restfulEndpointUrl</code> is a dependency.</li>
<li>The table still contains the parameters of the <strong>previous endpoint</strong>.</li>
<li>The incorrect parameters are saved under the <strong>new endpoint’s URL</strong>.</li>
</ol>
<hr>
<h2 id="Sequence-Diagram-After-the-Fix"><a href="#Sequence-Diagram-After-the-Fix" class="headerlink" title="Sequence Diagram: After the Fix"></a><strong>Sequence Diagram: After the Fix</strong></h2><pre><code class="highlight mermaid">sequenceDiagram
    participant User
    participant Component
    participant LocalStorage

    User-&gt;&gt;Component: Switches Endpoint
    Component-&gt;&gt;Component: restfulEndpointUrl changes
    Component-&gt;&gt;Component: ref updated with new URL
    Component-&gt;&gt;Component: Table updated with new endpoint&#x27;s params
    User-&gt;&gt;Component: Edits Table
    Component-&gt;&gt;Component: useEffect (persistence) triggers
    Component-&gt;&gt;LocalStorage: Correct params saved under new endpoint&#x27;s URL</code></pre>

<h3 id="Explanation-1"><a href="#Explanation-1" class="headerlink" title="Explanation"></a><strong>Explanation</strong></h3><ol>
<li>The user switches the endpoint.</li>
<li>The <code>restfulEndpointUrl</code> changes.</li>
<li>The <code>ref</code> is updated with the new URL.</li>
<li>The table is updated with the new endpoint’s parameters.</li>
<li>The user edits the table.</li>
<li>The <code>useEffect</code> (persistence) triggers because <code>rows</code> changed.</li>
<li>The correct parameters are saved under the <strong>new endpoint’s URL</strong>.</li>
</ol>
<hr>
<h2 id="Key-Differences-in-the-Diagrams"><a href="#Key-Differences-in-the-Diagrams" class="headerlink" title="Key Differences in the Diagrams"></a><strong>Key Differences in the Diagrams</strong></h2><table>
<thead>
<tr>
<th><strong>Before the Fix</strong></th>
<th><strong>After the Fix</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>useEffect</code> triggers when <code>restfulEndpointUrl</code> changes.</td>
<td><code>useEffect</code> triggers only when <code>rows</code> changes.</td>
</tr>
<tr>
<td>Incorrect parameters are saved because the table hasn’t been updated yet.</td>
<td>Correct parameters are saved because the table is updated before persistence.</td>
</tr>
<tr>
<td><code>restfulEndpointUrl</code> is a dependency in <code>useEffect</code>.</td>
<td><code>restfulEndpointUrl</code> is stored in a <code>ref</code> and not a dependency in <code>useEffect</code>.</td>
</tr>
</tbody></table>
<hr>
<hr>
<h2 id="Key-Takeaways"><a href="#Key-Takeaways" class="headerlink" title="Key Takeaways"></a><strong>Key Takeaways</strong></h2><h3 id="Why-Unnecessary-Dependencies-Are-Problematic"><a href="#Why-Unnecessary-Dependencies-Are-Problematic" class="headerlink" title="Why Unnecessary Dependencies Are Problematic"></a><strong>Why Unnecessary Dependencies Are Problematic</strong></h3><ol>
<li>They can cause re-triggers in <code>useEffect</code> that don’t align with the intended logic.  </li>
<li>This often leads to outdated or incorrect state usage.</li>
</ol>
<h3 id="Why-useRef-Is-the-Solution"><a href="#Why-useRef-Is-the-Solution" class="headerlink" title="Why useRef Is the Solution"></a><strong>Why <code>useRef</code> Is the Solution</strong></h3><ol>
<li><code>useRef</code> provides a mutable container that doesn’t cause re-renders or hook re-triggers.  </li>
<li>It allows us to maintain the latest value of a variable without adding it to <code>useEffect</code> dependencies.</li>
</ol>
<hr>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a><strong>Conclusion</strong></h2><p>Using <code>useEffect</code> effectively requires careful consideration of its dependencies. In this case, leveraging <code>useRef</code> eliminated unnecessary triggers, ensuring the correct behavior when switching endpoints. This approach is a best practice for similar scenarios where state changes need to be decoupled from unrelated external variables.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/12/27/Deep-Dive-into-Local-Storage-Usage-in-React-with-TypeScript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/12/27/Deep-Dive-into-Local-Storage-Usage-in-React-with-TypeScript/" class="post-title-link" itemprop="url">Deep Dive into Local Storage Usage in React with TypeScript</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-12-27 16:00:44" itemprop="dateCreated datePublished" datetime="2024-12-27T16:00:44-05:00">2024-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/" itemprop="url" rel="index"><span itemprop="name">Deep Dive</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/React/" itemprop="url" rel="index"><span itemprop="name">React</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/React/TypeScript/" itemprop="url" rel="index"><span itemprop="name">TypeScript</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Local storage is a simple yet powerful tool for persisting data in web applications. In this article, we’ll explore every detail of local storage usage in React with TypeScript, including best practices, sample code, and test cases. The illustrations are based on the latest versions of React (18.x) and TypeScript (5.x).</p>
<hr>
<h2 id="What-is-Local-Storage"><a href="#What-is-Local-Storage" class="headerlink" title="What is Local Storage?"></a><strong>What is Local Storage?</strong></h2><p>Local storage is a web API that allows developers to store key-value pairs in a web browser. The data persists even after the browser is closed, making it ideal for saving user preferences, authentication tokens, and other non-sensitive data.</p>
<h3 id="Key-Characteristics-of-Local-Storage"><a href="#Key-Characteristics-of-Local-Storage" class="headerlink" title="Key Characteristics of Local Storage:"></a>Key Characteristics of Local Storage:</h3><ul>
<li><strong>Synchronous API</strong>: Operations are blocking.</li>
<li><strong>Storage Limit</strong>: Approximately 5MB per domain.</li>
<li><strong>Data Lifetime</strong>: Persists until explicitly deleted.</li>
<li><strong>Data Scope</strong>: Accessible only within the same origin.</li>
</ul>
<hr>
<h2 id="Using-Local-Storage-in-React-with-TypeScript"><a href="#Using-Local-Storage-in-React-with-TypeScript" class="headerlink" title="Using Local Storage in React with TypeScript"></a><strong>Using Local Storage in React with TypeScript</strong></h2><h3 id="1-Basic-CRUD-Operations"><a href="#1-Basic-CRUD-Operations" class="headerlink" title="1. Basic CRUD Operations"></a>1. <strong>Basic CRUD Operations</strong></h3><p>Local storage provides three core methods:</p>
<ul>
<li><code>localStorage.setItem(key, value)</code></li>
<li><code>localStorage.getItem(key)</code></li>
<li><code>localStorage.removeItem(key)</code></li>
</ul>
<h3 id="Example-Wrapper-Utility-for-Local-Storage"><a href="#Example-Wrapper-Utility-for-Local-Storage" class="headerlink" title="Example: Wrapper Utility for Local Storage"></a>Example: Wrapper Utility for Local Storage</h3><p>We can create a type-safe utility to handle common operations:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// utils/localStorage.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">LocalStorageHelper</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> setItem&lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">value</span>: T): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> getItem&lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>): T | <span class="literal">null</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> value = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">        <span class="keyword">return</span> value ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(value) <span class="keyword">as</span> T : <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="title function_">removeItem</span>(<span class="attr">key</span>: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Test-Cases"><a href="#Test-Cases" class="headerlink" title="Test Cases"></a>Test Cases</h3><p>Using Jest, we can write unit tests to validate the utility:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// utils/localStorage.test.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LocalStorageHelper</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./localStorage&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;LocalStorageHelper&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">beforeEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">clear</span>();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;should set and retrieve an item&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title class_">LocalStorageHelper</span>.<span class="title function_">setItem</span>(<span class="string">&quot;key&quot;</span>, &#123; <span class="attr">name</span>: <span class="string">&quot;John&quot;</span> &#125;);</span><br><span class="line">        <span class="keyword">const</span> item = <span class="title class_">LocalStorageHelper</span>.<span class="property">getItem</span>&lt;&#123; <span class="attr">name</span>: <span class="built_in">string</span> &#125;&gt;(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">        <span class="title function_">expect</span>(item).<span class="title function_">toEqual</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;John&quot;</span> &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;should return null for non-existent keys&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> item = <span class="title class_">LocalStorageHelper</span>.<span class="title function_">getItem</span>(<span class="string">&quot;nonexistent&quot;</span>);</span><br><span class="line">        <span class="title function_">expect</span>(item).<span class="title function_">toBeNull</span>();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;should remove an item&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title class_">LocalStorageHelper</span>.<span class="title function_">setItem</span>(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">        <span class="title class_">LocalStorageHelper</span>.<span class="title function_">removeItem</span>(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> item = <span class="title class_">LocalStorageHelper</span>.<span class="title function_">getItem</span>(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">        <span class="title function_">expect</span>(item).<span class="title function_">toBeNull</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="2-Integrating-Local-Storage-in-React-Components"><a href="#2-Integrating-Local-Storage-in-React-Components" class="headerlink" title="2. Integrating Local Storage in React Components"></a>2. <strong>Integrating Local Storage in React Components</strong></h3><h4 id="Example-Using-Local-Storage-with-useState"><a href="#Example-Using-Local-Storage-with-useState" class="headerlink" title="Example: Using Local Storage with useState"></a>Example: Using Local Storage with <code>useState</code></h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// components/Counter.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LocalStorageHelper</span> &#125; <span class="keyword">from</span> <span class="string">&quot;../utils/localStorage&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Counter</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [count, setCount] = useState&lt;<span class="built_in">number</span>&gt;(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">LocalStorageHelper</span>.<span class="property">getItem</span>&lt;<span class="built_in">number</span>&gt;(<span class="string">&quot;count&quot;</span>) || <span class="number">0</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title class_">LocalStorageHelper</span>.<span class="title function_">setItem</span>(<span class="string">&quot;count&quot;</span>, count);</span><br><span class="line">    &#125;, [count]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Counter: &#123;count&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount((prev) =&gt; prev + 1)&#125;&gt;Increment<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount((prev) =&gt; prev - 1)&#125;&gt;Decrement<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Counter</span>;</span><br></pre></td></tr></table></figure>

<h4 id="Test-Cases-1"><a href="#Test-Cases-1" class="headerlink" title="Test Cases"></a>Test Cases</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// components/Counter.test.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render, screen, fireEvent &#125; <span class="keyword">from</span> <span class="string">&quot;@testing-library/react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Counter</span> <span class="keyword">from</span> <span class="string">&quot;./Counter&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Counter Component&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;should initialize with value from local storage&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;count&quot;</span>, <span class="string">&quot;5&quot;</span>);</span><br><span class="line">        <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Counter</span> /&gt;</span></span>);</span><br><span class="line">        <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="regexp">/Counter: 5/i</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;should increment the counter&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Counter</span> /&gt;</span></span>);</span><br><span class="line">        fireEvent.<span class="title function_">click</span>(screen.<span class="title function_">getByText</span>(<span class="regexp">/Increment/i</span>));</span><br><span class="line">        <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="regexp">/Counter: 1/i</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;should decrement the counter&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Counter</span> /&gt;</span></span>);</span><br><span class="line">        fireEvent.<span class="title function_">click</span>(screen.<span class="title function_">getByText</span>(<span class="regexp">/Decrement/i</span>));</span><br><span class="line">        <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="regexp">/Counter: -1/i</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-React-Hooks-for-Local-Storage"><a href="#3-React-Hooks-for-Local-Storage" class="headerlink" title="3. React Hooks for Local Storage"></a>3. <strong>React Hooks for Local Storage</strong></h3><p>We can create a custom hook to encapsulate the logic for interacting with local storage.</p>
<h4 id="Example-Custom-Hook"><a href="#Example-Custom-Hook" class="headerlink" title="Example: Custom Hook"></a>Example: Custom Hook</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// hooks/useLocalStorage.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> useLocalStorage&lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">initialValue</span>: T) &#123;</span><br><span class="line">    <span class="keyword">const</span> [storedValue, setStoredValue] = useState&lt;T&gt;(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> item = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">            <span class="keyword">return</span> item ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(item) : initialValue;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Error reading localStorage key&quot;</span>, key, error);</span><br><span class="line">            <span class="keyword">return</span> initialValue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">setValue</span> = (<span class="params"><span class="attr">value</span>: T</span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="title function_">setStoredValue</span>(value);</span><br><span class="line">            <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Error setting localStorage key&quot;</span>, key, error);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [storedValue, setValue] <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useLocalStorage;</span><br></pre></td></tr></table></figure>

<h4 id="Usage-Example"><a href="#Usage-Example" class="headerlink" title="Usage Example"></a>Usage Example</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// components/ThemeSwitcher.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> useLocalStorage <span class="keyword">from</span> <span class="string">&quot;../hooks/useLocalStorage&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ThemeSwitcher</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [theme, setTheme] = useLocalStorage&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;theme&quot;</span>, <span class="string">&quot;light&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">theme-</span>$&#123;<span class="attr">theme</span>&#125;`&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Current Theme: &#123;theme&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setTheme(&quot;light&quot;)&#125;&gt;Light<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setTheme(&quot;dark&quot;)&#125;&gt;Dark<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">ThemeSwitcher</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-Best-Practices-for-Local-Storage-in-React"><a href="#4-Best-Practices-for-Local-Storage-in-React" class="headerlink" title="4. Best Practices for Local Storage in React"></a>4. <strong>Best Practices for Local Storage in React</strong></h3><ol>
<li><strong>Avoid Storing Sensitive Data</strong>: Local storage is not secure; avoid storing sensitive information like passwords or tokens.</li>
<li><strong>Validate Stored Data</strong>: Always validate and sanitize data retrieved from local storage.</li>
<li><strong>Error Handling</strong>: Wrap local storage operations in <code>try-catch</code> blocks to handle potential errors.</li>
<li><strong>Abstract Logic</strong>: Use utilities or hooks to encapsulate local storage interactions for reusability and type safety.</li>
<li><strong>Synchronize Across Tabs</strong>: Use the <code>storage</code> event to synchronize data across multiple tabs.</li>
</ol>
<h4 id="Example-Tab-Synchronization"><a href="#Example-Tab-Synchronization" class="headerlink" title="Example: Tab Synchronization"></a>Example: Tab Synchronization</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// hooks/useSyncLocalStorage.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useSyncLocalStorage</span>(<span class="params"><span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">callback</span>: (newValue: <span class="built_in">string</span> | <span class="literal">null</span>) =&gt; <span class="built_in">void</span></span>) &#123;</span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">handler</span> = (<span class="params"><span class="attr">event</span>: <span class="title class_">StorageEvent</span></span>) =&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (event.<span class="property">key</span> === key) &#123;</span><br><span class="line">                <span class="title function_">callback</span>(event.<span class="property">newValue</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;storage&quot;</span>, handler);</span><br><span class="line">        <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&quot;storage&quot;</span>, handler);</span><br><span class="line">    &#125;, [key, callback]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/12/20/Deep-Dive-Modal-Dialog-Mechanism-in-React-Applications/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/12/20/Deep-Dive-Modal-Dialog-Mechanism-in-React-Applications/" class="post-title-link" itemprop="url">Deep Dive: Modal Dialog Mechanism in React Applications</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-12-20 11:28:22" itemprop="dateCreated datePublished" datetime="2024-12-20T11:28:22-05:00">2024-12-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/" itemprop="url" rel="index"><span itemprop="name">ReactJS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Modal dialogs are a common UI pattern used to display important information, collect user input, or confirm actions. In React applications, implementing a modal dialog involves managing state, rendering the dialog conditionally, and ensuring proper styling and positioning. This article explores the modal dialog mechanism in React, using the popular <code>react-modal</code> library as an example. We’ll also provide a complete testing setup to ensure the modal works as expected.</p>
<hr>
<h3 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h3><ol>
<li><strong>Introduction to Modal Dialogs</strong></li>
<li><strong>Key Concepts in Modal Dialogs</strong></li>
<li><strong>Using <code>react-modal</code> in React</strong></li>
<li><strong>Styling and Positioning the Modal</strong></li>
<li><strong>Ensuring Proper Z-Index</strong></li>
<li><strong>Testing Modal Dialogs</strong></li>
<li><strong>Conclusion</strong></li>
</ol>
<hr>
<h3 id="1-Introduction-to-Modal-Dialogs"><a href="#1-Introduction-to-Modal-Dialogs" class="headerlink" title="1. Introduction to Modal Dialogs"></a>1. Introduction to Modal Dialogs</h3><p>A modal dialog is a UI component that overlays the main application content, forcing the user to interact with it before continuing. Modal dialogs are commonly used for:</p>
<ul>
<li>Alerts and confirmations</li>
<li>Form inputs</li>
<li>Loading indicators</li>
<li>Error messages</li>
</ul>
<p>In React, modal dialogs are typically implemented using state to control their visibility and lifecycle.</p>
<hr>
<h3 id="2-Key-Concepts-in-Modal-Dialogs"><a href="#2-Key-Concepts-in-Modal-Dialogs" class="headerlink" title="2. Key Concepts in Modal Dialogs"></a>2. Key Concepts in Modal Dialogs</h3><h4 id="a-State-Management"><a href="#a-State-Management" class="headerlink" title="a. State Management"></a>a. <strong>State Management</strong></h4><p>The visibility of a modal dialog is controlled by a boolean state variable (e.g., <code>isOpen</code>). When <code>isOpen</code> is <code>true</code>, the modal is rendered; otherwise, it is hidden.</p>
<h4 id="b-Conditional-Rendering"><a href="#b-Conditional-Rendering" class="headerlink" title="b. Conditional Rendering"></a>b. <strong>Conditional Rendering</strong></h4><p>The modal is rendered conditionally based on the state variable. This ensures that the modal is only added to the DOM when needed.</p>
<h4 id="c-Focus-Management"><a href="#c-Focus-Management" class="headerlink" title="c. Focus Management"></a>c. <strong>Focus Management</strong></h4><p>Modals should trap focus within their content to ensure accessibility. This prevents users from interacting with the background content while the modal is open.</p>
<h4 id="d-Z-Index"><a href="#d-Z-Index" class="headerlink" title="d. Z-Index"></a>d. <strong>Z-Index</strong></h4><p>The modal’s <code>z-index</code> must be higher than the parent component’s <code>z-index</code> to ensure it appears on top of other elements.</p>
<h4 id="e-Escape-Key-Handling"><a href="#e-Escape-Key-Handling" class="headerlink" title="e. Escape Key Handling"></a>e. <strong>Escape Key Handling</strong></h4><p>Users should be able to close the modal by pressing the <code>Escape</code> key.</p>
<hr>
<h3 id="3-Using-react-modal-in-React"><a href="#3-Using-react-modal-in-React" class="headerlink" title="3. Using react-modal in React"></a>3. Using <code>react-modal</code> in React</h3><p><code>react-modal</code> is a popular library for creating accessible and customizable modal dialogs in React. Below is an example of how to use it:</p>
<h4 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react-modal</span><br></pre></td></tr></table></figure>

<h4 id="Example-Code"><a href="#Example-Code" class="headerlink" title="Example Code"></a>Example Code</h4><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Modal</span> <span class="keyword">from</span> <span class="string">&quot;react-modal&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set the app element for accessibility (required by react-modal)</span></span><br><span class="line"><span class="title class_">Modal</span>.<span class="title function_">setAppElement</span>(<span class="string">&quot;#root&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> [isOpen, setIsOpen] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">openModal</span> = (<span class="params"></span>) =&gt; <span class="title function_">setIsOpen</span>(<span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">closeModal</span> = (<span class="params"></span>) =&gt; <span class="title function_">setIsOpen</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;openModal&#125;</span>&gt;</span>Open Modal<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Modal</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">isOpen</span>=<span class="string">&#123;isOpen&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">onRequestClose</span>=<span class="string">&#123;closeModal&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">contentLabel</span>=<span class="string">&quot;Example Modal&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">overlay:</span> &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">backgroundColor:</span> &quot;<span class="attr">rgba</span>(<span class="attr">0</span>, <span class="attr">0</span>, <span class="attr">0</span>, <span class="attr">0.5</span>)&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">zIndex:</span> <span class="attr">1000</span>, // <span class="attr">Ensure</span> <span class="attr">the</span> <span class="attr">modal</span> <span class="attr">is</span> <span class="attr">on</span> <span class="attr">top</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">content:</span> &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">width:</span> &quot;<span class="attr">400px</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">height:</span> &quot;<span class="attr">200px</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">margin:</span> &quot;<span class="attr">auto</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">padding:</span> &quot;<span class="attr">20px</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">borderRadius:</span> &quot;<span class="attr">8px</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">boxShadow:</span> &quot;<span class="attr">0</span> <span class="attr">4px</span> <span class="attr">6px</span> <span class="attr">rgba</span>(<span class="attr">0</span>, <span class="attr">0</span>, <span class="attr">0</span>, <span class="attr">0.1</span>)&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Modal Title<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>This is the modal content.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;closeModal&#125;</span>&gt;</span>Close<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Modal</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-Styling-and-Positioning-the-Modal"><a href="#4-Styling-and-Positioning-the-Modal" class="headerlink" title="4. Styling and Positioning the Modal"></a>4. Styling and Positioning the Modal</h3><h4 id="a-Custom-Styles"><a href="#a-Custom-Styles" class="headerlink" title="a. Custom Styles"></a>a. <strong>Custom Styles</strong></h4><p><code>react-modal</code> allows you to customize the modal’s appearance using the <code>style</code> prop. The <code>overlay</code> style controls the background overlay, while the <code>content</code> style controls the modal’s content.</p>
<h4 id="b-Centering-the-Modal"><a href="#b-Centering-the-Modal" class="headerlink" title="b. Centering the Modal"></a>b. <strong>Centering the Modal</strong></h4><p>To center the modal, set the <code>margin</code> property of the <code>content</code> style to <code>auto</code>.</p>
<h4 id="c-Responsive-Design"><a href="#c-Responsive-Design" class="headerlink" title="c. Responsive Design"></a>c. <strong>Responsive Design</strong></h4><p>Use CSS media queries to adjust the modal’s size and position for different screen sizes.</p>
<hr>
<h3 id="5-Ensuring-Proper-Z-Index"><a href="#5-Ensuring-Proper-Z-Index" class="headerlink" title="5. Ensuring Proper Z-Index"></a>5. Ensuring Proper Z-Index</h3><p>The <code>z-index</code> property is crucial for ensuring the modal appears on top of other elements. Here’s how to handle it:</p>
<h4 id="a-Set-a-High-Z-Index-for-the-Modal"><a href="#a-Set-a-High-Z-Index-for-the-Modal" class="headerlink" title="a. Set a High Z-Index for the Modal"></a>a. <strong>Set a High Z-Index for the Modal</strong></h4><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Modal</span></span><br><span class="line">    isOpen=&#123;isOpen&#125;</span><br><span class="line">    style=&#123;&#123;</span><br><span class="line">        <span class="attr">overlay</span>: &#123;</span><br><span class="line">            <span class="attr">zIndex</span>: <span class="number">1000</span>, <span class="comment">// Higher than other elements</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>

<h4 id="b-Ensure-Parent-Components-Have-Lower-Z-Index"><a href="#b-Ensure-Parent-Components-Have-Lower-Z-Index" class="headerlink" title="b. Ensure Parent Components Have Lower Z-Index"></a>b. <strong>Ensure Parent Components Have Lower Z-Index</strong></h4><p>If the parent component has a high <code>z-index</code>, the modal will not appear on top. For example:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.parent-component</span> &#123;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">10</span>; <span class="comment">/* Lower than the modal&#x27;s z-index */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="6-Testing-Modal-Dialogs"><a href="#6-Testing-Modal-Dialogs" class="headerlink" title="6. Testing Modal Dialogs"></a>6. Testing Modal Dialogs</h3><p>Testing modal dialogs ensures they work as expected in different scenarios. Below is an example of testing a modal dialog using <code>react-testing-library</code>.</p>
<h4 id="Installation-1"><a href="#Installation-1" class="headerlink" title="Installation"></a>Installation</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @testing-library/react @testing-library/jest-dom</span><br></pre></td></tr></table></figure>

<h4 id="Testing-Code"><a href="#Testing-Code" class="headerlink" title="Testing Code"></a>Testing Code</h4><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render, screen, fireEvent &#125; <span class="keyword">from</span> <span class="string">&quot;@testing-library/react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Modal</span> <span class="keyword">from</span> <span class="string">&quot;react-modal&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Mock react-modal</span></span><br><span class="line">jest.<span class="title function_">mock</span>(<span class="string">&quot;react-modal&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">Modal</span> = (<span class="params">&#123; isOpen, children &#125;</span>) =&gt; (isOpen ? <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;children&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span> : <span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Modal</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Modal Dialog&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;opens and closes the modal&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Modal should not be visible initially</span></span><br><span class="line">        <span class="title function_">expect</span>(screen.<span class="title function_">queryByText</span>(<span class="string">&quot;Modal Title&quot;</span>)).<span class="property">not</span>.<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Open the modal</span></span><br><span class="line">        fireEvent.<span class="title function_">click</span>(screen.<span class="title function_">getByText</span>(<span class="string">&quot;Open Modal&quot;</span>));</span><br><span class="line">        <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="string">&quot;Modal Title&quot;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Close the modal</span></span><br><span class="line">        fireEvent.<span class="title function_">click</span>(screen.<span class="title function_">getByText</span>(<span class="string">&quot;Close&quot;</span>));</span><br><span class="line">        <span class="title function_">expect</span>(screen.<span class="title function_">queryByText</span>(<span class="string">&quot;Modal Title&quot;</span>)).<span class="property">not</span>.<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="7-Conclusion"><a href="#7-Conclusion" class="headerlink" title="7. Conclusion"></a>7. Conclusion</h3><p>Modal dialogs are a powerful tool for enhancing user interaction in React applications. By understanding key concepts like state management, conditional rendering, focus trapping, and <code>z-index</code>, you can create accessible and user-friendly modals. The <code>react-modal</code> library simplifies the process, and proper testing ensures your modals work as expected in all scenarios.</p>
<hr>
<h3 id="Additional-Resources"><a href="#Additional-Resources" class="headerlink" title="Additional Resources"></a>Additional Resources</h3><ul>
<li><a target="_blank" rel="noopener" href="https://reactcommunity.org/react-modal/">React Modal Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://testing-library.com/docs/react-testing-library/intro/">React Testing Library Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index">Z-Index and Stacking Contexts</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/12/19/Run-a-Proxy-Server-with-cors-anywhere/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/12/19/Run-a-Proxy-Server-with-cors-anywhere/" class="post-title-link" itemprop="url">Run a Proxy Server with cors-anywhere</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-12-19 12:14:20" itemprop="dateCreated datePublished" datetime="2024-12-19T12:14:20-05:00">2024-12-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Node-js/" itemprop="url" rel="index"><span itemprop="name">Node.js</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Node-js/Proxy/" itemprop="url" rel="index"><span itemprop="name">Proxy</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Node-js/Proxy/CORS/" itemprop="url" rel="index"><span itemprop="name">CORS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h4 id="1-Install-Node-js"><a href="#1-Install-Node-js" class="headerlink" title="1. Install Node.js"></a>1. <strong>Install Node.js</strong></h4><ul>
<li>Ensure you have Node.js installed on your machine. You can download it from <a target="_blank" rel="noopener" href="https://nodejs.org/">nodejs.org</a>.</li>
<li>Verify the installation by running:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="2-Create-a-New-Directory-for-Your-Proxy-Server"><a href="#2-Create-a-New-Directory-for-Your-Proxy-Server" class="headerlink" title="2. Create a New Directory for Your Proxy Server"></a>2. <strong>Create a New Directory for Your Proxy Server</strong></h4><ul>
<li>Create a new directory for your proxy server:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> cors-proxy-server</span><br><span class="line"><span class="built_in">cd</span> cors-proxy-server</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="3-Initialize-a-New-Node-js-Project"><a href="#3-Initialize-a-New-Node-js-Project" class="headerlink" title="3. Initialize a New Node.js Project"></a>3. <strong>Initialize a New Node.js Project</strong></h4><ul>
<li>Initialize a new Node.js project:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure></li>
<li>This will create a <code>package.json</code> file.</li>
</ul>
<h4 id="4-Install-cors-anywhere"><a href="#4-Install-cors-anywhere" class="headerlink" title="4. Install cors-anywhere"></a>4. <strong>Install <code>cors-anywhere</code></strong></h4><ul>
<li>Install the <code>cors-anywhere</code> package:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install cors-anywhere</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="5-Create-the-Proxy-Server-Script"><a href="#5-Create-the-Proxy-Server-Script" class="headerlink" title="5. Create the Proxy Server Script"></a>5. <strong>Create the Proxy Server Script</strong></h4><ul>
<li>Create a new file named <code>server.js</code> in the project directory:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> server.js</span><br></pre></td></tr></table></figure></li>
<li>Add the following code to <code>server.js</code>:</li>
</ul>
<hr>
<h3 id="server-js-JavaScript-Implementation"><a href="#server-js-JavaScript-Implementation" class="headerlink" title="server.js (JavaScript Implementation)"></a><code>server.js</code> (JavaScript Implementation)</h3><p>Here’s the complete implementation of the proxy server in <strong>JavaScript</strong>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cors_proxy = <span class="built_in">require</span>(<span class="string">&quot;cors-anywhere&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Define the host and port for the proxy server</span></span><br><span class="line"><span class="keyword">const</span> host = <span class="string">&quot;127.0.0.1&quot;</span>; <span class="comment">// Localhost</span></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">8080</span>; <span class="comment">// Port to run the proxy</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Create and start the proxy server</span></span><br><span class="line">cors_proxy</span><br><span class="line">    .<span class="title function_">createServer</span>(&#123;</span><br><span class="line">        <span class="attr">originWhitelist</span>: [], <span class="comment">// Allow all origins (you can restrict this to specific domains)</span></span><br><span class="line">        <span class="attr">requireHeader</span>: [<span class="string">&quot;origin&quot;</span>, <span class="string">&quot;x-requested-with&quot;</span>], <span class="comment">// Require these headers</span></span><br><span class="line">        <span class="attr">removeHeaders</span>: [<span class="string">&quot;cookie&quot;</span>, <span class="string">&quot;cookie2&quot;</span>], <span class="comment">// Remove sensitive headers</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">listen</span>(port, host, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CORS Anywhere proxy server is running on http://<span class="subst">$&#123;host&#125;</span>:<span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="6-Run-the-Proxy-Server"><a href="#6-Run-the-Proxy-Server" class="headerlink" title="6. Run the Proxy Server"></a>6. <strong>Run the Proxy Server</strong></h3><ul>
<li>Start the proxy server:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node server.js</span><br></pre></td></tr></table></figure></li>
<li>You should see the following output:<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CORS Anywhere proxy server is running on http://127.0.0.1:8080</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="Using-the-Proxy-Server-in-Your-Application"><a href="#Using-the-Proxy-Server-in-Your-Application" class="headerlink" title="Using the Proxy Server in Your Application"></a>Using the Proxy Server in Your Application</h3><p>Once the proxy server is running, you can use it in your application to bypass CORS restrictions.</p>
<h4 id="Example-Fetching-Data-in-a-React-Application"><a href="#Example-Fetching-Data-in-a-React-Application" class="headerlink" title="Example: Fetching Data in a React Application"></a>Example: Fetching Data in a React Application</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> proxyUrl = <span class="string">&quot;http://127.0.0.1:8080/&quot;</span>; <span class="comment">// Your local proxy server</span></span><br><span class="line"><span class="keyword">const</span> apiUrl = <span class="string">&quot;https://dog.ceo/api/breeds/list/all&quot;</span>; <span class="comment">// The API you want to access</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">fetch</span>(proxyUrl + apiUrl)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(data))</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Error:&quot;</span>, error));</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Summary-of-Steps"><a href="#Summary-of-Steps" class="headerlink" title="Summary of Steps"></a>Summary of Steps</h3><ol>
<li>Install Node.js and initialize a new project.</li>
<li>Install the <code>cors-anywhere</code> package.</li>
<li>Create a <code>server.js</code> file with the proxy server implementation.</li>
<li>Run the proxy server using <code>node server.js</code>.</li>
<li>Use the proxy server in your application by prefixing your API URL with the proxy URL.</li>
</ol>
<hr>
<h3 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h3><ul>
<li><strong>Security</strong>: By default, the proxy server allows all origins (<code>originWhitelist: []</code>). You can restrict this to specific domains for better security.</li>
<li><strong>Production</strong>: Running a local proxy server is fine for development, but for production, consider deploying the proxy server to a cloud service (e.g., Heroku, Vercel) or using a backend server as a middleman.</li>
<li><strong>Rate Limits</strong>: Some APIs may have rate limits or restrictions on the number of requests you can make. Be mindful of this when using a proxy.</li>
</ul>
<p>This setup will allow you to bypass CORS restrictions and make API requests from your application during development.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Dazhi Zhang</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.1/mermaid.min.js","integrity":"sha256-YbM1pG3wWnzhyYN49g5fPnen+2CKEFaZfopkkwSpNtY="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  





</body>
</html>
