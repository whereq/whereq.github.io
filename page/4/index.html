<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.whereq.com","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.21.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="WhereQ">
<meta property="og:url" content="https://www.whereq.com/page/4/index.html">
<meta property="og:site_name" content="WhereQ">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Dazhi Zhang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.whereq.com/page/4/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/4/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>WhereQ</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">WhereQ</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-articles"><a href="/articles/" rel="section"><i class="fa fa-file fa-fw"></i>Articles</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Dazhi Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">128</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">116</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">75</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/04/Best-Practices-for-Local-Storage-Handling-in-ReactJS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/04/Best-Practices-for-Local-Storage-Handling-in-ReactJS/" class="post-title-link" itemprop="url">Best Practices for Local Storage Handling in ReactJS</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-04 17:49:26 / Modified: 18:48:34" itemprop="dateCreated datePublished" datetime="2024-11-04T17:49:26-05:00">2024-11-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/" itemprop="url" rel="index"><span itemprop="name">Deep Dive</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/ReactJS/" itemprop="url" rel="index"><span itemprop="name">ReactJS</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/ReactJS/Redux/" itemprop="url" rel="index"><span itemprop="name">Redux</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/ReactJS/Redux/Best-Practices/" itemprop="url" rel="index"><span itemprop="name">Best Practices</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#1-local-storage-basics">1. Local Storage Basics</a></li>
<li><a href="#11-project-setup">1.1 Project Setup</a><ul>
<li><a href="#yarn-commands">Yarn Commands</a></li>
</ul>
</li>
<li><a href="#12-project-folder-structure">1.2 Project Folder Structure</a><ul>
<li><a href="#21-what-is-local-storage">2.1 What is Local Storage?</a></li>
<li><a href="#22-local-storage-vs-session-storage">2.2 Local Storage vs Session Storage</a></li>
</ul>
</li>
<li><a href="#3-local-storage-basics">3. Local Storage Basics</a></li>
<li><a href="#31-basic-api">3.1 Basic API</a><ul>
<li><a href="#32-type-safety">3.2 Type Safety</a></li>
<li><a href="#33-error-handling">3.3 Error Handling</a></li>
<li><a href="#34-data-serialization">3.4 Data Serialization</a></li>
<li><a href="#35-expiration-handling">3.5 Expiration Handling</a></li>
</ul>
</li>
<li><a href="#4-best-practices">4. Best Practices</a><ul>
<li><a href="#41-encapsulating-local-storage-access">4.1 Encapsulating Local Storage Access</a></li>
</ul>
</li>
<li><a href="#5-more-scenarios">5 More Scenarios</a><ul>
<li><a href="#51-scenario-1-user-preferences">5.1 Scenario 1: User Preferences</a></li>
<li><a href="#52-scenario-2-shopping-cart">5.2 Scenario 2: Shopping Cart</a></li>
</ul>
</li>
<li><a href="#6-design-diagrams">6-Design Diagrams</a><ul>
<li><a href="#61-component-diagram">6.1 Component Diagram</a></li>
<li><a href="#62-sequence-diagram">6.2 Sequence Diagram</a></li>
</ul>
</li>
<li><a href="#7-unit-test-cases">7. Unit Test Cases</a><ul>
<li><a href="#71-userpreferencescomponenttesttsx">7.1 UserPreferencesComponent.test.tsx</a></li>
<li><a href="#72-shoppingcartcomponenttesttsx">7.2 ShoppingCartComponent.test.tsx</a></li>
</ul>
</li>
<li><a href="#8-commands-to-init-and-add-dependencies">8. Commands to Init and Add Dependencies</a></li>
<li><a href="#9-conclusion">9. Conclusion</a></li>
<li><a href="#10-more-samples">10. More Samples</a><ul>
<li><a href="#101-project-setup">10.1 Project Setup</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Local storage is a powerful tool for persisting data in web applications. In ReactJS, local storage can be used to store user preferences, shopping cart items, and other data that needs to persist across sessions. This article will deep dive into best practices for handling local storage in ReactJS with TypeScript, focusing on functional components and the latest version of the tech stack. We will provide real production scenarios with TypeScript code samples, design diagrams, project folder structures, unit test cases, and commands to initialize and add dependencies using Yarn.</p>
<p><a name="1-local-storage-basics"></a></p>
<h2 id="1-Local-Storage-Basics"><a href="#1-Local-Storage-Basics" class="headerlink" title="1. Local Storage Basics"></a>1. Local Storage Basics</h2><p><a name="11-project-setup"></a></p>
<h2 id="1-1-Project-Setup"><a href="#1-1-Project-Setup" class="headerlink" title="1.1 Project Setup"></a>1.1 Project Setup</h2><p>To get started, we need to set up a React project with TypeScript and add the necessary dependencies using Yarn.</p>
<h3 id="Yarn-Commands"><a href="#Yarn-Commands" class="headerlink" title="Yarn Commands"></a>Yarn Commands</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a React project with TypeScript template</span></span><br><span class="line">yarn create react-app local-storage-app --template typescript</span><br><span class="line"></span><br><span class="line"><span class="comment"># Navigate into the project directory</span></span><br><span class="line"><span class="built_in">cd</span> local-storage-app</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add any additional dependencies if needed (e.g., testing libraries)</span></span><br><span class="line">yarn add @testing-library/react @testing-library/jest-dom</span><br></pre></td></tr></table></figure>

<p><a name="12-project-folder-structure"></a></p>
<h2 id="1-2-Project-Folder-Structure"><a href="#1-2-Project-Folder-Structure" class="headerlink" title="1.2 Project Folder Structure"></a>1.2 Project Folder Structure</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">project-root/</span><br><span class="line">├── src/</span><br><span class="line">│   ├── components/</span><br><span class="line">│   │   ├── UserPreferencesComponent.tsx</span><br><span class="line">│   │   ├── ShoppingCartComponent.tsx</span><br><span class="line">│   ├── hooks/</span><br><span class="line">│   │   └── useLocalStorage.ts</span><br><span class="line">│   ├── utils/</span><br><span class="line">│   │   ├── localStorageUtils.ts</span><br><span class="line">│   ├── App.tsx</span><br><span class="line">│   ├── index.tsx</span><br><span class="line">├── tests/</span><br><span class="line">│   ├── components/</span><br><span class="line">│   │   ├── UserPreferencesComponent.test.tsx</span><br><span class="line">│   │   ├── ShoppingCartComponent.test.tsx</span><br><span class="line">│   ├── utils/</span><br><span class="line">│   │   ├── localStorageUtils.test.ts</span><br><span class="line">├── package.json</span><br><span class="line">├── tsconfig.json</span><br><span class="line">├── yarn.lock</span><br></pre></td></tr></table></figure>

<p><a name="21-what-is-local-storage"></a></p>
<h3 id="2-1-What-is-Local-Storage"><a href="#2-1-What-is-Local-Storage" class="headerlink" title="2.1 What is Local Storage?"></a>2.1 What is Local Storage?</h3><p>Local storage is a web storage API that allows you to store key-value pairs in a web browser. It is a synchronous, persistent storage that allows developers to store data client-side. The data stored in local storage persists even after the browser is closed and reopened. Leveraging local storage in React applications with TypeScript can help maintain user state, save preferences, and reduce API calls.</p>
<p><a name="22-local-storage-vs-session-storage"></a></p>
<h3 id="2-2-Local-Storage-vs-Session-Storage"><a href="#2-2-Local-Storage-vs-Session-Storage" class="headerlink" title="2.2 Local Storage vs Session Storage"></a>2.2 Local Storage vs Session Storage</h3><ul>
<li><strong>Local Storage</strong>: Data persists across browser sessions.</li>
<li><strong>Session Storage</strong>: Data is cleared when the browser session ends (e.g., when the browser is closed).</li>
</ul>
<p><a name="3-local-storage-basics"></a></p>
<h2 id="3-Local-Storage-Basics"><a href="#3-Local-Storage-Basics" class="headerlink" title="3. Local Storage Basics"></a>3. Local Storage Basics</h2><p><a name="31-basic-api"></a></p>
<h2 id="3-1-Basic-API"><a href="#3-1-Basic-API" class="headerlink" title="3.1 Basic API"></a>3.1 Basic API</h2><p>Local storage provides a simple API: <code>setItem()</code>, <code>getItem()</code>, and <code>removeItem()</code>. Data stored in local storage is accessible across browser sessions.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Setting an item</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;key&#x27;</span>, <span class="string">&#x27;value&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Getting an item</span></span><br><span class="line"><span class="keyword">const</span> value = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;key&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Removing an item</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;key&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="32-type-safety"></a></p>
<h3 id="3-2-Type-Safety"><a href="#3-2-Type-Safety" class="headerlink" title="3.2 Type Safety"></a>3.2 Type Safety</h3><p>Use TypeScript to ensure type safety when interacting with local storage. Create utility functions or custom hooks in TypeScript to handle type-safe operations.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">UserPreferences</span> &#123;</span><br><span class="line">  <span class="attr">theme</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">notifications</span>: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> setUserPreferences = (<span class="attr">preferences</span>: <span class="title class_">UserPreferences</span>): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">setLocalStorageItem</span>(<span class="string">&#x27;userPreferences&#x27;</span>, preferences);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getUserPreferences = (): <span class="title class_">UserPreferences</span> | <span class="function"><span class="params">null</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> getLocalStorageItem&lt;<span class="title class_">UserPreferences</span>&gt;(<span class="string">&#x27;userPreferences&#x27;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><a name="33-error-handling"></a></p>
<h3 id="3-3-Error-Handling"><a href="#3-3-Error-Handling" class="headerlink" title="3.3 Error Handling"></a>3.3 Error Handling</h3><p>Handle errors gracefully when interacting with local storage. Wrap local storage operations in <code>try-catch</code> blocks to handle any potential errors gracefully.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> setLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">value</span>: T): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value));</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Error setting local storage item: <span class="subst">$&#123;error&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>): T | <span class="function"><span class="params">null</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> item = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">    <span class="keyword">return</span> item ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(item) : <span class="literal">null</span>;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Error getting local storage item: <span class="subst">$&#123;error&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><a name="34-data-serialization"></a></p>
<h3 id="3-4-Data-Serialization"><a href="#3-4-Data-Serialization" class="headerlink" title="3.4 Data Serialization"></a>3.4 Data Serialization</h3><p>Ensure that data is properly serialized and deserialized when storing and retrieving from local storage. Always serialize complex data structures as strings using <code>JSON.stringify()</code>.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> setLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">value</span>: T): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>): T | <span class="function"><span class="params">null</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> item = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">  <span class="keyword">return</span> item ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(item) : <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><a name="35-expiration-handling"></a></p>
<h3 id="3-5-Expiration-Handling"><a href="#3-5-Expiration-Handling" class="headerlink" title="3.5 Expiration Handling"></a>3.5 Expiration Handling</h3><p>Implement expiration handling for local storage items to ensure that stale data is not used.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">ExpirableItem</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="attr">value</span>: T;</span><br><span class="line">  <span class="attr">expiration</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> setExpirableLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">value</span>: T, <span class="attr">expirationInMinutes</span>: <span class="built_in">number</span>): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> expiration = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>() + expirationInMinutes * <span class="number">60</span> * <span class="number">1000</span>;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">item</span>: <span class="title class_">ExpirableItem</span>&lt;T&gt; = &#123; value, expiration &#125;;</span><br><span class="line">  <span class="title function_">setLocalStorageItem</span>(key, item);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getExpirableLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>): T | <span class="function"><span class="params">null</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> item = getLocalStorageItem&lt;<span class="title class_">ExpirableItem</span>&lt;T&gt;&gt;(key);</span><br><span class="line">  <span class="keyword">if</span> (item &amp;&amp; item.<span class="property">expiration</span> &gt; <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>()) &#123;</span><br><span class="line">    <span class="keyword">return</span> item.<span class="property">value</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">removeLocalStorageItem</span>(key);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>


<p><a name="4-best-practices"></a></p>
<h2 id="4-Best-Practices"><a href="#4-Best-Practices" class="headerlink" title="4. Best Practices"></a>4. Best Practices</h2><p><a name="41-encapsulating-local-storage-access"></a></p>
<h3 id="4-1-Encapsulating-Local-Storage-Access"><a href="#4-1-Encapsulating-Local-Storage-Access" class="headerlink" title="4.1 Encapsulating Local Storage Access"></a>4.1 Encapsulating Local Storage Access</h3><p>Encapsulate local storage logic inside React hooks or service functions to keep components clean. Encapsulate local storage access within utility functions to avoid code duplication and improve maintainability.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> setLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">value</span>: T): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>): T | <span class="function"><span class="params">null</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> item = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">  <span class="keyword">return</span> item ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(item) : <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> removeLocalStorageItem = (<span class="attr">key</span>: <span class="built_in">string</span>): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(key);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><a name="5-more-scenarios"></a></p>
<h2 id="5-More-Scenarios"><a href="#5-More-Scenarios" class="headerlink" title="5 More Scenarios"></a>5 More Scenarios</h2><p><a name="51-scenario-1-user-preferences"></a></p>
<h3 id="5-1-Scenario-1-User-Preferences"><a href="#5-1-Scenario-1-User-Preferences" class="headerlink" title="5.1 Scenario 1: User Preferences"></a>5.1 Scenario 1: User Preferences</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; setUserPreferences, getUserPreferences &#125; <span class="keyword">from</span> <span class="string">&#x27;./localStorageUtils&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">UserPreferences</span> &#123;</span><br><span class="line">  <span class="attr">theme</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">notifications</span>: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">UserPreferencesComponent</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [preferences, setPreferences] = useState&lt;<span class="title class_">UserPreferences</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> storedPreferences = <span class="title function_">getUserPreferences</span>();</span><br><span class="line">    <span class="keyword">if</span> (storedPreferences) &#123;</span><br><span class="line">      <span class="title function_">setPreferences</span>(storedPreferences);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleThemeChange</span> = (<span class="params"><span class="attr">theme</span>: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> updatedPreferences = &#123; ...preferences, theme &#125; <span class="keyword">as</span> <span class="title class_">UserPreferences</span>;</span><br><span class="line">    <span class="title function_">setUserPreferences</span>(updatedPreferences);</span><br><span class="line">    <span class="title function_">setPreferences</span>(updatedPreferences);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleNotificationsChange</span> = (<span class="params"><span class="attr">notifications</span>: <span class="built_in">boolean</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> updatedPreferences = &#123; ...preferences, notifications &#125; <span class="keyword">as</span> <span class="title class_">UserPreferences</span>;</span><br><span class="line">    <span class="title function_">setUserPreferences</span>(updatedPreferences);</span><br><span class="line">    <span class="title function_">setPreferences</span>(updatedPreferences);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>User Preferences<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>Theme:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">value</span>=<span class="string">&#123;preferences?.theme&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> handleThemeChange(e.target.value)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;light&quot;</span>&gt;</span>Light<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;dark&quot;</span>&gt;</span>Dark<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>Notifications:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">checked</span>=<span class="string">&#123;preferences?.notifications&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> handleNotificationsChange(e.target.checked)&#125;</span></span><br><span class="line"><span class="language-xml">        /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">UserPreferencesComponent</span>;</span><br></pre></td></tr></table></figure>

<p><a name="52-scenario-2-shopping-cart"></a></p>
<h3 id="5-2-Scenario-2-Shopping-Cart"><a href="#5-2-Scenario-2-Shopping-Cart" class="headerlink" title="5.2 Scenario 2: Shopping Cart"></a>5.2 Scenario 2: Shopping Cart</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; setLocalStorageItem, getLocalStorageItem, removeLocalStorageItem &#125; <span class="keyword">from</span> <span class="string">&#x27;./localStorageUtils&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">CartItem</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ShoppingCartComponent</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [cartItems, setCartItems] = useState&lt;<span class="title class_">CartItem</span>[]&gt;([]);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> storedCartItems = getLocalStorageItem&lt;<span class="title class_">CartItem</span>[]&gt;(<span class="string">&#x27;cartItems&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (storedCartItems) &#123;</span><br><span class="line">      <span class="title function_">setCartItems</span>(storedCartItems);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">addToCart</span> = (<span class="params"><span class="attr">item</span>: <span class="title class_">CartItem</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> updatedCartItems = [...cartItems, item];</span><br><span class="line">    <span class="title function_">setLocalStorageItem</span>(<span class="string">&#x27;cartItems&#x27;</span>, updatedCartItems);</span><br><span class="line">    <span class="title function_">setCartItems</span>(updatedCartItems);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">removeFromCart</span> = (<span class="params"><span class="attr">id</span>: <span class="built_in">number</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> updatedCartItems = cartItems.<span class="title function_">filter</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">id</span> !== id);</span><br><span class="line">    <span class="title function_">setLocalStorageItem</span>(<span class="string">&#x27;cartItems&#x27;</span>, updatedCartItems);</span><br><span class="line">    <span class="title function_">setCartItems</span>(updatedCartItems);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Shopping Cart<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;cartItems.map((item) =&gt; (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;item.name&#125; - $&#123;item.price&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> removeFromCart(item.id)&#125;&gt;Remove<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        ))&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> addToCart(&#123; id: Date.now(), name: &#x27;New Item&#x27;, price: 10 &#125;)&#125;&gt;Add Item<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">ShoppingCartComponent</span>;</span><br></pre></td></tr></table></figure>

<p><a name="6-design-diagrams"></a></p>
<h2 id="6-Design-Diagrams"><a href="#6-Design-Diagrams" class="headerlink" title="6-Design Diagrams"></a>6-Design Diagrams</h2><p><a name="61-component-diagram"></a></p>
<h3 id="6-1-Component-Diagram"><a href="#6-1-Component-Diagram" class="headerlink" title="6.1 Component Diagram"></a>6.1 Component Diagram</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| App               |       | UserPreferences   |       | ShoppingCart      |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (1) User Preferences      |                           |</span><br><span class="line">        |--------------------------&gt;|                           |</span><br><span class="line">        |                           | (2) Shopping Cart         |</span><br><span class="line">        |                           |--------------------------&gt;|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (3) Local Storage         |                           |</span><br><span class="line">        |&lt;--------------------------|                           |</span><br><span class="line">        |                           |                           |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| App               |       | UserPreferences   |       | ShoppingCart      |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br></pre></td></tr></table></figure>

<p><a name="62-sequence-diagram"></a></p>
<h3 id="6-2-Sequence-Diagram"><a href="#6-2-Sequence-Diagram" class="headerlink" title="6.2 Sequence Diagram"></a>6.2 Sequence Diagram</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| User              |       | UserPreferences   |       | Local Storage     |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (1) Change Theme          |                           |</span><br><span class="line">        |--------------------------&gt;|                           |</span><br><span class="line">        |                           | (2) Update Preferences    |</span><br><span class="line">        |                           |--------------------------&gt;|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (3) Store Preferences     |                           |</span><br><span class="line">        |&lt;--------------------------|                           |</span><br><span class="line">        |                           |                           |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| User              |       | UserPreferences   |       | Local Storage     |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br></pre></td></tr></table></figure>



<p><a name="7-unit-test-cases"></a></p>
<h2 id="7-Unit-Test-Cases"><a href="#7-Unit-Test-Cases" class="headerlink" title="7. Unit Test Cases"></a>7. Unit Test Cases</h2><p><a name="71-user-preferences-component-test"></a></p>
<h3 id="7-1-UserPreferencesComponent-test-tsx"><a href="#7-1-UserPreferencesComponent-test-tsx" class="headerlink" title="7.1 UserPreferencesComponent.test.tsx"></a>7.1 UserPreferencesComponent.test.tsx</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render, fireEvent &#125; <span class="keyword">from</span> <span class="string">&#x27;@testing-library/react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UserPreferencesComponent</span> <span class="keyword">from</span> <span class="string">&#x27;../../src/components/UserPreferencesComponent&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; setUserPreferences, getUserPreferences &#125; <span class="keyword">from</span> <span class="string">&#x27;../../src/utils/localStorageUtils&#x27;</span>;</span><br><span class="line"></span><br><span class="line">jest.<span class="title function_">mock</span>(<span class="string">&#x27;../../src/utils/localStorageUtils&#x27;</span>, <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">  <span class="attr">setUserPreferences</span>: jest.<span class="title function_">fn</span>(),</span><br><span class="line">  <span class="attr">getUserPreferences</span>: jest.<span class="title function_">fn</span>(),</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;UserPreferencesComponent updates and retrieves preferences&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  (getUserPreferences <span class="keyword">as</span> jest.<span class="property">Mock</span>).<span class="title function_">mockReturnValue</span>(&#123; <span class="attr">theme</span>: <span class="string">&#x27;light&#x27;</span>, <span class="attr">notifications</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; getByLabelText, getByText &#125; = <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">UserPreferencesComponent</span> /&gt;</span></span>);</span><br><span class="line"></span><br><span class="line">  fireEvent.<span class="title function_">change</span>(<span class="title function_">getByLabelText</span>(<span class="string">&#x27;Theme:&#x27;</span>), &#123; <span class="attr">target</span>: &#123; <span class="attr">value</span>: <span class="string">&#x27;dark&#x27;</span> &#125; &#125;);</span><br><span class="line">  <span class="title function_">expect</span>(setUserPreferences).<span class="title function_">toHaveBeenCalledWith</span>(&#123; <span class="attr">theme</span>: <span class="string">&#x27;dark&#x27;</span>, <span class="attr">notifications</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"></span><br><span class="line">  fireEvent.<span class="title function_">click</span>(<span class="title function_">getByLabelText</span>(<span class="string">&#x27;Notifications:&#x27;</span>));</span><br><span class="line">  <span class="title function_">expect</span>(setUserPreferences).<span class="title function_">toHaveBeenCalledWith</span>(&#123; <span class="attr">theme</span>: <span class="string">&#x27;dark&#x27;</span>, <span class="attr">notifications</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><a name="72-shopping-cart-component-test"></a></p>
<h3 id="7-2-ShoppingCartComponent-test-tsx"><a href="#7-2-ShoppingCartComponent-test-tsx" class="headerlink" title="7.2 ShoppingCartComponent.test.tsx"></a>7.2 ShoppingCartComponent.test.tsx</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render, fireEvent &#125; <span class="keyword">from</span> <span class="string">&#x27;@testing-library/react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ShoppingCartComponent</span> <span class="keyword">from</span> <span class="string">&#x27;../../src/components/ShoppingCartComponent&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; setLocalStorageItem, getLocalStorageItem, removeLocalStorageItem &#125; <span class="keyword">from</span> <span class="string">&#x27;../../src/utils/localStorageUtils&#x27;</span>;</span><br><span class="line"></span><br><span class="line">jest.<span class="title function_">mock</span>(<span class="string">&#x27;../../src/utils/localStorageUtils&#x27;</span>, <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">  <span class="attr">setLocalStorageItem</span>: jest.<span class="title function_">fn</span>(),</span><br><span class="line">  <span class="attr">getLocalStorageItem</span>: jest.<span class="title function_">fn</span>(),</span><br><span class="line">  <span class="attr">removeLocalStorageItem</span>: jest.<span class="title function_">fn</span>(),</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;ShoppingCartComponent adds and removes items&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  (getLocalStorageItem <span class="keyword">as</span> jest.<span class="property">Mock</span>).<span class="title function_">mockReturnValue</span>([&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;Item 1&#x27;</span>, <span class="attr">price</span>: <span class="number">10</span> &#125;]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; getByText &#125; = <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">ShoppingCartComponent</span> /&gt;</span></span>);</span><br><span class="line"></span><br><span class="line">  fireEvent.<span class="title function_">click</span>(<span class="title function_">getByText</span>(<span class="string">&#x27;Add Item&#x27;</span>));</span><br><span class="line">  <span class="title function_">expect</span>(setLocalStorageItem).<span class="title function_">toHaveBeenCalled</span>();</span><br><span class="line"></span><br><span class="line">  fireEvent.<span class="title function_">click</span>(<span class="title function_">getByText</span>(<span class="string">&#x27;Remove&#x27;</span>));</span><br><span class="line">  <span class="title function_">expect</span>(removeLocalStorageItem).<span class="title function_">toHaveBeenCalled</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><a name="8-commands-to-init-and-add-dependencies"></a></p>
<h2 id="8-Commands-to-Init-and-Add-Dependencies"><a href="#8-Commands-to-Init-and-Add-Dependencies" class="headerlink" title="8. Commands to Init and Add Dependencies"></a>8. Commands to Init and Add Dependencies</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Initialize a new React project with TypeScript</span></span><br><span class="line">yarn create react-app my-app --template typescript</span><br><span class="line"></span><br><span class="line"><span class="comment"># Navigate to the project directory</span></span><br><span class="line"><span class="built_in">cd</span> my-app</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add Testing Library</span></span><br><span class="line">yarn add --dev @testing-library/react @testing-library/jest-dom</span><br></pre></td></tr></table></figure>

<p><a name="9-conclusion"></a></p>
<h2 id="9-Conclusion"><a href="#9-Conclusion" class="headerlink" title="9. Conclusion"></a>9. Conclusion</h2><p>Local storage is a powerful tool for persisting data in web applications. This article provided a deep dive into best practices for handling local storage in ReactJS with TypeScript, focusing on functional components and the latest version of the tech stack. We explored real production scenarios with TypeScript code samples, design diagrams, project folder structures, unit test cases, and commands to initialize and add dependencies using Yarn.</p>
<p>By understanding and applying these best practices, developers can effectively manage local storage in their ReactJS applications, ensuring they remain scalable, maintainable, and performant.</p>
<p><a name="10-more-samples"></a></p>
<h2 id="10-More-Samples"><a href="#10-More-Samples" class="headerlink" title="10. More Samples"></a>10. More Samples</h2><p><a name="101-project-setup"></a></p>
<h3 id="10-1-Project-Setup"><a href="#10-1-Project-Setup" class="headerlink" title="10.1 Project Setup"></a>10.1 Project Setup</h3><p>To get started, we need to set up a React project with TypeScript and add the necessary dependencies using Yarn.</p>
<blockquote>
<p><strong>Yarn Commands</strong></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a React project with TypeScript template</span></span><br><span class="line">yarn create react-app local-storage-app --template typescript</span><br><span class="line"></span><br><span class="line"><span class="comment"># Navigate into the project directory</span></span><br><span class="line"><span class="built_in">cd</span> local-storage-app</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add any additional dependencies if needed (e.g., testing libraries)</span></span><br><span class="line">yarn add @testing-library/react @testing-library/jest-dom</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Project Folder Structure</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">local-storage-app/</span><br><span class="line">├── src/</span><br><span class="line">│   ├── components/</span><br><span class="line">│   │   ├── LocalStorageHandler.tsx</span><br><span class="line">│   │   └── UserPreferences.tsx</span><br><span class="line">│   ├── hooks/</span><br><span class="line">│   │   └── useLocalStorage.ts</span><br><span class="line">│   ├── tests/</span><br><span class="line">│   │   └── LocalStorageHandler.test.tsx</span><br><span class="line">│   ├── App.tsx</span><br><span class="line">│   └── index.tsx</span><br><span class="line">├── public/</span><br><span class="line">└── package.json</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>useLocalStorage.ts</strong></p>
</blockquote>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/hooks/useLocalStorage.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Custom hook for local storage handling</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">key</span> - The key under which data is stored in local storage</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">initialValue</span> - The initial value to use if no value is stored</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> A tuple containing the stored value and a function to set the value</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> useLocalStorage&lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">initialValue</span>: T) &#123;</span><br><span class="line">  <span class="keyword">const</span> [storedValue, setStoredValue] = useState&lt;T&gt;(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> item = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">      <span class="keyword">return</span> item ? (<span class="title class_">JSON</span>.<span class="title function_">parse</span>(item) <span class="keyword">as</span> T) : initialValue;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error reading from local storage&#x27;</span>, error);</span><br><span class="line">      <span class="keyword">return</span> initialValue;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Sets a new value in local storage</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> <span class="variable">value</span> - The new value to store</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">setValue</span> = (<span class="params"><span class="attr">value</span>: T</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="title function_">setStoredValue</span>(value);</span><br><span class="line">      <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error saving to local storage&#x27;</span>, error);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> [storedValue, setValue] <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useLocalStorage;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>UserPreferences</strong>: Detailed Code for Using <code>useLocalStorage</code> in a Component</p>
</blockquote>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/components/UserPreferences.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> useLocalStorage <span class="keyword">from</span> <span class="string">&#x27;../hooks/useLocalStorage&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">UserPreferences</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Using the custom hook to manage theme preference</span></span><br><span class="line">  <span class="keyword">const</span> [theme, setTheme] = useLocalStorage&lt;<span class="built_in">string</span>&gt;(<span class="string">&#x27;theme&#x27;</span>, <span class="string">&#x27;light&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Toggles between &#x27;light&#x27; and &#x27;dark&#x27; themes</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">toggleTheme</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setTheme</span>(theme === <span class="string">&#x27;light&#x27;</span> ? <span class="string">&#x27;dark&#x27;</span> : <span class="string">&#x27;light&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>User Preferences<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Current theme: &#123;theme&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;toggleTheme&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        Toggle Theme</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">UserPreferences</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Type-Safe</strong> Local Storage Utility Functions<br>For larger applications, you might prefer having utility functions to handle local storage logic:</p>
</blockquote>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/utils/localStorageUtils.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">defaultValue</span>: T): <span class="function"><span class="params">T</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> storedItem = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">    <span class="keyword">return</span> storedItem ? (<span class="title class_">JSON</span>.<span class="title function_">parse</span>(storedItem) <span class="keyword">as</span> T) : defaultValue;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Error reading key &quot;<span class="subst">$&#123;key&#125;</span>&quot; from local storage`</span>, error);</span><br><span class="line">    <span class="keyword">return</span> defaultValue;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> setLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">value</span>: T): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value));</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Error setting key &quot;<span class="subst">$&#123;key&#125;</span>&quot; in local storage`</span>, error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Detailed Unit Test Cases</p>
</blockquote>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/tests/useLocalStorage.test.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; renderHook, act &#125; <span class="keyword">from</span> <span class="string">&#x27;@testing-library/react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> useLocalStorage <span class="keyword">from</span> <span class="string">&#x27;../hooks/useLocalStorage&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;useLocalStorage hook&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">beforeEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">clear</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should return initial value if no value is stored&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; result &#125; = <span class="title function_">renderHook</span>(<span class="function">() =&gt;</span> <span class="title function_">useLocalStorage</span>(<span class="string">&#x27;testKey&#x27;</span>, <span class="string">&#x27;initialValue&#x27;</span>));</span><br><span class="line">    <span class="title function_">expect</span>(result.<span class="property">current</span>[<span class="number">0</span>]).<span class="title function_">toBe</span>(<span class="string">&#x27;initialValue&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should save and retrieve a value&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; result &#125; = <span class="title function_">renderHook</span>(<span class="function">() =&gt;</span> <span class="title function_">useLocalStorage</span>(<span class="string">&#x27;testKey&#x27;</span>, <span class="string">&#x27;initialValue&#x27;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="title function_">act</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      result.<span class="property">current</span>[<span class="number">1</span>](<span class="string">&#x27;newValue&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(result.<span class="property">current</span>[<span class="number">0</span>]).<span class="title function_">toBe</span>(<span class="string">&#x27;newValue&#x27;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;testKey&#x27;</span>)).<span class="title function_">toBe</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="string">&#x27;newValue&#x27;</span>));</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should handle JSON parsing errors gracefully&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;testKey&#x27;</span>, <span class="string">&#x27;&#123;invalid JSON&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> &#123; result &#125; = <span class="title function_">renderHook</span>(<span class="function">() =&gt;</span> <span class="title function_">useLocalStorage</span>(<span class="string">&#x27;testKey&#x27;</span>, <span class="string">&#x27;defaultValue&#x27;</span>));</span><br><span class="line">    <span class="title function_">expect</span>(result.<span class="property">current</span>[<span class="number">0</span>]).<span class="title function_">toBe</span>(<span class="string">&#x27;defaultValue&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Commands to Run Unit Tests</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Run unit tests with Yarn</span></span><br><span class="line">yarn <span class="built_in">test</span></span><br></pre></td></tr></table></figure>


<p><a name="references"></a></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://reactjs.org/docs/getting-started.html">React Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/">TypeScript Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API">Web Storage API</a></li>
<li><a target="_blank" rel="noopener" href="https://testing-library.com/docs/react-testing-library/intro">Testing Library</a></li>
</ul>
<hr>
<p>This article provides a comprehensive guide to best practices for local storage handling in ReactJS with TypeScript, including detailed code samples, design diagrams, project folder structures, unit test cases, and commands to initialize and add dependencies using Yarn. By understanding and applying these practices, developers can leverage the full potential of local storage in their ReactJS projects.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/04/Deep-Dive-into-State-Management-in-ReactJS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/04/Deep-Dive-into-State-Management-in-ReactJS/" class="post-title-link" itemprop="url">Deep Dive into State Management in ReactJS</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-04 15:47:50 / Modified: 17:48:44" itemprop="dateCreated datePublished" datetime="2024-11-04T15:47:50-05:00">2024-11-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/" itemprop="url" rel="index"><span itemprop="name">Deep Dive</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/ReactJS/" itemprop="url" rel="index"><span itemprop="name">ReactJS</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/ReactJS/Redux/" itemprop="url" rel="index"><span itemprop="name">Redux</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/ReactJS/Redux/Best-Practices/" itemprop="url" rel="index"><span itemprop="name">Best Practices</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#1-state-management-basics">1. State Management Basics</a><ul>
<li><a href="#11-what-is-state">1.1 What is State?</a></li>
<li><a href="#12-local-state-vs-global-state">1.2 Local State vs Global State</a></li>
</ul>
</li>
<li><a href="#2-setting-up-the-project">2. Setting Up the Project</a><ul>
<li><a href="#initialize-the-react-project-with-typescript">Initialize the React Project with TypeScript</a></li>
</ul>
</li>
<li><a href="#3-state-management-options">3. State Management Options</a><ul>
<li><a href="#31-react-context-api">3.1 React Context API</a></li>
</ul>
</li>
<li><a href="#4-local-state-management-with-usestate-and-usereducer">4. Local State Management with <code>useState</code> and <code>useReducer</code></a><ul>
<li><a href="#41-using-usestate">4.1 Using <code>useState</code></a></li>
<li><a href="#42-using-usereducer">4.2 Using <code>useReducer</code></a></li>
</ul>
</li>
<li><a href="#5-global-state-management-with-redux">5. Global State Management with Redux</a><ul>
<li><a href="#51-architecture-of-redux">5.1 Architecture of Redux</a></li>
<li><a href="#52-redux-state-machine">5.2 Redux state machine</a></li>
<li><a href="#explanation">Explanation:</a></li>
<li><a href="#52-redux-samples">5.2 Redux Samples</a></li>
</ul>
</li>
<li><a href="#6-alternative-global-state-management-with-zustand">6. Alternative Global State Management with Zustand</a><ul>
<li><a href="#61-architecture-of-zustand">6.1 Architecture of Zustand</a></li>
<li><a href="#62-typescript-code-example">6.2 TypeScript Code Example</a></li>
</ul>
</li>
<li><a href="#more-scenarios">More Scenarios</a><ul>
<li><a href="#71-scenario-1-user-authentication">7.1 Scenario 1: User Authentication</a><ul>
<li><a href="#react-context-api">React Context API</a></li>
<li><a href="#redux">Redux</a></li>
</ul>
</li>
<li><a href="#72-scenario-2-shopping-cart">7.2 Scenario 2: Shopping Cart</a><ul>
<li><a href="#react-context-api-1">React Context API</a></li>
<li><a href="#redux-1">Redux</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#8-some-diagrams">8. Some Diagrams</a></li>
<li><a href="#project-folder-structure">Project Folder Structure</a></li>
<li><a href="#unit-test-cases">Unit Test Cases</a><ul>
<li><a href="#loginpagetesttsx">LoginPage.test.tsx</a></li>
<li><a href="#dashboardtesttsx">Dashboard.test.tsx</a></li>
</ul>
</li>
<li><a href="#commands-to-init-and-add-dependencies">Commands to Init and Add Dependencies</a></li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>State management is a critical aspect of building complex ReactJS applications. Proper state management ensures that your application remains scalable, maintainable, and performant. This article will deep dive into state management in ReactJS, focusing on functional components and the latest version of the tech stack. We will explore two main state management options: React Context API and Redux. Additionally, we will provide real production scenarios with TypeScript code samples, design diagrams, project folder structures, unit test cases, and commands to initialize and add dependencies using Yarn.</p>
<p><a name="1-state-management-basics"></a></p>
<h2 id="1-State-Management-Basics"><a href="#1-State-Management-Basics" class="headerlink" title="1. State Management Basics"></a>1. State Management Basics</h2><p><a name="11-what-is-state"></a></p>
<h3 id="1-1-What-is-State"><a href="#1-1-What-is-State" class="headerlink" title="1.1 What is State?"></a>1.1 What is State?</h3><p>State in ReactJS is an object that represents the dynamic data of a component. It determines how the component renders and behaves. State can be local to a single component or shared across multiple components.</p>
<p>State management refers to managing data that changes over time, ensuring that the user interface updates appropriately. Choosing the right state management solution is crucial for developing scalable and maintainable applications. We’ll explore <code>useState</code> and <code>useReducer</code> for local state management and Redux and Zustand for global state management, with detailed TypeScript examples.</p>
<p><a name="12-local-state-vs-global-state"></a></p>
<h3 id="1-2-Local-State-vs-Global-State"><a href="#1-2-Local-State-vs-Global-State" class="headerlink" title="1.2 Local State vs Global State"></a>1.2 Local State vs Global State</h3><ul>
<li><strong>Local State</strong>: State that is confined to a single component. It is managed using the <code>useState</code> hook.</li>
<li><strong>Global State</strong>: State that is shared across multiple components. It is managed using state management libraries like React Context API or Redux.</li>
</ul>
<p><a name="2-setting-up-the-project"></a></p>
<h2 id="2-Setting-Up-the-Project"><a href="#2-Setting-Up-the-Project" class="headerlink" title="2. Setting Up the Project"></a>2. Setting Up the Project</h2><h3 id="Initialize-the-React-Project-with-TypeScript"><a href="#Initialize-the-React-Project-with-TypeScript" class="headerlink" title="Initialize the React Project with TypeScript"></a>Initialize the React Project with TypeScript</h3><p>Run the following commands to create a new React project with TypeScript and install the necessary dependencies:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a new React app with TypeScript</span></span><br><span class="line">yarn create react-app react-state-management --template typescript</span><br><span class="line"></span><br><span class="line"><span class="comment"># Navigate to the project folder</span></span><br><span class="line"><span class="built_in">cd</span> react-state-management</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install Redux and Zustand for state management</span></span><br><span class="line">yarn add redux react-redux @reduxjs/toolkit zustand</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install TypeScript types for React and Redux</span></span><br><span class="line">yarn add -D @types/react-redux</span><br></pre></td></tr></table></figure>

<p><a name="3-state-management-options"></a></p>
<h2 id="3-State-Management-Options"><a href="#3-State-Management-Options" class="headerlink" title="3. State Management Options"></a>3. State Management Options</h2><p><a name="31-react-context-api"></a></p>
<h3 id="3-1-React-Context-API"><a href="#3-1-React-Context-API" class="headerlink" title="3.1 React Context API"></a>3.1 React Context API</h3><p>The React Context API provides a way to pass data through the component tree without having to pass props down manually at every level. It is ideal for small to medium-sized applications.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; createContext, useContext, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">AuthContextType</span> &#123;</span><br><span class="line">  <span class="attr">isAuthenticated</span>: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">login</span>: <span class="function">() =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">  <span class="attr">logout</span>: <span class="function">() =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AuthContext</span> = createContext&lt;<span class="title class_">AuthContextType</span>&gt;(&#123;</span><br><span class="line">  <span class="attr">isAuthenticated</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">login</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">  <span class="attr">logout</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">AuthProvider</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">(<span class="params">&#123; children &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [isAuthenticated, setIsAuthenticated] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">login</span> = (<span class="params"></span>) =&gt; <span class="title function_">setIsAuthenticated</span>(<span class="literal">true</span>);</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">logout</span> = (<span class="params"></span>) =&gt; <span class="title function_">setIsAuthenticated</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">AuthContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;&#123;</span> <span class="attr">isAuthenticated</span>, <span class="attr">login</span>, <span class="attr">logout</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">AuthContext.Provider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">useAuth</span> = (<span class="params"></span>) =&gt; <span class="title function_">useContext</span>(<span class="title class_">AuthContext</span>);</span><br></pre></td></tr></table></figure>

<p><a name="4-local-state-management"></a></p>
<h2 id="4-Local-State-Management-with-useState-and-useReducer"><a href="#4-Local-State-Management-with-useState-and-useReducer" class="headerlink" title="4. Local State Management with useState and useReducer"></a>4. Local State Management with <code>useState</code> and <code>useReducer</code></h2><p><a name="41-using-usestate"></a></p>
<h3 id="4-1-Using-useState"><a href="#4-1-Using-useState" class="headerlink" title="4.1 Using useState"></a>4.1 Using <code>useState</code></h3><p><code>useState</code> is simple to use and ideal for managing local state.</p>
<p><strong>TypeScript Code Sample</strong>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Counter</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = useState&lt;<span class="built_in">number</span>&gt;(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> increment = (): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setCount</span>(<span class="function"><span class="params">prevCount</span> =&gt;</span> prevCount + <span class="number">1</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Current Count: &#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;increment&#125;</span>&gt;</span>Increment<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Counter</span>;</span><br></pre></td></tr></table></figure>

<p><strong>Best Practices</strong>:</p>
<ul>
<li>Use <code>useState</code> for simple and straightforward state updates.</li>
<li>Type your state variables for better type safety.</li>
</ul>
<p><a name="42-using-usereducer"></a></p>
<h3 id="4-2-Using-useReducer"><a href="#4-2-Using-useReducer" class="headerlink" title="4.2 Using useReducer"></a>4.2 Using <code>useReducer</code></h3><p><code>useReducer</code> is suitable for managing complex state logic.</p>
<p><strong>TypeScript Code Sample</strong>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useReducer &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">State</span> &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Action</span> &#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;increment&#x27;</span> | <span class="string">&#x27;decrement&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">initialState</span>: <span class="title class_">State</span> = &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params"><span class="attr">state</span>: <span class="title class_">State</span>, <span class="attr">action</span>: <span class="title class_">Action</span></span>): <span class="title class_">State</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;increment&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;decrement&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Unknown action type&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Counter</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [state, dispatch] = <span class="title function_">useReducer</span>(reducer, initialState);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Current Count: &#123;state.count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(&#123; type: &#x27;increment&#x27; &#125;)&#125;&gt;Increment<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(&#123; type: &#x27;decrement&#x27; &#125;)&#125;&gt;Decrement<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Counter</span>;</span><br></pre></td></tr></table></figure>

<p><strong>Best Practices</strong>:</p>
<ul>
<li>Use <code>useReducer</code> when state logic is complex or involves multiple sub-values.</li>
<li>Type both state and actions for enhanced type safety.</li>
</ul>
<hr>
<p><a name="5-global-state-management-redux"></a></p>
<h2 id="5-Global-State-Management-with-Redux"><a href="#5-Global-State-Management-with-Redux" class="headerlink" title="5. Global State Management with Redux"></a>5. Global State Management with Redux</h2><p>Redux is a predictable state container for JavaScript apps. It is widely used for managing global state in large-scale applications.</p>
<p><a name="51-architecture-of-redux"></a></p>
<h3 id="5-1-Architecture-of-Redux"><a href="#5-1-Architecture-of-Redux" class="headerlink" title="5.1 Architecture of Redux"></a>5.1 Architecture of Redux</h3><p><strong>Redux Architecture</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------------+      +---------------+      +-------------+</span><br><span class="line">|   Action   | --&gt; |    Reducer     | --&gt; |    Store     |</span><br><span class="line">+------------+      +---------------+      +-------------+</span><br><span class="line">       ^                                          |</span><br><span class="line">       |                                          |</span><br><span class="line">       +------------------------------------------+</span><br></pre></td></tr></table></figure>

<p><a name="52-redux-state-machine"></a></p>
<h3 id="5-2-Redux-state-machine"><a href="#5-2-Redux-state-machine" class="headerlink" title="5.2 Redux state machine"></a>5.2 Redux state machine</h3><p>Here’s a textual representation of a state machine diagram for a Redux state management flow:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">+--------------------+       Action       +----------------------+</span><br><span class="line">|                    |   (dispatch)       |                      |</span><br><span class="line">|   React Component  | -----------------&gt; |       Action         |</span><br><span class="line">|                    |                    | (type &amp; payload)     |</span><br><span class="line">+--------------------+                    +----------------------+</span><br><span class="line">                                               |</span><br><span class="line">                                               |</span><br><span class="line">                                       Dispatches action</span><br><span class="line">                                               |</span><br><span class="line">                                               v</span><br><span class="line">                                       +----------------+</span><br><span class="line">                                       |                |</span><br><span class="line">                                       |    Reducer     |</span><br><span class="line">                                       | (pure function)|</span><br><span class="line">                                       +----------------+</span><br><span class="line">                                               |</span><br><span class="line">                       Updates state           |</span><br><span class="line">                       based on action         |</span><br><span class="line">                                               v</span><br><span class="line">                                       +----------------+</span><br><span class="line">                                       |                |</span><br><span class="line">                                       |    Store       |</span><br><span class="line">                                       | (holds state)  |</span><br><span class="line">                                       +----------------+</span><br><span class="line">                                               |</span><br><span class="line">                      State subscription       |</span><br><span class="line">                      triggers re-render       |</span><br><span class="line">                      of component             |</span><br><span class="line">                                               v</span><br><span class="line">+--------------------+      Updated       +----------------------+</span><br><span class="line">|                    |      State         |                      |</span><br><span class="line">|   React Component  | &lt;----------------- |      Store           |</span><br><span class="line">|                    |                    |                      |</span><br><span class="line">+--------------------+                    +----------------------+</span><br></pre></td></tr></table></figure>

<h3 id="Explanation"><a href="#Explanation" class="headerlink" title="Explanation:"></a>Explanation:</h3><ul>
<li><strong>React Component</strong>: The UI component where user interactions or events trigger actions.</li>
<li><strong>Action</strong>: An object describing what type of event occurred (e.g., <code>&#123; type: &#39;INCREMENT&#39; &#125;</code>).</li>
<li><strong>Reducer</strong>: A pure function that takes the current state and an action, then returns a new state.</li>
<li><strong>Store</strong>: The central place where the state is kept, updated, and managed.</li>
<li><strong>State Flow</strong>: Components subscribe to the store to get updates when the state changes, causing a re-render to reflect new data.</li>
</ul>
<p><a name="52-redux-samples"></a></p>
<h3 id="5-2-Redux-Samples"><a href="#5-2-Redux-Samples" class="headerlink" title="5.2 Redux Samples"></a>5.2 Redux Samples</h3><blockquote>
<p><strong>The Simple One</strong></p>
</blockquote>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">State</span> &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Action</span> &#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">initialState</span>: <span class="title class_">State</span> = &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state = initialState, <span class="attr">action</span>: <span class="title class_">Action</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;INCREMENT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;DECREMENT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>


<blockquote>
<p><strong>The Sample of Details</strong><br><strong><code>actions.ts</code></strong>:</p>
</blockquote>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">increment</span> = (<span class="params"></span>) =&gt; (&#123; <span class="attr">type</span>: <span class="string">&#x27;INCREMENT&#x27;</span> &#125; <span class="keyword">as</span> <span class="keyword">const</span>);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">decrement</span> = (<span class="params"></span>) =&gt; (&#123; <span class="attr">type</span>: <span class="string">&#x27;DECREMENT&#x27;</span> &#125; <span class="keyword">as</span> <span class="keyword">const</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">ActionType</span> = <span class="title class_">ReturnType</span>&lt;<span class="keyword">typeof</span> increment | <span class="keyword">typeof</span> decrement&gt;;</span><br></pre></td></tr></table></figure>

<p><strong><code>reducers.ts</code></strong>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ActionType</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./actions&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">State</span> &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">initialState</span>: <span class="title class_">State</span> = &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> counterReducer = (<span class="attr">state</span>: <span class="title class_">State</span> = initialState, <span class="attr">action</span>: <span class="title class_">ActionType</span>): <span class="function"><span class="params">State</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;INCREMENT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;DECREMENT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong><code>store.ts</code></strong>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; counterReducer &#125; <span class="keyword">from</span> <span class="string">&#x27;./reducers&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(counterReducer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>

<p><strong><code>App.tsx</code></strong>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span>, useDispatch, useSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./state/redux/store&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; increment, decrement &#125; <span class="keyword">from</span> <span class="string">&#x27;./state/redux/actions&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">RootState</span> &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> count = <span class="title function_">useSelector</span>(<span class="function">(<span class="params"><span class="attr">state</span>: <span class="title class_">RootState</span></span>) =&gt;</span> state.<span class="property">count</span>);</span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Current Count: &#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(increment())&#125;&gt;Increment<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(decrement())&#125;&gt;Decrement<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="6-global-state-management-zustand"></a></p>
<h2 id="6-Alternative-Global-State-Management-with-Zustand"><a href="#6-Alternative-Global-State-Management-with-Zustand" class="headerlink" title="6. Alternative Global State Management with Zustand"></a>6. Alternative Global State Management with Zustand</h2><p>Zustand offers a simple and flexible state management solution without the boilerplate of Redux.</p>
<p><a name="61-architecture-of-zustand"></a></p>
<h3 id="6-1-Architecture-of-Zustand"><a href="#6-1-Architecture-of-Zustand" class="headerlink" title="6.1 Architecture of Zustand"></a>6.1 Architecture of Zustand</h3><p><strong>Simple Architecture</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Component --&gt; useStore --&gt; State &amp; Actions</span><br></pre></td></tr></table></figure>

<p><a name="62-zustand-typescript-example"></a></p>
<h3 id="6-2-TypeScript-Code-Example"><a href="#6-2-TypeScript-Code-Example" class="headerlink" title="6.2 TypeScript Code Example"></a>6.2 TypeScript Code Example</h3><p><strong><code>useStore.ts</code></strong>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> create <span class="keyword">from</span> <span class="string">&#x27;zustand&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">StoreState</span> &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">increment</span>: <span class="function">() =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">  <span class="attr">decrement</span>: <span class="function">() =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useStore = create&lt;<span class="title class_">StoreState</span>&gt;(<span class="function"><span class="params">set</span> =&gt;</span> (&#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">increment</span>: <span class="function">() =&gt;</span> <span class="title function_">set</span>(<span class="function"><span class="params">state</span> =&gt;</span> (&#123; <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span> &#125;)),</span><br><span class="line">  <span class="attr">decrement</span>: <span class="function">() =&gt;</span> <span class="title function_">set</span>(<span class="function"><span class="params">state</span> =&gt;</span> (&#123; <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span> &#125;))</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useStore;</span><br></pre></td></tr></table></figure>

<p><strong><code>App.tsx</code></strong>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> useStore <span class="keyword">from</span> <span class="string">&#x27;./state/zustand/useStore&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span></span><br><span class="line"></span><br><span class="line">: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; count, increment, decrement &#125; = <span class="title function_">useStore</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Current Count: &#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;increment&#125;</span>&gt;</span>Increment<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;decrement&#125;</span>&gt;</span>Decrement<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="7-more-scenarios"></a></p>
<h2 id="More-Scenarios"><a href="#More-Scenarios" class="headerlink" title="More Scenarios"></a>More Scenarios</h2><p><a name="71-scenario-1-user-authentication"></a></p>
<h3 id="7-1-Scenario-1-User-Authentication"><a href="#7-1-Scenario-1-User-Authentication" class="headerlink" title="7.1 Scenario 1: User Authentication"></a>7.1 Scenario 1: User Authentication</h3><h4 id="React-Context-API"><a href="#React-Context-API" class="headerlink" title="React Context API"></a>React Context API</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AuthProvider</span>, useAuth &#125; <span class="keyword">from</span> <span class="string">&#x27;./AuthContext&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">LoginPage</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; login &#125; = <span class="title function_">useAuth</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Login Page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;login&#125;</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Dashboard</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; isAuthenticated, logout &#125; = <span class="title function_">useAuth</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Dashboard<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;isAuthenticated ? (</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;logout&#125;</span>&gt;</span>Logout<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      ) : (</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Please login to access the dashboard.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      )&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">AuthProvider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">LoginPage</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Dashboard</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">AuthProvider</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<h4 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span>, useSelector, useDispatch &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">LoginPage</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">login</span> = (<span class="params"></span>) =&gt; <span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;LOGIN&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Login Page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;login&#125;</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Dashboard</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> isAuthenticated = <span class="title function_">useSelector</span>(<span class="function">(<span class="params"><span class="attr">state</span>: <span class="built_in">any</span></span>) =&gt;</span> state.<span class="property">isAuthenticated</span>);</span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">logout</span> = (<span class="params"></span>) =&gt; <span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;LOGOUT&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Dashboard<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;isAuthenticated ? (</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;logout&#125;</span>&gt;</span>Logout<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      ) : (</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Please login to access the dashboard.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      )&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">LoginPage</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Dashboard</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p><a name="72-scenario-2-shopping-cart"></a></p>
<h3 id="7-2-Scenario-2-Shopping-Cart"><a href="#7-2-Scenario-2-Shopping-Cart" class="headerlink" title="7.2 Scenario 2: Shopping Cart"></a>7.2 Scenario 2: Shopping Cart</h3><h4 id="React-Context-API-1"><a href="#React-Context-API-1" class="headerlink" title="React Context API"></a>React Context API</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; createContext, useContext, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">CartItem</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">CartContextType</span> &#123;</span><br><span class="line">  <span class="attr">cartItems</span>: <span class="title class_">CartItem</span>[];</span><br><span class="line">  <span class="attr">addToCart</span>: <span class="function">(<span class="params"><span class="attr">item</span>: <span class="title class_">CartItem</span></span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">  <span class="attr">removeFromCart</span>: <span class="function">(<span class="params"><span class="attr">id</span>: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">CartContext</span> = createContext&lt;<span class="title class_">CartContextType</span>&gt;(&#123;</span><br><span class="line">  <span class="attr">cartItems</span>: [],</span><br><span class="line">  <span class="attr">addToCart</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">  <span class="attr">removeFromCart</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">CartProvider</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">(<span class="params">&#123; children &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [cartItems, setCartItems] = useState&lt;<span class="title class_">CartItem</span>[]&gt;([]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">addToCart</span> = (<span class="params"><span class="attr">item</span>: <span class="title class_">CartItem</span></span>) =&gt; <span class="title function_">setCartItems</span>([...cartItems, item]);</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">removeFromCart</span> = (<span class="params"><span class="attr">id</span>: <span class="built_in">number</span></span>) =&gt;</span><br><span class="line">    <span class="title function_">setCartItems</span>(cartItems.<span class="title function_">filter</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">id</span> !== id));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">CartContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;&#123;</span> <span class="attr">cartItems</span>, <span class="attr">addToCart</span>, <span class="attr">removeFromCart</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">CartContext.Provider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">useCart</span> = (<span class="params"></span>) =&gt; <span class="title function_">useContext</span>(<span class="title class_">CartContext</span>);</span><br></pre></td></tr></table></figure>

<h4 id="Redux-1"><a href="#Redux-1" class="headerlink" title="Redux"></a>Redux</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">CartItem</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">State</span> &#123;</span><br><span class="line">  <span class="attr">cartItems</span>: <span class="title class_">CartItem</span>[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Action</span> &#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="built_in">string</span>;</span><br><span class="line">  payload?: <span class="built_in">any</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">initialState</span>: <span class="title class_">State</span> = &#123; <span class="attr">cartItems</span>: [] &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state = initialState, <span class="attr">action</span>: <span class="title class_">Action</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;ADD_TO_CART&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">cartItems</span>: [...state.<span class="property">cartItems</span>, action.<span class="property">payload</span>] &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;REMOVE_FROM_CART&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">cartItems</span>: state.<span class="property">cartItems</span>.<span class="title function_">filter</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">id</span> !== action.<span class="property">payload</span>),</span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>

<p><a name="8-some-diagrams"></a></p>
<h2 id="8-Some-Diagrams"><a href="#8-Some-Diagrams" class="headerlink" title="8. Some Diagrams"></a>8. Some Diagrams</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| App               |       | AuthProvider      |       | CartProvider      |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">        |                            |                           |</span><br><span class="line">        | (1) Auth Context           |                           |</span><br><span class="line">        |---------------------------&gt;|                           |</span><br><span class="line">        |                            | (2) Cart Context          |</span><br><span class="line">        |                            |--------------------------&gt;|</span><br><span class="line">        |                            |                           |</span><br><span class="line">        | (3) LoginPage              |                           |</span><br><span class="line">        |&lt;------------ --------------|                           |</span><br><span class="line">        |                            |                           |</span><br><span class="line">        | (4) Dashboard              |                           |</span><br><span class="line">        |&lt;------------ --------------|                           |</span><br><span class="line">        |                            |                           |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| App               |       | AuthProvider      |       | CartProvider      |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| User              |       | LoginPage         |       | AuthProvider      |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (1) Click Login Button    |                           |</span><br><span class="line">        |--------------------------&gt;|                           |</span><br><span class="line">        |                           | (2) Dispatch Login Action |</span><br><span class="line">        |                           |--------------------------&gt;|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (3) Update Auth State     |                           |</span><br><span class="line">        |&lt;--------------------------|                           |</span><br><span class="line">        |                           |                           |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| User              |       | LoginPage         |       | AuthProvider      |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br></pre></td></tr></table></figure>

<p><a name="project-folder-structure"></a></p>
<h2 id="Project-Folder-Structure"><a href="#Project-Folder-Structure" class="headerlink" title="Project Folder Structure"></a>Project Folder Structure</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">project-root/</span><br><span class="line">├── src/</span><br><span class="line">│   ├── components/</span><br><span class="line">│   │   ├── LoginPage.tsx</span><br><span class="line">│   │   ├── Dashboard.tsx</span><br><span class="line">│   ├── contexts/</span><br><span class="line">│   │   ├── AuthContext.tsx</span><br><span class="line">│   │   ├── CartContext.tsx</span><br><span class="line">│   ├── redux/</span><br><span class="line">│   │   ├── store.ts</span><br><span class="line">│   ├── App.tsx</span><br><span class="line">│   ├── index.tsx</span><br><span class="line">├── tests/</span><br><span class="line">│   ├── components/</span><br><span class="line">│   │   ├── LoginPage.test.tsx</span><br><span class="line">│   │   ├── Dashboard.test.tsx</span><br><span class="line">│   ├── contexts/</span><br><span class="line">│   │   ├── AuthContext.test.tsx</span><br><span class="line">│   │   ├── CartContext.test.tsx</span><br><span class="line">│   ├── redux/</span><br><span class="line">│   │   ├── store.test.ts</span><br><span class="line">├── package.json</span><br><span class="line">├── tsconfig.json</span><br><span class="line">├── yarn.lock</span><br></pre></td></tr></table></figure>

<p><a name="unit-test-cases"></a></p>
<h2 id="Unit-Test-Cases"><a href="#Unit-Test-Cases" class="headerlink" title="Unit Test Cases"></a>Unit Test Cases</h2><p><a name="login-page-test"></a></p>
<h3 id="LoginPage-test-tsx"><a href="#LoginPage-test-tsx" class="headerlink" title="LoginPage.test.tsx"></a>LoginPage.test.tsx</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render, fireEvent &#125; <span class="keyword">from</span> <span class="string">&#x27;@testing-library/react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AuthProvider</span>, useAuth &#125; <span class="keyword">from</span> <span class="string">&#x27;../../src/contexts/AuthContext&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">LoginPage</span> <span class="keyword">from</span> <span class="string">&#x27;../../src/components/LoginPage&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TestComponent</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; isAuthenticated &#125; = <span class="title function_">useAuth</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;isAuthenticated ? &#x27;Logged In&#x27; : &#x27;Logged Out&#x27;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;LoginPage logs in user&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; getByText &#125; = <span class="title function_">render</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">AuthProvider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">LoginPage</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">TestComponent</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">AuthProvider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  fireEvent.<span class="title function_">click</span>(<span class="title function_">getByText</span>(<span class="string">&#x27;Login&#x27;</span>));</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title function_">getByText</span>(<span class="string">&#x27;Logged In&#x27;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><a name="dashboard-test"></a></p>
<h3 id="Dashboard-test-tsx"><a href="#Dashboard-test-tsx" class="headerlink" title="Dashboard.test.tsx"></a>Dashboard.test.tsx</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render, fireEvent &#125; <span class="keyword">from</span> <span class="string">&#x27;@testing-library/react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AuthProvider</span>, useAuth &#125; <span class="keyword">from</span> <span class="string">&#x27;../../src/contexts/AuthContext&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Dashboard</span> <span class="keyword">from</span> <span class="string">&#x27;../../src/components/Dashboard&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TestComponent</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; isAuthenticated &#125; = <span class="title function_">useAuth</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;isAuthenticated ? &#x27;Logged In&#x27; : &#x27;Logged Out&#x27;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;Dashboard logs out user&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; getByText &#125; = <span class="title function_">render</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">AuthProvider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Dashboard</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">TestComponent</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">AuthProvider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  fireEvent.<span class="title function_">click</span>(<span class="title function_">getByText</span>(<span class="string">&#x27;Logout&#x27;</span>));</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title function_">getByText</span>(<span class="string">&#x27;Logged Out&#x27;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><a name="commands-to-init-and-add-dependencies"></a></p>
<h2 id="Commands-to-Init-and-Add-Dependencies"><a href="#Commands-to-Init-and-Add-Dependencies" class="headerlink" title="Commands to Init and Add Dependencies"></a>Commands to Init and Add Dependencies</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Initialize a new React project with TypeScript</span></span><br><span class="line">yarn create react-app my-app --template typescript</span><br><span class="line"></span><br><span class="line"><span class="comment"># Navigate to the project directory</span></span><br><span class="line"><span class="built_in">cd</span> my-app</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add Redux and React-Redux</span></span><br><span class="line">yarn add redux react-redux</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add React Context API (no additional packages needed)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add Testing Library</span></span><br><span class="line">yarn add --dev @testing-library/react @testing-library/jest-dom</span><br></pre></td></tr></table></figure>

<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>State management is a crucial aspect of building scalable and maintainable ReactJS applications. This article provided a deep dive into state management in ReactJS, focusing on functional components and the latest version of the tech stack. We explored two main state management options: React Context API and Redux. Additionally, we provided real production scenarios with TypeScript code samples, design diagrams, project folder structures, unit test cases, and commands to initialize and add dependencies using Yarn.</p>
<p>By understanding and applying these concepts, developers can effectively manage state in their ReactJS applications, ensuring they remain scalable, maintainable, and performant.</p>
<p><a name="references"></a></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://reactjs.org/docs/getting-started.html">React Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://redux.js.org/introduction/getting-started">Redux Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://reactjs.org/docs/context.html">React Context API</a></li>
<li><a target="_blank" rel="noopener" href="https://testing-library.com/docs/react-testing-library/intro">Testing Library</a></li>
</ul>
<hr>
<p>This article provides a comprehensive guide to state management in ReactJS, including detailed code samples, design diagrams, project folder structures, unit test cases, and commands to initialize and add dependencies using Yarn. By understanding and applying these practices, developers can leverage the full potential of state management in their ReactJS projects.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/04/Best-Practices-for-Java-8-Lambda-Expressions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/04/Best-Practices-for-Java-8-Lambda-Expressions/" class="post-title-link" itemprop="url">Best Practices for Java 8 Lambda Expressions</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-04 11:56:27 / Modified: 13:25:15" itemprop="dateCreated datePublished" datetime="2024-11-04T11:56:27-05:00">2024-11-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java/Lambda/" itemprop="url" rel="index"><span itemprop="name">Lambda</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#1-high-level-overview">1. High-Level Overview</a></li>
<li><a href="#lambda-basics">Lambda Basics</a><ul>
<li><a href="#21-functional-interfaces">2.1 Functional Interfaces</a></li>
<li><a href="#22-lambda-syntax">2.2 Lambda Syntax</a></li>
</ul>
</li>
<li><a href="#3-best-practices">3. Best Practices</a><ul>
<li><a href="#31-simplifying-iterations">3.1 Simplifying Iterations</a></li>
<li><a href="#32-avoiding-stateful-lambdas">3.2 Avoiding Stateful Lambdas</a></li>
<li><a href="#33-using-lambdas-with-streams">3.3 Using Lambdas with Streams</a></li>
<li><a href="#34-handling-exceptions">3.4 Handling Exceptions</a></li>
<li><a href="#35-using-method-references">3.5 Using Method References</a></li>
<li><a href="#36-avoiding-state-modifications">3.6 Avoiding State Modifications</a></li>
<li><a href="#37-chaining-lambdas">3.7 Chaining Lambdas</a></li>
<li><a href="#38-parallel-streams">3.8 Parallel Streams</a></li>
<li><a href="#39-lazy-evaluation">3.9 Lazy Evaluation</a></li>
</ul>
</li>
<li><a href="#4-code-samples">4. Code Samples</a><ul>
<li><a href="#41-filtering-and-mapping">4.1 Filtering and Mapping</a></li>
<li><a href="#42-reducing-and-collecting">4.2 Reducing and Collecting</a></li>
<li><a href="#43-sorting-and-grouping">4.3 Sorting and Grouping</a></li>
<li><a href="#44-custom-functional-interfaces">4.4 Custom Functional Interfaces</a></li>
</ul>
</li>
<li><a href="#5-conclusion">5. Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<hr>
<p>Java 8 introduced lambda expressions, providing a functional programming capability that simplifies code, improves readability, and makes certain operations more concise. This article outlines best practices for using Java 8 lambda operators in real production scenarios, complete with detailed code samples, design diagrams, and unit tests.</p>
<p><a name="1-high-level-overview"></a></p>
<h2 id="1-High-Level-Overview"><a href="#1-High-Level-Overview" class="headerlink" title="1. High-Level Overview"></a>1. High-Level Overview</h2><p>Java 8 lambda expressions and the <code>Stream</code> API transform traditional iterative and procedural operations into concise, readable code. Best practices include using functional interfaces, optimizing performance, and ensuring code maintainability.</p>
<p><a name="lambda-basics"></a></p>
<h2 id="Lambda-Basics"><a href="#Lambda-Basics" class="headerlink" title="Lambda Basics"></a>Lambda Basics</h2><p><a name="21-functional-interfaces"></a></p>
<h3 id="2-1-Functional-Interfaces"><a href="#2-1-Functional-Interfaces" class="headerlink" title="2.1 Functional Interfaces"></a>2.1 Functional Interfaces</h3><p>Functional interfaces are interfaces that have exactly one abstract method. They are the foundation of lambda expressions in Java. Some common functional interfaces include <code>Predicate</code>, <code>Function</code>, <code>Consumer</code>, and <code>Supplier</code>.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">MyFunctionalInterface</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">doSomething</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="22-lambda-syntax"></a></p>
<h3 id="2-2-Lambda-Syntax"><a href="#2-2-Lambda-Syntax" class="headerlink" title="2.2 Lambda Syntax"></a>2.2 Lambda Syntax</h3><p>Lambda expressions provide a concise way to represent instances of functional interfaces. The basic syntax is:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(parameters) -&gt; expression</span><br><span class="line">(parameters) -&gt; &#123; statements; &#125;</span><br></pre></td></tr></table></figure>

<p>Example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">MyFunctionalInterface</span> <span class="variable">myLambda</span> <span class="operator">=</span> () -&gt; System.out.println(<span class="string">&quot;Hello, Lambda!&quot;</span>);</span><br><span class="line">myLambda.doSomething();</span><br></pre></td></tr></table></figure>

<p><a name="3-best-practices"></a></p>
<h2 id="3-Best-Practices"><a href="#3-Best-Practices" class="headerlink" title="3. Best Practices"></a>3. Best Practices</h2><p><a name="31-simplifying-iterations"></a></p>
<h3 id="3-1-Simplifying-Iterations"><a href="#3-1-Simplifying-Iterations" class="headerlink" title="3.1 Simplifying Iterations"></a>3.1 Simplifying Iterations</h3><p><strong>Example</strong>: Replacing traditional loops with lambda expressions.</p>
<p><strong>Before</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; items = Arrays.asList(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;orange&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (String item : items) &#123;</span><br><span class="line">    System.out.println(item);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>After</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">items.forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<p><strong>Best Practice</strong>: Use <code>forEach()</code> for concise iteration.</p>
<p><a name="32-avoiding-stateful-lambdas"></a></p>
<h3 id="3-2-Avoiding-Stateful-Lambdas"><a href="#3-2-Avoiding-Stateful-Lambdas" class="headerlink" title="3.2 Avoiding Stateful Lambdas"></a>3.2 Avoiding Stateful Lambdas</h3><p>Stateful lambdas can lead to unpredictable behavior, especially in parallel streams. Prefer stateless lambdas to ensure thread safety.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">numbers.stream()</span><br><span class="line">       .map(n -&gt; n * <span class="number">2</span>) <span class="comment">// Stateless lambda</span></span><br><span class="line">       .forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<p><a name="33-using-lambdas-with-streams"></a></p>
<h3 id="3-3-Using-Lambdas-with-Streams"><a href="#3-3-Using-Lambdas-with-Streams" class="headerlink" title="3.3 Using Lambdas with Streams"></a>3.3 Using Lambdas with Streams</h3><p><strong>Example</strong>: Filtering, mapping, and collecting data using <code>Stream</code>.</p>
<p><strong>Code Sample</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; items = Arrays.asList(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;orange&quot;</span>, <span class="string">&quot;pear&quot;</span>);</span><br><span class="line">List&lt;String&gt; filteredItems = items.stream()</span><br><span class="line">    .filter(item -&gt; item.startsWith(<span class="string">&quot;a&quot;</span>))</span><br><span class="line">    .map(String::toUpperCase)</span><br><span class="line">    .collect(Collectors.toList());</span><br></pre></td></tr></table></figure>

<p><strong>Best Practice</strong>: Use <code>Stream</code> to filter and transform data in a functional style.</p>
<p><a name="34-handling-exceptions"></a></p>
<h3 id="3-4-Handling-Exceptions"><a href="#3-4-Handling-Exceptions" class="headerlink" title="3.4 Handling Exceptions"></a>3.4 Handling Exceptions</h3><p>Lambda expressions can’t throw checked exceptions directly. Use a helper method for handling them.</p>
<p><strong>Code Sample</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Consumer&lt;T&gt; <span class="title function_">handleConsumerWithException</span><span class="params">(Consumer&lt;T&gt; consumer)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> i -&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            consumer.accept(i);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(ex);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Usage</span></span><br><span class="line">items.forEach(handleConsumerWithException(item -&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.equals(<span class="string">&quot;apple&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IOException</span>(<span class="string">&quot;Test exception&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(item);</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>


<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">CheckedFunction</span>&lt;T, R&gt; &#123;</span><br><span class="line">    R <span class="title function_">apply</span><span class="params">(T t)</span> <span class="keyword">throws</span> Exception;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T, R&gt; Function&lt;T, R&gt; <span class="title function_">wrap</span><span class="params">(CheckedFunction&lt;T, R&gt; checkedFunction)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> t -&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> checkedFunction.apply(t);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">List&lt;String&gt; files = Arrays.asList(<span class="string">&quot;file1.txt&quot;</span>, <span class="string">&quot;file2.txt&quot;</span>);</span><br><span class="line">files.stream()</span><br><span class="line">     .map(wrap(File::<span class="keyword">new</span>))</span><br><span class="line">     .forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<p><a name="35-using-method-references"></a></p>
<h3 id="3-5-Using-Method-References"><a href="#3-5-Using-Method-References" class="headerlink" title="3.5 Using Method References"></a>3.5 Using Method References</h3><p>Method references make lambda expressions cleaner.</p>
<p><strong>Example</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Using lambda</span></span><br><span class="line">items.forEach(item -&gt; System.out.println(item));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Using method reference</span></span><br><span class="line">items.forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<p><strong>Best Practice</strong>: Use method references when possible for better readability.</p>
<p><a name="36-avoiding-state-modifications"></a></p>
<h3 id="3-6-Avoiding-State-Modifications"><a href="#3-6-Avoiding-State-Modifications" class="headerlink" title="3.6 Avoiding State Modifications"></a>3.6 Avoiding State Modifications</h3><p>Ensure that lambdas do not modify state, leading to race conditions in parallel streams.</p>
<p><strong>Bad Practice</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line"><span class="type">int</span>[] sum = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">numbers.parallelStream().forEach(num -&gt; sum[<span class="number">0</span>] += num); <span class="comment">// Not thread-safe</span></span><br></pre></td></tr></table></figure>

<p><strong>Good Practice</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> numbers.parallelStream().mapToInt(Integer::intValue).sum();</span><br></pre></td></tr></table></figure>

<p><a name="37-chaining-lambdas"></a></p>
<h3 id="3-7-Chaining-Lambdas"><a href="#3-7-Chaining-Lambdas" class="headerlink" title="3.7 Chaining Lambdas"></a>3.7 Chaining Lambdas</h3><p>Combine multiple lambda operations using <code>andThen()</code> or <code>compose()</code> for complex transformations.</p>
<p><strong>Example</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Function&lt;String, String&gt; toUpperCase = String::toUpperCase;</span><br><span class="line">Function&lt;String, String&gt; addExclamation = s -&gt; s + <span class="string">&quot;!&quot;</span>;</span><br><span class="line">Function&lt;String, String&gt; transform = toUpperCase.andThen(addExclamation);</span><br><span class="line"></span><br><span class="line">System.out.println(transform.apply(<span class="string">&quot;hello&quot;</span>)); <span class="comment">// Output: HELLO!</span></span><br></pre></td></tr></table></figure>


<p><a name="38-parallel-streams"></a></p>
<h3 id="3-8-Parallel-Streams"><a href="#3-8-Parallel-Streams" class="headerlink" title="3.8 Parallel Streams"></a>3.8 Parallel Streams</h3><p>Parallel streams can improve performance for large datasets. However, ensure that the operations are thread-safe.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line"><span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> numbers.parallelStream()</span><br><span class="line">                 .mapToInt(Integer::intValue)</span><br><span class="line">                 .sum();</span><br><span class="line">System.out.println(<span class="string">&quot;Sum: &quot;</span> + sum);</span><br></pre></td></tr></table></figure>

<p><a name="39-lazy-evaluation"></a></p>
<h3 id="3-9-Lazy-Evaluation"><a href="#3-9-Lazy-Evaluation" class="headerlink" title="3.9 Lazy Evaluation"></a>3.9 Lazy Evaluation</h3><p>Streams use lazy evaluation, meaning that operations are not executed until a terminal operation is called. This can optimize performance.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">Optional&lt;Integer&gt; firstEven = numbers.stream()</span><br><span class="line">                                     .filter(n -&gt; n % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">                                     .findFirst();</span><br><span class="line">System.out.println(<span class="string">&quot;First even number: &quot;</span> + firstEven.orElse(-<span class="number">1</span>));</span><br></pre></td></tr></table></figure>

<p><a name="4-code-samples"></a></p>
<h2 id="4-Code-Samples"><a href="#4-Code-Samples" class="headerlink" title="4. Code Samples"></a>4. Code Samples</h2><p><strong>Example</strong>: Processing large datasets in a batch processing service.</p>
<p><strong><code>LambdaUsageExamples.java</code></strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LambdaUsageExamples</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">filterAndTransform</span><span class="params">(List&lt;String&gt; items)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> items.stream()</span><br><span class="line">                .filter(item -&gt; item.length() &gt; <span class="number">3</span>)</span><br><span class="line">                .map(String::toUpperCase)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">printItems</span><span class="params">(List&lt;String&gt; items)</span> &#123;</span><br><span class="line">        items.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="41-filtering-and-mapping"></a></p>
<h3 id="4-1-Filtering-and-Mapping"><a href="#4-1-Filtering-and-Mapping" class="headerlink" title="4.1 Filtering and Mapping"></a>4.1 Filtering and Mapping</h3><p>Filtering and mapping are common operations in data processing. Use <code>filter</code> and <code>map</code> methods to transform data.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Person&gt; people = Arrays.asList(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Alice&quot;</span>, <span class="number">30</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Bob&quot;</span>, <span class="number">25</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Charlie&quot;</span>, <span class="number">35</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">List&lt;String&gt; names = people.stream()</span><br><span class="line">                           .filter(p -&gt; p.getAge() &gt; <span class="number">25</span>)</span><br><span class="line">                           .map(Person::getName)</span><br><span class="line">                           .collect(Collectors.toList());</span><br><span class="line">System.out.println(names);</span><br></pre></td></tr></table></figure>

<p><a name="42-reducing-and-collecting"></a></p>
<h3 id="4-2-Reducing-and-Collecting"><a href="#4-2-Reducing-and-Collecting" class="headerlink" title="4.2 Reducing and Collecting"></a>4.2 Reducing and Collecting</h3><p>Reducing and collecting operations aggregate data. Use <code>reduce</code> and <code>collect</code> methods for these operations.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line"><span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> numbers.stream()</span><br><span class="line">                 .reduce(<span class="number">0</span>, Integer::sum);</span><br><span class="line">System.out.println(<span class="string">&quot;Sum: &quot;</span> + sum);</span><br><span class="line"></span><br><span class="line">Map&lt;String, Integer&gt; nameToAge = people.stream()</span><br><span class="line">                                       .collect(Collectors.toMap(Person::getName, Person::getAge));</span><br><span class="line">System.out.println(nameToAge);</span><br></pre></td></tr></table></figure>

<p><a name="43-sorting-and-grouping"></a></p>
<h3 id="4-3-Sorting-and-Grouping"><a href="#4-3-Sorting-and-Grouping" class="headerlink" title="4.3 Sorting and Grouping"></a>4.3 Sorting and Grouping</h3><p>Sorting and grouping are useful for organizing data. Use <code>sorted</code> and <code>groupingBy</code> methods.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Person&gt; sortedPeople = people.stream()</span><br><span class="line">                                  .sorted(Comparator.comparing(Person::getAge))</span><br><span class="line">                                  .collect(Collectors.toList());</span><br><span class="line">System.out.println(sortedPeople);</span><br><span class="line"></span><br><span class="line">Map&lt;Integer, List&lt;Person&gt;&gt; ageGroups = people.stream()</span><br><span class="line">                                             .collect(Collectors.groupingBy(Person::getAge));</span><br><span class="line">System.out.println(ageGroups);</span><br></pre></td></tr></table></figure>

<p><a name="44-custom-functional-interfaces"></a></p>
<h3 id="4-4-Custom-Functional-Interfaces"><a href="#4-4-Custom-Functional-Interfaces" class="headerlink" title="4.4 Custom Functional Interfaces"></a>4.4 Custom Functional Interfaces</h3><p>Custom functional interfaces can be used to encapsulate business logic. Define custom interfaces as needed.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">AgeChecker</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">checkAge</span><span class="params">(Person person)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">AgeChecker</span> <span class="variable">isAdult</span> <span class="operator">=</span> person -&gt; person.getAge() &gt;= <span class="number">18</span>;</span><br><span class="line">people.stream()</span><br><span class="line">      .filter(isAdult::checkAge)</span><br><span class="line">      .forEach(System.out::println);</span><br></pre></td></tr></table></figure>

<p><a name="5-conclusion"></a></p>
<h2 id="5-Conclusion"><a href="#5-Conclusion" class="headerlink" title="5. Conclusion"></a>5. Conclusion</h2><p>Adhering to best practices with Java 8 lambdas enhances code readability, safety, and maintainability. Avoid modifying state within lambda operations, handle exceptions thoughtfully, and prefer method references for simpler expressions. Implementing these best practices in production scenarios ensures robust and scalable code.</p>
<p><a name="references"></a></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/util/function/package-summary.html">Java 8 Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/package-summary.html">Java Streams Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://www.baeldung.com/java-8-functional-interfaces">Java Functional Programming</a></li>
</ul>
<hr>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/03/Spark-in-Spring-Boot-Application/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/03/Spark-in-Spring-Boot-Application/" class="post-title-link" itemprop="url">Spark in Spring Boot Application</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-03 16:24:53 / Modified: 22:20:38" itemprop="dateCreated datePublished" datetime="2024-11-03T16:24:53-05:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/Spark/" itemprop="url" rel="index"><span itemprop="name">Spark</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/Spark/Big-Data/" itemprop="url" rel="index"><span itemprop="name">Big Data</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/Spark/Big-Data/Kafka/" itemprop="url" rel="index"><span itemprop="name">Kafka</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/Spark/Big-Data/Kafka/Elasticsearch/" itemprop="url" rel="index"><span itemprop="name">Elasticsearch</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/Spark/Big-Data/Kafka/Elasticsearch/Minio/" itemprop="url" rel="index"><span itemprop="name">Minio</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#project-folder-structure">Project Folder Structure</a></li>
<li><a href="#setting-up-the-spring-boot-application">Setting Up the Spring Boot Application</a><ul>
<li><a href="#step-1-create-a-spring-boot-project">Step 1: Create a Spring Boot Project</a></li>
<li><a href="#step-2-configure-application-properties">Step 2: Configure Application Properties</a></li>
</ul>
</li>
<li><a href="#integrating-spark-with-spring-boot">Integrating Spark with Spring Boot</a><ul>
<li><a href="#step-1-add-spark-dependencies">Step 1: Add Spark Dependencies</a></li>
<li><a href="#step-2-configure-spark">Step 2: Configure Spark</a></li>
</ul>
</li>
<li><a href="#communicating-with-kafka">Communicating with Kafka</a><ul>
<li><a href="#reading-avro-records-from-kafka">Reading Avro Records from Kafka</a></li>
<li><a href="#reading-avro-records-from-kafka-with-schema-registry">Reading Avro Records from Kafka with Schema Registry</a></li>
<li><a href="#writing-data-to-kafka">Writing Data to Kafka</a></li>
<li><a href="#writing-avro-records-to-kafka-with-schema-registry">Writing Avro Records to Kafka with Schema Registry</a></li>
</ul>
</li>
<li><a href="#communicating-with-elasticsearch">Communicating with Elasticsearch</a><ul>
<li><a href="#reading-json-data-from-elasticsearch">Reading JSON Data from Elasticsearch</a></li>
<li><a href="#writing-data-to-elasticsearch">Writing Data to Elasticsearch</a></li>
</ul>
</li>
<li><a href="#handling-parquet-files-in-minio">Handling Parquet Files in MinIO</a><ul>
<li><a href="#reading-parquet-files-from-minio">Reading Parquet Files from MinIO</a></li>
<li><a href="#writing-parquet-files-to-minio">Writing Parquet Files to MinIO</a></li>
</ul>
</li>
<li><a href="#using-spark-dataframe-and-spark-sql">Using Spark DataFrame and Spark SQL</a><ul>
<li><a href="#creating-dataframes">Creating DataFrames</a></li>
<li><a href="#querying-dataframes-with-spark-sql">Querying DataFrames with Spark SQL</a></li>
</ul>
</li>
<li><a href="#unit-test-cases">Unit Test Cases</a><ul>
<li><a href="#kafkaservicetestjava">KafkaServiceTest.java</a></li>
<li><a href="#elasticsearchservicetestjava">ElasticsearchServiceTest.java</a></li>
<li><a href="#minioservicetestjava">MinIOServiceTest.java</a></li>
<li><a href="#dataframeservicetestjava">DataFrameServiceTest.java</a></li>
</ul>
</li>
<li><a href="#design-diagrams">Design Diagrams</a><ul>
<li><a href="#component-diagram">Component Diagram</a></li>
<li><a href="#sequence-diagram">Sequence Diagram</a></li>
</ul>
</li>
<li><a href="#advanced-scenarios">Advanced Scenarios</a><ul>
<li><a href="#complex-scenario-1-flow-control-and-backpressure-handling">Complex Scenario 1: Flow Control and Backpressure Handling</a></li>
<li><a href="#complex-scenario-2-handling-large-scale-data-processing">Complex Scenario 2: Handling Large-Scale Data Processing</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>This article provides a comprehensive guide to developing a Spark application with Spring Boot 3.3.5 to communicate with Kafka and Elasticsearch. The application will handle Avro records in Kafka, JSON data in Elasticsearch, and Parquet files in MinIO using Spark DataFrame and Spark SQL. The article covers the setup, integration, and advanced scenarios for handling large-scale data processing, including the use of Avro Schema Registry when communicating with Kafka.</p>
<hr>
<p><a name="prerequisites"></a></p>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><ul>
<li>Java 17 or later</li>
<li>Apache Spark 3.5.4</li>
<li>Spring Boot 3.3.5</li>
<li>Kafka 3.x</li>
<li>Elasticsearch 8.x</li>
<li>MinIO</li>
<li>Maven or Gradle</li>
<li>Confluent Schema Registry</li>
</ul>
<hr>
<p><a name="project-folder-structure"></a></p>
<h2 id="Project-Folder-Structure"><a href="#Project-Folder-Structure" class="headerlink" title="Project Folder Structure"></a>Project Folder Structure</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">spark-spring-boot-app/</span><br><span class="line">├── src/</span><br><span class="line">│   ├── main/</span><br><span class="line">│   │   ├── java/</span><br><span class="line">│   │   │   ├── com/</span><br><span class="line">│   │   │   │   ├── example/</span><br><span class="line">│   │   │   │   │   ├── config/</span><br><span class="line">│   │   │   │   │   │   ├── SparkConfig.java</span><br><span class="line">│   │   │   │   │   ├── service/</span><br><span class="line">│   │   │   │   │   │   ├── KafkaService.java</span><br><span class="line">│   │   │   │   │   │   ├── ElasticsearchService.java</span><br><span class="line">│   │   │   │   │   │   ├── MinIOService.java</span><br><span class="line">│   │   │   │   │   │   ├── DataFrameService.java</span><br><span class="line">│   │   │   │   │   ├── SparkSpringBootConsoleApplication.java</span><br><span class="line">│   │   ├── resources/</span><br><span class="line">│   │   │   ├── application.properties</span><br><span class="line">│   ├── test/</span><br><span class="line">│   │   ├── java/</span><br><span class="line">│   │   │   ├── com/</span><br><span class="line">│   │   │   │   ├── example/</span><br><span class="line">│   │   │   │   │   ├── service/</span><br><span class="line">│   │   │   │   │   │   ├── KafkaServiceTest.java</span><br><span class="line">│   │   │   │   │   │   ├── ElasticsearchServiceTest.java</span><br><span class="line">│   │   │   │   │   │   ├── MinIOServiceTest.java</span><br><span class="line">│   │   │   │   │   │   ├── DataFrameServiceTest.java</span><br><span class="line">├── pom.xml (or build.gradle)</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="setting-up-the-spring-boot-application"></a></p>
<h2 id="Setting-Up-the-Spring-Boot-Application"><a href="#Setting-Up-the-Spring-Boot-Application" class="headerlink" title="Setting Up the Spring Boot Application"></a>Setting Up the Spring Boot Application</h2><h3 id="Step-1-Create-a-Spring-Boot-Project"><a href="#Step-1-Create-a-Spring-Boot-Project" class="headerlink" title="Step 1: Create a Spring Boot Project"></a>Step 1: Create a Spring Boot Project</h3><p>Create a new Spring Boot project using Spring Initializr or your preferred IDE. Include the following dependencies:</p>
<ul>
<li>Spring for Apache Kafka</li>
<li>Spring Data Elasticsearch</li>
<li>Spring for Apache Spark</li>
</ul>
<h3 id="Step-2-Configure-Application-Properties"><a href="#Step-2-Configure-Application-Properties" class="headerlink" title="Step 2: Configure Application Properties"></a>Step 2: Configure Application Properties</h3><p>Configure the application properties for Kafka, Elasticsearch, and MinIO:</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Kafka Configuration</span></span><br><span class="line"><span class="attr">spring.kafka.bootstrap-servers</span>=<span class="string">localhost:9092</span></span><br><span class="line"><span class="attr">spring.kafka.consumer.group-id</span>=<span class="string">my-group</span></span><br><span class="line"><span class="attr">spring.kafka.consumer.key-deserializer</span>=<span class="string">org.apache.kafka.common.serialization.StringDeserializer</span></span><br><span class="line"><span class="attr">spring.kafka.consumer.value-deserializer</span>=<span class="string">org.apache.kafka.common.serialization.ByteArrayDeserializer</span></span><br><span class="line"><span class="attr">spring.kafka.producer.key-serializer</span>=<span class="string">org.apache.kafka.common.serialization.StringSerializer</span></span><br><span class="line"><span class="attr">spring.kafka.producer.value-serializer</span>=<span class="string">org.apache.kafka.common.serialization.ByteArraySerializer</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># Schema Registry Configuration</span></span><br><span class="line"><span class="attr">schema.registry.url</span>=<span class="string">http://localhost:8081</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># Elasticsearch Configuration</span></span><br><span class="line"><span class="attr">spring.elasticsearch.rest.uris</span>=<span class="string">http://localhost:9200</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># MinIO Configuration</span></span><br><span class="line"><span class="attr">minio.endpoint</span>=<span class="string">http://localhost:9000</span></span><br><span class="line"><span class="attr">minio.accessKey</span>=<span class="string">your-access-key</span></span><br><span class="line"><span class="attr">minio.secretKey</span>=<span class="string">your-secret-key</span></span><br><span class="line"><span class="attr">minio.bucket</span>=<span class="string">your-bucket</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="integrating-spark-with-spring-boot"></a></p>
<h2 id="Integrating-Spark-with-Spring-Boot"><a href="#Integrating-Spark-with-Spring-Boot" class="headerlink" title="Integrating Spark with Spring Boot"></a>Integrating Spark with Spring Boot</h2><h3 id="Step-1-Add-Spark-Dependencies"><a href="#Step-1-Add-Spark-Dependencies" class="headerlink" title="Step 1: Add Spark Dependencies"></a>Step 1: Add Spark Dependencies</h3><p>Add the following dependencies to your <code>pom.xml</code> or <code>build.gradle</code> file:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-core_2.12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-sql_2.12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-avro_2.12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-sql-kafka-0-10_2.12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.confluent<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>kafka-avro-serializer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>7.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Step-2-Configure-Spark"><a href="#Step-2-Configure-Spark" class="headerlink" title="Step 2: Configure Spark"></a>Step 2: Configure Spark</h3><p>Configure Spark in your Spring Boot application using annotation-style configuration:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SparkConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SparkSession <span class="title function_">sparkSession</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> SparkSession.builder()</span><br><span class="line">                .appName(<span class="string">&quot;SparkSpringBootApp&quot;</span>)</span><br><span class="line">                .master(<span class="string">&quot;local[*]&quot;</span>)</span><br><span class="line">                .config(<span class="string">&quot;spark.sql.shuffle.partitions&quot;</span>, <span class="string">&quot;10&quot;</span>)</span><br><span class="line">                .getOrCreate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="communicating-with-kafka"></a></p>
<h2 id="Communicating-with-Kafka"><a href="#Communicating-with-Kafka" class="headerlink" title="Communicating with Kafka"></a>Communicating with Kafka</h2><p><a name="reading-avro-records-from-kafka"></a></p>
<h3 id="Reading-Avro-Records-from-Kafka"><a href="#Reading-Avro-Records-from-Kafka" class="headerlink" title="Reading Avro Records from Kafka"></a>Reading Avro Records from Kafka</h3><p>To read Avro records from Kafka, use the <code>spark-avro</code> and <code>spark-sql-kafka-0-10</code> libraries:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KafkaService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Dataset&lt;Row&gt; <span class="title function_">readAvroFromKafka</span><span class="params">(String topic)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sparkSession.read()</span><br><span class="line">                .format(<span class="string">&quot;kafka&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;kafka.bootstrap.servers&quot;</span>, <span class="string">&quot;localhost:9092&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;subscribe&quot;</span>, topic)</span><br><span class="line">                .load()</span><br><span class="line">                .selectExpr(<span class="string">&quot;CAST(value AS BINARY)&quot;</span>)</span><br><span class="line">                .select(org.apache.spark.sql.avro.functions.from_avro(col(<span class="string">&quot;value&quot;</span>), <span class="string">&quot;your_avro_schema&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><a name="reading-avro-records-from-kafka-with-schema-registry"></a></p>
<h3 id="Reading-Avro-Records-from-Kafka-with-Schema-Registry"><a href="#Reading-Avro-Records-from-Kafka-with-Schema-Registry" class="headerlink" title="Reading Avro Records from Kafka with Schema Registry"></a>Reading Avro Records from Kafka with Schema Registry</h3><p>To read Avro records from Kafka using the Schema Registry, use the <code>spark-avro</code> and <code>spark-sql-kafka-0-10</code> libraries:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KafkaService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;schema.registry.url&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String schemaRegistryUrl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Dataset&lt;Row&gt; <span class="title function_">readAvroFromKafka</span><span class="params">(String topic)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sparkSession.read()</span><br><span class="line">                .format(<span class="string">&quot;kafka&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;kafka.bootstrap.servers&quot;</span>, <span class="string">&quot;localhost:9092&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;subscribe&quot;</span>, topic)</span><br><span class="line">                .load()</span><br><span class="line">                .selectExpr(<span class="string">&quot;CAST(value AS BINARY)&quot;</span>)</span><br><span class="line">                .select(org.apache.spark.sql.avro.functions.from_avro(col(<span class="string">&quot;value&quot;</span>), schemaRegistryUrl + <span class="string">&quot;/subjects/&quot;</span> + topic + <span class="string">&quot;-value/versions/latest&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="writing-data-to-kafka"></a></p>
<h3 id="Writing-Data-to-Kafka"><a href="#Writing-Data-to-Kafka" class="headerlink" title="Writing Data to Kafka"></a>Writing Data to Kafka</h3><p>To write data to Kafka, use the <code>spark-sql-kafka-0-10</code> library:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KafkaService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeToKafka</span><span class="params">(Dataset&lt;Row&gt; dataset, String topic)</span> &#123;</span><br><span class="line">        dataset.selectExpr(<span class="string">&quot;to_json(struct(*)) AS value&quot;</span>)</span><br><span class="line">                .write()</span><br><span class="line">                .format(<span class="string">&quot;kafka&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;kafka.bootstrap.servers&quot;</span>, <span class="string">&quot;localhost:9092&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;topic&quot;</span>, topic)</span><br><span class="line">                .save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="writing-avro-records-to-kafka-with-schema-registry"></a></p>
<h3 id="Writing-Avro-Records-to-Kafka-with-Schema-Registry"><a href="#Writing-Avro-Records-to-Kafka-with-Schema-Registry" class="headerlink" title="Writing Avro Records to Kafka with Schema Registry"></a>Writing Avro Records to Kafka with Schema Registry</h3><p>To write Avro records to Kafka using the Schema Registry, use the <code>spark-avro</code> and <code>spark-sql-kafka-0-10</code> libraries:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KafkaService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;schema.registry.url&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String schemaRegistryUrl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeAvroToKafka</span><span class="params">(Dataset&lt;Row&gt; dataset, String topic)</span> &#123;</span><br><span class="line">        dataset.select(org.apache.spark.sql.avro.functions.to_avro(struct(<span class="string">&quot;*&quot;</span>)).as(<span class="string">&quot;value&quot;</span>))</span><br><span class="line">                .write()</span><br><span class="line">                .format(<span class="string">&quot;kafka&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;kafka.bootstrap.servers&quot;</span>, <span class="string">&quot;localhost:9092&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;topic&quot;</span>, topic)</span><br><span class="line">                .option(<span class="string">&quot;schema.registry.url&quot;</span>, schemaRegistryUrl)</span><br><span class="line">                .save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="communicating-with-elasticsearch"></a></p>
<h2 id="Communicating-with-Elasticsearch"><a href="#Communicating-with-Elasticsearch" class="headerlink" title="Communicating with Elasticsearch"></a>Communicating with Elasticsearch</h2><p><a name="reading-json-data-from-elasticsearch"></a></p>
<h3 id="Reading-JSON-Data-from-Elasticsearch"><a href="#Reading-JSON-Data-from-Elasticsearch" class="headerlink" title="Reading JSON Data from Elasticsearch"></a>Reading JSON Data from Elasticsearch</h3><p>To read JSON data from Elasticsearch, use the <code>elasticsearch-hadoop</code> library:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ElasticsearchService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Dataset&lt;Row&gt; <span class="title function_">readFromElasticsearch</span><span class="params">(String index)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sparkSession.read()</span><br><span class="line">                .format(<span class="string">&quot;org.elasticsearch.spark.sql&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;es.nodes&quot;</span>, <span class="string">&quot;localhost&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;es.port&quot;</span>, <span class="string">&quot;9200&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;es.resource&quot;</span>, index)</span><br><span class="line">                .load();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="writing-data-to-elasticsearch"></a></p>
<h3 id="Writing-Data-to-Elasticsearch"><a href="#Writing-Data-to-Elasticsearch" class="headerlink" title="Writing Data to Elasticsearch"></a>Writing Data to Elasticsearch</h3><p>To write data to Elasticsearch, use the <code>elasticsearch-hadoop</code> library:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ElasticsearchService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeToElasticsearch</span><span class="params">(Dataset&lt;Row&gt; dataset, String index)</span> &#123;</span><br><span class="line">        dataset.write()</span><br><span class="line">                .format(<span class="string">&quot;org.elasticsearch.spark.sql&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;es.nodes&quot;</span>, <span class="string">&quot;localhost&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;es.port&quot;</span>, <span class="string">&quot;9200&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;es.resource&quot;</span>, index)</span><br><span class="line">                .save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="handling-parquet-files-in-minio"></a></p>
<h2 id="Handling-Parquet-Files-in-MinIO"><a href="#Handling-Parquet-Files-in-MinIO" class="headerlink" title="Handling Parquet Files in MinIO"></a>Handling Parquet Files in MinIO</h2><p><a name="reading-parquet-files-from-minio"></a></p>
<h3 id="Reading-Parquet-Files-from-MinIO"><a href="#Reading-Parquet-Files-from-MinIO" class="headerlink" title="Reading Parquet Files from MinIO"></a>Reading Parquet Files from MinIO</h3><p>To read Parquet files from MinIO, use the <code>spark-hadoop-cloud</code> library:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MinIOService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Dataset&lt;Row&gt; <span class="title function_">readParquetFromMinIO</span><span class="params">(String bucket, String path)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sparkSession.read()</span><br><span class="line">                .format(<span class="string">&quot;parquet&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;spark.hadoop.fs.s3a.endpoint&quot;</span>, <span class="string">&quot;http://localhost:9000&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;spark.hadoop.fs.s3a.access.key&quot;</span>, <span class="string">&quot;your-access-key&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;spark.hadoop.fs.s3a.secret.key&quot;</span>, <span class="string">&quot;your-secret-key&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;spark.hadoop.fs.s3a.path.style.access&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">                .load(<span class="string">&quot;s3a://&quot;</span> + bucket + <span class="string">&quot;/&quot;</span> + path);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="writing-parquet-files-to-minio"></a> </p>
<h3 id="Writing-Parquet-Files-to-MinIO"><a href="#Writing-Parquet-Files-to-MinIO" class="headerlink" title="Writing Parquet Files to MinIO"></a>Writing Parquet Files to MinIO</h3><p>To write Parquet files to MinIO, use the <code>spark-hadoop-cloud</code> library:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MinIOService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">writeParquetToMinIO</span><span class="params">(Dataset&lt;Row&gt; dataset, String bucket, String path)</span> &#123;</span><br><span class="line">        dataset.write()</span><br><span class="line">                .format(<span class="string">&quot;parquet&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;spark.hadoop.fs.s3a.endpoint&quot;</span>, <span class="string">&quot;http://localhost:9000&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;spark.hadoop.fs.s3a.access.key&quot;</span>, <span class="string">&quot;your-access-key&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;spark.hadoop.fs.s3a.secret.key&quot;</span>, <span class="string">&quot;your-secret-key&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;spark.hadoop.fs.s3a.path.style.access&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">                .save(<span class="string">&quot;s3a://&quot;</span> + bucket + <span class="string">&quot;/&quot;</span> + path);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="using-spark-dataframe-and-spark-sql"></a></p>
<h2 id="Using-Spark-DataFrame-and-Spark-SQL"><a href="#Using-Spark-DataFrame-and-Spark-SQL" class="headerlink" title="Using Spark DataFrame and Spark SQL"></a>Using Spark DataFrame and Spark SQL</h2><p><a name="creating-dataframes"></a></p>
<h3 id="Creating-DataFrames"><a href="#Creating-DataFrames" class="headerlink" title="Creating DataFrames"></a>Creating DataFrames</h3><p>To create DataFrames, use the <code>SparkSession</code> object:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataFrameService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Dataset&lt;Row&gt; <span class="title function_">createDataFrame</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sparkSession.read()</span><br><span class="line">                .format(<span class="string">&quot;csv&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;header&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">                .load(<span class="string">&quot;path/to/csv/file&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="querying-dataframes-with-spark-sql"></a></p>
<h3 id="Querying-DataFrames-with-Spark-SQL"><a href="#Querying-DataFrames-with-Spark-SQL" class="headerlink" title="Querying DataFrames with Spark SQL"></a>Querying DataFrames with Spark SQL</h3><p>To query DataFrames using Spark SQL, register the DataFrame as a temporary view:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataFrameService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Dataset&lt;Row&gt; <span class="title function_">queryDataFrame</span><span class="params">(Dataset&lt;Row&gt; df)</span> &#123;</span><br><span class="line">        df.createOrReplaceTempView(<span class="string">&quot;my_table&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> sparkSession.sql(<span class="string">&quot;SELECT * FROM my_table WHERE column = &#x27;value&#x27;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="unit-test-cases"></a></p>
<h2 id="Unit-Test-Cases"><a href="#Unit-Test-Cases" class="headerlink" title="Unit Test Cases"></a>Unit Test Cases</h2><h3 id="KafkaServiceTest-java"><a href="#KafkaServiceTest-java" class="headerlink" title="KafkaServiceTest.java"></a>KafkaServiceTest.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assertions.assertNotNull;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KafkaServiceTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> KafkaService kafkaService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testReadAvroFromKafka</span><span class="params">()</span> &#123;</span><br><span class="line">        Dataset&lt;Row&gt; dataset = kafkaService.readAvroFromKafka(<span class="string">&quot;test-topic&quot;</span>);</span><br><span class="line">        assertNotNull(dataset);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testWriteAvroToKafka</span><span class="params">()</span> &#123;</span><br><span class="line">        Dataset&lt;Row&gt; dataset = sparkSession.read().json(<span class="string">&quot;path/to/json/file&quot;</span>);</span><br><span class="line">        kafkaService.writeAvroToKafka(dataset, <span class="string">&quot;test-topic&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ElasticsearchServiceTest-java"><a href="#ElasticsearchServiceTest-java" class="headerlink" title="ElasticsearchServiceTest.java"></a>ElasticsearchServiceTest.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assertions.assertNotNull;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ElasticsearchServiceTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ElasticsearchService elasticsearchService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testReadFromElasticsearch</span><span class="params">()</span> &#123;</span><br><span class="line">        Dataset&lt;Row&gt; dataset = elasticsearchService.readFromElasticsearch(<span class="string">&quot;test-index&quot;</span>);</span><br><span class="line">        assertNotNull(dataset);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testWriteToElasticsearch</span><span class="params">()</span> &#123;</span><br><span class="line">        Dataset&lt;Row&gt; dataset = sparkSession.read().json(<span class="string">&quot;path/to/json/file&quot;</span>);</span><br><span class="line">        elasticsearchService.writeToElasticsearch(dataset, <span class="string">&quot;test-index&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="MinIOServiceTest-java"><a href="#MinIOServiceTest-java" class="headerlink" title="MinIOServiceTest.java"></a>MinIOServiceTest.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assertions.assertNotNull;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MinIOServiceTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MinIOService minIOService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testReadParquetFromMinIO</span><span class="params">()</span> &#123;</span><br><span class="line">        Dataset&lt;Row&gt; dataset = minIOService.readParquetFromMinIO(<span class="string">&quot;test-bucket&quot;</span>, <span class="string">&quot;test-path&quot;</span>);</span><br><span class="line">        assertNotNull(dataset);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testWriteParquetToMinIO</span><span class="params">()</span> &#123;</span><br><span class="line">        Dataset&lt;Row&gt; dataset = sparkSession.read().json(<span class="string">&quot;path/to/json/file&quot;</span>);</span><br><span class="line">        minIOService.writeParquetToMinIO(dataset, <span class="string">&quot;test-bucket&quot;</span>, <span class="string">&quot;test-path&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="DataFrameServiceTest-java"><a href="#DataFrameServiceTest-java" class="headerlink" title="DataFrameServiceTest.java"></a>DataFrameServiceTest.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assertions.assertNotNull;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataFrameServiceTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DataFrameService dataFrameService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testCreateDataFrame</span><span class="params">()</span> &#123;</span><br><span class="line">        Dataset&lt;Row&gt; dataset = dataFrameService.createDataFrame();</span><br><span class="line">        assertNotNull(dataset);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testQueryDataFrame</span><span class="params">()</span> &#123;</span><br><span class="line">        Dataset&lt;Row&gt; dataset = sparkSession.read().json(<span class="string">&quot;path/to/json/file&quot;</span>);</span><br><span class="line">        Dataset&lt;Row&gt; result = dataFrameService.queryDataFrame(dataset);</span><br><span class="line">        assertNotNull(result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="design-diagrams"></a></p>
<h2 id="Design-Diagrams"><a href="#Design-Diagrams" class="headerlink" title="Design Diagrams"></a>Design Diagrams</h2><p><a name="component-diagram"></a></p>
<h3 id="Component-Diagram"><a href="#Component-Diagram" class="headerlink" title="Component Diagram"></a>Component Diagram</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">|                   |       |                   |       |                   |</span><br><span class="line">|   Spring Boot     |       |   Apache Spark    |       |   Kafka           |</span><br><span class="line">|                   |       |                   |       |                   |</span><br><span class="line">+--------+----------+       +--------+----------+       +--------+----------+</span><br><span class="line">         |                           |                           |</span><br><span class="line">         |                           |                           |</span><br><span class="line">         v                           v                           v</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">|                   |       |                   |       |                   |</span><br><span class="line">|   KafkaService    |       |   Elasticsearch   |       |   MinIOService    |</span><br><span class="line">|                   |       |                   |       |                   |</span><br><span class="line">+--------+----------+       +--------+----------+       +--------+----------+</span><br><span class="line">         |                           |                           |</span><br><span class="line">         |                           |                           |</span><br><span class="line">         v                           v                           v</span><br><span class="line">+--------------------+       +-------------------+       +---------------------------------------+</span><br><span class="line">|                    |       |                   |       |                                       |</span><br><span class="line">|   DataFrameService |       |   SparkConfig     |       |   SparkSpringBootConsoleApplication   |</span><br><span class="line">|                    |       |                   |       |                                       |</span><br><span class="line">+--------------------+       +-------------------+       +---------------------------------------+</span><br></pre></td></tr></table></figure>

<p><a name="sequence-diagram"></a></p>
<h3 id="Sequence-Diagram"><a href="#Sequence-Diagram" class="headerlink" title="Sequence Diagram"></a>Sequence Diagram</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">+---------+       +---------+       +---------+       +---------+</span><br><span class="line">|         |       |         |       |         |       |         |</span><br><span class="line">| Client  |       | Spring  |       | Spark   |       | Kafka   |</span><br><span class="line">|         |       | Boot    |       |         |       |         |</span><br><span class="line">+---------+       +---------+       +---------+       +---------+</span><br><span class="line">    |                  |               |               |</span><br><span class="line">    |  Request         |               |               |</span><br><span class="line">    |-----------------&gt;|               |               |</span><br><span class="line">    |                  |               |               |</span><br><span class="line">    |                  |  Read Avro    |               |</span><br><span class="line">    |                  |  from Kafka   |               |</span><br><span class="line">    |                  |--------------&gt;|               |</span><br><span class="line">    |                  |               |               |</span><br><span class="line">    |                  |               |  Send Avro    |</span><br><span class="line">    |                  |               |&lt;-------------&gt;|</span><br><span class="line">    |                  |               |               |</span><br><span class="line">    |                  |  Process      |               |</span><br><span class="line">    |                  |  Data         |               |</span><br><span class="line">    |                  |--------------&gt;|               |</span><br><span class="line">    |                  |               |               |</span><br><span class="line">    |                  |  Write to     |               |</span><br><span class="line">    |                  |  Elasticsearch|               |</span><br><span class="line">    |                  |--------------&gt;|               |</span><br><span class="line">    |                  |               |               |</span><br><span class="line">    |                  |  Write to     |               |</span><br><span class="line">    |                  |  MinIO        |               |</span><br><span class="line">    |                  |--------------&gt;|               |</span><br><span class="line">    |                  |               |               |</span><br><span class="line">    |  Response        |               |               |</span><br><span class="line">    |&lt;-----------------|               |               |</span><br><span class="line">    |                  |               |               |</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="advanced-scenarios"></a></p>
<h2 id="Advanced-Scenarios"><a href="#Advanced-Scenarios" class="headerlink" title="Advanced Scenarios"></a>Advanced Scenarios</h2><p><a name="complex-scenario-1-flow-control-and-backpressure-handling"></a></p>
<h3 id="Complex-Scenario-1-Flow-Control-and-Backpressure-Handling"><a href="#Complex-Scenario-1-Flow-Control-and-Backpressure-Handling" class="headerlink" title="Complex Scenario 1: Flow Control and Backpressure Handling"></a>Complex Scenario 1: Flow Control and Backpressure Handling</h3><p>In scenarios where your application needs to handle flow control and backpressure, you can use Spark’s built-in mechanisms for handling large-scale data processing.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FlowControlService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleFlowControl</span><span class="params">(Dataset&lt;Row&gt; dataset)</span> &#123;</span><br><span class="line">        dataset.writeStream()</span><br><span class="line">                .format(<span class="string">&quot;console&quot;</span>)</span><br><span class="line">                .option(<span class="string">&quot;checkpointLocation&quot;</span>, <span class="string">&quot;path/to/checkpoint&quot;</span>)</span><br><span class="line">                .start()</span><br><span class="line">                .awaitTermination();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="complex-scenario-2-handling-large-scale-data-processing"></a></p>
<h3 id="Complex-Scenario-2-Handling-Large-Scale-Data-Processing"><a href="#Complex-Scenario-2-Handling-Large-Scale-Data-Processing" class="headerlink" title="Complex Scenario 2: Handling Large-Scale Data Processing"></a>Complex Scenario 2: Handling Large-Scale Data Processing</h3><p>For large-scale data processing, use Spark’s distributed processing capabilities and optimize resource usage.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Dataset;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.Row;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.SparkSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LargeScaleProcessingService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SparkSession sparkSession;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processLargeScaleData</span><span class="params">(Dataset&lt;Row&gt; dataset)</span> &#123;</span><br><span class="line">        dataset.repartition(<span class="number">100</span>)</span><br><span class="line">                .write()</span><br><span class="line">                .format(<span class="string">&quot;parquet&quot;</span>)</span><br><span class="line">                .save(<span class="string">&quot;path/to/output&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Developing a Spark application with Spring Boot 3.3.5 to communicate with Kafka and Elasticsearch involves setting up the Spring Boot application, integrating Spark, and handling data using Spark DataFrame and Spark SQL. By following the best practices outlined in this article, you can create efficient and scalable data processing applications.</p>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/">Spring Boot Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/">Apache Spark Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://kafka.apache.org/documentation/">Apache Kafka Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html">Elasticsearch Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.min.io/">MinIO Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.confluent.io/platform/current/schema-registry/index.html">Confluent Schema Registry Documentation</a></li>
</ol>
<p>By following these best practices, you can leverage Spark and Spring Boot to build powerful and scalable data processing applications.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/03/Best-Practices-of-Using-Docker-in-Application-Development/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/03/Best-Practices-of-Using-Docker-in-Application-Development/" class="post-title-link" itemprop="url">Best Practices of Using Docker in Application Development</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-03 14:42:30 / Modified: 14:44:12" itemprop="dateCreated datePublished" datetime="2024-11-03T14:42:30-05:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/" itemprop="url" rel="index"><span itemprop="name">Best Practices</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/Docker/" itemprop="url" rel="index"><span itemprop="name">Docker</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-docker-usage">Basic Docker Usage</a><ul>
<li><a href="#-running-containers"> Running Containers</a></li>
<li><a href="#-building-images"> Building Images</a></li>
</ul>
</li>
<li><a href="#advanced-docker-usage">Advanced Docker Usage</a><ul>
<li><a href="#-communicating-among-docker-containers"> Communicating Among Docker Containers</a><ul>
<li><a href="#example">Example</a></li>
</ul>
</li>
<li><a href="#-mounting-local-filesfolders"> Mounting Local Files&#x2F;Folders</a></li>
<li><a href="#-using-docker-networks"> Using Docker Networks</a><ul>
<li><a href="#example-1">Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#common-scenarios">Common Scenarios</a><ul>
<li><a href="#-spring-boot-application-with-postgresql"> Spring Boot Application with PostgreSQL</a></li>
</ul>
</li>
<li><a href="#best-practices">Best Practices</a><ul>
<li><a href="#-security"> Security</a></li>
<li><a href="#-resource-management"> Resource Management</a></li>
<li><a href="#-logging-and-monitoring"> Logging and Monitoring</a></li>
</ul>
</li>
<li><a href="#advanced-scenarios">Advanced Scenarios</a><ul>
<li><a href="#-complex-scenario-1-flow-control-and-backpressure-handling"> Complex Scenario 1: Flow Control and Backpressure Handling</a><ul>
<li><a href="#example-2">Example</a></li>
</ul>
</li>
<li><a href="#-complex-scenario-2-multi-container-applications-with-docker-compose"> Complex Scenario 2: Multi-Container Applications with Docker Compose</a><ul>
<li><a href="#example-docker-composeyml">Example <code>docker-compose.yml</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Docker is a powerful tool for application development, enabling developers to package applications and their dependencies into containers. This article provides a comprehensive guide to best practices for using Docker in application development, covering various scenarios such as communicating among containers, mounting local files&#x2F;folders, and managing multi-container applications.</p>
<hr>
<p><a name="basic-docker-usage"></a></p>
<h2 id="Basic-Docker-Usage"><a href="#Basic-Docker-Usage" class="headerlink" title="Basic Docker Usage"></a>Basic Docker Usage</h2><h3 id="Running-Containers"><a href="#Running-Containers" class="headerlink" title=" Running Containers"></a><a name="running-containers"></a> Running Containers</h3><p>To run a Docker container, use the <code>docker run</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name my-container my-image</span><br></pre></td></tr></table></figure>

<p>This command runs a container in detached mode (<code>-d</code>) with the name <code>my-container</code> using the image <code>my-image</code>.</p>
<h3 id="Building-Images"><a href="#Building-Images" class="headerlink" title=" Building Images"></a><a name="building-images"></a> Building Images</h3><p>To build a Docker image from a Dockerfile, use the <code>docker build</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t my-image .</span><br></pre></td></tr></table></figure>

<p>This command builds an image with the tag <code>my-image</code> using the Dockerfile in the current directory.</p>
<hr>
<p><a name="advanced-docker-usage"></a></p>
<h2 id="Advanced-Docker-Usage"><a href="#Advanced-Docker-Usage" class="headerlink" title="Advanced Docker Usage"></a>Advanced Docker Usage</h2><h3 id="Communicating-Among-Docker-Containers"><a href="#Communicating-Among-Docker-Containers" class="headerlink" title=" Communicating Among Docker Containers"></a><a name="communicating-among-docker-containers"></a> Communicating Among Docker Containers</h3><p>Containers can communicate with each other using Docker networks. By default, Docker creates a bridge network that allows containers to communicate with each other.</p>
<h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><p>To create a network and run two containers on the same network:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker network create my-network</span><br><span class="line">docker run -d --name container1 --network my-network my-image1</span><br><span class="line">docker run -d --name container2 --network my-network my-image2</span><br></pre></td></tr></table></figure>

<p>Containers <code>container1</code> and <code>container2</code> can now communicate with each other using their container names as hostnames.</p>
<h3 id="Mounting-Local-Files-Folders"><a href="#Mounting-Local-Files-Folders" class="headerlink" title=" Mounting Local Files&#x2F;Folders"></a><a name="mounting-local-filesfolders"></a> Mounting Local Files&#x2F;Folders</h3><p>To mount local files or folders into a Docker container, use the <code>-v</code> or <code>--volume</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name my-container -v /path/to/local/folder:/path/in/container my-image</span><br></pre></td></tr></table></figure>

<p>This command mounts the local folder <code>/path/to/local/folder</code> into the container at <code>/path/in/container</code>.</p>
<h3 id="Using-Docker-Networks"><a href="#Using-Docker-Networks" class="headerlink" title=" Using Docker Networks"></a><a name="using-docker-networks"></a> Using Docker Networks</h3><p>Docker networks allow containers to communicate with each other securely and efficiently. You can create custom networks and attach containers to them.</p>
<h4 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h4><p>To create a custom network and attach containers:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker network create my-network</span><br><span class="line">docker run -d --name container1 --network my-network my-image1</span><br><span class="line">docker run -d --name container2 --network my-network my-image2</span><br></pre></td></tr></table></figure>

<p>Containers <code>container1</code> and <code>container2</code> can now communicate with each other using their container names as hostnames.</p>
<hr>
<p><a name="common-scenarios"></a></p>
<h2 id="Common-Scenarios"><a href="#Common-Scenarios" class="headerlink" title="Common Scenarios"></a>Common Scenarios</h2><h3 id="Spring-Boot-Application-with-PostgreSQL"><a href="#Spring-Boot-Application-with-PostgreSQL" class="headerlink" title=" Spring Boot Application with PostgreSQL"></a><a name="spring-boot-application-with-postgresql"></a> Spring Boot Application with PostgreSQL</h3><p>To run a Spring Boot application that connects to a PostgreSQL database, follow these steps:</p>
<ol>
<li><p><strong>Create a Docker Network</strong>: Create a Docker network for the containers to communicate.</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker network create my-network</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Run PostgreSQL Container</strong>: Run a PostgreSQL container on the network.</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name postgres --network my-network -e POSTGRES_USER=user -e POSTGRES_PASSWORD=password -e POSTGRES_DB=mydb postgres:13</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Build Spring Boot Application Image</strong>: Build the Docker image for the Spring Boot application.</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t spring-boot-app .</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Run Spring Boot Application Container</strong>: Run the Spring Boot application container on the same network.</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name spring-boot-app --network my-network -e SPRING_DATASOURCE_URL=jdbc:postgresql://postgres:5432/mydb -e SPRING_DATASOURCE_USERNAME=user -e SPRING_DATASOURCE_PASSWORD=password spring-boot-app</span><br></pre></td></tr></table></figure></li>
</ol>
<p>In this setup, the Spring Boot application connects to the PostgreSQL database using the JDBC URL <code>jdbc:postgresql://postgres:5432/mydb</code>, where <code>postgres</code> is the hostname of the PostgreSQL container.</p>
<hr>
<p><a name="best-practices"></a></p>
<h2 id="Best-Practices"><a href="#Best-Practices" class="headerlink" title="Best Practices"></a>Best Practices</h2><h3 id="Security"><a href="#Security" class="headerlink" title=" Security"></a><a name="security"></a> Security</h3><ul>
<li><strong>Use Minimal Base Images</strong>: Use minimal base images that contain only the necessary components.</li>
<li><strong>Regularly Update Dependencies</strong>: Regularly update dependencies to ensure security patches are applied.</li>
<li><strong>Scan for Vulnerabilities</strong>: Use tools like <code>docker scan</code> to scan images for vulnerabilities.</li>
<li><strong>Avoid Storing Secrets</strong>: Avoid storing secrets in Dockerfiles. Use environment variables or secret management tools.</li>
</ul>
<h3 id="Resource-Management"><a href="#Resource-Management" class="headerlink" title=" Resource Management"></a><a name="resource-management"></a> Resource Management</h3><ul>
<li><strong>Limit Resource Usage</strong>: Use resource limits to prevent containers from consuming excessive resources.</li>
<li><strong>Use Ephemeral Containers</strong>: Use ephemeral containers that can be easily replaced or updated.</li>
</ul>
<h3 id="Logging-and-Monitoring"><a href="#Logging-and-Monitoring" class="headerlink" title=" Logging and Monitoring"></a><a name="logging-and-monitoring"></a> Logging and Monitoring</h3><ul>
<li><strong>Enable Logging</strong>: Enable logging for containers to track application behavior and diagnose issues.</li>
<li><strong>Monitor Container Performance</strong>: Monitor container performance and resource usage to ensure optimal operation.</li>
</ul>
<hr>
<p><a name="advanced-scenarios"></a></p>
<h2 id="Advanced-Scenarios"><a href="#Advanced-Scenarios" class="headerlink" title="Advanced Scenarios"></a>Advanced Scenarios</h2><h3 id="Complex-Scenario-1-Flow-Control-and-Backpressure-Handling"><a href="#Complex-Scenario-1-Flow-Control-and-Backpressure-Handling" class="headerlink" title=" Complex Scenario 1: Flow Control and Backpressure Handling"></a><a name="complex-scenario-1-flow-control-and-backpressure-handling"></a> Complex Scenario 1: Flow Control and Backpressure Handling</h3><p>In scenarios where your application needs to handle flow control and backpressure, you can use environment variables to configure the behavior.</p>
<h4 id="Example-2"><a href="#Example-2" class="headerlink" title="Example"></a>Example</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name my-app --network my-network -e MAX_CONNECTIONS=100 -e BACKPRESSURE_THRESHOLD=50 my-image</span><br></pre></td></tr></table></figure>

<h3 id="Complex-Scenario-2-Multi-Container-Applications-with-Docker-Compose"><a href="#Complex-Scenario-2-Multi-Container-Applications-with-Docker-Compose" class="headerlink" title=" Complex Scenario 2: Multi-Container Applications with Docker Compose"></a><a name="complex-scenario-2-multi-container-applications-with-docker-compose"></a> Complex Scenario 2: Multi-Container Applications with Docker Compose</h3><p>For complex applications with multiple containers, use Docker Compose to define and manage multi-container applications.</p>
<h4 id="Example-docker-compose-yml"><a href="#Example-docker-compose-yml" class="headerlink" title="Example docker-compose.yml"></a>Example <code>docker-compose.yml</code></h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">postgres:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">postgres:13</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">POSTGRES_USER:</span> <span class="string">user</span></span><br><span class="line">      <span class="attr">POSTGRES_PASSWORD:</span> <span class="string">password</span></span><br><span class="line">      <span class="attr">POSTGRES_DB:</span> <span class="string">mydb</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">my-network</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">spring-boot-app:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">spring-boot-app</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">SPRING_DATASOURCE_URL:</span> <span class="string">jdbc:postgresql://postgres:5432/mydb</span></span><br><span class="line">      <span class="attr">SPRING_DATASOURCE_USERNAME:</span> <span class="string">user</span></span><br><span class="line">      <span class="attr">SPRING_DATASOURCE_PASSWORD:</span> <span class="string">password</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">my-network</span></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">my-network:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br></pre></td></tr></table></figure>

<p>To start the application, run:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Using Docker in application development provides numerous benefits, including consistent environments, easy deployment, and efficient resource management. By following the best practices outlined in this article, you can create secure, efficient, and maintainable Docker-based applications.</p>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/">Docker Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/compose/">Docker Compose Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/engine/security/">Docker Security Best Practices</a></li>
<li><a target="_blank" rel="noopener" href="https://spring.io/guides/gs/spring-boot-docker/">Spring Boot with Docker</a></li>
<li><a target="_blank" rel="noopener" href="https://hub.docker.com/_/postgres">PostgreSQL Docker Image</a></li>
</ol>
<p>By following these best practices, you can leverage Docker to its full potential and efficiently manage your application development and deployment processes.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/03/Best-Practices-for-Writing-Dockerfiles/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/03/Best-Practices-for-Writing-Dockerfiles/" class="post-title-link" itemprop="url">Best Practices for Writing Dockerfiles</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-03 13:44:24 / Modified: 13:45:35" itemprop="dateCreated datePublished" datetime="2024-11-03T13:44:24-05:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/" itemprop="url" rel="index"><span itemprop="name">Best Practices</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/Docker/" itemprop="url" rel="index"><span itemprop="name">Docker</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-dockerfile-structure">Basic Dockerfile Structure</a></li>
<li><a href="#best-practices">Best Practices</a><ul>
<li><a href="#-use-official-base-images"> Use Official Base Images</a></li>
<li><a href="#-minimize-the-number-of-layers"> Minimize the Number of Layers</a></li>
<li><a href="#-leverage-multi-stage-builds"> Leverage Multi-Stage Builds</a></li>
<li><a href="#-use-dockerignore"> Use .dockerignore</a></li>
<li><a href="#-avoid-installing-unnecessary-packages"> Avoid Installing Unnecessary Packages</a></li>
<li><a href="#-set-the-working-directory"> Set the Working Directory</a></li>
<li><a href="#-use-environment-variables"> Use Environment Variables</a></li>
<li><a href="#-handle-permissions"> Handle Permissions</a></li>
<li><a href="#-control-image-size"> Control Image Size</a></li>
<li><a href="#-security-best-practices"> Security Best Practices</a></li>
<li><a href="#-use-proxy"> Use Proxy</a></li>
</ul>
</li>
<li><a href="#advanced-scenarios">Advanced Scenarios</a><ul>
<li><a href="#-complex-scenario-1-flow-control-and-backpressure-handling"> Complex Scenario 1: Flow Control and Backpressure Handling</a></li>
<li><a href="#-complex-scenario-2-multi-stage-builds-for-complex-applications"> Complex Scenario 2: Multi-Stage Builds for Complex Applications</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Dockerfiles are the blueprints for building Docker images. Writing efficient and secure Dockerfiles is crucial for creating lightweight, maintainable, and secure container images. This article provides a comprehensive guide to best practices for writing Dockerfiles, covering various scenarios such as minimizing image size, handling permissions, ensuring security, and using proxies.</p>
<hr>
<p><a name="basic-dockerfile-structure"></a></p>
<h2 id="Basic-Dockerfile-Structure"><a href="#Basic-Dockerfile-Structure" class="headerlink" title="Basic Dockerfile Structure"></a>Basic Dockerfile Structure</h2><p>A typical Dockerfile consists of the following structure:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Use an official base image</span></span><br><span class="line"><span class="keyword">FROM</span> &lt;base-image&gt;:&lt;tag&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the working directory</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy application files</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Install dependencies</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> &lt;<span class="built_in">command</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Expose ports</span></span><br><span class="line"><span class="keyword">EXPOSE</span> &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set environment variables</span></span><br><span class="line"><span class="keyword">ENV</span> &lt;key&gt;=&lt;value&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define the command to run the application</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;&lt;command&gt;&quot;</span>, <span class="string">&quot;&lt;arg1&gt;&quot;</span>, <span class="string">&quot;&lt;arg2&gt;&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="best-practices"></a></p>
<h2 id="Best-Practices"><a href="#Best-Practices" class="headerlink" title="Best Practices"></a>Best Practices</h2><h3 id="Use-Official-Base-Images"><a href="#Use-Official-Base-Images" class="headerlink" title=" Use Official Base Images"></a><a name="use-official-base-images"></a> Use Official Base Images</h3><p>Always use official base images from trusted sources. Official images are maintained by the Docker community and are regularly updated with security patches.</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.9</span>-slim</span><br></pre></td></tr></table></figure>

<h3 id="Minimize-the-Number-of-Layers"><a href="#Minimize-the-Number-of-Layers" class="headerlink" title=" Minimize the Number of Layers"></a><a name="minimize-the-number-of-layers"></a> Minimize the Number of Layers</h3><p>Each instruction in a Dockerfile creates a new layer. Minimize the number of layers by combining related commands into a single <code>RUN</code> instruction.</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get install -y \</span></span><br><span class="line"><span class="language-bash">    package1 \</span></span><br><span class="line"><span class="language-bash">    package2 \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">rm</span> -rf /var/lib/apt/lists/*</span></span><br></pre></td></tr></table></figure>

<h3 id="Leverage-Multi-Stage-Builds"><a href="#Leverage-Multi-Stage-Builds" class="headerlink" title=" Leverage Multi-Stage Builds"></a><a name="leverage-multi-stage-builds"></a> Leverage Multi-Stage Builds</h3><p>Use multi-stage builds to create smaller and more efficient images. This allows you to use a separate build environment for compiling and packaging your application.</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Stage 1: Build environment</span></span><br><span class="line"><span class="keyword">FROM</span> golang:<span class="number">1.16</span> AS build</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> go build -o myapp .</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Stage 2: Production environment</span></span><br><span class="line"><span class="keyword">FROM</span> alpine:<span class="number">3.14</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=build /app/myapp .</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;./myapp&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<h3 id="Use-dockerignore"><a href="#Use-dockerignore" class="headerlink" title=" Use .dockerignore"></a><a name="use-dockerignore"></a> Use .dockerignore</h3><p>Use a <code>.dockerignore</code> file to exclude unnecessary files and directories from being copied into the Docker image. This reduces the image size and improves build performance.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.git</span><br><span class="line">node_modules</span><br><span class="line">*.log</span><br></pre></td></tr></table></figure>

<h3 id="Avoid-Installing-Unnecessary-Packages"><a href="#Avoid-Installing-Unnecessary-Packages" class="headerlink" title=" Avoid Installing Unnecessary Packages"></a><a name="avoid-installing-unnecessary-packages"></a> Avoid Installing Unnecessary Packages</h3><p>Only install the necessary packages required to run your application. Avoid installing development tools and dependencies that are not needed in the final image.</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get install -y \</span></span><br><span class="line"><span class="language-bash">    curl \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">rm</span> -rf /var/lib/apt/lists/*</span></span><br></pre></td></tr></table></figure>

<h3 id="Set-the-Working-Directory"><a href="#Set-the-Working-Directory" class="headerlink" title=" Set the Working Directory"></a><a name="set-the-working-directory"></a> Set the Working Directory</h3><p>Set the working directory using the <code>WORKDIR</code> instruction to avoid ambiguity and improve readability.</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br></pre></td></tr></table></figure>

<h3 id="Use-Environment-Variables"><a href="#Use-Environment-Variables" class="headerlink" title=" Use Environment Variables"></a><a name="use-environment-variables"></a> Use Environment Variables</h3><p>Use environment variables to configure your application at runtime. This allows for easier configuration and flexibility.</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENV</span> PORT=<span class="number">8080</span></span><br><span class="line"><span class="keyword">EXPOSE</span> $PORT</span><br></pre></td></tr></table></figure>

<h3 id="Handle-Permissions"><a href="#Handle-Permissions" class="headerlink" title=" Handle Permissions"></a><a name="handle-permissions"></a> Handle Permissions</h3><p>Ensure that the application runs with the appropriate permissions. Avoid running the application as the root user.</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="language-bash"> useradd -ms /bin/bash appuser</span></span><br><span class="line"><span class="keyword">USER</span> appuser</span><br></pre></td></tr></table></figure>

<h3 id="Control-Image-Size"><a href="#Control-Image-Size" class="headerlink" title=" Control Image Size"></a><a name="control-image-size"></a> Control Image Size</h3><p>Minimize the image size by removing unnecessary files and using lightweight base images.</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> alpine:<span class="number">3.14</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apk add --no-cache &lt;package&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Security-Best-Practices"><a href="#Security-Best-Practices" class="headerlink" title=" Security Best Practices"></a><a name="security-best-practices"></a> Security Best Practices</h3><ul>
<li><strong>Use Minimal Base Images</strong>: Use minimal base images that contain only the necessary components.</li>
<li><strong>Regularly Update Dependencies</strong>: Regularly update dependencies to ensure security patches are applied.</li>
<li><strong>Scan for Vulnerabilities</strong>: Use tools like <code>docker scan</code> to scan images for vulnerabilities.</li>
<li><strong>Avoid Storing Secrets</strong>: Avoid storing secrets in Dockerfiles. Use environment variables or secret management tools.</li>
</ul>
<h3 id="Use-Proxy"><a href="#Use-Proxy" class="headerlink" title=" Use Proxy"></a><a name="use-proxy"></a> Use Proxy</h3><p>If your build environment requires a proxy, set the proxy settings in the Dockerfile.</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENV</span> http_proxy=http://proxy.example.com:<span class="number">8080</span></span><br><span class="line"><span class="keyword">ENV</span> https_proxy=http://proxy.example.com:<span class="number">8080</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="advanced-scenarios"></a></p>
<h2 id="Advanced-Scenarios"><a href="#Advanced-Scenarios" class="headerlink" title="Advanced Scenarios"></a>Advanced Scenarios</h2><h3 id="Complex-Scenario-1-Flow-Control-and-Backpressure-Handling"><a href="#Complex-Scenario-1-Flow-Control-and-Backpressure-Handling" class="headerlink" title=" Complex Scenario 1: Flow Control and Backpressure Handling"></a><a name="complex-scenario-1-flow-control-and-backpressure-handling"></a> Complex Scenario 1: Flow Control and Backpressure Handling</h3><p>In scenarios where your application needs to handle flow control and backpressure, you can use environment variables to configure the behavior.</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENV</span> MAX_CONNECTIONS=<span class="number">100</span></span><br><span class="line"><span class="keyword">ENV</span> BACKPRESSURE_THRESHOLD=<span class="number">50</span></span><br></pre></td></tr></table></figure>

<h3 id="Complex-Scenario-2-Multi-Stage-Builds-for-Complex-Applications"><a href="#Complex-Scenario-2-Multi-Stage-Builds-for-Complex-Applications" class="headerlink" title=" Complex Scenario 2: Multi-Stage Builds for Complex Applications"></a><a name="complex-scenario-2-multi-stage-builds-for-complex-applications"></a> Complex Scenario 2: Multi-Stage Builds for Complex Applications</h3><p>For complex applications, use multi-stage builds to separate build dependencies from runtime dependencies.</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Stage 1: Build environment</span></span><br><span class="line"><span class="keyword">FROM</span> maven:<span class="number">3.8</span>.<span class="number">3</span>-openjdk-<span class="number">17</span> AS build</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> pom.xml .</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> src ./src</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> mvn clean package</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Stage 2: Production environment</span></span><br><span class="line"><span class="keyword">FROM</span> openjdk:<span class="number">17</span>-slim</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=build /app/target/myapp.jar .</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;java&quot;</span>, <span class="string">&quot;-jar&quot;</span>, <span class="string">&quot;myapp.jar&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Writing efficient and secure Dockerfiles is essential for creating lightweight, maintainable, and secure container images. By following the best practices outlined in this article, you can minimize image size, handle permissions, ensure security, and use proxies effectively.</p>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Dockerfile Best Practices</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/develop/develop-images/multistage-build/">Multi-Stage Builds</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/engine/security/">Docker Security Best Practices</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/builder/">Dockerfile Reference</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/builder/#dockerignore-file">Docker .dockerignore File</a></li>
</ol>
<p>By following these best practices, you can create Docker images that are efficient, secure, and maintainable.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/03/Deep-Dive-into-Kubectl-port-forward/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/03/Deep-Dive-into-Kubectl-port-forward/" class="post-title-link" itemprop="url">Deep Dive into Kubectl port-forward</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-03 13:14:47 / Modified: 13:24:53" itemprop="dateCreated datePublished" datetime="2024-11-03T13:14:47-05:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/" itemprop="url" rel="index"><span itemprop="name">Deep Dive</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/Kubernetes/Kubectl/" itemprop="url" rel="index"><span itemprop="name">Kubectl</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#how-kubectl-port-forward-works">How <code>kubectl port-forward</code> Works</a><ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#steps">Steps</a></li>
<li><a href="#example">Example</a></li>
</ul>
</li>
<li><a href="#basic-usage">Basic Usage</a><ul>
<li><a href="#forwarding-a-single-port">Forwarding a Single Port</a></li>
<li><a href="#forwarding-a-single-port-to-a-service">Forwarding a Single Port to a Service</a></li>
</ul>
</li>
<li><a href="#advanced-usage">Advanced Usage</a><ul>
<li><a href="#-forwarding-multiple-ports"> Forwarding Multiple Ports</a></li>
<li><a href="#-forwarding-to-a-specific-pod"> Forwarding to a Specific Pod</a></li>
<li><a href="#-forwarding-to-a-service"> Forwarding to a Service</a></li>
</ul>
</li>
<li><a href="#common-scenarios">Common Scenarios</a><ul>
<li><a href="#-accessing-a-postgresql-database"> Accessing a PostgreSQL Database</a></li>
</ul>
</li>
<li><a href="#best-practices">Best Practices</a><ul>
<li><a href="#-security-considerations"> Security Considerations</a></li>
<li><a href="#-resource-management"> Resource Management</a></li>
<li><a href="#-monitoring-and-logging"> Monitoring and Logging</a></li>
</ul>
</li>
<li><a href="#lifecycle-of-kubectl-port-forward">Lifecycle of <code>kubectl port-forward</code></a><ul>
<li><a href="#running-as-a-process">Running as a Process</a></li>
<li><a href="#example-1">Example</a></li>
<li><a href="#termination">Termination</a></li>
</ul>
</li>
<li><a href="#temporary-nature-of-port-forwarding">Temporary Nature of Port Forwarding</a><ul>
<li><a href="#temporary-connection">Temporary Connection</a></li>
<li><a href="#impact-of-reboot">Impact of Reboot</a></li>
</ul>
</li>
<li><a href="#persisting-port-forwarding">Persisting Port Forwarding</a><ul>
<li><a href="#using-systemd-service">Using Systemd Service</a><ul>
<li><a href="#step-by-step-guide">Step-by-Step Guide</a></li>
</ul>
</li>
<li><a href="#using-cron-job">Using Cron Job</a><ul>
<li><a href="#step-by-step-guide-1">Step-by-Step Guide</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#security-considerations">Security Considerations</a><ul>
<li><a href="#limiting-access">Limiting Access</a></li>
<li><a href="#resource-management">Resource Management</a></li>
<li><a href="#monitoring-and-logging">Monitoring and Logging</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>The <code>kubectl port-forward</code> command is a powerful tool in Kubernetes that allows you to forward local ports to ports on a pod or service. This is particularly useful for accessing services running inside a Kubernetes cluster from your local machine, debugging applications, and accessing internal services without exposing them to the public internet. This article provides a deep dive into the <code>kubectl port-forward</code> command, covering various scenarios, best practices, and advanced usage, with a detailed example of accessing a PostgreSQL database deployed in a Kubernetes cluster.</p>
<hr>
<p><a name="how-kubectl-port-forward-works"></a></p>
<h2 id="How-kubectl-port-forward-Works"><a href="#How-kubectl-port-forward-Works" class="headerlink" title="How kubectl port-forward Works"></a>How <code>kubectl port-forward</code> Works</h2><h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>The <code>kubectl port-forward</code> command establishes a TCP connection between your local machine and a specific pod or service in the Kubernetes cluster. This connection is bidirectional, meaning that traffic sent to the local port is forwarded to the pod or service, and vice versa.</p>
<h3 id="Steps"><a href="#Steps" class="headerlink" title="Steps"></a>Steps</h3><ol>
<li><strong>Identify the Pod or Service</strong>: The command specifies the pod or service to which the port forwarding will be established.</li>
<li><strong>Establish a Connection</strong>: <code>kubectl</code> establishes a TCP connection to the specified pod or service in the Kubernetes cluster.</li>
<li><strong>Forward Traffic</strong>: <code>kubectl</code> listens on the specified local port and forwards incoming traffic to the corresponding port on the pod or service.</li>
</ol>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>To forward local port 5432 to a PostgreSQL pod running on port 5432:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward postgresql-0 5432:5432 -n database</span><br></pre></td></tr></table></figure>

<p>In this example:</p>
<ul>
<li><code>postgresql-0</code> is the name of the PostgreSQL pod.</li>
<li><code>5432:5432</code> specifies that local port 5432 will be forwarded to port 5432 on the pod.</li>
<li><code>-n database</code> specifies the namespace where the pod is located.</li>
</ul>
<hr>
<p><a name="basic-usage"></a></p>
<h2 id="Basic-Usage"><a href="#Basic-Usage" class="headerlink" title="Basic Usage"></a>Basic Usage</h2><h3 id="Forwarding-a-Single-Port"><a href="#Forwarding-a-Single-Port" class="headerlink" title="Forwarding a Single Port"></a>Forwarding a Single Port</h3><p>To forward a local port to a port on a pod, use the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward &lt;pod-name&gt; &lt;local-port&gt;:&lt;pod-port&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>For example, to forward local port 8080 to port 80 on a pod named <code>my-pod</code> in the <code>default</code> namespace:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward my-pod 8080:80</span><br></pre></td></tr></table></figure>

<h3 id="Forwarding-a-Single-Port-to-a-Service"><a href="#Forwarding-a-Single-Port-to-a-Service" class="headerlink" title="Forwarding a Single Port to a Service"></a>Forwarding a Single Port to a Service</h3><p>To forward a local port to a port on a service, use the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward service/&lt;service-name&gt; &lt;local-port&gt;:&lt;service-port&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>For example, to forward local port 8080 to port 80 on a service named <code>my-service</code> in the <code>default</code> namespace:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward service/my-service 8080:80</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="advanced-usage"></a></p>
<h2 id="Advanced-Usage"><a href="#Advanced-Usage" class="headerlink" title="Advanced Usage"></a>Advanced Usage</h2><h3 id="Forwarding-Multiple-Ports"><a href="#Forwarding-Multiple-Ports" class="headerlink" title=" Forwarding Multiple Ports"></a><a name="forwarding-multiple-ports"></a> Forwarding Multiple Ports</h3><p>To forward multiple ports, specify multiple <code>&lt;local-port&gt;:&lt;pod-port&gt;</code> pairs:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward &lt;pod-name&gt; &lt;local-port1&gt;:&lt;pod-port1&gt; &lt;local-port2&gt;:&lt;pod-port2&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>For example, to forward local ports 8080 and 9090 to ports 80 and 90 on a pod named <code>my-pod</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward my-pod 8080:80 9090:90</span><br></pre></td></tr></table></figure>

<h3 id="Forwarding-to-a-Specific-Pod"><a href="#Forwarding-to-a-Specific-Pod" class="headerlink" title=" Forwarding to a Specific Pod"></a><a name="forwarding-to-a-specific-pod"></a> Forwarding to a Specific Pod</h3><p>If you have multiple pods with the same label, you can forward to a specific pod by specifying the pod name:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward &lt;pod-name&gt; &lt;local-port&gt;:&lt;pod-port&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>For example, to forward local port 8080 to port 80 on a specific pod named <code>my-pod-1</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward my-pod-1 8080:80</span><br></pre></td></tr></table></figure>

<h3 id="Forwarding-to-a-Service"><a href="#Forwarding-to-a-Service" class="headerlink" title=" Forwarding to a Service"></a><a name="forwarding-to-a-service"></a> Forwarding to a Service</h3><p>To forward to a service, use the <code>service/</code> prefix:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward service/&lt;service-name&gt; &lt;local-port&gt;:&lt;service-port&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>For example, to forward local port 8080 to port 80 on a service named <code>my-service</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward service/my-service 8080:80</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="common-scenarios"></a></p>
<h2 id="Common-Scenarios"><a href="#Common-Scenarios" class="headerlink" title="Common Scenarios"></a>Common Scenarios</h2><h3 id="Accessing-a-PostgreSQL-Database"><a href="#Accessing-a-PostgreSQL-Database" class="headerlink" title=" Accessing a PostgreSQL Database"></a><a name="accessing-a-postgresql-database"></a> Accessing a PostgreSQL Database</h3><p>To access a PostgreSQL database running inside a Kubernetes cluster, follow these steps:</p>
<ol>
<li><p><strong>Identify the PostgreSQL Pod</strong>: First, identify the name of the PostgreSQL pod. You can list all pods in the namespace where PostgreSQL is deployed:</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p> For example, if the PostgreSQL pod is named <code>postgresql-0</code> in the <code>database</code> namespace:</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods -n database</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Port Forward to the PostgreSQL Pod</strong>: Forward the PostgreSQL port (default is 5432) to a local port:</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward &lt;pod-name&gt; &lt;local-port&gt;:5432 -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p> For example, to forward local port 5432 to the PostgreSQL pod:</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward postgresql-0 5432:5432 -n database</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Connect to the PostgreSQL Database</strong>: Use a PostgreSQL client to connect to the database using the local port. The JDBC URL to connect to the PostgreSQL database from your local machine would be:</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:postgresql://localhost:&lt;local-port&gt;/&lt;database-name&gt;</span><br></pre></td></tr></table></figure>

<p> For example, if the database name is <code>mydb</code>, the JDBC URL would be:</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:postgresql://localhost:5432/mydb</span><br></pre></td></tr></table></figure>

<p> You can also specify the username and password in the JDBC URL:</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:postgresql://localhost:5432/mydb?user=&lt;username&gt;&amp;password=&lt;password&gt;</span><br></pre></td></tr></table></figure>

<p> Alternatively, you can use a PostgreSQL client like <code>psql</code> to connect:</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psql -h localhost -p 5432 -U &lt;username&gt; -d &lt;database-name&gt;</span><br></pre></td></tr></table></figure>

<p> For example:</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psql -h localhost -p 5432 -U postgres -d mydb</span><br></pre></td></tr></table></figure>
</li>
<li><p>Underlying Mechanism</p>
</li>
</ol>
<p>The <code>kubectl port-forward</code> command sets up a proxy that listens on the specified local port (e.g., 5432) and forwards incoming traffic to the corresponding port on the PostgreSQL pod in the Kubernetes cluster. This proxy effectively creates a tunnel between your local machine and the Kubernetes cluster, allowing you to use <code>localhost</code> to connect to the database.</p>
<blockquote>
<p><strong>Example</strong></p>
</blockquote>
<p>When you run the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward postgresql-0 5432:5432 -n database</span><br></pre></td></tr></table></figure>

<p><code>kubectl</code> sets up a proxy that listens on <code>localhost:5432</code> and forwards incoming traffic to <code>postgresql-0:5432</code> in the <code>database</code> namespace.</p>
<hr>
<p><a name="best-practices"></a></p>
<h2 id="Best-Practices"><a href="#Best-Practices" class="headerlink" title="Best Practices"></a>Best Practices</h2><h3 id="Security-Considerations"><a href="#Security-Considerations" class="headerlink" title=" Security Considerations"></a><a name="security-considerations"></a> Security Considerations</h3><ul>
<li><strong>Limit Access</strong>: Only forward ports when necessary and limit access to the forwarded ports.</li>
<li><strong>Use Namespaces</strong>: Use namespaces to isolate resources and limit the scope of port forwarding.</li>
<li><strong>Monitor Access</strong>: Monitor access to forwarded ports and review logs for suspicious activity.</li>
</ul>
<h3 id="Resource-Management"><a href="#Resource-Management" class="headerlink" title=" Resource Management"></a><a name="resource-management"></a> Resource Management</h3><ul>
<li><strong>Avoid Overloading</strong>: Avoid forwarding too many ports simultaneously to prevent overloading the local machine.</li>
<li><strong>Use Ephemeral Ports</strong>: Use ephemeral ports (e.g., 49152-65535) for local forwarding to avoid conflicts with other services.</li>
</ul>
<h3 id="Monitoring-and-Logging"><a href="#Monitoring-and-Logging" class="headerlink" title=" Monitoring and Logging"></a><a name="monitoring-and-logging"></a> Monitoring and Logging</h3><ul>
<li><strong>Enable Logging</strong>: Enable logging for port forwarding to track access and diagnose issues.</li>
<li><strong>Monitor Performance</strong>: Monitor the performance of the local machine and the Kubernetes cluster to ensure port forwarding does not impact performance.</li>
</ul>
<hr>
<p><a name="lifecycle-of-kubectl-port-forward"></a></p>
<h2 id="Lifecycle-of-kubectl-port-forward"><a href="#Lifecycle-of-kubectl-port-forward" class="headerlink" title="Lifecycle of kubectl port-forward"></a>Lifecycle of <code>kubectl port-forward</code></h2><h3 id="Running-as-a-Process"><a href="#Running-as-a-Process" class="headerlink" title="Running as a Process"></a>Running as a Process</h3><p>When you run the <code>kubectl port-forward</code> command, <code>kubectl</code> starts a new process on your local machine. This process listens on the specified local port and forwards traffic to the corresponding port on the pod or service in the Kubernetes cluster.</p>
<h3 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h3><p>When you run the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward postgresql-0 5432:5432 -n database</span><br></pre></td></tr></table></figure>

<p><code>kubectl</code> starts a new process that listens on <code>localhost:5432</code> and forwards incoming traffic to <code>postgresql-0:5432</code> in the <code>database</code> namespace.</p>
<h3 id="Termination"><a href="#Termination" class="headerlink" title="Termination"></a>Termination</h3><p>The <code>kubectl port-forward</code> process runs until you manually terminate it. You can terminate the process by pressing <code>Ctrl+C</code> in the terminal where the command is running.</p>
<hr>
<p><a name="temporary-nature-of-port-forwarding"></a></p>
<h2 id="Temporary-Nature-of-Port-Forwarding"><a href="#Temporary-Nature-of-Port-Forwarding" class="headerlink" title="Temporary Nature of Port Forwarding"></a>Temporary Nature of Port Forwarding</h2><h3 id="Temporary-Connection"><a href="#Temporary-Connection" class="headerlink" title="Temporary Connection"></a>Temporary Connection</h3><p>The port forwarding established by <code>kubectl port-forward</code> is temporary. It only lasts as long as the <code>kubectl port-forward</code> process is running. Once you terminate the process (e.g., by pressing <code>Ctrl+C</code>), the port forwarding stops, and you can no longer access the pod or service via the forwarded port.</p>
<h3 id="Impact-of-Reboot"><a href="#Impact-of-Reboot" class="headerlink" title="Impact of Reboot"></a>Impact of Reboot</h3><p>If you reboot your local machine, the <code>kubectl port-forward</code> process will be terminated, and the port forwarding will be lost. You will need to rerun the <code>kubectl port-forward</code> command after rebooting to reestablish the connection.</p>
<hr>
<p><a name="persisting-port-forwarding"></a></p>
<h2 id="Persisting-Port-Forwarding"><a href="#Persisting-Port-Forwarding" class="headerlink" title="Persisting Port Forwarding"></a>Persisting Port Forwarding</h2><h3 id="Using-Systemd-Service"><a href="#Using-Systemd-Service" class="headerlink" title="Using Systemd Service"></a>Using Systemd Service</h3><p>To persist port forwarding across reboots, you can create a systemd service that runs the <code>kubectl port-forward</code> command on startup.</p>
<h4 id="Step-by-Step-Guide"><a href="#Step-by-Step-Guide" class="headerlink" title="Step-by-Step Guide"></a>Step-by-Step Guide</h4><ol>
<li><p><strong>Create a Script</strong>: Create a script that runs the <code>kubectl port-forward</code> command.</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">kubectl port-forward postgresql-0 5432:5432 -n database</span><br></pre></td></tr></table></figure>

<p> Save this script as <code>port-forward.sh</code> and make it executable:</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x port-forward.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Create a Systemd Service</strong>: Create a systemd service file to run the script on startup.</p>
 <figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=Kubernetes Port Forwarding for PostgreSQL</span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">ExecStart</span>=/path/to/port-forward.sh</span><br><span class="line"><span class="attr">Restart</span>=always</span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span></span><br><span class="line"><span class="attr">WantedBy</span>=multi-user.target</span><br></pre></td></tr></table></figure>

<p> Save this file as <code>/etc/systemd/system/kubectl-port-forward.service</code>.</p>
</li>
<li><p><strong>Enable and Start the Service</strong>: Enable and start the systemd service.</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl <span class="built_in">enable</span> kubectl-port-forward.service</span><br><span class="line"><span class="built_in">sudo</span> systemctl start kubectl-port-forward.service</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="Using-Cron-Job"><a href="#Using-Cron-Job" class="headerlink" title="Using Cron Job"></a>Using Cron Job</h3><p>Another approach is to use a cron job to run the <code>kubectl port-forward</code> command on startup.</p>
<h4 id="Step-by-Step-Guide-1"><a href="#Step-by-Step-Guide-1" class="headerlink" title="Step-by-Step Guide"></a>Step-by-Step Guide</h4><ol>
<li><p><strong>Create a Script</strong>: Create a script that runs the <code>kubectl port-forward</code> command.</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">kubectl port-forward postgresql-0 5432:5432 -n database</span><br></pre></td></tr></table></figure>

<p> Save this script as <code>port-forward.sh</code> and make it executable:</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x port-forward.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Create a Cron Job</strong>: Create a cron job to run the script on startup.</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@reboot /path/to/port-forward.sh</span><br></pre></td></tr></table></figure>

<p> Add this line to your crontab by running:</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<p><a name="security-considerations"></a></p>
<h2 id="Security-Considerations-1"><a href="#Security-Considerations-1" class="headerlink" title="Security Considerations"></a>Security Considerations</h2><h3 id="Limiting-Access"><a href="#Limiting-Access" class="headerlink" title="Limiting Access"></a>Limiting Access</h3><ul>
<li><strong>Only Forward Ports When Necessary</strong>: Only forward ports when necessary and limit access to the forwarded ports.</li>
<li><strong>Use Namespaces</strong>: Use namespaces to isolate resources and limit the scope of port forwarding.</li>
<li><strong>Monitor Access</strong>: Monitor access to forwarded ports and review logs for suspicious activity.</li>
</ul>
<h3 id="Resource-Management-1"><a href="#Resource-Management-1" class="headerlink" title="Resource Management"></a>Resource Management</h3><ul>
<li><strong>Avoid Overloading</strong>: Avoid forwarding too many ports simultaneously to prevent overloading the local machine.</li>
<li><strong>Use Ephemeral Ports</strong>: Use ephemeral ports (e.g., 49152-65535) for local forwarding to avoid conflicts with other services.</li>
</ul>
<h3 id="Monitoring-and-Logging-1"><a href="#Monitoring-and-Logging-1" class="headerlink" title="Monitoring and Logging"></a>Monitoring and Logging</h3><ul>
<li><strong>Enable Logging</strong>: Enable logging for port forwarding to track access and diagnose issues.</li>
<li><strong>Monitor Performance</strong>: Monitor the performance of the local machine and the Kubernetes cluster to ensure port forwarding does not impact performance.</li>
</ul>
<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>The <code>kubectl port-forward</code> command is a versatile and powerful tool for accessing services running inside a Kubernetes cluster from your local machine. By mastering the various options and scenarios covered in this article, you can effectively use <code>kubectl port-forward</code> for debugging applications, accessing databases, and accessing internal services. The detailed example of accessing a PostgreSQL database deployed in a Kubernetes cluster demonstrates how to use <code>kubectl port-forward</code> to connect to a database from your local machine.</p>
<p>The port forwarding established by <code>kubectl port-forward</code> is temporary and only lasts as long as the <code>kubectl port-forward</code> process is running. If you reboot your local machine, the port forwarding will be lost, and you will need to rerun the command to reestablish the connection.</p>
<p>To persist port forwarding across reboots, you can create a systemd service or a cron job to run the <code>kubectl port-forward</code> command on startup.</p>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#port-forward">kubectl port-forward Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/best-practices/">Kubernetes Best Practices</a></li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/security/">Kubernetes Security Best Practices</a></li>
<li><a target="_blank" rel="noopener" href="https://jdbc.postgresql.org/documentation/head/index.html">PostgreSQL JDBC Driver Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://www.freedesktop.org/software/systemd/man/systemd.service.html">Systemd Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man5/crontab.5.html">Cron Documentation</a></li>
</ol>
<p>By following these best practices, you can leverage <code>kubectl port-forward</code> to its full potential and efficiently manage your Kubernetes cluster access and debugging tasks.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/03/Best-Practices-of-kubectl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/03/Best-Practices-of-kubectl/" class="post-title-link" itemprop="url">Best Practices of kubectl</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-03 12:14:08 / Modified: 13:13:54" itemprop="dateCreated datePublished" datetime="2024-11-03T12:14:08-05:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/" itemprop="url" rel="index"><span itemprop="name">Best Practices</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/Kubernetes/Kubectl/" itemprop="url" rel="index"><span itemprop="name">Kubectl</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-cluster-information">Basic Cluster Information</a><ul>
<li><a href="#-get-cluster-info"> Get Cluster Info</a></li>
<li><a href="#-list-nodes"> List Nodes</a></li>
<li><a href="#-list-namespaces"> List Namespaces</a></li>
</ul>
</li>
<li><a href="#resource-monitoring">Resource Monitoring</a><ul>
<li><a href="#-list-pods"> List Pods</a></li>
<li><a href="#-list-deployments"> List Deployments</a></li>
<li><a href="#-list-services"> List Services</a></li>
<li><a href="#-list-configmaps"> List ConfigMaps</a></li>
<li><a href="#-list-secrets"> List Secrets</a></li>
</ul>
</li>
<li><a href="#advanced-resource-analysis">Advanced Resource Analysis</a><ul>
<li><a href="#-describe-resources"> Describe Resources</a></li>
<li><a href="#-logs"> Logs</a></li>
<li><a href="#-exec-into-pod"> Exec into Pod</a></li>
<li><a href="#-port-forwarding"> Port Forwarding</a></li>
</ul>
</li>
<li><a href="#troubleshooting">Troubleshooting</a><ul>
<li><a href="#-check-pod-status"> Check Pod Status</a></li>
<li><a href="#-check-node-status"> Check Node Status</a></li>
<li><a href="#-check-events"> Check Events</a></li>
<li><a href="#-check-resource-limits"> Check Resource Limits</a></li>
</ul>
</li>
<li><a href="#advanced-scenarios">Advanced Scenarios</a><ul>
<li><a href="#-scaling-deployments"> Scaling Deployments</a></li>
<li><a href="#-rolling-updates"> Rolling Updates</a></li>
<li><a href="#-debugging-with-kubectl"> Debugging with <code>kubectl</code></a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<hr>
<blockquote>
<p><strong>Best Practices of Using <code>kubectl</code> to Analyze Kubernetes Cluster Status</strong></p>
</blockquote>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Monitoring and analyzing the status of a Kubernetes (K8s) cluster is crucial for maintaining the health and efficiency of your applications. The <code>kubectl</code> command-line tool provides powerful capabilities for interacting with and analyzing your Kubernetes cluster. This article provides a comprehensive guide to the best practices of using <code>kubectl</code> to analyze cluster status, covering various scenarios such as checking cluster information, monitoring resources, troubleshooting issues, and performing advanced operations.</p>
<hr>
<p><a name="basic-cluster-information"></a></p>
<h2 id="Basic-Cluster-Information"><a href="#Basic-Cluster-Information" class="headerlink" title="Basic Cluster Information"></a>Basic Cluster Information</h2><h3 id="Get-Cluster-Info"><a href="#Get-Cluster-Info" class="headerlink" title=" Get Cluster Info"></a><a name="get-cluster-info"></a> Get Cluster Info</h3><p>To get basic information about the cluster, use the <code>kubectl cluster-info</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl cluster-info</span><br></pre></td></tr></table></figure>

<p>This command displays the Kubernetes master and DNS endpoints.</p>
<h3 id="List-Nodes"><a href="#List-Nodes" class="headerlink" title=" List Nodes"></a><a name="list-nodes"></a> List Nodes</h3><p>To list all nodes in the cluster, use the <code>kubectl get nodes</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get nodes</span><br></pre></td></tr></table></figure>

<p>This command displays the status, roles, age, and version of each node.</p>
<h3 id="List-Namespaces"><a href="#List-Namespaces" class="headerlink" title=" List Namespaces"></a><a name="list-namespaces"></a> List Namespaces</h3><p>To list all namespaces in the cluster, use the <code>kubectl get namespaces</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get namespaces</span><br></pre></td></tr></table></figure>

<p>This command displays the name and status of each namespace.</p>
<hr>
<p><a name="resource-monitoring"></a></p>
<h2 id="Resource-Monitoring"><a href="#Resource-Monitoring" class="headerlink" title="Resource Monitoring"></a>Resource Monitoring</h2><h3 id="List-Pods"><a href="#List-Pods" class="headerlink" title=" List Pods"></a><a name="list-pods"></a> List Pods</h3><p>To list all pods in a namespace, use the <code>kubectl get pods</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>This command displays the name, ready status, status, restarts, and age of each pod.</p>
<h3 id="List-Deployments"><a href="#List-Deployments" class="headerlink" title=" List Deployments"></a><a name="list-deployments"></a> List Deployments</h3><p>To list all deployments in a namespace, use the <code>kubectl get deployments</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get deployments -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>This command displays the name, desired replicas, current replicas, up-to-date replicas, and available replicas of each deployment.</p>
<h3 id="List-Services"><a href="#List-Services" class="headerlink" title=" List Services"></a><a name="list-services"></a> List Services</h3><p>To list all services in a namespace, use the <code>kubectl get services</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get services -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>This command displays the name, type, cluster IP, external IP, and ports of each service.</p>
<h3 id="List-ConfigMaps"><a href="#List-ConfigMaps" class="headerlink" title=" List ConfigMaps"></a><a name="list-configmaps"></a> List ConfigMaps</h3><p>To list all ConfigMaps in a namespace, use the <code>kubectl get configmaps</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get configmaps -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>This command displays the name and age of each ConfigMap.</p>
<h3 id="List-Secrets"><a href="#List-Secrets" class="headerlink" title=" List Secrets"></a><a name="list-secrets"></a> List Secrets</h3><p>To list all Secrets in a namespace, use the <code>kubectl get secrets</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get secrets -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>This command displays the name and age of each Secret.</p>
<hr>
<p><a name="advanced-resource-analysis"></a></p>
<h2 id="Advanced-Resource-Analysis"><a href="#Advanced-Resource-Analysis" class="headerlink" title="Advanced Resource Analysis"></a>Advanced Resource Analysis</h2><h3 id="Describe-Resources"><a href="#Describe-Resources" class="headerlink" title=" Describe Resources"></a><a name="describe-resources"></a> Describe Resources</h3><p>To get detailed information about a specific resource, use the <code>kubectl describe</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe &lt;resource&gt; &lt;name&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>For example, to describe a pod:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe pod &lt;pod-name&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>This command provides detailed information about the resource, including events and status.</p>
<h3 id="Logs"><a href="#Logs" class="headerlink" title=" Logs"></a><a name="logs"></a> Logs</h3><p>To view the logs of a pod, use the <code>kubectl logs</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl logs &lt;pod-name&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>To follow the logs in real-time, use the <code>-f</code> flag:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl logs -f &lt;pod-name&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Exec-into-Pod"><a href="#Exec-into-Pod" class="headerlink" title=" Exec into Pod"></a><a name="exec-into-pod"></a> Exec into Pod</h3><p>To execute a command inside a running pod, use the <code>kubectl exec</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl <span class="built_in">exec</span> -it &lt;pod-name&gt; -n &lt;namespace&gt; -- /bin/bash</span><br></pre></td></tr></table></figure>

<p>This command opens an interactive shell inside the pod.</p>
<h3 id="Port-Forwarding"><a href="#Port-Forwarding" class="headerlink" title=" Port Forwarding"></a><a name="port-forwarding"></a> Port Forwarding</h3><p>To forward a local port to a port on a pod, use the <code>kubectl port-forward</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward &lt;pod-name&gt; &lt;local-port&gt;:&lt;pod-port&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>This command allows you to access the pod’s service locally.</p>
<hr>
<p><a name="troubleshooting"></a></p>
<h2 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h2><h3 id="Check-Pod-Status"><a href="#Check-Pod-Status" class="headerlink" title=" Check Pod Status"></a><a name="check-pod-status"></a> Check Pod Status</h3><p>To check the status of a specific pod, use the <code>kubectl get pods</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods &lt;pod-name&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>This command displays the status and other details of the pod.</p>
<h3 id="Check-Node-Status"><a href="#Check-Node-Status" class="headerlink" title=" Check Node Status"></a><a name="check-node-status"></a> Check Node Status</h3><p>To check the status of a specific node, use the <code>kubectl get nodes</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get nodes &lt;node-name&gt;</span><br></pre></td></tr></table></figure>

<p>This command displays the status and other details of the node.</p>
<h3 id="Check-Events"><a href="#Check-Events" class="headerlink" title=" Check Events"></a><a name="check-events"></a> Check Events</h3><p>To check recent events in the cluster, use the <code>kubectl get events</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get events -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>This command displays recent events, which can help diagnose issues.</p>
<h3 id="Check-Resource-Limits"><a href="#Check-Resource-Limits" class="headerlink" title=" Check Resource Limits"></a><a name="check-resource-limits"></a> Check Resource Limits</h3><p>To check resource limits and requests for a pod, use the <code>kubectl describe</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe pod &lt;pod-name&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>This command provides detailed information about resource limits and requests.</p>
<hr>
<p><a name="advanced-scenarios"></a></p>
<h2 id="Advanced-Scenarios"><a href="#Advanced-Scenarios" class="headerlink" title="Advanced Scenarios"></a>Advanced Scenarios</h2><h3 id="Scaling-Deployments"><a href="#Scaling-Deployments" class="headerlink" title=" Scaling Deployments"></a><a name="scaling-deployments"></a> Scaling Deployments</h3><p>To scale a deployment, use the <code>kubectl scale</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl scale deployment &lt;deployment-name&gt; --replicas=&lt;number&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>This command scales the deployment to the specified number of replicas.</p>
<h3 id="Rolling-Updates"><a href="#Rolling-Updates" class="headerlink" title=" Rolling Updates"></a><a name="rolling-updates"></a> Rolling Updates</h3><p>To perform a rolling update on a deployment, use the <code>kubectl rollout</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl rollout restart deployment &lt;deployment-name&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>This command restarts the deployment, performing a rolling update.</p>
<h3 id="Debugging-with-kubectl"><a href="#Debugging-with-kubectl" class="headerlink" title=" Debugging with kubectl"></a><a name="debugging-with-kubectl"></a> Debugging with <code>kubectl</code></h3><p>To debug a pod, use the <code>kubectl debug</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl debug &lt;pod-name&gt; -n &lt;namespace&gt;</span><br></pre></td></tr></table></figure>

<p>This command creates a debugging container inside the pod.</p>
<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Monitoring and analyzing the status of a Kubernetes cluster is essential for maintaining the health and efficiency of your applications. By mastering the various options and scenarios covered in this article, you can effectively use <code>kubectl</code> to interact with and analyze your Kubernetes cluster.</p>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/reference/kubectl/cheatsheet/">kubectl Cheat Sheet</a></li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands">kubectl Command Reference</a></li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/">Kubernetes Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/best-practices/">Kubernetes Best Practices</a></li>
</ol>
<p>By following these best practices, you can leverage <code>kubectl</code> to its full potential and efficiently manage your Kubernetes cluster monitoring and troubleshooting tasks.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/03/Best-Practices-of-Linux-System-Performance-Analysis-and-Tuning-with-CLI/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/03/Best-Practices-of-Linux-System-Performance-Analysis-and-Tuning-with-CLI/" class="post-title-link" itemprop="url">Best Practices of Linux System Performance Analysis and Tuning with CLI</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-03 12:06:47 / Modified: 12:07:44" itemprop="dateCreated datePublished" datetime="2024-11-03T12:06:47-05:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/" itemprop="url" rel="index"><span itemprop="name">Best Practices</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/System/" itemprop="url" rel="index"><span itemprop="name">System</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/System/Performance/" itemprop="url" rel="index"><span itemprop="name">Performance</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/System/Performance/Troubleshooting/" itemprop="url" rel="index"><span itemprop="name">Troubleshooting</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/System/Performance/Troubleshooting/CLI/" itemprop="url" rel="index"><span itemprop="name">CLI</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-system-monitoring">Basic System Monitoring</a><ul>
<li><a href="#-check-cpu-usage"> Check CPU Usage</a></li>
<li><a href="#-check-memory-usage"> Check Memory Usage</a></li>
<li><a href="#-check-disk-io"> Check Disk I&#x2F;O</a></li>
<li><a href="#-check-network-traffic"> Check Network Traffic</a></li>
</ul>
</li>
<li><a href="#process-monitoring">Process Monitoring</a><ul>
<li><a href="#-list-running-processes"> List Running Processes</a></li>
<li><a href="#-check-process-status"> Check Process Status</a></li>
<li><a href="#-kill-a-process"> Kill a Process</a></li>
</ul>
</li>
<li><a href="#advanced-performance-tuning">Advanced Performance Tuning</a><ul>
<li><a href="#-top"> Top</a></li>
<li><a href="#-htop"> Htop</a></li>
<li><a href="#-iotop"> Iotop</a></li>
<li><a href="#-sar"> Sar</a></li>
</ul>
</li>
<li><a href="#troubleshooting-real-production-issues">Troubleshooting Real Production Issues</a><ul>
<li><a href="#-high-cpu-usage"> High CPU Usage</a></li>
<li><a href="#-high-memory-usage"> High Memory Usage</a></li>
<li><a href="#-high-disk-io"> High Disk I&#x2F;O</a></li>
<li><a href="#-network-latency"> Network Latency</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Monitoring and tuning Linux system performance is crucial for maintaining the health and efficiency of your infrastructure. Command line tools like <code>top</code>, <code>htop</code>, <code>iotop</code>, <code>sar</code>, <code>ps</code>, <code>free</code>, <code>vmstat</code>, and <code>netstat</code> provide powerful capabilities for analyzing and optimizing system performance. This article provides a comprehensive guide to the best practices of using these tools, covering various scenarios such as checking CPU and memory usage, monitoring processes, and troubleshooting real production issues.</p>
<hr>
<p><a name="basic-system-monitoring"></a></p>
<h2 id="Basic-System-Monitoring"><a href="#Basic-System-Monitoring" class="headerlink" title="Basic System Monitoring"></a>Basic System Monitoring</h2><h3 id="Check-CPU-Usage"><a href="#Check-CPU-Usage" class="headerlink" title=" Check CPU Usage"></a><a name="check-cpu-usage"></a> Check CPU Usage</h3><p>To check CPU usage, use the <code>top</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top</span><br></pre></td></tr></table></figure>

<p>This command displays real-time CPU and memory usage, along with a list of running processes.</p>
<h3 id="Check-Memory-Usage"><a href="#Check-Memory-Usage" class="headerlink" title=" Check Memory Usage"></a><a name="check-memory-usage"></a> Check Memory Usage</h3><p>To check memory usage, use the <code>free</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">free -h</span><br></pre></td></tr></table></figure>

<p>This command displays the total, used, and free memory in a human-readable format.</p>
<h3 id="Check-Disk-I-O"><a href="#Check-Disk-I-O" class="headerlink" title=" Check Disk I&#x2F;O"></a><a name="check-disk-io"></a> Check Disk I&#x2F;O</h3><p>To check disk I&#x2F;O, use the <code>iostat</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat -x 1</span><br></pre></td></tr></table></figure>

<p>This command displays detailed I&#x2F;O statistics, including read and write rates.</p>
<h3 id="Check-Network-Traffic"><a href="#Check-Network-Traffic" class="headerlink" title=" Check Network Traffic"></a><a name="check-network-traffic"></a> Check Network Traffic</h3><p>To check network traffic, use the <code>iftop</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iftop -i eth0</span><br></pre></td></tr></table></figure>

<p>This command displays real-time network traffic on the <code>eth0</code> interface.</p>
<hr>
<p><a name="process-monitoring"></a></p>
<h2 id="Process-Monitoring"><a href="#Process-Monitoring" class="headerlink" title="Process Monitoring"></a>Process Monitoring</h2><h3 id="List-Running-Processes"><a href="#List-Running-Processes" class="headerlink" title=" List Running Processes"></a><a name="list-running-processes"></a> List Running Processes</h3><p>To list all running processes, use the <code>ps</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux</span><br></pre></td></tr></table></figure>

<p>This command displays a detailed list of all running processes.</p>
<h3 id="Check-Process-Status"><a href="#Check-Process-Status" class="headerlink" title=" Check Process Status"></a><a name="check-process-status"></a> Check Process Status</h3><p>To check the status of a specific process, use the <code>ps</code> command with the process ID (PID):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -p &lt;PID&gt; -o pid,ppid,cmd,%cpu,%mem,state</span><br></pre></td></tr></table></figure>

<p>This command displays the status of the process with the specified PID.</p>
<h3 id="Kill-a-Process"><a href="#Kill-a-Process" class="headerlink" title=" Kill a Process"></a><a name="kill-a-process"></a> Kill a Process</h3><p>To kill a process, use the <code>kill</code> command with the process ID (PID):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> &lt;PID&gt;</span><br></pre></td></tr></table></figure>

<p>This command sends a termination signal to the process with the specified PID.</p>
<hr>
<p><a name="advanced-performance-tuning"></a></p>
<h2 id="Advanced-Performance-Tuning"><a href="#Advanced-Performance-Tuning" class="headerlink" title="Advanced Performance Tuning"></a>Advanced Performance Tuning</h2><h3 id="Top"><a href="#Top" class="headerlink" title=" Top"></a><a name="top"></a> Top</h3><p>To monitor system performance in real-time, use the <code>top</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top</span><br></pre></td></tr></table></figure>

<p>This command provides a dynamic view of system resources and running processes.</p>
<h3 id="Htop"><a href="#Htop" class="headerlink" title=" Htop"></a><a name="htop"></a> Htop</h3><p>To monitor system performance with a more user-friendly interface, use <code>htop</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">htop</span><br></pre></td></tr></table></figure>

<p>This command provides a colorful and interactive view of system resources and running processes.</p>
<h3 id="Iotop"><a href="#Iotop" class="headerlink" title=" Iotop"></a><a name="iotop"></a> Iotop</h3><p>To monitor disk I&#x2F;O in real-time, use the <code>iotop</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iotop</span><br></pre></td></tr></table></figure>

<p>This command displays real-time disk I&#x2F;O statistics for running processes.</p>
<h3 id="Sar"><a href="#Sar" class="headerlink" title=" Sar"></a><a name="sar"></a> Sar</h3><p>To collect and report system activity, use the <code>sar</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sar -u 1 5</span><br></pre></td></tr></table></figure>

<p>This command collects CPU usage statistics every second for 5 seconds.</p>
<hr>
<p><a name="troubleshooting-real-production-issues"></a></p>
<h2 id="Troubleshooting-Real-Production-Issues"><a href="#Troubleshooting-Real-Production-Issues" class="headerlink" title="Troubleshooting Real Production Issues"></a>Troubleshooting Real Production Issues</h2><h3 id="High-CPU-Usage"><a href="#High-CPU-Usage" class="headerlink" title=" High CPU Usage"></a><a name="high-cpu-usage"></a> High CPU Usage</h3><p>To identify processes causing high CPU usage, use <code>top</code> or <code>htop</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top</span><br></pre></td></tr></table></figure>

<p>Sort processes by CPU usage by pressing <code>P</code>.</p>
<h3 id="High-Memory-Usage"><a href="#High-Memory-Usage" class="headerlink" title=" High Memory Usage"></a><a name="high-memory-usage"></a> High Memory Usage</h3><p>To identify processes causing high memory usage, use <code>top</code> or <code>htop</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top</span><br></pre></td></tr></table></figure>

<p>Sort processes by memory usage by pressing <code>M</code>.</p>
<h3 id="High-Disk-I-O"><a href="#High-Disk-I-O" class="headerlink" title=" High Disk I&#x2F;O"></a><a name="high-disk-io"></a> High Disk I&#x2F;O</h3><p>To identify processes causing high disk I&#x2F;O, use <code>iotop</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iotop</span><br></pre></td></tr></table></figure>

<p>This command displays real-time disk I&#x2F;O statistics for running processes.</p>
<h3 id="Network-Latency"><a href="#Network-Latency" class="headerlink" title=" Network Latency"></a><a name="network-latency"></a> Network Latency</h3><p>To diagnose network latency, use <code>ping</code> and <code>traceroute</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ping google.com</span><br><span class="line">traceroute google.com</span><br></pre></td></tr></table></figure>

<p>These commands help identify network latency and routing issues.</p>
<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Monitoring and tuning Linux system performance is essential for maintaining the health and efficiency of your infrastructure. By mastering the various options and scenarios covered in this article, you can effectively use command line tools like <code>top</code>, <code>htop</code>, <code>iotop</code>, <code>sar</code>, <code>ps</code>, <code>free</code>, <code>vmstat</code>, and <code>netstat</code> to analyze and optimize system performance.</p>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/top.1.html">top Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://hisham.hm/htop/index.php?page=documentation">htop Man Page</a></li>
<li><a target="_blank" rel="noopener" href="http://www.ex-parrot.com/pdw/iftop/iftop-man.html">iotop Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/sar.1.html">sar Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/ps.1.html">ps Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/free.1.html">free Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man8/iostat.8.html">iostat Man Page</a></li>
<li><a target="_blank" rel="noopener" href="http://www.ex-parrot.com/pdw/iftop/iftop-man.html">iftop Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man8/ping.8.html">ping Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man8/traceroute.8.html">traceroute Man Page</a></li>
</ol>
<p>By following these best practices, you can leverage these system performance tools to their full potential and efficiently manage your monitoring and tuning tasks.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/03/Best-Practices-of-Using-Command-Line-Tools-for-Network-Analysis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/03/Best-Practices-of-Using-Command-Line-Tools-for-Network-Analysis/" class="post-title-link" itemprop="url">Best Practices of Using Command Line Tools for Network Analysis</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-03 12:02:12 / Modified: 12:02:44" itemprop="dateCreated datePublished" datetime="2024-11-03T12:02:12-05:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/" itemprop="url" rel="index"><span itemprop="name">Best Practices</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/Network/" itemprop="url" rel="index"><span itemprop="name">Network</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/Network/CLI/" itemprop="url" rel="index"><span itemprop="name">CLI</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-network-analysis">Basic Network Analysis</a><ul>
<li><a href="#-ping"> Ping</a></li>
<li><a href="#-traceroute"> Traceroute</a></li>
<li><a href="#-netstat"> Netstat</a></li>
<li><a href="#-netcat"> Netcat</a></li>
</ul>
</li>
<li><a href="#advanced-network-analysis">Advanced Network Analysis</a><ul>
<li><a href="#-tcpdump"> Tcpdump</a></li>
<li><a href="#-wireshark"> Wireshark</a></li>
<li><a href="#-nmap"> Nmap</a></li>
<li><a href="#-iftop"> Iftop</a></li>
</ul>
</li>
<li><a href="#combining-commands">Combining Commands</a><ul>
<li><a href="#-using-grep-with-tcpdump"> Using <code>grep</code> with <code>tcpdump</code></a></li>
<li><a href="#-using-awk-with-netstat"> Using <code>awk</code> with <code>netstat</code></a></li>
<li><a href="#-using-sed-with-nmap"> Using <code>sed</code> with <code>nmap</code></a></li>
</ul>
</li>
<li><a href="#advanced-scenarios">Advanced Scenarios</a><ul>
<li><a href="#-analyzing-http-traffic"> Analyzing HTTP Traffic</a></li>
<li><a href="#-monitoring-real-time-traffic"> Monitoring Real-Time Traffic</a></li>
<li><a href="#-diagnosing-network-issues"> Diagnosing Network Issues</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Network analysis is a critical skill for system administrators and network engineers. Command line tools like <code>ping</code>, <code>traceroute</code>, <code>netstat</code>, <code>tcpdump</code>, <code>nmap</code>, <code>iftop</code>, and <code>wireshark</code> provide powerful capabilities for monitoring, diagnosing, and troubleshooting network issues. This article provides a comprehensive guide to the best practices of using these tools, covering various scenarios such as capturing and filtering network traffic, displaying network statistics, and diagnosing network issues.</p>
<hr>
<p><a name="basic-network-analysis"></a></p>
<h2 id="Basic-Network-Analysis"><a href="#Basic-Network-Analysis" class="headerlink" title="Basic Network Analysis"></a>Basic Network Analysis</h2><h3 id="Ping"><a href="#Ping" class="headerlink" title=" Ping"></a><a name="ping"></a> Ping</h3><p>To check connectivity to a host, use the <code>ping</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping google.com</span><br></pre></td></tr></table></figure>

<p>This command sends ICMP echo requests to the specified host and displays the response time.</p>
<h3 id="Traceroute"><a href="#Traceroute" class="headerlink" title=" Traceroute"></a><a name="traceroute"></a> Traceroute</h3><p>To trace the route to a host, use the <code>traceroute</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">traceroute google.com</span><br></pre></td></tr></table></figure>

<p>This command shows the path packets take to reach the specified host.</p>
<h3 id="Netstat"><a href="#Netstat" class="headerlink" title=" Netstat"></a><a name="netstat"></a> Netstat</h3><p>To display network statistics and active connections, use the <code>netstat</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -a</span><br></pre></td></tr></table></figure>

<p>This command displays all active connections and listening ports.</p>
<h3 id="Netcat"><a href="#Netcat" class="headerlink" title=" Netcat"></a><a name="netcat"></a> Netcat</h3><p>To test network connections and transfer data, use the <code>nc</code> (netcat) command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -zv google.com 80</span><br></pre></td></tr></table></figure>

<p>This command checks if port 80 is open on <code>google.com</code>.</p>
<hr>
<p><a name="advanced-network-analysis"></a></p>
<h2 id="Advanced-Network-Analysis"><a href="#Advanced-Network-Analysis" class="headerlink" title="Advanced Network Analysis"></a>Advanced Network Analysis</h2><h3 id="Tcpdump"><a href="#Tcpdump" class="headerlink" title=" Tcpdump"></a><a name="tcpdump"></a> Tcpdump</h3><p>To capture and analyze network traffic, use the <code>tcpdump</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -i eth0</span><br></pre></td></tr></table></figure>

<p>This command captures all traffic on the <code>eth0</code> interface.</p>
<h3 id="Wireshark"><a href="#Wireshark" class="headerlink" title=" Wireshark"></a><a name="wireshark"></a> Wireshark</h3><p>To capture and analyze network traffic with a graphical interface, use <code>wireshark</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wireshark</span><br></pre></td></tr></table></figure>

<p>This tool provides advanced filtering and analysis capabilities.</p>
<h3 id="Nmap"><a href="#Nmap" class="headerlink" title=" Nmap"></a><a name="nmap"></a> Nmap</h3><p>To scan for open ports and services on a host, use the <code>nmap</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap 192.168.1.1</span><br></pre></td></tr></table></figure>

<p>This command scans the specified IP address for open ports and services.</p>
<h3 id="Iftop"><a href="#Iftop" class="headerlink" title=" Iftop"></a><a name="iftop"></a> Iftop</h3><p>To monitor network traffic in real-time, use the <code>iftop</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iftop -i eth0</span><br></pre></td></tr></table></figure>

<p>This command displays real-time network traffic on the <code>eth0</code> interface.</p>
<hr>
<p><a name="combining-commands"></a></p>
<h2 id="Combining-Commands"><a href="#Combining-Commands" class="headerlink" title="Combining Commands"></a>Combining Commands</h2><h3 id="Using-grep-with-tcpdump"><a href="#Using-grep-with-tcpdump" class="headerlink" title=" Using grep with tcpdump"></a><a name="using-grep-with-tcpdump"></a> Using <code>grep</code> with <code>tcpdump</code></h3><p>To filter <code>tcpdump</code> output, use <code>grep</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -i eth0 | grep <span class="string">&quot;HTTP&quot;</span></span><br></pre></td></tr></table></figure>

<p>This command filters <code>tcpdump</code> output to show only HTTP traffic.</p>
<h3 id="Using-awk-with-netstat"><a href="#Using-awk-with-netstat" class="headerlink" title=" Using awk with netstat"></a><a name="using-awk-with-netstat"></a> Using <code>awk</code> with <code>netstat</code></h3><p>To process <code>netstat</code> output, use <code>awk</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -an | awk <span class="string">&#x27;/:80 / &#123;print $5&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>This command extracts the IP addresses of connections on port 80.</p>
<h3 id="Using-sed-with-nmap"><a href="#Using-sed-with-nmap" class="headerlink" title=" Using sed with nmap"></a><a name="using-sed-with-nmap"></a> Using <code>sed</code> with <code>nmap</code></h3><p>To process <code>nmap</code> output, use <code>sed</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap 192.168.1.1 | sed -n <span class="string">&#x27;/open/p&#x27;</span></span><br></pre></td></tr></table></figure>

<p>This command filters <code>nmap</code> output to show only open ports.</p>
<hr>
<p><a name="advanced-scenarios"></a></p>
<h2 id="Advanced-Scenarios"><a href="#Advanced-Scenarios" class="headerlink" title="Advanced Scenarios"></a>Advanced Scenarios</h2><h3 id="Analyzing-HTTP-Traffic"><a href="#Analyzing-HTTP-Traffic" class="headerlink" title=" Analyzing HTTP Traffic"></a><a name="analyzing-http-traffic"></a> Analyzing HTTP Traffic</h3><p>To capture and analyze HTTP traffic, use <code>tcpdump</code> with port filtering:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -i eth0 port 80</span><br></pre></td></tr></table></figure>

<h3 id="Monitoring-Real-Time-Traffic"><a href="#Monitoring-Real-Time-Traffic" class="headerlink" title=" Monitoring Real-Time Traffic"></a><a name="monitoring-real-time-traffic"></a> Monitoring Real-Time Traffic</h3><p>To monitor real-time traffic on a specific interface, use <code>iftop</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iftop -i eth0</span><br></pre></td></tr></table></figure>

<h3 id="Diagnosing-Network-Issues"><a href="#Diagnosing-Network-Issues" class="headerlink" title=" Diagnosing Network Issues"></a><a name="diagnosing-network-issues"></a> Diagnosing Network Issues</h3><p>To diagnose network issues, use a combination of <code>ping</code>, <code>traceroute</code>, and <code>tcpdump</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ping google.com</span><br><span class="line">traceroute google.com</span><br><span class="line">tcpdump -i eth0 host google.com</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Network analysis is a critical skill for maintaining and troubleshooting network infrastructure. By mastering the various options and scenarios covered in this article, you can effectively use command line tools like <code>ping</code>, <code>traceroute</code>, <code>netstat</code>, <code>tcpdump</code>, <code>nmap</code>, <code>iftop</code>, and <code>wireshark</code> to monitor, diagnose, and troubleshoot network issues.</p>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man8/ping.8.html">ping Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man8/traceroute.8.html">traceroute Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man8/netstat.8.html">netstat Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/nc.1.html">nc (netcat) Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://www.tcpdump.org/manpages/tcpdump.1.html">tcpdump Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://www.wireshark.org/docs/">Wireshark Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://nmap.org/book/man.html">nmap Man Page</a></li>
<li><a target="_blank" rel="noopener" href="http://www.ex-parrot.com/pdw/iftop/iftop-man.html">iftop Man Page</a></li>
</ol>
<p>By following these best practices, you can leverage these network analysis tools to their full potential and efficiently manage your network monitoring and troubleshooting tasks.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Dazhi Zhang</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.1/mermaid.min.js","integrity":"sha256-YbM1pG3wWnzhyYN49g5fPnen+2CKEFaZfopkkwSpNtY="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  





</body>
</html>
