<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.whereq.com","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.21.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="WhereQ">
<meta property="og:url" content="https://www.whereq.com/page/14/index.html">
<meta property="og:site_name" content="WhereQ">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Dazhi Zhang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.whereq.com/page/14/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/14/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>WhereQ</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">WhereQ</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-articles"><a href="/articles/" rel="section"><i class="fa fa-file fa-fw"></i>Articles</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Dazhi Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">140</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">126</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">83</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/23/Deep-Dive-Spring-Boot-Retry-Mechanism-and-Implementation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/23/Deep-Dive-Spring-Boot-Retry-Mechanism-and-Implementation/" class="post-title-link" itemprop="url">Deep Dive Spring Boot Retry Mechanism and Implementation</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-23 20:52:55" itemprop="dateCreated datePublished" datetime="2024-10-23T20:52:55-04:00">2024-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/WebFlux/" itemprop="url" rel="index"><span itemprop="name">WebFlux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#spring-boot-retry-mechanism---detailed-guide-with-sample-code">Spring Boot Retry Mechanism - Detailed Guide with Sample Code</a><ul>
<li><a href="#1-introduction-to-spring-retry">1. Introduction to Spring Retry</a><ul>
<li><a href="#key-features">Key Features:</a></li>
</ul>
</li>
<li><a href="#2-how-retry-mechanism-works">2. How Retry Mechanism Works</a><ul>
<li><a href="#flow-of-retry-mechanism">Flow of Retry Mechanism:</a></li>
</ul>
</li>
<li><a href="#3-plain-retry-implementation-using-retrytemplate">3. Plain Retry Implementation using <code>RetryTemplate</code></a><ul>
<li><a href="#step-by-step-guide">Step-by-Step Guide:</a></li>
<li><a href="#key-points">Key Points:</a></li>
</ul>
</li>
<li><a href="#4-annotation-based-retry-implementation-using-retryable">4. Annotation-Based Retry Implementation using <code>@Retryable</code></a><ul>
<li><a href="#step-by-step-guide-1">Step-by-Step Guide:</a></li>
<li><a href="#key-points-1">Key Points:</a></li>
</ul>
</li>
<li><a href="#5-recovering-from-failure-using-recover">5. Recovering from Failure using <code>@Recover</code></a><ul>
<li><a href="#key-points-2">Key Points:</a></li>
<li><a href="#advanced-recovery">Advanced Recovery:</a></li>
</ul>
</li>
<li><a href="#6-flowchart-retry-mechanism">6. Flowchart: Retry Mechanism</a><ul>
<li><a href="#key-points-3">Key Points:</a></li>
</ul>
</li>
<li><a href="#7-multiple-recover-methods">7. Multiple Recover Methods</a><ul>
<li><a href="#example-multiple-recover-methods">Example: Multiple <code>@Recover</code> Methods</a></li>
<li><a href="#key-points-4">Key Points:</a></li>
<li><a href="#how-it-works">How It Works:</a></li>
<li><a href="#summary">Summary:</a></li>
</ul>
</li>
<li><a href="#8-conclusion">8. Conclusion</a><ul>
<li><a href="#key-takeaways">Key Takeaways:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h1 id="Spring-Boot-Retry-Mechanism-Detailed-Guide-with-Sample-Code"><a href="#Spring-Boot-Retry-Mechanism-Detailed-Guide-with-Sample-Code" class="headerlink" title="Spring Boot Retry Mechanism - Detailed Guide with Sample Code"></a>Spring Boot Retry Mechanism - Detailed Guide with Sample Code</h1><hr>
<h2 id="1-Introduction-to-Spring-Retry"><a href="#1-Introduction-to-Spring-Retry" class="headerlink" title="1. Introduction to Spring Retry"></a>1. Introduction to Spring Retry</h2><p><a name="1-introduction-to-spring-retry"></a></p>
<p>Spring Boot provides a robust retry mechanism through the <strong>Spring Retry</strong> module. This module allows developers to automatically retry operations that fail due to certain exceptions, making it highly useful for handling transient faults in distributed systems, such as network issues, service unavailability, and more.</p>
<p>Spring Retry can be implemented in two primary ways:</p>
<ul>
<li><strong>Programmatically</strong> using <code>RetryTemplate</code>.</li>
<li><strong>Declaratively</strong> using the <code>@Retryable</code> annotation.</li>
</ul>
<p>Additionally, Spring Retry supports recovery methods using the <code>@Recover</code> annotation, which can be invoked when all retry attempts are exhausted.</p>
<h3 id="Key-Features"><a href="#Key-Features" class="headerlink" title="Key Features:"></a>Key Features:</h3><ul>
<li><strong>Retry Policies</strong>: Define the number of retry attempts and conditions for retrying.</li>
<li><strong>Backoff Policies</strong>: Implement delays between retries, including fixed, exponential, and custom backoff strategies.</li>
<li><strong>Exception Handling</strong>: Retry based on specific exceptions or generic conditions.</li>
<li><strong>Recovery Mechanism</strong>: Gracefully handle failures using <code>@Recover</code> methods.</li>
</ul>
<hr>
<h2 id="2-How-Retry-Mechanism-Works"><a href="#2-How-Retry-Mechanism-Works" class="headerlink" title="2. How Retry Mechanism Works"></a>2. How Retry Mechanism Works</h2><p><a name="2-how-retry-mechanism-works"></a></p>
<p>The retry mechanism in Spring operates as follows:</p>
<ul>
<li>When a method annotated with <code>@Retryable</code> or executed via <code>RetryTemplate</code> encounters an exception, Spring can automatically retry that method a configurable number of times.</li>
<li>The retry logic can be customized based on specific exceptions or broader conditions.</li>
<li>Spring supports various backoff policies, such as fixed delays, exponential backoff, and custom backoff strategies, to manage the interval between retry attempts.</li>
<li>After exhausting the maximum retry attempts, a <code>@Recover</code> method can be invoked to handle the failure gracefully.</li>
</ul>
<h3 id="Flow-of-Retry-Mechanism"><a href="#Flow-of-Retry-Mechanism" class="headerlink" title="Flow of Retry Mechanism:"></a>Flow of Retry Mechanism:</h3><ol>
<li><strong>Method Invocation</strong>: The retryable method is invoked.</li>
<li><strong>Exception Occurs</strong>: If an exception occurs, Spring checks if the method is retryable.</li>
<li><strong>Retry Policy</strong>: The retry policy determines whether to retry the method.</li>
<li><strong>Backoff Policy</strong>: If retries are allowed, the backoff policy defines the delay before the next retry.</li>
<li><strong>Retry Execution</strong>: The method is retried according to the defined policy.</li>
<li><strong>Recovery</strong>: If all retries fail, the <code>@Recover</code> method is invoked.</li>
</ol>
<hr>
<h2 id="3-Plain-Retry-Implementation-using-RetryTemplate"><a href="#3-Plain-Retry-Implementation-using-RetryTemplate" class="headerlink" title="3. Plain Retry Implementation using RetryTemplate"></a>3. Plain Retry Implementation using <code>RetryTemplate</code></h2><p><a name="3-plain-retry-implementation-using-retrytemplate"></a></p>
<p>The <code>RetryTemplate</code> is used to implement the retry mechanism programmatically. This approach provides fine-grained control over the retry logic and is ideal for complex scenarios.</p>
<h3 id="Step-by-Step-Guide"><a href="#Step-by-Step-Guide" class="headerlink" title="Step-by-Step Guide:"></a>Step-by-Step Guide:</h3><ol>
<li><p><strong>Add Dependencies</strong> in <code>pom.xml</code> (if using Maven):</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.retry<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-retry<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Define <code>RetryTemplate</code> Bean</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RetryConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RetryTemplate <span class="title function_">retryTemplate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">RetryTemplate</span> <span class="variable">retryTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RetryTemplate</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Define retry policy (e.g., 3 attempts for any exception)</span></span><br><span class="line">        <span class="type">SimpleRetryPolicy</span> <span class="variable">retryPolicy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleRetryPolicy</span>();</span><br><span class="line">        retryPolicy.setMaxAttempts(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Define backoff policy (e.g., 2 seconds between retries)</span></span><br><span class="line">        <span class="type">FixedBackOffPolicy</span> <span class="variable">backOffPolicy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FixedBackOffPolicy</span>();</span><br><span class="line">        backOffPolicy.setBackOffPeriod(<span class="number">2000</span>); <span class="comment">// 2000 ms = 2 seconds</span></span><br><span class="line"></span><br><span class="line">        retryTemplate.setRetryPolicy(retryPolicy);</span><br><span class="line">        retryTemplate.setBackOffPolicy(backOffPolicy);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> retryTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Use <code>RetryTemplate</code> in Business Logic</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RetryTemplate retryTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">performTask</span><span class="params">()</span> &#123;</span><br><span class="line">        retryTemplate.execute(context -&gt; &#123;</span><br><span class="line">            <span class="comment">// Logic that might fail</span></span><br><span class="line">            System.out.println(<span class="string">&quot;Attempting task...&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(<span class="number">10</span>) &lt; <span class="number">8</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Failed task&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;Task succeeded&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Main Application</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RetryApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(RetryApplication.class, args);</span><br><span class="line">        <span class="type">MyService</span> <span class="variable">service</span> <span class="operator">=</span> context.getBean(MyService.class);</span><br><span class="line">        service.performTask();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="Key-Points"><a href="#Key-Points" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>RetryTemplate</strong>: Provides a flexible way to define retry policies and backoff strategies.</li>
<li><strong>SimpleRetryPolicy</strong>: Defines the maximum number of retry attempts.</li>
<li><strong>FixedBackOffPolicy</strong>: Sets a fixed delay between retry attempts.</li>
<li><strong>execute() Method</strong>: Executes the retry logic within a lambda expression.</li>
</ul>
<hr>
<h2 id="4-Annotation-Based-Retry-Implementation-using-Retryable"><a href="#4-Annotation-Based-Retry-Implementation-using-Retryable" class="headerlink" title="4. Annotation-Based Retry Implementation using @Retryable"></a>4. Annotation-Based Retry Implementation using <code>@Retryable</code></h2><p><a name="4-annotation-based-retry-implementation-using-retryable"></a></p>
<p>The annotation-based approach uses the <code>@Retryable</code> annotation to automatically retry methods without explicitly defining a <code>RetryTemplate</code>. This method is simpler and more concise, making it ideal for straightforward retry scenarios.</p>
<h3 id="Step-by-Step-Guide-1"><a href="#Step-by-Step-Guide-1" class="headerlink" title="Step-by-Step Guide:"></a>Step-by-Step Guide:</h3><ol>
<li><p><strong>Add Dependencies</strong> (same as in <code>RetryTemplate</code> approach).</p>
</li>
<li><p><strong>Enable Retry in Spring Boot Application</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableRetry</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RetryApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(RetryApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Use <code>@Retryable</code> Annotation</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Retryable(</span></span><br><span class="line"><span class="meta">        value = &#123; RuntimeException.class &#125;, // Retry on specific exceptions</span></span><br><span class="line"><span class="meta">        maxAttempts = 3,                     // Retry up to 3 times</span></span><br><span class="line"><span class="meta">        backoff = @Backoff(delay = 2000)     // 2 seconds delay between retries</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">performTask</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Attempting task...&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(<span class="number">10</span>) &lt; <span class="number">8</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Task failed&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;Task succeeded&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Recover from Failure using <code>@Recover</code></strong>:<br>You can define a recovery method that will be called when all retry attempts are exhausted.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Retryable(</span></span><br><span class="line"><span class="meta">        value = &#123; RuntimeException.class &#125;,</span></span><br><span class="line"><span class="meta">        maxAttempts = 3,</span></span><br><span class="line"><span class="meta">        backoff = @Backoff(delay = 2000)</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">performTask</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Attempting task...&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(<span class="number">10</span>) &lt; <span class="number">8</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Task failed&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;Task succeeded&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Recover</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">recover</span><span class="params">(RuntimeException e)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Recovering from failure: &quot;</span> + e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="Key-Points-1"><a href="#Key-Points-1" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>@Retryable</strong>: Specifies the method to be retried, along with the retry conditions and backoff policy.</li>
<li><strong>@Recover</strong>: Defines a fallback method to handle failures after all retries are exhausted.</li>
<li><strong>@EnableRetry</strong>: Enables the retry mechanism in the Spring Boot application.</li>
</ul>
<hr>
<h2 id="5-Recovering-from-Failure-using-Recover"><a href="#5-Recovering-from-Failure-using-Recover" class="headerlink" title="5. Recovering from Failure using @Recover"></a>5. Recovering from Failure using <code>@Recover</code></h2><p><a name="5-recovering-from-failure-using-recover"></a></p>
<p>The <code>@Recover</code> annotation is used to define a fallback method that will be called when all retry attempts fail. This method allows you to handle the failure gracefully and provide a fallback response.</p>
<h3 id="Key-Points-2"><a href="#Key-Points-2" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li>The method annotated with <code>@Recover</code> must have the same return type as the retryable method.</li>
<li>It must accept the exception type being handled as a parameter.</li>
</ul>
<p>Example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Recover</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">recoverFromFailure</span><span class="params">(RuntimeException e)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Recovery logic for exception: &quot;</span> + e.getMessage());</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Fallback result&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In the above example, when all retries fail, the <code>recoverFromFailure()</code> method will be called, and the fallback result will be returned.</p>
<h3 id="Advanced-Recovery"><a href="#Advanced-Recovery" class="headerlink" title="Advanced Recovery:"></a>Advanced Recovery:</h3><ul>
<li><strong>Multiple <code>@Recover</code> Methods</strong>: You can define multiple recovery methods for different exception types, allowing for more granular error handling.</li>
<li><strong>Parameter Matching</strong>: The recovery method’s parameters must match the retryable method’s parameters, except for the first parameter, which must be the exception type.</li>
</ul>
<hr>
<h2 id="6-Flowchart-Retry-Mechanism"><a href="#6-Flowchart-Retry-Mechanism" class="headerlink" title="6. Flowchart: Retry Mechanism"></a>6. Flowchart: Retry Mechanism</h2><p><a name="6-flowchart-retry-mechanism"></a></p>
<p>Below is a textual representation of the Spring Boot retry mechanism flowchart:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">+------------------------------------------+</span><br><span class="line">|      Start Application                   |</span><br><span class="line">+------------------------------------------+</span><br><span class="line">               |</span><br><span class="line">               V</span><br><span class="line">+------------------------------------------+</span><br><span class="line">|  Method Invoked (e.g., performTask)      |</span><br><span class="line">+------------------------------------------+</span><br><span class="line">               |</span><br><span class="line">               V</span><br><span class="line">+---------------------------------------------------+</span><br><span class="line">|  Is Retryable? (Check @Retryable or RT)           |</span><br><span class="line">+---------------------------------------------------+</span><br><span class="line">   Yes |                                     No |</span><br><span class="line">       V                                        V</span><br><span class="line">+-------------------------------------+  +-----------------------------+</span><br><span class="line">|  Try Method Execution               |  |  No retry, continue normal  |</span><br><span class="line">|                                     |  |  method execution           |</span><br><span class="line">+-------------------------------------+  +-----------------------------+</span><br><span class="line">               |</span><br><span class="line">               V</span><br><span class="line">+--------------------------------------------------+</span><br><span class="line">|  Method Execution Fails?                         |</span><br><span class="line">+--------------------------------------------------+</span><br><span class="line">   Yes |                                       No |</span><br><span class="line">       V                                          V</span><br><span class="line">+------------------------------------------+ +-----------------------------+</span><br><span class="line">|  Retry Policy Check (max attempts?)      | |  Method succeeds, continue  |</span><br><span class="line">+------------------------------------------+ +-----------------------------+</span><br><span class="line">   Yes |                                          No |</span><br><span class="line">       V                                             V</span><br><span class="line">+------------------------------------------+ +-----------------------------+</span><br><span class="line">|  Retry Backoff (delay before retry)      | |  Call @Recover method       |</span><br><span class="line">+------------------------------------------+ +-----------------------------+</span><br><span class="line">               |</span><br><span class="line">               V</span><br><span class="line">+------------------------------------------+</span><br><span class="line">|  Retry Method Execution                  |</span><br><span class="line">+------------------------------------------+</span><br><span class="line">               |</span><br><span class="line">               V</span><br><span class="line">+-------------------------------------------------------+</span><br><span class="line">|  Retry Limit Reached or Success?                      |</span><br><span class="line">+-------------------------------------------------------+</span><br><span class="line">  Retry Limit |                                 Success |</span><br><span class="line">              V                                         V</span><br><span class="line">+------------------------------------------+ +-----------------------------+</span><br><span class="line">|  Call @Recover method                    | |  Continue normal execution  |</span><br><span class="line">+------------------------------------------+ +-----------------------------+</span><br></pre></td></tr></table></figure>

<h3 id="Key-Points-3"><a href="#Key-Points-3" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Retryable Check</strong>: Determines if the method is eligible for retries.</li>
<li><strong>Retry Policy</strong>: Defines the number of retry attempts and conditions.</li>
<li><strong>Backoff Policy</strong>: Manages the delay between retry attempts.</li>
<li><strong>Recovery Method</strong>: Handles failures after all retries are exhausted.</li>
</ul>
<hr>
<h2 id="7-Multiple-Recover-Methods"><a href="#7-Multiple-Recover-Methods" class="headerlink" title="7. Multiple Recover Methods"></a>7. Multiple Recover Methods</h2><p><a name="7-multiple-recover-methods"></a></p>
<p>In Spring Retry, while it might seem like there is no explicit way to specify a “recover” method in the <code>@Retryable</code> annotation itself, you can still have multiple recover methods in the same class. Spring Retry allows you to define <strong>different recovery methods</strong> by relying on <strong>method signatures</strong>.</p>
<p>The framework will match the appropriate recovery method based on the <strong>parameters</strong> of the method, so each <code>@Recover</code> method corresponds to a specific exception type (or a list of exception types) that it’s designed to handle.</p>
<h3 id="Example-Multiple-Recover-Methods"><a href="#Example-Multiple-Recover-Methods" class="headerlink" title="Example: Multiple @Recover Methods"></a>Example: Multiple <code>@Recover</code> Methods</h3><p><a name="example-multiple-recover-methods"></a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApiService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ApiService</span><span class="params">(RestTemplateBuilder restTemplateBuilder)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.restTemplate = restTemplateBuilder.build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Retryable method for HTTP client errors</span></span><br><span class="line">    <span class="meta">@Retryable(</span></span><br><span class="line"><span class="meta">        value = &#123; HttpClientErrorException.class &#125;,</span></span><br><span class="line"><span class="meta">        maxAttempts = 4,</span></span><br><span class="line"><span class="meta">        backoff = @Backoff(delay = 1000)</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">invokeClientApi</span><span class="params">(String url)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(url, String.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Retryable method for HTTP server errors</span></span><br><span class="line">    <span class="meta">@Retryable(</span></span><br><span class="line"><span class="meta">        value = &#123; HttpServerErrorException.class &#125;,</span></span><br><span class="line"><span class="meta">        maxAttempts = 4,</span></span><br><span class="line"><span class="meta">        backoff = @Backoff(delay = 1000)</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">invokeServerApi</span><span class="params">(String url)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(url, String.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Recovery method for HTTP client errors</span></span><br><span class="line">    <span class="meta">@Recover</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">recoverClientError</span><span class="params">(HttpClientErrorException e, String url)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Client error fallback for URL: &quot;</span> + url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Recovery method for HTTP server errors</span></span><br><span class="line">    <span class="meta">@Recover</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">recoverServerError</span><span class="params">(HttpServerErrorException e, String url)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Server error fallback for URL: &quot;</span> + url;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Key-Points-4"><a href="#Key-Points-4" class="headerlink" title="Key Points:"></a>Key Points:</h3><p><a name="key-points-1"></a></p>
<ul>
<li><strong>Different <code>@Recover</code> methods</strong> are defined based on the exception type (e.g., <code>HttpClientErrorException</code> vs. <code>HttpServerErrorException</code>).</li>
<li>The recovery method’s <strong>first parameter</strong> is the exception type that triggered the retry failure. This is how Spring determines which recover method to invoke.</li>
<li><strong>Additional parameters</strong> (like <code>url</code> in the example) must match the parameters of the corresponding retryable method.</li>
</ul>
<h3 id="How-It-Works"><a href="#How-It-Works" class="headerlink" title="How It Works:"></a>How It Works:</h3><p><a name="how-it-works"></a></p>
<ol>
<li>If the retryable method (<code>invokeClientApi</code> or <code>invokeServerApi</code>) fails after exhausting the retry attempts, Spring will look for a recovery method based on the exception type.</li>
<li>The recovery method (<code>recoverClientError</code> or <code>recoverServerError</code>) will be called depending on whether a <code>HttpClientErrorException</code> or a <code>HttpServerErrorException</code> occurred.</li>
</ol>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary:"></a>Summary:</h3><p><a name="summary"></a><br>A class can have <strong>multiple <code>@Recover</code> methods</strong>. Spring matches the correct recovery method based on the exception type and method signature, so you can create recover methods for different types of exceptions in the same class.</p>
<hr>
<h2 id="8-Conclusion"><a href="#8-Conclusion" class="headerlink" title="8. Conclusion"></a>8. Conclusion</h2><p><a name="8-conclusion"></a></p>
<p>Spring Boot’s retry mechanism provides a simple and powerful way to retry failed operations, with both <strong>programmatic</strong> (<code>RetryTemplate</code>) and <strong>declarative</strong> (<code>@Retryable</code>) support. Additionally, recovery methods allow handling failure gracefully after retry attempts are exhausted.</p>
<p>Whether you choose to use <code>RetryTemplate</code> or <code>@Retryable</code>, both approaches are robust solutions for retrying failed methods in Spring applications.</p>
<h3 id="Key-Takeaways"><a href="#Key-Takeaways" class="headerlink" title="Key Takeaways:"></a>Key Takeaways:</h3><ul>
<li><strong>RetryTemplate</strong>: Offers fine-grained control over retry logic.</li>
<li><strong>@Retryable</strong>: Provides a simpler, declarative approach to retries.</li>
<li><strong>@Recover</strong>: Enables graceful handling of failures after retries are exhausted.</li>
<li><strong>Multiple Recover Methods</strong>: Allows for granular error handling based on exception types.</li>
</ul>
<p>By leveraging Spring Retry, developers can build resilient applications that can handle transient faults effectively, ensuring higher availability and reliability.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/23/How-to-Elegantly-Invoke-3rd-Party-APIs-in-Spring-Boot/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/23/How-to-Elegantly-Invoke-3rd-Party-APIs-in-Spring-Boot/" class="post-title-link" itemprop="url">How to Elegantly Invoke 3rd Party APIs in Spring Boot</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-23 20:20:44" itemprop="dateCreated datePublished" datetime="2024-10-23T20:20:44-04:00">2024-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/API/" itemprop="url" rel="index"><span itemprop="name">API</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#how-to-elegantly-invoke-3rd-party-apis-in-spring-boot-with-retries-and-circuit-breakers">How to Elegantly Invoke 3rd Party APIs in Spring Boot with Retries and Circuit Breakers</a><ul>
<li><a href="#1-basic-api-invocation-using-resttemplate">1. Basic API Invocation Using <code>RestTemplate</code></a></li>
<li><a href="#key-points">Key Points:</a></li>
<li><a href="#2-elegant-error-handling-with-resttemplate">2. Elegant Error Handling with <code>RestTemplate</code></a></li>
<li><a href="#key-points-1">Key Points:</a></li>
<li><a href="#3-retries-using-retrytemplate-with-annotations">3. Retries Using <code>RetryTemplate</code> with Annotations</a><ul>
<li><a href="#using-retryable-annotation">Using <code>@Retryable</code> Annotation</a></li>
<li><a href="#explanation">Explanation:</a></li>
</ul>
</li>
<li><a href="#key-points-2">Key Points:</a></li>
<li><a href="#4-circuit-breaker-with-resilience4j-and-annotations">4. Circuit Breaker with Resilience4j and Annotations</a><ul>
<li><a href="#dependency-setup">Dependency Setup</a></li>
<li><a href="#circuit-breaker-configuration">Circuit Breaker Configuration</a></li>
<li><a href="#using-resilience4j-annotations">Using Resilience4j Annotations</a></li>
<li><a href="#explanation-1">Explanation:</a></li>
</ul>
</li>
<li><a href="#key-points-3">Key Points:</a></li>
<li><a href="#5-sample-code-with-annotations">5. Sample Code with Annotations</a></li>
<li><a href="#key-points-4">Key Points:</a></li>
<li><a href="#diagrams">Diagrams</a></li>
<li><a href="#key-points-5">Key Points:</a></li>
<li><a href="#6-conclusion">6. Conclusion</a></li>
<li><a href="#key-takeaways">Key Takeaways:</a></li>
</ul>
</li>
</ul>
<hr>
<h1 id="How-to-Elegantly-Invoke-3rd-Party-APIs-in-Spring-Boot-with-Retries-and-Circuit-Breakers"><a href="#How-to-Elegantly-Invoke-3rd-Party-APIs-in-Spring-Boot-with-Retries-and-Circuit-Breakers" class="headerlink" title="How to Elegantly Invoke 3rd Party APIs in Spring Boot with Retries and Circuit Breakers"></a>How to Elegantly Invoke 3rd Party APIs in Spring Boot with Retries and Circuit Breakers</h1><hr>
<p>When integrating with third-party APIs, ensuring robust and fault-tolerant API invocations is crucial for a resilient microservices architecture. In this updated guide, we will expand on retry mechanisms and fallback strategies, introducing annotations for retries and fallbacks. We will also explore enhanced usage of Resilience4j for circuit breaking, along with retry policies via <code>RetryTemplate</code> and Spring’s <code>@Retryable</code> annotation.</p>
<hr>
<h3 id="1-Basic-API-Invocation-Using-RestTemplate"><a href="#1-Basic-API-Invocation-Using-RestTemplate" class="headerlink" title="1. Basic API Invocation Using RestTemplate"></a>1. Basic API Invocation Using <code>RestTemplate</code></h3><p><a name="1-basic-api-invocation-using-resttemplate"></a></p>
<p>We start with a simple HTTP client in Spring Boot, using <code>RestTemplate</code> to invoke a third-party API. Although basic, this approach lacks resilience for handling errors or failures in the third-party service.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApiService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ApiService</span><span class="params">(RestTemplateBuilder restTemplateBuilder)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.restTemplate = restTemplateBuilder.build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">invokeExternalApi</span><span class="params">(String url)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(url, String.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Key-Points"><a href="#Key-Points" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>RestTemplate</strong>: Basic HTTP client for API invocation.</li>
<li><strong>Lack of Resilience</strong>: No built-in error handling or retry mechanisms.</li>
</ul>
<hr>
<h3 id="2-Elegant-Error-Handling-with-RestTemplate"><a href="#2-Elegant-Error-Handling-with-RestTemplate" class="headerlink" title="2. Elegant Error Handling with RestTemplate"></a>2. Elegant Error Handling with <code>RestTemplate</code></h3><p><a name="2-elegant-error-handling-with-resttemplate"></a></p>
<p>Error handling can be enhanced by implementing custom error handling for different types of HTTP status codes using <code>ResponseErrorHandler</code>.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApiService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ApiService</span><span class="params">(RestTemplateBuilder restTemplateBuilder)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.restTemplate = restTemplateBuilder</span><br><span class="line">                            .errorHandler(<span class="keyword">new</span> <span class="title class_">CustomErrorHandler</span>())  <span class="comment">// custom error handler</span></span><br><span class="line">                            .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">invokeExternalApi</span><span class="params">(String url)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> restTemplate.getForObject(url, String.class);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (HttpClientErrorException ex) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Client error: &quot;</span> + ex.getStatusCode();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (HttpServerErrorException ex) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Server error: &quot;</span> + ex.getStatusCode();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomErrorHandler</span> <span class="keyword">implements</span> <span class="title class_">ResponseErrorHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasError</span><span class="params">(ClientHttpResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">return</span> response.getStatusCode().is4xxClientError() || response.getStatusCode().is5xxServerError();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleError</span><span class="params">(ClientHttpResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// Custom error handling</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Key-Points-1"><a href="#Key-Points-1" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Custom Error Handler</strong>: Implements <code>ResponseErrorHandler</code> for fine-grained error handling.</li>
<li><strong>Exception Handling</strong>: Catches specific HTTP exceptions for client and server errors.</li>
</ul>
<hr>
<h3 id="3-Retries-Using-RetryTemplate-with-Annotations"><a href="#3-Retries-Using-RetryTemplate-with-Annotations" class="headerlink" title="3. Retries Using RetryTemplate with Annotations"></a>3. Retries Using <code>RetryTemplate</code> with Annotations</h3><p><a name="3-retries-using-retrytemplate-with-annotations"></a></p>
<p>Spring Retry provides powerful retry mechanisms that can be applied using annotations for cleaner code. The <code>@Retryable</code> annotation helps trigger automatic retries when exceptions occur.</p>
<h4 id="Using-Retryable-Annotation"><a href="#Using-Retryable-Annotation" class="headerlink" title="Using @Retryable Annotation"></a>Using <code>@Retryable</code> Annotation</h4><p><a name="using-retryable-annotation"></a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApiService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ApiService</span><span class="params">(RestTemplateBuilder restTemplateBuilder)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.restTemplate = restTemplateBuilder.build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Retryable(</span></span><br><span class="line"><span class="meta">        value = &#123; HttpServerErrorException.class &#125;,</span></span><br><span class="line"><span class="meta">        maxAttempts = 5,</span></span><br><span class="line"><span class="meta">        backoff = @Backoff(delay = 2000)</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">invokeExternalApiWithRetry</span><span class="params">(String url)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(url, String.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Recover</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">recover</span><span class="params">(HttpServerErrorException e, String url)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Fallback response for: &quot;</span> + url;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Explanation"><a href="#Explanation" class="headerlink" title="Explanation:"></a>Explanation:</h4><p><a name="explanation"></a></p>
<ul>
<li><strong>@Retryable</strong>: Specifies retryable exceptions (e.g., <code>HttpServerErrorException</code>), with configurable maximum attempts and backoff strategy.</li>
<li><strong>@Recover</strong>: Defines a fallback method that triggers when retries are exhausted.</li>
</ul>
<h3 id="Key-Points-2"><a href="#Key-Points-2" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Retry Logic</strong>: Automatically retries failed API calls.</li>
<li><strong>Fallback Mechanism</strong>: Provides a fallback response when retries fail.</li>
</ul>
<hr>
<h3 id="4-Circuit-Breaker-with-Resilience4j-and-Annotations"><a href="#4-Circuit-Breaker-with-Resilience4j-and-Annotations" class="headerlink" title="4. Circuit Breaker with Resilience4j and Annotations"></a>4. Circuit Breaker with Resilience4j and Annotations</h3><p><a name="4-circuit-breaker-with-resilience4j-and-annotations"></a></p>
<p>Resilience4j is a lightweight, easy-to-use fault tolerance library designed for Java 8 and functional programming. It provides circuit breaking capabilities similar to Hystrix but with a more modern approach.</p>
<h4 id="Dependency-Setup"><a href="#Dependency-Setup" class="headerlink" title="Dependency Setup"></a>Dependency Setup</h4><p>First, add the necessary dependencies to your <code>pom.xml</code>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.resilience4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>resilience4j-spring-boot3<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="Circuit-Breaker-Configuration"><a href="#Circuit-Breaker-Configuration" class="headerlink" title="Circuit Breaker Configuration"></a>Circuit Breaker Configuration</h4><p>Configure the circuit breaker in your Spring Boot application:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Resilience4jConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CircuitBreakerConfig <span class="title function_">circuitBreakerConfig</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> CircuitBreakerConfig.custom()</span><br><span class="line">            .failureRateThreshold(<span class="number">50</span>)</span><br><span class="line">            .waitDurationInOpenState(Duration.ofMillis(<span class="number">1000</span>))</span><br><span class="line">            .ringBufferSizeInClosedState(<span class="number">2</span>)</span><br><span class="line">            .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CircuitBreakerRegistry <span class="title function_">circuitBreakerRegistry</span><span class="params">(CircuitBreakerConfig circuitBreakerConfig)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> CircuitBreakerRegistry.of(circuitBreakerConfig);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CircuitBreaker <span class="title function_">circuitBreaker</span><span class="params">(CircuitBreakerRegistry circuitBreakerRegistry)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> circuitBreakerRegistry.circuitBreaker(<span class="string">&quot;externalApi&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Using-Resilience4j-Annotations"><a href="#Using-Resilience4j-Annotations" class="headerlink" title="Using Resilience4j Annotations"></a>Using Resilience4j Annotations</h4><p>Apply the circuit breaker to your service method:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApiService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RestTemplate restTemplate;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> CircuitBreaker circuitBreaker;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ApiService</span><span class="params">(RestTemplateBuilder restTemplateBuilder, CircuitBreaker circuitBreaker)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.restTemplate = restTemplateBuilder.build();</span><br><span class="line">        <span class="built_in">this</span>.circuitBreaker = circuitBreaker;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@CircuitBreaker(name = &quot;externalApi&quot;, fallbackMethod = &quot;fallbackMethod&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">invokeApiWithCircuitBreaker</span><span class="params">(String url)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(url, String.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">fallbackMethod</span><span class="params">(String url, Throwable t)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Fallback response for: &quot;</span> + url;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Explanation-1"><a href="#Explanation-1" class="headerlink" title="Explanation:"></a>Explanation:</h4><p><a name="explanation-1"></a></p>
<ul>
<li><strong>CircuitBreaker</strong>: Configures the circuit breaker with custom settings.</li>
<li><strong>@CircuitBreaker</strong>: Annotates the method to be protected by the circuit breaker.</li>
<li><strong>Fallback Method</strong>: Provides a fallback response when the circuit breaker trips.</li>
</ul>
<h3 id="Key-Points-3"><a href="#Key-Points-3" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Resilience4j</strong>: Modern fault tolerance library replacing Hystrix.</li>
<li><strong>Circuit Breaker</strong>: Prevents cascading failures by short-circuiting failed API calls.</li>
<li><strong>Fallback Method</strong>: Provides a fallback response when the circuit breaker trips.</li>
</ul>
<hr>
<h3 id="5-Sample-Code-with-Annotations"><a href="#5-Sample-Code-with-Annotations" class="headerlink" title="5. Sample Code with Annotations"></a>5. Sample Code with Annotations</h3><p><a name="5-sample-code-with-annotations"></a></p>
<p>Combining both <code>@Retryable</code> and Resilience4j’s <code>@CircuitBreaker</code>, we create a highly resilient service capable of handling third-party API failures.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApiService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RestTemplate restTemplate;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> CircuitBreaker circuitBreaker;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ApiService</span><span class="params">(RestTemplateBuilder restTemplateBuilder, CircuitBreaker circuitBreaker)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.restTemplate = restTemplateBuilder.build();</span><br><span class="line">        <span class="built_in">this</span>.circuitBreaker = circuitBreaker;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Retryable(</span></span><br><span class="line"><span class="meta">        value = &#123; HttpServerErrorException.class &#125;,</span></span><br><span class="line"><span class="meta">        maxAttempts = 5,</span></span><br><span class="line"><span class="meta">        backoff = @Backoff(delay = 1000)</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="meta">@CircuitBreaker(name = &quot;externalApi&quot;, fallbackMethod = &quot;fallbackMethod&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">invokeApi</span><span class="params">(String url)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(url, String.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Recover</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">retryRecovery</span><span class="params">(HttpServerErrorException e, String url)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Retry failed for: &quot;</span> + url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">fallbackMethod</span><span class="params">(String url, Throwable t)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Circuit breaker fallback for: &quot;</span> + url;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Key-Points-4"><a href="#Key-Points-4" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Combined Resilience</strong>: Combines retries and circuit breaking for improved fault tolerance.</li>
<li><strong>Fallback Handling</strong>: Provides fallback responses for both retry failures and circuit breaker trips.</li>
</ul>
<hr>
<h3 id="Diagrams"><a href="#Diagrams" class="headerlink" title="Diagrams"></a>Diagrams</h3><p><a name="diagrams"></a></p>
<p>To visualize how retries and circuit breakers work together, the following diagram illustrates the flow:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+      +------------------+</span><br><span class="line">| API Call Attempt  |----&gt; | Retry Logic      |</span><br><span class="line">+-------------------+      +------------------+</span><br><span class="line">                              |</span><br><span class="line">            Retry Success&lt;----+----&gt;Retry Failure</span><br><span class="line">                              |</span><br><span class="line">                          Circuit Breaker</span><br><span class="line">                              |</span><br><span class="line">            Success&lt;-----------+------------&gt;Fallback</span><br></pre></td></tr></table></figure>

<h3 id="Key-Points-5"><a href="#Key-Points-5" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>API Call Attempt</strong>: Initial API invocation.</li>
<li><strong>Retry Logic</strong>: Retries the API call if it fails.</li>
<li><strong>Circuit Breaker</strong>: Evaluates whether to invoke the fallback method after retries fail.</li>
</ul>
<hr>
<h3 id="6-Conclusion"><a href="#6-Conclusion" class="headerlink" title="6. Conclusion"></a>6. Conclusion</h3><p><a name="6-conclusion"></a></p>
<p>In Spring Boot, integrating with third-party APIs elegantly involves applying retry mechanisms and circuit breaker patterns. Using <code>@Retryable</code> and Resilience4j annotations simplifies the code, making it more resilient to failures and easier to maintain. The combination of these two approaches ensures that your system can handle both intermittent and persistent issues with third-party APIs.</p>
<h3 id="Key-Takeaways"><a href="#Key-Takeaways" class="headerlink" title="Key Takeaways:"></a>Key Takeaways:</h3><ul>
<li><strong>Resilient API Invocations</strong>: Use retries and circuit breakers for fault tolerance.</li>
<li><strong>Annotation-Based Configuration</strong>: Simplifies implementation and maintenance.</li>
<li><strong>Fallback Strategies</strong>: Provide graceful degradation when API calls fail.</li>
</ul>
<p>By mastering these techniques, you can build robust and resilient microservices that gracefully handle third-party API failures.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/23/Kafka-Producer-Tuning-Guide/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/23/Kafka-Producer-Tuning-Guide/" class="post-title-link" itemprop="url">Kafka Producer Tuning Guide</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-23 16:01:38" itemprop="dateCreated datePublished" datetime="2024-10-23T16:01:38-04:00">2024-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Kafka/" itemprop="url" rel="index"><span itemprop="name">Kafka</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#kafka-producer-tuning-guide">Kafka Producer Tuning Guide</a><ul>
<li><a href="#1-introduction">1. Introduction</a></li>
<li><a href="#2-optimizing-producer-throughput">2. Optimizing Producer Throughput</a><ul>
<li><a href="#21-batching">2.1 Batching</a></li>
<li><a href="#22-compression">2.2 Compression</a></li>
<li><a href="#23-asynchronous-send">2.3 Asynchronous Send</a></li>
<li><a href="#24-producer-configuration-for-high-throughput">2.4 Producer Configuration for High Throughput</a></li>
</ul>
</li>
<li><a href="#3-ensuring-data-reliability">3. Ensuring Data Reliability</a><ul>
<li><a href="#31-acknowledgment-acks">3.1 Acknowledgment (acks)</a></li>
<li><a href="#32-retries-and-idempotence">3.2 Retries and Idempotence</a></li>
<li><a href="#33-durability-with-replication">3.3 Durability with Replication</a></li>
</ul>
</li>
<li><a href="#4-guaranteeing-exactly-once-semantics">4. Guaranteeing Exactly Once Semantics</a><ul>
<li><a href="#41-idempotent-producer">4.1 Idempotent Producer</a></li>
<li><a href="#42-transactions">4.2 Transactions</a></li>
</ul>
</li>
<li><a href="#5-maintaining-data-order">5. Maintaining Data Order</a><ul>
<li><a href="#51-partitioning">5.1 Partitioning</a></li>
<li><a href="#52-producer-configuration-for-ordering">5.2 Producer Configuration for Ordering</a></li>
</ul>
</li>
<li><a href="#6-conclusion">6. Conclusion</a></li>
<li><a href="#diagram-kafka-producer-configuration-for-throughput-and-reliability">Diagram: Kafka Producer Configuration for Throughput and Reliability</a></li>
<li><a href="#configuration-parameters">Configuration Parameters</a><ul>
<li><a href="#maxinflightrequestsperconnection"><code>max.in.flight.requests.per.connection</code></a><ul>
<li><a href="#how-it-works">How it Works:</a></li>
<li><a href="#default-value">Default Value:</a></li>
<li><a href="#impact-on-performance-and-ordering">Impact on Performance and Ordering:</a><ul>
<li><a href="#1-throughput">1. <strong>Throughput:</strong></a></li>
<li><a href="#2-message-ordering">2. <strong>Message Ordering:</strong></a></li>
<li><a href="#3-reliability">3. <strong>Reliability:</strong></a></li>
</ul>
</li>
<li><a href="#recommended-settings">Recommended Settings:</a></li>
<li><a href="#summary-of-key-points">Summary of Key Points:</a></li>
<li><a href="#diagram-effect-of-maxinflightrequestsperconnection-on-kafka-producer-behavior">Diagram: Effect of <code>max.in.flight.requests.per.connection</code> on Kafka Producer Behavior</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h1 id="Kafka-Producer-Tuning-Guide"><a href="#Kafka-Producer-Tuning-Guide" class="headerlink" title="Kafka Producer Tuning Guide"></a>Kafka Producer Tuning Guide</h1><hr>
<h3 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h3><p><a name="1-introduction"></a></p>
<p>Apache Kafka is a distributed streaming platform often used for building real-time data pipelines and streaming applications. Kafka producers are responsible for sending records to Kafka brokers, and tuning their performance is essential to achieving high throughput, reliability, and proper data ordering. In this article, we will cover the various aspects of Kafka producer tuning, including optimizing throughput, ensuring reliability, avoiding data duplication, and maintaining data order.</p>
<hr>
<h3 id="2-Optimizing-Producer-Throughput"><a href="#2-Optimizing-Producer-Throughput" class="headerlink" title="2. Optimizing Producer Throughput"></a>2. Optimizing Producer Throughput</h3><p><a name="2-optimizing-producer-throughput"></a></p>
<p>Throughput optimization focuses on increasing the number of messages the producer can send per second. Kafka producers offer multiple configuration options to improve throughput:</p>
<h4 id="2-1-Batching"><a href="#2-1-Batching" class="headerlink" title="2.1 Batching"></a>2.1 Batching</h4><p><a name="21-batching"></a></p>
<p>Kafka producers can batch multiple records before sending them to the broker, reducing the number of network requests.</p>
<ul>
<li><strong>Batch size (<code>batch.size</code>)</strong>: Determines the maximum number of bytes in a batch. Increasing this value allows the producer to group more records in one request, increasing throughput.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">props.put(<span class="string">&quot;batch.size&quot;</span>, <span class="number">16384</span>); <span class="comment">// 16KB per batch</span></span><br></pre></td></tr></table></figure>

<h4 id="2-2-Compression"><a href="#2-2-Compression" class="headerlink" title="2.2 Compression"></a>2.2 Compression</h4><p><a name="22-compression"></a></p>
<p>Enabling compression can reduce the size of data being sent, decreasing network traffic and increasing throughput.</p>
<ul>
<li><strong>Compression type (<code>compression.type</code>)</strong>: Supported types are <code>gzip</code>, <code>snappy</code>, <code>lz4</code>, and <code>zstd</code>.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">props.put(<span class="string">&quot;compression.type&quot;</span>, <span class="string">&quot;snappy&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="2-3-Asynchronous-Send"><a href="#2-3-Asynchronous-Send" class="headerlink" title="2.3 Asynchronous Send"></a>2.3 Asynchronous Send</h4><p><a name="23-asynchronous-send"></a></p>
<p>Producers can send data asynchronously to minimize the time spent waiting for broker acknowledgments.</p>
<ul>
<li><strong>Linger time (<code>linger.ms</code>)</strong>: The producer will wait for up to this time before sending a batch of messages, allowing more records to be added to the batch.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">props.put(<span class="string">&quot;linger.ms&quot;</span>, <span class="number">10</span>); <span class="comment">// Wait 10 ms before sending a batch</span></span><br></pre></td></tr></table></figure>

<h4 id="2-4-Producer-Configuration-for-High-Throughput"><a href="#2-4-Producer-Configuration-for-High-Throughput" class="headerlink" title="2.4 Producer Configuration for High Throughput"></a>2.4 Producer Configuration for High Throughput</h4><p><a name="24-producer-configuration-for-high-throughput"></a></p>
<p>Below is a configuration snippet optimized for throughput:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Properties</span> <span class="variable">props</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">props.put(<span class="string">&quot;bootstrap.servers&quot;</span>, <span class="string">&quot;localhost:9092&quot;</span>);</span><br><span class="line">props.put(<span class="string">&quot;acks&quot;</span>, <span class="string">&quot;1&quot;</span>); <span class="comment">// Leader acknowledgment for faster send</span></span><br><span class="line">props.put(<span class="string">&quot;compression.type&quot;</span>, <span class="string">&quot;lz4&quot;</span>);</span><br><span class="line">props.put(<span class="string">&quot;batch.size&quot;</span>, <span class="number">32768</span>); <span class="comment">// 32KB batch size</span></span><br><span class="line">props.put(<span class="string">&quot;linger.ms&quot;</span>, <span class="number">5</span>); <span class="comment">// Wait for 5ms before sending</span></span><br><span class="line">props.put(<span class="string">&quot;max.in.flight.requests.per.connection&quot;</span>, <span class="string">&quot;5&quot;</span>); <span class="comment">// Max concurrent requests</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-Ensuring-Data-Reliability"><a href="#3-Ensuring-Data-Reliability" class="headerlink" title="3. Ensuring Data Reliability"></a>3. Ensuring Data Reliability</h3><p><a name="3-ensuring-data-reliability"></a></p>
<p>Reliability involves ensuring that messages are delivered and persisted correctly by the Kafka broker. To achieve this, several configurations control how Kafka handles acknowledgment and retries.</p>
<h4 id="3-1-Acknowledgment-acks"><a href="#3-1-Acknowledgment-acks" class="headerlink" title="3.1 Acknowledgment (acks)"></a>3.1 Acknowledgment (acks)</h4><p><a name="31-acknowledgment-acks"></a></p>
<ul>
<li><strong><code>acks</code> configuration</strong>: Controls how many replicas must acknowledge the record. The safest setting is <code>acks=all</code>, ensuring the data is replicated to all in-sync replicas (ISR).</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">props.put(<span class="string">&quot;acks&quot;</span>, <span class="string">&quot;all&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="3-2-Retries-and-Idempotence"><a href="#3-2-Retries-and-Idempotence" class="headerlink" title="3.2 Retries and Idempotence"></a>3.2 Retries and Idempotence</h4><p><a name="32-retries-and-idempotence"></a></p>
<ul>
<li><strong><code>retries</code></strong>: Controls the number of retry attempts if a request fails.</li>
<li><strong><code>enable.idempotence</code></strong>: Ensures that retries don’t result in duplicated messages.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">props.put(<span class="string">&quot;retries&quot;</span>, <span class="number">3</span>); <span class="comment">// Retry 3 times on failure</span></span><br><span class="line">props.put(<span class="string">&quot;enable.idempotence&quot;</span>, <span class="string">&quot;true&quot;</span>); <span class="comment">// Avoid duplicate messages</span></span><br></pre></td></tr></table></figure>

<h4 id="3-3-Durability-with-Replication"><a href="#3-3-Durability-with-Replication" class="headerlink" title="3.3 Durability with Replication"></a>3.3 Durability with Replication</h4><p><a name="33-durability-with-replication"></a></p>
<p>Kafka ensures durability with data replication across multiple brokers. Setting the <strong><code>acks=all</code></strong> guarantees that the data is fully replicated before considering the record as successfully sent.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">props.put(<span class="string">&quot;acks&quot;</span>, <span class="string">&quot;all&quot;</span>); <span class="comment">// Wait for acknowledgment from all replicas</span></span><br><span class="line">props.put(<span class="string">&quot;min.insync.replicas&quot;</span>, <span class="number">2</span>); <span class="comment">// At least 2 replicas must acknowledge</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-Guaranteeing-Exactly-Once-Semantics"><a href="#4-Guaranteeing-Exactly-Once-Semantics" class="headerlink" title="4. Guaranteeing Exactly Once Semantics"></a>4. Guaranteeing Exactly Once Semantics</h3><p><a name="4-guaranteeing-exactly-once-semantics"></a></p>
<p>Kafka provides <strong>exactly-once semantics (EOS)</strong>, ensuring that data is neither lost nor duplicated. This is critical for financial systems and applications that cannot tolerate duplicates or lost data.</p>
<h4 id="4-1-Idempotent-Producer"><a href="#4-1-Idempotent-Producer" class="headerlink" title="4.1 Idempotent Producer"></a>4.1 Idempotent Producer</h4><p><a name="41-idempotent-producer"></a></p>
<p>An idempotent producer ensures that duplicate messages are not written to the Kafka log, even in case of retries. This is achieved by enabling the idempotence feature.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">props.put(<span class="string">&quot;enable.idempotence&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="4-2-Transactions"><a href="#4-2-Transactions" class="headerlink" title="4.2 Transactions"></a>4.2 Transactions</h4><p><a name="42-transactions"></a></p>
<p>Transactions allow multiple operations (e.g., sending messages to different partitions) to be treated as a single unit, ensuring that either all messages are written successfully or none are written.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Configuring a transactional producer</span></span><br><span class="line">props.put(<span class="string">&quot;transactional.id&quot;</span>, <span class="string">&quot;my-transaction-id&quot;</span>);</span><br><span class="line"></span><br><span class="line">KafkaProducer&lt;String, String&gt; producer = <span class="keyword">new</span> <span class="title class_">KafkaProducer</span>&lt;&gt;(props);</span><br><span class="line">producer.initTransactions();</span><br><span class="line">producer.beginTransaction();</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    producer.send(<span class="keyword">new</span> <span class="title class_">ProducerRecord</span>&lt;&gt;(<span class="string">&quot;topic1&quot;</span>, <span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>));</span><br><span class="line">    producer.send(<span class="keyword">new</span> <span class="title class_">ProducerRecord</span>&lt;&gt;(<span class="string">&quot;topic2&quot;</span>, <span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>));</span><br><span class="line">    producer.commitTransaction();</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    producer.abortTransaction();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="5-Maintaining-Data-Order"><a href="#5-Maintaining-Data-Order" class="headerlink" title="5. Maintaining Data Order"></a>5. Maintaining Data Order</h3><p><a name="5-maintaining-data-order"></a></p>
<p>By default, Kafka guarantees that records are written in the order they are sent, but only within a partition. You can control data ordering by correctly configuring partitioning strategies.</p>
<h4 id="5-1-Partitioning"><a href="#5-1-Partitioning" class="headerlink" title="5.1 Partitioning"></a>5.1 Partitioning</h4><p><a name="51-partitioning"></a></p>
<p>Kafka producers can partition records using a <strong>key</strong>. Messages with the same key will always go to the same partition, ensuring their order is maintained.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">producer.send(<span class="keyword">new</span> <span class="title class_">ProducerRecord</span>&lt;&gt;(<span class="string">&quot;topic&quot;</span>, <span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>));</span><br></pre></td></tr></table></figure>

<h4 id="5-2-Producer-Configuration-for-Ordering"><a href="#5-2-Producer-Configuration-for-Ordering" class="headerlink" title="5.2 Producer Configuration for Ordering"></a>5.2 Producer Configuration for Ordering</h4><p><a name="52-producer-configuration-for-ordering"></a></p>
<p>To maintain message order, especially during retries, the <strong><code>max.in.flight.requests.per.connection</code></strong> setting is crucial. Setting it to 1 ensures that only one request is sent to the broker at a time.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">props.put(<span class="string">&quot;max.in.flight.requests.per.connection&quot;</span>, <span class="number">1</span>); <span class="comment">// Guarantees ordering</span></span><br><span class="line">props.put(<span class="string">&quot;enable.idempotence&quot;</span>, <span class="string">&quot;true&quot;</span>); <span class="comment">// Ensures no duplicates</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="6-Conclusion"><a href="#6-Conclusion" class="headerlink" title="6. Conclusion"></a>6. Conclusion</h3><p><a name="6-conclusion"></a></p>
<p>Kafka producer tuning involves balancing between throughput, reliability, and data ordering based on the specific requirements of the application. By configuring batching, compression, retries, and idempotence, Kafka producers can achieve high performance while maintaining the necessary level of data reliability and ordering.</p>
<hr>
<h3 id="Diagram-Kafka-Producer-Configuration-for-Throughput-and-Reliability"><a href="#Diagram-Kafka-Producer-Configuration-for-Throughput-and-Reliability" class="headerlink" title="Diagram: Kafka Producer Configuration for Throughput and Reliability"></a>Diagram: Kafka Producer Configuration for Throughput and Reliability</h3><p><a name="diagram-kafka-producer-configuration-for-throughput-and-reliability"></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+----------------------+        +----------------------+        +---------------------+</span><br><span class="line">| Producer Properties  | -----&gt; | Batch, Compression,  | -----&gt; | High Throughput and |</span><br><span class="line">| Configuration        |        | Asynchronous Send    |        | Reliable Delivery   |</span><br><span class="line">+----------------------+        +----------------------+        +---------------------+</span><br><span class="line">                                  |</span><br><span class="line">                                  v</span><br><span class="line">+----------------------+        +---------------------+        +---------------------+</span><br><span class="line">| Idempotence,         | -----&gt; | Exactly-Once        | -----&gt; | Guaranteed Message  |</span><br><span class="line">| Transactions Enabled |        | Semantics           |        | Ordering and No Dups|</span><br><span class="line">+----------------------+        +---------------------+        +---------------------+</span><br></pre></td></tr></table></figure>

<h3 id="Configuration-Parameters"><a href="#Configuration-Parameters" class="headerlink" title="Configuration Parameters"></a>Configuration Parameters</h3><p><a name="configuration-parameters"></a></p>
<h4 id="max-in-flight-requests-per-connection"><a href="#max-in-flight-requests-per-connection" class="headerlink" title="max.in.flight.requests.per.connection"></a><code>max.in.flight.requests.per.connection</code></h4><p><a name="maxinflightrequestsperconnection"></a></p>
<p>The <code>max.in.flight.requests.per.connection</code> configuration in Kafka producers controls how many requests can be sent concurrently to the Kafka broker over a single connection. This setting plays a crucial role in determining how Kafka handles the trade-off between throughput, message ordering, and data reliability.</p>
<h5 id="How-it-Works"><a href="#How-it-Works" class="headerlink" title="How it Works:"></a>How it Works:</h5><p><a name="how-it-works"></a></p>
<ul>
<li>When a producer sends messages to Kafka, each message is sent in a request to the broker.</li>
<li>If the producer has multiple requests to send at the same time (due to batching or high message rates), these requests can either be sent sequentially or in parallel.</li>
<li>The <code>max.in.flight.requests.per.connection</code> setting defines how many such requests can be “in-flight” — meaning waiting for a response from the broker — at any given time.</li>
</ul>
<h5 id="Default-Value"><a href="#Default-Value" class="headerlink" title="Default Value:"></a>Default Value:</h5><p><a name="default-value"></a></p>
<ul>
<li>By default, this value is set to <code>5</code>. This allows the producer to send up to five requests at once before receiving responses for any of them.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">props.put(<span class="string">&quot;max.in.flight.requests.per.connection&quot;</span>, <span class="number">5</span>);</span><br></pre></td></tr></table></figure>

<h5 id="Impact-on-Performance-and-Ordering"><a href="#Impact-on-Performance-and-Ordering" class="headerlink" title="Impact on Performance and Ordering:"></a>Impact on Performance and Ordering:</h5><p><a name="impact-on-performance-and-ordering"></a></p>
<h6 id="1-Throughput"><a href="#1-Throughput" class="headerlink" title="1. Throughput:"></a>1. <strong>Throughput:</strong></h6><p><a name="1-throughput"></a></p>
<ul>
<li><p><strong>Higher Values</strong>: Setting <code>max.in.flight.requests.per.connection</code> to a higher number increases throughput, as the producer can send multiple requests simultaneously without waiting for each one to be acknowledged. This reduces the time spent waiting and maximizes network bandwidth usage.</p>
</li>
<li><p><strong>Lower Values</strong>: If you lower the value, for example, to <code>1</code>, the producer will wait for a response from the broker for each request before sending the next one. While this ensures ordering, it can limit throughput because the producer spends more time waiting for acknowledgments.</p>
</li>
</ul>
<h6 id="2-Message-Ordering"><a href="#2-Message-Ordering" class="headerlink" title="2. Message Ordering:"></a>2. <strong>Message Ordering:</strong></h6><p><a name="2-message-ordering"></a></p>
<ul>
<li><p><strong>Higher Values</strong>: When <code>max.in.flight.requests.per.connection</code> is greater than 1, messages can potentially be delivered out of order if a failure occurs. For example, if two requests (Request A and Request B) are sent in parallel, and Request A fails while Request B succeeds, Kafka may retry Request A, leading to message reordering.</p>
</li>
<li><p><strong>Lower Values</strong>: Setting this value to <code>1</code> ensures strict message ordering. This is because the producer waits for each request to be acknowledged before sending the next one, preventing any reordering even in the case of retries.</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">props.put(<span class="string">&quot;max.in.flight.requests.per.connection&quot;</span>, <span class="number">1</span>); <span class="comment">// Guarantees strict message order</span></span><br></pre></td></tr></table></figure>

<h6 id="3-Reliability"><a href="#3-Reliability" class="headerlink" title="3. Reliability:"></a>3. <strong>Reliability:</strong></h6><p><a name="3-reliability"></a></p>
<ul>
<li><p><strong>Higher Values</strong>: While more concurrent requests can improve throughput, they can lead to situations where retries (in case of failure) result in duplicate messages or out-of-order delivery.</p>
</li>
<li><p><strong>Lower Values</strong>: With a value of <code>1</code>, Kafka guarantees that even if a retry occurs (due to network failure, for example), messages will be delivered in the correct order. Coupled with <code>enable.idempotence=true</code>, this ensures that no duplicate messages are sent, and they arrive in the correct sequence.</p>
</li>
</ul>
<h5 id="Recommended-Settings"><a href="#Recommended-Settings" class="headerlink" title="Recommended Settings:"></a>Recommended Settings:</h5><p><a name="recommended-settings"></a></p>
<ul>
<li><p><strong>For High Throughput</strong>: </p>
<ul>
<li>Use higher values (such as <code>5</code> or more). This allows Kafka to send multiple messages simultaneously, maximizing throughput at the potential cost of strict ordering if failures occur.</li>
</ul>
</li>
<li><p><strong>For Exactly Once Semantics (EOS)</strong>:</p>
<ul>
<li>Use <code>1</code> in conjunction with <code>enable.idempotence=true</code> and <code>retries</code> to ensure no duplicates and guarantee strict message ordering.</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// High throughput with risk of out-of-order messages on failure</span></span><br><span class="line">props.put(<span class="string">&quot;max.in.flight.requests.per.connection&quot;</span>, <span class="number">5</span>);</span><br><span class="line">props.put(<span class="string">&quot;enable.idempotence&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Strict ordering and exactly-once delivery</span></span><br><span class="line">props.put(<span class="string">&quot;max.in.flight.requests.per.connection&quot;</span>, <span class="number">1</span>);</span><br><span class="line">props.put(<span class="string">&quot;enable.idempotence&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">props.put(<span class="string">&quot;acks&quot;</span>, <span class="string">&quot;all&quot;</span>);</span><br><span class="line">props.put(<span class="string">&quot;retries&quot;</span>, Integer.MAX_VALUE);</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="Summary-of-Key-Points"><a href="#Summary-of-Key-Points" class="headerlink" title="Summary of Key Points:"></a>Summary of Key Points:</h5><p><a name="summary-of-key-points"></a></p>
<ul>
<li><strong>Higher <code>max.in.flight.requests.per.connection</code></strong> increases throughput but may lead to message reordering on failure.</li>
<li><strong>Lower <code>max.in.flight.requests.per.connection</code></strong> ensures strict ordering but may decrease throughput as the producer waits for each acknowledgment.</li>
<li>For <strong>exactly-once semantics (EOS)</strong> and strict ordering, set it to <code>1</code> in conjunction with <code>enable.idempotence=true</code>.</li>
</ul>
<hr>
<h5 id="Diagram-Effect-of-max-in-flight-requests-per-connection-on-Kafka-Producer-Behavior"><a href="#Diagram-Effect-of-max-in-flight-requests-per-connection-on-Kafka-Producer-Behavior" class="headerlink" title="Diagram: Effect of max.in.flight.requests.per.connection on Kafka Producer Behavior"></a>Diagram: Effect of <code>max.in.flight.requests.per.connection</code> on Kafka Producer Behavior</h5><p><a name="diagram-effect-of-maxinflightrequestsperconnection-on-kafka-producer-behavior"></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+------------------------+          +----------------------+          +-----------------------+</span><br><span class="line">| max.in.flight = 5      | ------&gt;  | Higher Throughput    |  -----&gt;  | Possible Reordering   |</span><br><span class="line">| Multiple concurrent    |          | Faster message send  |          | Retries can cause out-|</span><br><span class="line">| requests allowed       |          | with reduced latency |          | of-order delivery     |</span><br><span class="line">+------------------------+          +----------------------+          +-----------------------+</span><br><span class="line"></span><br><span class="line">+------------------------+          +----------------------+          +-----------------------+</span><br><span class="line">| max.in.flight = 1      | ------&gt;  | Strict Ordering      |  -----&gt;  | Lower Throughput      |</span><br><span class="line">| One request at a time  |          | Each message waits   |          | Wait time for each    |</span><br><span class="line">| Strict sequence        |          | for ack before next  |          | acknowledgment        |</span><br><span class="line">+------------------------+          +----------------------+          +-----------------------+</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/23/Kafka-Transaction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/23/Kafka-Transaction/" class="post-title-link" itemprop="url">Kafka Transaction</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-23 14:06:39" itemprop="dateCreated datePublished" datetime="2024-10-23T14:06:39-04:00">2024-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Kafka/" itemprop="url" rel="index"><span itemprop="name">Kafka</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#kafka-transaction-workflow">Kafka Transaction Workflow</a><ul>
<li><a href="#1-introduction">1. Introduction</a></li>
<li><a href="#2-idempotence-in-kafka">2. Idempotence in Kafka</a><ul>
<li><a href="#21-how-idempotence-works">2.1 How Idempotence Works</a></li>
</ul>
</li>
<li><a href="#3-kafka-transactions">3. Kafka Transactions</a><ul>
<li><a href="#31-how-to-enable-kafka-transactions">3.1 How to Enable Kafka Transactions</a><ul>
<li><a href="#example-creating-a-kafka-producer-with-transactions">Example: Creating a Kafka Producer with Transactions</a></li>
</ul>
</li>
<li><a href="#32-how-kafka-transactions-work">3.2 How Kafka Transactions Work</a><ul>
<li><a href="#1-starting-the-producer-and-assigning-a-transaction-coordinator">1) Starting the Producer and Assigning a Transaction Coordinator</a></li>
<li><a href="#2-sending-messages">2) Sending Messages</a></li>
<li><a href="#3-committing-or-aborting-the-transaction">3) Committing or Aborting the Transaction</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#4-diagram-kafka-transaction-flow">4. Diagram: Kafka Transaction Flow</a></li>
<li><a href="#5-conclusion">5. Conclusion</a></li>
<li><a href="#key-takeaways">Key Takeaways:</a></li>
</ul>
</li>
</ul>
<hr>
<h1 id="Kafka-Transaction-Workflow"><a href="#Kafka-Transaction-Workflow" class="headerlink" title="Kafka Transaction Workflow"></a>Kafka Transaction Workflow</h1><hr>
<h3 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h3><p><a name="1-introduction"></a></p>
<p>Let’s first recall the concept of a transaction: either all operations succeed, or all of them fail. Kafka transactions follow the same rule.</p>
<p>Starting from Kafka 0.11.0.0, two major features were introduced: <strong>idempotence</strong> and <strong>transactions</strong>. Understanding transactions requires understanding idempotence because transactions are built on top of idempotence. This article explains how Kafka transactions work in simple terms, without diving too deep into technical details.</p>
<p>The key points we will cover:</p>
<ul>
<li>What is idempotence? How to enable it?</li>
<li>How does idempotence work?</li>
<li>What are Kafka transactions? How to enable transactions?</li>
<li>How do Kafka transactions work?</li>
</ul>
<hr>
<h3 id="2-Idempotence-in-Kafka"><a href="#2-Idempotence-in-Kafka" class="headerlink" title="2. Idempotence in Kafka"></a>2. Idempotence in Kafka</h3><p><a name="2-idempotence-in-kafka"></a></p>
<p>Idempotence ensures that no matter how many times the producer sends the same message, the Kafka broker will only persist it once, ensuring no data duplication. Idempotence is enabled by default and can be configured using the <code>enable.idempotence</code> setting.</p>
<h4 id="2-1-How-Idempotence-Works"><a href="#2-1-How-Idempotence-Works" class="headerlink" title="2.1 How Idempotence Works"></a>2.1 How Idempotence Works</h4><p><a name="21-how-idempotence-works"></a></p>
<p>The idempotence mechanism in Kafka is simple. Each message has a unique key composed of <code>&lt;PID, Partition, SeqNumber&gt;</code>:</p>
<ul>
<li><strong>PID (Producer ID):</strong> A unique identifier assigned to each producer when it starts.</li>
<li><strong>Partition:</strong> The target partition for the message.</li>
<li><strong>SeqNumber:</strong> An incrementing ID assigned to each message by the producer, ensuring that each message has a unique sequence number.</li>
</ul>
<p>Kafka prevents duplicate message persistence for messages with the same key. However, idempotence is limited to single partition and single session guarantees. If Kafka restarts and a new PID is assigned, duplicates could occur. This is where <strong>Kafka transactions</strong> come into play.</p>
<hr>
<h3 id="3-Kafka-Transactions"><a href="#3-Kafka-Transactions" class="headerlink" title="3. Kafka Transactions"></a>3. Kafka Transactions</h3><p><a name="3-kafka-transactions"></a></p>
<p>Kafka transactions allow for atomic writes across multiple topics and partitions. All messages in the same transaction are either fully committed or fully aborted. </p>
<p>Kafka transactions are primarily concerned with <strong>producer transactions</strong>, though <strong>consumer transactions</strong> are also possible. However, consumers rely on the producer’s transaction mechanism, so we will focus on producer transactions here.</p>
<h4 id="3-1-How-to-Enable-Kafka-Transactions"><a href="#3-1-How-to-Enable-Kafka-Transactions" class="headerlink" title="3.1 How to Enable Kafka Transactions"></a>3.1 How to Enable Kafka Transactions</h4><p><a name="31-how-to-enable-kafka-transactions"></a></p>
<p>Before delving into the internals of Kafka transactions, let’s start with a simple example.</p>
<h5 id="Example-Creating-a-Kafka-Producer-with-Transactions"><a href="#Example-Creating-a-Kafka-Producer-with-Transactions" class="headerlink" title="Example: Creating a Kafka Producer with Transactions"></a>Example: Creating a Kafka Producer with Transactions</h5><p><a name="example-creating-a-kafka-producer-with-transactions"></a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">properties.setProperty(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, <span class="string">&quot;localhost:9092&quot;</span>);</span><br><span class="line">properties.setProperty(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());</span><br><span class="line">properties.setProperty(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set the transactional ID, this is required</span></span><br><span class="line">properties.setProperty(ProducerConfig.TRANSACTIONAL_ID_CONFIG, <span class="string">&quot;transactional_id_1&quot;</span>);</span><br><span class="line"></span><br><span class="line">KafkaProducer&lt;String, String&gt; producer = <span class="keyword">new</span> <span class="title class_">KafkaProducer</span>&lt;&gt;(properties);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Initialize transaction</span></span><br><span class="line">producer.initTransactions();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Start transaction</span></span><br><span class="line">producer.beginTransaction();</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// Send 10 messages to Kafka, if an error occurs, all messages will be aborted</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        producer.send(<span class="keyword">new</span> <span class="title class_">ProducerRecord</span>&lt;&gt;(<span class="string">&quot;topic-test&quot;</span>, <span class="string">&quot;a message &quot;</span> + i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Commit the transaction</span></span><br><span class="line">    producer.commitTransaction();</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    <span class="comment">// Abort the transaction if any exception occurs</span></span><br><span class="line">    producer.abortTransaction();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    producer.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In this code:</p>
<ul>
<li>The producer is configured with a <strong>transactional ID</strong>, which is essential for Kafka transactions.</li>
<li>The producer starts a transaction with <code>beginTransaction()</code>.</li>
<li>After sending messages, it commits the transaction using <code>commitTransaction()</code>. If any error occurs, the transaction is aborted with <code>abortTransaction()</code>.</li>
</ul>
<h4 id="3-2-How-Kafka-Transactions-Work"><a href="#3-2-How-Kafka-Transactions-Work" class="headerlink" title="3.2 How Kafka Transactions Work"></a>3.2 How Kafka Transactions Work</h4><p><a name="32-how-kafka-transactions-work"></a></p>
<h5 id="1-Starting-the-Producer-and-Assigning-a-Transaction-Coordinator"><a href="#1-Starting-the-Producer-and-Assigning-a-Transaction-Coordinator" class="headerlink" title="1) Starting the Producer and Assigning a Transaction Coordinator"></a>1) Starting the Producer and Assigning a Transaction Coordinator</h5><p><a name="1-starting-the-producer-and-assigning-a-transaction-coordinator"></a></p>
<p>When using transactions, the producer must be assigned a <strong>transactional ID</strong>. Upon startup, Kafka assigns a <strong>Transaction Coordinator</strong> based on this ID. Each Kafka broker has a transaction coordinator responsible for assigning <strong>Producer IDs (PIDs)</strong> and managing transactions.</p>
<p>The allocation of a transaction coordinator involves a special Kafka topic <code>__transaction_state</code>, which by default has 50 partitions. Each partition is responsible for a portion of the transactions. Kafka calculates the hash of the transactional ID and assigns the producer to a specific partition, whose leader broker will become the transaction coordinator.</p>
<p>After assigning a coordinator, the coordinator assigns a <strong>PID</strong> to the producer, allowing it to start sending messages.</p>
<h5 id="2-Sending-Messages"><a href="#2-Sending-Messages" class="headerlink" title="2) Sending Messages"></a>2) Sending Messages</h5><p><a name="2-sending-messages"></a></p>
<p>After receiving its PID, the producer informs the coordinator which partitions the transaction will target. Then, it starts sending messages. These messages are flagged as part of a transaction.</p>
<p>Once the producer has sent all its transactional messages, it sends either a <strong>Commit</strong> or <strong>Abort</strong> request to the transaction coordinator, signaling the end of its task.</p>
<h5 id="3-Committing-or-Aborting-the-Transaction"><a href="#3-Committing-or-Aborting-the-Transaction" class="headerlink" title="3) Committing or Aborting the Transaction"></a>3) Committing or Aborting the Transaction</h5><p><a name="3-committing-or-aborting-the-transaction"></a></p>
<p>When the producer starts sending messages, the coordinator marks the beginning of the transaction and records it in the <code>__transaction_state</code> topic.</p>
<p>Once all messages are sent, or in case of failure, the coordinator will receive a <strong>Commit</strong> or <strong>Abort</strong> request. The coordinator then communicates with all the topics involved in the transaction. If the transaction is successful, the topics confirm receipt of the messages, and the coordinator records the successful transaction.</p>
<p>If the transaction fails, all messages related to the transaction are discarded, and the coordinator records the failure in <code>__transaction_state</code>.</p>
<hr>
<h3 id="4-Diagram-Kafka-Transaction-Flow"><a href="#4-Diagram-Kafka-Transaction-Flow" class="headerlink" title="4. Diagram: Kafka Transaction Flow"></a>4. Diagram: Kafka Transaction Flow</h3><p><a name="4-diagram-kafka-transaction-flow"></a></p>
<p>Below is a diagram representing the Kafka transaction process:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+---------------------------+        +----------------------+        +---------------------+</span><br><span class="line">|   Producer Starts         | -----&gt; | Assign Transaction   | -----&gt; | Send Messages to    |</span><br><span class="line">|   (with transactional ID) |        | Coordinator &amp; Assign |        | Partitions          |</span><br><span class="line">+---------------------------+        | PID                  |        +---------------------+</span><br><span class="line">                                     +----------------------+</span><br><span class="line"></span><br><span class="line">                                           |</span><br><span class="line">                                           |</span><br><span class="line">                                           v</span><br><span class="line">+------------------------+        +------------------------+        +----------------------+</span><br><span class="line">|   Transaction Begins   | -----&gt; | Send Commit/Abort      | -----&gt; | Coordinator Confirms |</span><br><span class="line">+------------------------+        | Request to Coordinator |        | Success or Failure   |</span><br><span class="line">                                  +------------------------+        +----------------------+</span><br></pre></td></tr></table></figure>

<ol>
<li><strong>Producer Starts</strong>: The producer is assigned a transactional ID and a transaction coordinator.</li>
<li><strong>Sending Messages</strong>: Messages are sent as part of the transaction.</li>
<li><strong>Commit&#x2F;Abort</strong>: The producer sends a Commit or Abort request to the coordinator.</li>
<li><strong>Confirmation</strong>: The coordinator confirms the success or failure of the transaction.</li>
</ol>
<hr>
<h3 id="5-Conclusion"><a href="#5-Conclusion" class="headerlink" title="5. Conclusion"></a>5. Conclusion</h3><p><a name="5-conclusion"></a></p>
<p>Kafka transactions are a powerful feature that enables atomic writes across multiple topics and partitions, ensuring either all messages succeed or all fail. Built on top of Kafka’s idempotence mechanism, Kafka transactions provide robust guarantees for message processing, making it a reliable tool for distributed systems.</p>
<h3 id="Key-Takeaways"><a href="#Key-Takeaways" class="headerlink" title="Key Takeaways:"></a>Key Takeaways:</h3><ul>
<li><strong>Idempotence</strong>: Ensures that messages are not duplicated, even with retries.</li>
<li><strong>Transactions</strong>: Allow atomic writes across multiple topics and partitions.</li>
<li><strong>Transaction Coordinator</strong>: Manages the lifecycle of transactions, including assigning PIDs and handling commit&#x2F;abort requests.</li>
<li><strong>__transaction_state</strong>: Special Kafka topic that stores transaction metadata.</li>
</ul>
<p>By mastering these concepts, you can build robust and reliable Kafka-based applications that handle complex message processing scenarios with ease.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/23/Differences-Between-pem-csr-key-crt-and-Other-File-Extensions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/23/Differences-Between-pem-csr-key-crt-and-Other-File-Extensions/" class="post-title-link" itemprop="url">Differences Between pem csr key crt and Other File Extensions</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-23 10:54:02" itemprop="dateCreated datePublished" datetime="2024-10-23T10:54:02-04:00">2024-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/SSL/" itemprop="url" rel="index"><span itemprop="name">SSL</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#differences-between-pem-csr-key-crt-and-other-file-extensions">Differences Between <code>.pem</code>, <code>.csr</code>, <code>.key</code>, <code>.crt</code>, and Other File Extensions</a><ul>
<li><a href="#1-introduction">1. Introduction</a></li>
<li><a href="#key-points">Key Points:</a></li>
<li><a href="#2-what-is-a-pem-file">2. What is a <code>.pem</code> File?</a></li>
<li><a href="#key-points-1">Key Points:</a></li>
<li><a href="#3-what-is-a-csr-file">3. What is a <code>.csr</code> File?</a></li>
<li><a href="#key-points-2">Key Points:</a></li>
<li><a href="#4-what-is-a-key-file">4. What is a <code>.key</code> File?</a></li>
<li><a href="#key-points-3">Key Points:</a></li>
<li><a href="#5-what-is-a-crt-file">5. What is a <code>.crt</code> File?</a></li>
<li><a href="#key-points-4">Key Points:</a></li>
<li><a href="#6-other-common-certificate-formats">6. Other Common Certificate Formats</a></li>
<li><a href="#key-points-5">Key Points:</a></li>
<li><a href="#7-file-extensions-and-corresponding-commands">7. File Extensions and Corresponding Commands</a><ul>
<li><a href="#generate-a-private-key-key">Generate a Private Key (<code>.key</code>):</a></li>
<li><a href="#generate-a-csr-csr">Generate a CSR (<code>.csr</code>):</a></li>
<li><a href="#view-csr-content">View CSR Content:</a></li>
<li><a href="#generate-a-self-signed-certificate-crt">Generate a Self-Signed Certificate (<code>.crt</code>):</a></li>
<li><a href="#convert-a-pem-to-der">Convert a PEM to DER:</a></li>
<li><a href="#convert-a-pem-to-pfx">Convert a PEM to PFX:</a></li>
<li><a href="#view-certificate-content-crt-pem">View Certificate Content (<code>.crt</code>, <code>.pem</code>):</a></li>
</ul>
</li>
<li><a href="#key-points-6">Key Points:</a></li>
<li><a href="#8-diagram-certificate-workflow">8. Diagram: Certificate Workflow</a></li>
<li><a href="#key-points-7">Key Points:</a></li>
<li><a href="#9-conclusion">9. Conclusion</a></li>
<li><a href="#key-takeaways">Key Takeaways:</a></li>
</ul>
</li>
</ul>
<hr>
<h1 id="Differences-Between-pem-csr-key-crt-and-Other-File-Extensions"><a href="#Differences-Between-pem-csr-key-crt-and-Other-File-Extensions" class="headerlink" title="Differences Between .pem, .csr, .key, .crt, and Other File Extensions"></a>Differences Between <code>.pem</code>, <code>.csr</code>, <code>.key</code>, <code>.crt</code>, and Other File Extensions</h1><hr>
<h3 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h3><p><a name="1-introduction"></a></p>
<p>When dealing with SSL&#x2F;TLS certificates, you often encounter various file extensions like <code>.pem</code>, <code>.csr</code>, <code>.key</code>, and <code>.crt</code>. Each serves a different purpose in the certificate creation, signing, and installation process. Understanding these files and how they interrelate is essential for setting up secure communications.</p>
<h3 id="Key-Points"><a href="#Key-Points" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>SSL&#x2F;TLS Certificates</strong>: Secure communication over the internet.</li>
<li><strong>File Extensions</strong>: Different formats for storing cryptographic data.</li>
<li><strong>Certificate Lifecycle</strong>: From generation to deployment.</li>
</ul>
<hr>
<h3 id="2-What-is-a-pem-File"><a href="#2-What-is-a-pem-File" class="headerlink" title="2. What is a .pem File?"></a>2. What is a <code>.pem</code> File?</h3><p><a name="2-what-is-a-pem-file"></a></p>
<p>A <strong>PEM</strong> (Privacy Enhanced Mail) file is a container format used for encoding certificates, keys, and other related data in Base64. It is often used to store the root, intermediate, and server certificates in SSL communication.</p>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Encoded in Base64 (ASCII-readable).</li>
<li>Enclosed between <code>-----BEGIN CERTIFICATE-----</code> and <code>-----END CERTIFICATE-----</code>.</li>
</ul>
<p>PEM can store:</p>
<ul>
<li>Certificate authority (CA) certificates.</li>
<li>Server certificates.</li>
<li>Private keys.</li>
</ul>
<p><strong>Example Content of a <code>.pem</code> file:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIIDdzCCAl+gAwIBAgIE...</span><br><span class="line">-----END CERTIFICATE-----</span><br></pre></td></tr></table></figure>

<h3 id="Key-Points-1"><a href="#Key-Points-1" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Base64 Encoding</strong>: ASCII-readable format.</li>
<li><strong>Multiple Uses</strong>: Can store certificates and private keys.</li>
<li><strong>Commonly Used</strong>: Widely supported across different platforms.</li>
</ul>
<hr>
<h3 id="3-What-is-a-csr-File"><a href="#3-What-is-a-csr-File" class="headerlink" title="3. What is a .csr File?"></a>3. What is a <code>.csr</code> File?</h3><p><a name="3-what-is-a-csr-file"></a></p>
<p>A <strong>CSR</strong> (Certificate Signing Request) is a file generated when applying for an SSL certificate. It contains information about the domain and organization and is submitted to the Certificate Authority (CA) to request a signed certificate.</p>
<p><strong>Key Points:</strong></p>
<ul>
<li>It includes public key information and information about the organization.</li>
<li>The CA uses it to generate a signed certificate.</li>
</ul>
<p><strong>Example Content of a <code>.csr</code> file:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN CERTIFICATE REQUEST-----</span><br><span class="line">MIICzDCCAbQCAQAw...</span><br><span class="line">-----END CERTIFICATE REQUEST-----</span><br></pre></td></tr></table></figure>

<h3 id="Key-Points-2"><a href="#Key-Points-2" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Public Key</strong>: Included in the CSR.</li>
<li><strong>Organization Info</strong>: Details about the domain and organization.</li>
<li><strong>CA Submission</strong>: Sent to the CA for certificate issuance.</li>
</ul>
<hr>
<h3 id="4-What-is-a-key-File"><a href="#4-What-is-a-key-File" class="headerlink" title="4. What is a .key File?"></a>4. What is a <code>.key</code> File?</h3><p><a name="4-what-is-a-key-file"></a></p>
<p>A <strong>KEY</strong> file contains the private key used to encrypt and decrypt information. Private keys must remain confidential and should never be shared. They are used to secure communication between clients and servers, and they are essential for creating CSRs and decrypting SSL traffic.</p>
<p><strong>Key Points:</strong></p>
<ul>
<li>It is used to sign the CSR and decrypt the certificate.</li>
<li>Stored in PEM format but holds private key data.</li>
</ul>
<p><strong>Example Content of a <code>.key</code> file:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIIEvAIBADANBgkq...</span><br><span class="line">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<h3 id="Key-Points-3"><a href="#Key-Points-3" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Confidentiality</strong>: Must be kept secret.</li>
<li><strong>Encryption&#x2F;Decryption</strong>: Used to secure communication.</li>
<li><strong>CSR Generation</strong>: Required for creating a CSR.</li>
</ul>
<hr>
<h3 id="5-What-is-a-crt-File"><a href="#5-What-is-a-crt-File" class="headerlink" title="5. What is a .crt File?"></a>5. What is a <code>.crt</code> File?</h3><p><a name="5-what-is-a-crt-file"></a></p>
<p>A <strong>CRT</strong> (Certificate) file contains the SSL certificate issued by a CA. This certificate is used to secure communication between a client and a server. It contains the public key of the entity and is signed by the Certificate Authority.</p>
<p><strong>Key Points:</strong></p>
<ul>
<li>Often used interchangeably with <code>.pem</code>.</li>
<li>It may be in PEM or DER format.</li>
<li>Typically contains the public key of the certificate holder.</li>
</ul>
<p><strong>Example Content of a <code>.crt</code> file:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIIC+DCCAeCgAwIBAgIJALfZc1...</span><br><span class="line">-----END CERTIFICATE-----</span><br></pre></td></tr></table></figure>

<h3 id="Key-Points-4"><a href="#Key-Points-4" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Public Key</strong>: Included in the certificate.</li>
<li><strong>CA Signature</strong>: Ensures the certificate’s authenticity.</li>
<li><strong>Interchangeable</strong>: Often used with <code>.pem</code> format.</li>
</ul>
<hr>
<h3 id="6-Other-Common-Certificate-Formats"><a href="#6-Other-Common-Certificate-Formats" class="headerlink" title="6. Other Common Certificate Formats"></a>6. Other Common Certificate Formats</h3><p><a name="6-other-common-certificate-formats"></a></p>
<p><strong>DER (.der):</strong>  </p>
<ul>
<li>Binary version of PEM.</li>
<li>Commonly used in Windows.</li>
<li>Can store certificates and private keys.</li>
</ul>
<p><strong>PFX&#x2F;PKCS12 (.pfx or .p12):</strong>  </p>
<ul>
<li>Binary format for storing the certificate, intermediate certificates, and private key in one file.</li>
<li>Often used in Windows IIS servers.</li>
</ul>
<h3 id="Key-Points-5"><a href="#Key-Points-5" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>DER</strong>: Binary format for certificates.</li>
<li><strong>PFX&#x2F;PKCS12</strong>: Bundles certificates and private keys.</li>
<li><strong>Platform-Specific</strong>: Used in different operating systems.</li>
</ul>
<hr>
<h3 id="7-File-Extensions-and-Corresponding-Commands"><a href="#7-File-Extensions-and-Corresponding-Commands" class="headerlink" title="7. File Extensions and Corresponding Commands"></a>7. File Extensions and Corresponding Commands</h3><p><a name="7-file-extensions-and-corresponding-commands"></a></p>
<p>Here are some common OpenSSL commands for generating, converting, and inspecting certificate files:</p>
<h4 id="Generate-a-Private-Key-key"><a href="#Generate-a-Private-Key-key" class="headerlink" title="Generate a Private Key (.key):"></a>Generate a Private Key (<code>.key</code>):</h4><p><a name="generate-a-private-key-key"></a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl genrsa -out private.key 2048</span><br></pre></td></tr></table></figure>

<h4 id="Generate-a-CSR-csr"><a href="#Generate-a-CSR-csr" class="headerlink" title="Generate a CSR (.csr):"></a>Generate a CSR (<code>.csr</code>):</h4><p><a name="generate-a-csr-csr"></a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl req -new -key private.key -out request.csr</span><br></pre></td></tr></table></figure>

<h4 id="View-CSR-Content"><a href="#View-CSR-Content" class="headerlink" title="View CSR Content:"></a>View CSR Content:</h4><p><a name="view-csr-content"></a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl req -<span class="keyword">in</span> request.csr -noout -text</span><br></pre></td></tr></table></figure>

<h4 id="Generate-a-Self-Signed-Certificate-crt"><a href="#Generate-a-Self-Signed-Certificate-crt" class="headerlink" title="Generate a Self-Signed Certificate (.crt):"></a>Generate a Self-Signed Certificate (<code>.crt</code>):</h4><p><a name="generate-a-self-signed-certificate-crt"></a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl req -x509 -new -nodes -key private.key -sha256 -days 365 -out certificate.crt</span><br></pre></td></tr></table></figure>

<h4 id="Convert-a-PEM-to-DER"><a href="#Convert-a-PEM-to-DER" class="headerlink" title="Convert a PEM to DER:"></a>Convert a PEM to DER:</h4><p><a name="convert-a-pem-to-der"></a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -outform der -<span class="keyword">in</span> certificate.pem -out certificate.der</span><br></pre></td></tr></table></figure>

<h4 id="Convert-a-PEM-to-PFX"><a href="#Convert-a-PEM-to-PFX" class="headerlink" title="Convert a PEM to PFX:"></a>Convert a PEM to PFX:</h4><p><a name="convert-a-pem-to-pfx"></a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl pkcs12 -<span class="built_in">export</span> -out certificate.pfx -inkey private.key -<span class="keyword">in</span> certificate.crt -certfile ca.crt</span><br></pre></td></tr></table></figure>

<h4 id="View-Certificate-Content-crt-pem"><a href="#View-Certificate-Content-crt-pem" class="headerlink" title="View Certificate Content (.crt, .pem):"></a>View Certificate Content (<code>.crt</code>, <code>.pem</code>):</h4><p><a name="view-certificate-content-crt-pem"></a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -<span class="keyword">in</span> certificate.crt -noout -text</span><br></pre></td></tr></table></figure>

<h3 id="Key-Points-6"><a href="#Key-Points-6" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>OpenSSL</strong>: Command-line tool for managing certificates.</li>
<li><strong>Generation</strong>: Creating private keys and CSRs.</li>
<li><strong>Conversion</strong>: Converting between different formats.</li>
<li><strong>Inspection</strong>: Viewing certificate details.</li>
</ul>
<hr>
<h3 id="8-Diagram-Certificate-Workflow"><a href="#8-Diagram-Certificate-Workflow" class="headerlink" title="8. Diagram: Certificate Workflow"></a>8. Diagram: Certificate Workflow</h3><p><a name="8-diagram-certificate-workflow"></a></p>
<p>Here’s a diagram to illustrate the typical workflow from generating a private key to receiving a certificate from a Certificate Authority:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+-----------------------+        +--------------------+        +---------------------+</span><br><span class="line">|   Private Key (.key)  | -----&gt; |   CSR (.csr)       | -----&gt; |   Certificate (.crt)|</span><br><span class="line">+-----------------------+        +--------------------+        +---------------------+</span><br><span class="line">       |                                      ^</span><br><span class="line">       |                                      |</span><br><span class="line">       |           Certificate Signing        |</span><br><span class="line">       +--------------------------------------+</span><br></pre></td></tr></table></figure>

<ol>
<li><strong>Generate Private Key:</strong> The <code>.key</code> file is generated first, which is necessary for creating a CSR.</li>
<li><strong>Generate CSR:</strong> A <code>.csr</code> is generated using the private key and sent to the CA.</li>
<li><strong>Receive Certificate:</strong> The CA signs the CSR and returns a <code>.crt</code> or <code>.pem</code> certificate file.</li>
</ol>
<h3 id="Key-Points-7"><a href="#Key-Points-7" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Workflow</strong>: From key generation to certificate issuance.</li>
<li><strong>CA Role</strong>: Signing the CSR to produce a certificate.</li>
<li><strong>End Result</strong>: A signed certificate for secure communication.</li>
</ul>
<hr>
<h3 id="9-Conclusion"><a href="#9-Conclusion" class="headerlink" title="9. Conclusion"></a>9. Conclusion</h3><p><a name="9-conclusion"></a></p>
<p>Understanding the differences between certificate-related files like <code>.pem</code>, <code>.csr</code>, <code>.key</code>, and <code>.crt</code> is essential for managing SSL certificates. Each of these files has a unique role in the certificate lifecycle, from generating requests to securing communications. These files work together to ensure the integrity and security of encrypted data transmissions over the web.</p>
<h3 id="Key-Takeaways"><a href="#Key-Takeaways" class="headerlink" title="Key Takeaways:"></a>Key Takeaways:</h3><ul>
<li><strong>File Types</strong>: Understand the purpose of each file extension.</li>
<li><strong>Lifecycle</strong>: Follow the certificate lifecycle from generation to deployment.</li>
<li><strong>Security</strong>: Ensure proper handling and protection of private keys.</li>
</ul>
<p>By mastering these concepts, you can effectively manage SSL certificates and ensure secure communication in your applications.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/23/Understanding-Root-and-Intermediate-Certificates/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/23/Understanding-Root-and-Intermediate-Certificates/" class="post-title-link" itemprop="url">Understanding Root and Intermediate Certificates</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-23 09:35:02" itemprop="dateCreated datePublished" datetime="2024-10-23T09:35:02-04:00">2024-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/SSL/" itemprop="url" rel="index"><span itemprop="name">SSL</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#understanding-root-and-intermediate-certificates">Understanding Root and Intermediate Certificates</a><ul>
<li><a href="#1-what-are-certificates">1. What are Certificates?</a></li>
<li><a href="#key-points">Key Points:</a></li>
<li><a href="#2-introduction-to-certificate-authority-ca">2. Introduction to Certificate Authority (CA)</a></li>
<li><a href="#key-points-1">Key Points:</a></li>
<li><a href="#3-root-certificates">3. Root Certificates</a></li>
<li><a href="#key-points-2">Key Points:</a></li>
<li><a href="#4-intermediate-certificates">4. Intermediate Certificates</a></li>
<li><a href="#key-points-3">Key Points:</a></li>
<li><a href="#5-chain-of-trust">5. Chain of Trust</a></li>
<li><a href="#key-points-4">Key Points:</a></li>
<li><a href="#6-why-are-intermediate-certificates-used">6. Why are Intermediate Certificates Used?</a></li>
<li><a href="#key-points-5">Key Points:</a></li>
<li><a href="#7-sample-certificate-chain">7. Sample Certificate Chain</a></li>
<li><a href="#key-points-6">Key Points:</a></li>
<li><a href="#8-diagram-certificate-chain">8. Diagram: Certificate Chain</a></li>
<li><a href="#key-points-7">Key Points:</a></li>
<li><a href="#9-python-code-example-for-validating-certificates">9. Python Code Example for Validating Certificates</a><ul>
<li><a href="#python-code-to-validate-a-certificate-chain">Python Code to Validate a Certificate Chain</a></li>
</ul>
</li>
<li><a href="#key-points-8">Key Points:</a></li>
<li><a href="#10-conclusion">10. Conclusion</a></li>
<li><a href="#key-takeaways">Key Takeaways:</a></li>
</ul>
</li>
</ul>
<hr>
<h2 id="Understanding-Root-and-Intermediate-Certificates"><a href="#Understanding-Root-and-Intermediate-Certificates" class="headerlink" title="Understanding Root and Intermediate Certificates"></a>Understanding Root and Intermediate Certificates</h2><hr>
<h3 id="1-What-are-Certificates"><a href="#1-What-are-Certificates" class="headerlink" title="1. What are Certificates?"></a>1. What are Certificates?</h3><p><a name="1-what-are-certificates"></a></p>
<p>Certificates are digital documents that verify the identity of an entity (such as a website) and establish secure communication between servers and clients. A certificate ensures the authenticity of the entity claiming to be what it is.</p>
<h3 id="Key-Points"><a href="#Key-Points" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Digital Signature</strong>: Certificates are digitally signed by a Certificate Authority (CA) to ensure their authenticity.</li>
<li><strong>Public Key Infrastructure (PKI)</strong>: Certificates are a fundamental part of the PKI, which is used to secure online communications.</li>
<li><strong>Types of Certificates</strong>: There are various types of certificates, including SSL&#x2F;TLS certificates, code signing certificates, and email certificates.</li>
</ul>
<hr>
<h3 id="2-Introduction-to-Certificate-Authority-CA"><a href="#2-Introduction-to-Certificate-Authority-CA" class="headerlink" title="2. Introduction to Certificate Authority (CA)"></a>2. Introduction to Certificate Authority (CA)</h3><p><a name="2-introduction-to-certificate-authority-ca"></a></p>
<p>A <strong>Certificate Authority (CA)</strong> is a trusted entity responsible for issuing digital certificates. These certificates bind a public key with an entity’s identity, like a domain name or a company. The CA plays a crucial role in the <strong>Public Key Infrastructure (PKI)</strong> system, which helps to secure online communications.</p>
<h3 id="Key-Points-1"><a href="#Key-Points-1" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Issuing Certificates</strong>: CAs issue certificates after verifying the identity of the entity requesting the certificate.</li>
<li><strong>Trust Model</strong>: Browsers and operating systems come pre-installed with a list of trusted Root CAs.</li>
<li><strong>Revocation</strong>: CAs can revoke certificates if they are compromised or no longer valid.</li>
</ul>
<hr>
<h3 id="3-Root-Certificates"><a href="#3-Root-Certificates" class="headerlink" title="3. Root Certificates"></a>3. Root Certificates</h3><p><a name="3-root-certificates"></a></p>
<p>A <strong>Root Certificate</strong> is the foundation of a trust chain. It is issued by a <strong>Root Certificate Authority (Root CA)</strong>, which is a trusted entity pre-installed in web browsers and operating systems. All certificates trust a Root CA, and this trust is propagated through the chain of certificates.</p>
<h3 id="Key-Points-2"><a href="#Key-Points-2" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Self-Signed</strong>: Root Certificates are self-signed.</li>
<li><strong>Ultimate Trust Anchor</strong>: They act as the ultimate trust anchor.</li>
<li><strong>Reputation</strong>: Root CAs are only issued to very reputable organizations, and compromising a root certificate would cause massive security breaches.</li>
</ul>
<hr>
<h3 id="4-Intermediate-Certificates"><a href="#4-Intermediate-Certificates" class="headerlink" title="4. Intermediate Certificates"></a>4. Intermediate Certificates</h3><p><a name="4-intermediate-certificates"></a></p>
<p>An <strong>Intermediate Certificate</strong> is issued by a Root CA or another Intermediate CA. Intermediate certificates act as <strong>middle layers</strong> in the trust chain, allowing the Root CA to delegate the task of issuing end-user certificates.</p>
<h3 id="Key-Points-3"><a href="#Key-Points-3" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Delegation</strong>: Intermediate Certificates are used to spread the trust of a Root Certificate.</li>
<li><strong>Security</strong>: They ensure that if an Intermediate CA is compromised, the damage is limited to certificates issued by that Intermediate CA, not the root.</li>
<li><strong>Hierarchy</strong>: Intermediate Certificates are usually signed by the Root CA or another trusted intermediate CA.</li>
</ul>
<hr>
<h3 id="5-Chain-of-Trust"><a href="#5-Chain-of-Trust" class="headerlink" title="5. Chain of Trust"></a>5. Chain of Trust</h3><p><a name="5-chain-of-trust"></a></p>
<p>The <strong>Chain of Trust</strong> is the hierarchy of certificates starting from the <strong>Root Certificate</strong> at the bottom(root), followed by <strong>Intermediate Certificates</strong>, and finally the <strong>End-Entity Certificate</strong> (also known as the <strong>Leaf Certificate</strong>), which is the certificate for the actual entity (e.g., a website).</p>
<table>
<thead>
<tr>
<th><img src="/images/Understanding-Root-and-Intermediate-Certificates/Chain_of_trust_v2.svg" alt="Chain of Trust"></th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://commons.wikimedia.org/wiki/File:Chain_of_trust_v2.svg">Fanyangxi – CC BY-SA 4.0</a></td>
</tr>
</tbody></table>
<h3 id="Key-Points-4"><a href="#Key-Points-4" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Hierarchy</strong>: The chain of trust ensures that each certificate in the chain is signed by the next certificate up the chain.</li>
<li><strong>Validation</strong>: When a client connects to a server, it validates the entire certificate chain up to the trusted Root CA.</li>
<li><strong>Security</strong>: The chain of trust ensures that only trusted certificates are used for secure communications.</li>
</ul>
<hr>
<h3 id="6-Why-are-Intermediate-Certificates-Used"><a href="#6-Why-are-Intermediate-Certificates-Used" class="headerlink" title="6. Why are Intermediate Certificates Used?"></a>6. Why are Intermediate Certificates Used?</h3><p><a name="6-why-are-intermediate-certificates-used"></a></p>
<p>Intermediate certificates are used for several reasons:</p>
<ol>
<li><strong>Security</strong>: If a root certificate is compromised, all certificates under it are compromised. Intermediate certificates limit the scope of a breach.</li>
<li><strong>Delegation</strong>: Root certificates delegate the issuance of certificates to intermediates, spreading out the load and responsibility.</li>
<li><strong>Certificate Revocation</strong>: If an Intermediate CA is compromised, only certificates issued by that intermediate can be revoked without affecting the root.</li>
</ol>
<h3 id="Key-Points-5"><a href="#Key-Points-5" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Scalability</strong>: Intermediate CAs allow the Root CA to scale its operations by delegating certificate issuance.</li>
<li><strong>Flexibility</strong>: Intermediate CAs can be managed independently, allowing for more granular control over certificate issuance and revocation.</li>
<li><strong>Risk Mitigation</strong>: Intermediate CAs reduce the risk of a single point of failure by distributing trust across multiple entities.</li>
</ul>
<hr>
<h3 id="7-Sample-Certificate-Chain"><a href="#7-Sample-Certificate-Chain" class="headerlink" title="7. Sample Certificate Chain"></a>7. Sample Certificate Chain</h3><p><a name="7-sample-certificate-chain"></a></p>
<p>Let’s assume we are visiting a secure website. The browser will validate the certificate using a chain similar to the following:</p>
<ol>
<li><strong>Root Certificate</strong>: Trusted by browsers.</li>
<li><strong>Intermediate Certificate</strong>: Signed by the Root CA.</li>
<li><strong>Leaf Certificate</strong>: Issued for the website and signed by the Intermediate CA.</li>
</ol>
<h3 id="Key-Points-6"><a href="#Key-Points-6" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Validation Process</strong>: The browser validates the entire chain, starting from the Leaf Certificate and moving up to the Root Certificate.</li>
<li><strong>Trust Check</strong>: If any certificate in the chain is not trusted, the connection will fail.</li>
<li><strong>Chain Length</strong>: The length of the chain can vary depending on the number of intermediate CAs involved.</li>
</ul>
<hr>
<h3 id="8-Diagram-Certificate-Chain"><a href="#8-Diagram-Certificate-Chain" class="headerlink" title="8. Diagram: Certificate Chain"></a>8. Diagram: Certificate Chain</h3><p><a name="8-diagram-certificate-chain"></a></p>
<p>Here’s a visual diagram to explain the trust chain:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">+--------------------------+</span><br><span class="line">|       Root CA            |</span><br><span class="line">|    (Trusted by OS)       |</span><br><span class="line">+--------------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+--------------------------+</span><br><span class="line">|   Intermediate CA 1       |</span><br><span class="line">|   (Issued by Root CA)     |</span><br><span class="line">+--------------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+--------------------------+</span><br><span class="line">|   Intermediate CA 2       |</span><br><span class="line">|  (Issued by Int. CA 1)    |</span><br><span class="line">+--------------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+--------------------------+</span><br><span class="line">|    End-Entity Cert        |</span><br><span class="line">| (Issued for example.com)  |</span><br><span class="line">+--------------------------+</span><br></pre></td></tr></table></figure>

<h3 id="Key-Points-7"><a href="#Key-Points-7" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Hierarchy</strong>: The diagram shows the hierarchical structure of the certificate chain.</li>
<li><strong>Trust Propagation</strong>: Trust is propagated from the Root CA down to the End-Entity Certificate.</li>
<li><strong>Validation Path</strong>: The browser follows this path to validate the certificate chain.</li>
</ul>
<hr>
<h3 id="9-Python-Code-Example-for-Validating-Certificates"><a href="#9-Python-Code-Example-for-Validating-Certificates" class="headerlink" title="9. Python Code Example for Validating Certificates"></a>9. Python Code Example for Validating Certificates</h3><p><a name="9-python-code-example-for-validating-certificates"></a></p>
<p>We can use the <code>ssl</code> and <code>cryptography</code> libraries in Python to validate and inspect the certificate chain. Below is an example that uses Python to verify the SSL certificate chain of a given website.</p>
<h4 id="Python-Code-to-Validate-a-Certificate-Chain"><a href="#Python-Code-to-Validate-a-Certificate-Chain" class="headerlink" title="Python Code to Validate a Certificate Chain"></a>Python Code to Validate a Certificate Chain</h4><p><a name="python-code-to-validate-a-certificate-chain"></a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ssl</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> OpenSSL</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_certificate_chain</span>(<span class="params">hostname, port=<span class="number">443</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Fetch and print the certificate chain for a given hostname.&quot;&quot;&quot;</span></span><br><span class="line">    context = ssl.create_default_context()</span><br><span class="line">    conn = context.wrap_socket(</span><br><span class="line">        socket.socket(socket.AF_INET),</span><br><span class="line">        server_hostname=hostname,</span><br><span class="line">    )</span><br><span class="line">    conn.connect((hostname, port))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Get the certificate chain</span></span><br><span class="line">    cert_bin = conn.getpeercert(<span class="literal">True</span>)</span><br><span class="line">    cert = ssl.DER_cert_to_PEM_cert(cert_bin)</span><br><span class="line">    x509 = OpenSSL.crypto.load_certificate(OpenSSL.crypto.FILETYPE_PEM, cert)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Print certificates in the chain</span></span><br><span class="line">    chain = conn.getpeercert(<span class="literal">True</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Certificate chain for <span class="subst">&#123;hostname&#125;</span>:\n&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (idx, cert) <span class="keyword">in</span> <span class="built_in">enumerate</span>(chain):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Certificate <span class="subst">&#123;idx + <span class="number">1</span>&#125;</span>:\n&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(OpenSSL.crypto.dump_certificate(OpenSSL.crypto.FILETYPE_PEM, cert).decode())</span><br><span class="line">    </span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example: get certificate chain for a website</span></span><br><span class="line">get_certificate_chain(<span class="string">&#x27;www.example.com&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Key-Points-8"><a href="#Key-Points-8" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>SSL Context</strong>: The <code>ssl.create_default_context()</code> function creates a default SSL context with secure settings.</li>
<li><strong>Socket Connection</strong>: The <code>wrap_socket</code> method wraps a standard socket in an SSL socket, allowing secure communication.</li>
<li><strong>Certificate Chain</strong>: The <code>getpeercert</code> method retrieves the certificate chain from the server.</li>
<li><strong>Print Certificates</strong>: The certificates in the chain are printed in PEM format for inspection.</li>
</ul>
<hr>
<h3 id="10-Conclusion"><a href="#10-Conclusion" class="headerlink" title="10. Conclusion"></a>10. Conclusion</h3><p><a name="10-conclusion"></a></p>
<p>Root and Intermediate certificates are crucial to securing communications and establishing trust on the internet. By using a layered approach with Intermediate CAs, Root CAs can safely distribute trust across various entities while minimizing risk in case of a security breach.</p>
<h3 id="Key-Takeaways"><a href="#Key-Takeaways" class="headerlink" title="Key Takeaways:"></a>Key Takeaways:</h3><ul>
<li><strong>Trust Model</strong>: The chain of trust ensures that only trusted certificates are used for secure communications.</li>
<li><strong>Security</strong>: Intermediate certificates limit the scope of a breach, ensuring that if an Intermediate CA is compromised, only certificates issued by that intermediate are affected.</li>
<li><strong>Scalability</strong>: Intermediate CAs allow the Root CA to scale its operations by delegating certificate issuance.</li>
</ul>
<p>By mastering these concepts, you can better understand how certificates work and how they are used to secure online communications.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/22/Restman/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/22/Restman/" class="post-title-link" itemprop="url">Restman</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-22 22:49:47" itemprop="dateCreated datePublished" datetime="2024-10-22T22:49:47-04:00">2024-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adfad</span><br><span class="line">111</span><br></pre></td></tr></table></figure>

<p><strong>Restman</strong> is a command-line tool written in Python, designed to combine the simplicity of cURL with the powerful features of Postman. It aims to relieve users from the complexities of manually building network connections with URLs or endpoints, allowing them to focus solely on the core aspects of HTTP requests and responses. With Restman, users can quickly and efficiently test APIs, handle different HTTP methods, and parse response data without worrying about the underlying connection mechanics.</p>
<h2 id="Github-repo"><a href="#Github-repo" class="headerlink" title="Github repo"></a>Github repo</h2><p><a target="_blank" rel="noopener" href="https://github.com/whereq/whereq-commandoes/tree/main/Restman">WhereQ Commandoes — Restman</a></p>
<h2 id="Free-public-APIs-for-Testing"><a href="#Free-public-APIs-for-Testing" class="headerlink" title="Free public APIs for Testing"></a>Free public APIs for Testing</h2><table>
<thead>
<tr>
<th>Website</th>
<th>URL</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>Dummy API Example</td>
<td><a target="_blank" rel="noopener" href="https://dummy.restapiexample.com/">dummy.restapiexample.com</a></td>
<td>A simple API for testing dummy data.</td>
</tr>
<tr>
<td>ReqRes</td>
<td><a target="_blank" rel="noopener" href="https://reqres.in/">reqres.in</a></td>
<td>A hosted REST-API to simulate CRUD operations for testing.</td>
</tr>
<tr>
<td>Cat Facts</td>
<td><a target="_blank" rel="noopener" href="https://catfact.ninja/">catfact.ninja</a></td>
<td>Provides random cat facts.</td>
</tr>
<tr>
<td>Dog CEO API</td>
<td><a target="_blank" rel="noopener" href="https://dog.ceo/api/breeds/Image/random">dog.ceo</a></td>
<td>Random dog image generator.</td>
</tr>
<tr>
<td>JSONPlaceholder</td>
<td><a target="_blank" rel="noopener" href="https://jsonplaceholder.typicode.com/">jsonplaceholder.typicode.com</a></td>
<td>Fake API for testing and prototyping.</td>
</tr>
<tr>
<td>RestCountries</td>
<td><a target="_blank" rel="noopener" href="https://restcountries.com/">restcountries.com</a></td>
<td>API for getting country-related information.</td>
</tr>
<tr>
<td>PokeAPI</td>
<td><a target="_blank" rel="noopener" href="https://pokeapi.co/">pokeapi.co</a></td>
<td>Free API for Pokémon data.</td>
</tr>
<tr>
<td>CoinDesk API</td>
<td><a target="_blank" rel="noopener" href="https://www.coindesk.com/api">coindesk.com</a></td>
<td>Provides Bitcoin price index and cryptocurrency news.</td>
</tr>
<tr>
<td>Agify</td>
<td><a target="_blank" rel="noopener" href="https://api.agify.io/?name=meelad">api.agify.io</a></td>
<td>Predicts the age of a person based on their name.</td>
</tr>
<tr>
<td>Genderize</td>
<td><a target="_blank" rel="noopener" href="https://api.genderize.io/?name=luc">api.genderize.io</a></td>
<td>Predicts the gender of a person based on their name.</td>
</tr>
<tr>
<td>Nationalize</td>
<td><a target="_blank" rel="noopener" href="https://api.nationalize.io/?name=nathaniel">api.nationalize.io</a></td>
<td>Predicts the nationality based on a name.</td>
</tr>
<tr>
<td>Data USA</td>
<td><a target="_blank" rel="noopener" href="https://datausa.io/api/data?drilldowns=Nation&measures=Population">datausa.io</a></td>
<td>Provides data on the U.S. population.</td>
</tr>
<tr>
<td>IPify</td>
<td><a target="_blank" rel="noopener" href="https://api.ipify.org/?format=json">api.ipify.org</a></td>
<td>Simple API to get your public IP address.</td>
</tr>
<tr>
<td>IPInfo</td>
<td><a target="_blank" rel="noopener" href="https://ipinfo.io/161.185.160.93/geo">ipinfo.io</a></td>
<td>Provides detailed geolocation information of an IP address.</td>
</tr>
<tr>
<td>Official Joke API</td>
<td><a target="_blank" rel="noopener" href="https://official-joke-api.appspot.com/random_joke">official-joke-api.appspot.com</a></td>
<td>Fetches a random joke.</td>
</tr>
<tr>
<td>Random User API</td>
<td><a target="_blank" rel="noopener" href="https://randomuser.me/api/">randomuser.me</a></td>
<td>Generates random user data.</td>
</tr>
<tr>
<td>University Search API</td>
<td><a target="_blank" rel="noopener" href="http://universities.hipolabs.com/search?country=United+States">universities.hipolabs.com</a></td>
<td>Search for universities worldwide.</td>
</tr>
<tr>
<td>Zippopotam</td>
<td><a target="_blank" rel="noopener" href="https://api.zippopotam.us/us/33162">zippopotam.us</a></td>
<td>Get location data by U.S. ZIP code.</td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/22/Introduction-to-Regression-Algorithms/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/22/Introduction-to-Regression-Algorithms/" class="post-title-link" itemprop="url">Introduction to Regression Algorithms</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-22 16:47:07" itemprop="dateCreated datePublished" datetime="2024-10-22T16:47:07-04:00">2024-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/AI/" itemprop="url" rel="index"><span itemprop="name">AI</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Introduction-to-Regression-Algorithms"><a href="#Introduction-to-Regression-Algorithms" class="headerlink" title="Introduction to Regression Algorithms"></a>Introduction to Regression Algorithms</h1><p>Regression is a type of analysis used to understand relationships between variables. In machine learning, regression algorithms predict continuous outcomes based on input data. In this article, we will cover several common regression algorithms with sample Python code snippets and visual aids to help you understand how they work. Let’s dive in!</p>
<hr>
<h2 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h2><ul>
<li><a href="#introduction-to-regression-algorithms">Introduction to Regression Algorithms</a><ul>
<li><a href="#index">Index</a></li>
<li><a href="#1-linear-regression">1. Linear Regression</a><ul>
<li><a href="#example-diagram">Example Diagram:</a></li>
<li><a href="#python-code-example">Python Code Example:</a></li>
</ul>
</li>
<li><a href="#2-logistic-regression">2. Logistic Regression</a><ul>
<li><a href="#example-diagram-1">Example Diagram:</a></li>
<li><a href="#python-code-example-1">Python Code Example:</a></li>
</ul>
</li>
<li><a href="#3-decision-tree-regression">3. Decision Tree Regression</a><ul>
<li><a href="#example-diagram-2">Example Diagram:</a></li>
<li><a href="#python-code-example-2">Python Code Example:</a></li>
</ul>
</li>
<li><a href="#4-random-forest-regression">4. Random Forest Regression</a><ul>
<li><a href="#example-diagram-3">Example Diagram:</a></li>
<li><a href="#python-code-example-3">Python Code Example:</a></li>
</ul>
</li>
<li><a href="#5-support-vector-regression-svr">5. Support Vector Regression (SVR)</a><ul>
<li><a href="#example-diagram-4">Example Diagram:</a></li>
<li><a href="#python-code-example-4">Python Code Example:</a></li>
</ul>
</li>
<li><a href="#6-k-nearest-neighbors-knn-regression">6. K-Nearest Neighbors (KNN) Regression</a><ul>
<li><a href="#example-diagram-5">Example Diagram:</a></li>
<li><a href="#python-code-example-5">Python Code Example:</a></li>
</ul>
</li>
<li><a href="#7-bayesian-linear-regression">7. Bayesian Linear Regression</a><ul>
<li><a href="#python-code-example-6">Python Code Example:</a></li>
</ul>
</li>
<li><a href="#8-lasso-and-ridge-regression">8. Lasso and Ridge Regression</a><ul>
<li><a href="#lasso-regression-code-example">Lasso Regression Code Example:</a></li>
<li><a href="#ridge-regression-code-example">Ridge Regression Code Example:</a></li>
</ul>
</li>
<li><a href="#9-regression-analysis">9. Regression Analysis</a></li>
<li><a href="#10-neural-networks-with-regression">10. Neural Networks with Regression</a><ul>
<li><a href="#example-diagram-6">Example Diagram:</a></li>
<li><a href="#python-code-example-using-keras">Python Code Example (Using Keras):</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
<hr>
<h2 id="1-Linear-Regression"><a href="#1-Linear-Regression" class="headerlink" title="1. Linear Regression"></a>1. Linear Regression</h2><p><strong>Linear Regression</strong> models the relationship between input (x) and output (y) as a straight line. It tries to minimize the difference between the predicted and actual values.</p>
<h3 id="Example-Diagram"><a href="#Example-Diagram" class="headerlink" title="Example Diagram:"></a>Example Diagram:</h3><p><img src="/images/Introduction-to-Regression-Algorithms/Linear_regression.png" alt="Linear Regression"></p>
<h3 id="Python-Code-Example"><a href="#Python-Code-Example" class="headerlink" title="Python Code Example:"></a>Python Code Example:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sample data</span></span><br><span class="line">X = np.array([[<span class="number">1</span>], [<span class="number">2</span>], [<span class="number">3</span>], [<span class="number">4</span>], [<span class="number">5</span>]])</span><br><span class="line">y = np.array([<span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create and train model</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(X, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict new values</span></span><br><span class="line">y_pred = model.predict(np.array([[<span class="number">6</span>]]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Prediction for X=6: <span class="subst">&#123;y_pred[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="2-Logistic-Regression"><a href="#2-Logistic-Regression" class="headerlink" title="2. Logistic Regression"></a>2. Logistic Regression</h2><p><strong>Logistic Regression</strong> is used for binary classification, predicting probabilities that the input belongs to one of two classes (e.g., “yes” or “no”).</p>
<h3 id="Example-Diagram-1"><a href="#Example-Diagram-1" class="headerlink" title="Example Diagram:"></a>Example Diagram:</h3><p><img src="/images/Introduction-to-Regression-Algorithms/sigmoid_graph.png" alt="Logistic Regression"></p>
<h3 id="Python-Code-Example-1"><a href="#Python-Code-Example-1" class="headerlink" title="Python Code Example:"></a>Python Code Example:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sample data (1 or 0 outcome)</span></span><br><span class="line">X = np.array([[<span class="number">1</span>], [<span class="number">2</span>], [<span class="number">3</span>], [<span class="number">4</span>], [<span class="number">5</span>]])</span><br><span class="line">y = np.array([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create and train model</span></span><br><span class="line">model = LogisticRegression()</span><br><span class="line">model.fit(X, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict new value</span></span><br><span class="line">y_pred = model.predict(np.array([[<span class="number">3.5</span>]]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Prediction for X=3.5: <span class="subst">&#123;y_pred[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="3-Decision-Tree-Regression"><a href="#3-Decision-Tree-Regression" class="headerlink" title="3. Decision Tree Regression"></a>3. Decision Tree Regression</h2><p><strong>Decision Tree Regression</strong> splits the data into different regions based on decisions and forms a tree structure. Each leaf node represents a prediction.</p>
<h3 id="Example-Diagram-2"><a href="#Example-Diagram-2" class="headerlink" title="Example Diagram:"></a>Example Diagram:</h3><p><img src="/images/Introduction-to-Regression-Algorithms/Decision_Tree_1.png" alt="Decision Tree"></p>
<h3 id="Python-Code-Example-2"><a href="#Python-Code-Example-2" class="headerlink" title="Python Code Example:"></a>Python Code Example:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sample data</span></span><br><span class="line">X = np.array([[<span class="number">1</span>], [<span class="number">2</span>], [<span class="number">3</span>], [<span class="number">4</span>], [<span class="number">5</span>]])</span><br><span class="line">y = np.array([<span class="number">1.5</span>, <span class="number">2.5</span>, <span class="number">3.0</span>, <span class="number">3.5</span>, <span class="number">4.0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create and train model</span></span><br><span class="line">model = DecisionTreeRegressor()</span><br><span class="line">model.fit(X, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict new values</span></span><br><span class="line">y_pred = model.predict(np.array([[<span class="number">6</span>]]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Prediction for X=6: <span class="subst">&#123;y_pred[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="4-Random-Forest-Regression"><a href="#4-Random-Forest-Regression" class="headerlink" title="4. Random Forest Regression"></a>4. Random Forest Regression</h2><p><strong>Random Forest Regression</strong> is an ensemble of multiple decision trees that makes predictions by averaging the results of the trees.</p>
<h3 id="Example-Diagram-3"><a href="#Example-Diagram-3" class="headerlink" title="Example Diagram:"></a>Example Diagram:</h3><p><img src="/images/Introduction-to-Regression-Algorithms/Random_forest_explain.png" alt="Random Forest"></p>
<h3 id="Python-Code-Example-3"><a href="#Python-Code-Example-3" class="headerlink" title="Python Code Example:"></a>Python Code Example:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sample data</span></span><br><span class="line">X = np.array([[<span class="number">1</span>], [<span class="number">2</span>], [<span class="number">3</span>], [<span class="number">4</span>], [<span class="number">5</span>]])</span><br><span class="line">y = np.array([<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create and train model</span></span><br><span class="line">model = RandomForestRegressor(n_estimators=<span class="number">100</span>)</span><br><span class="line">model.fit(X, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict new value</span></span><br><span class="line">y_pred = model.predict(np.array([[<span class="number">6</span>]]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Prediction for X=6: <span class="subst">&#123;y_pred[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="5-Support-Vector-Regression-SVR"><a href="#5-Support-Vector-Regression-SVR" class="headerlink" title="5. Support Vector Regression (SVR)"></a>5. Support Vector Regression (SVR)</h2><p><strong>Support Vector Regression (SVR)</strong> fits the best line within a margin of error, known as the <strong>epsilon tube</strong>, focusing on points within this margin.</p>
<h3 id="Example-Diagram-4"><a href="#Example-Diagram-4" class="headerlink" title="Example Diagram:"></a>Example Diagram:</h3><p><img src="/images/Introduction-to-Regression-Algorithms/SVM_margin.png" alt="SVR"></p>
<h3 id="Python-Code-Example-4"><a href="#Python-Code-Example-4" class="headerlink" title="Python Code Example:"></a>Python Code Example:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVR</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sample data</span></span><br><span class="line">X = np.array([[<span class="number">1</span>], [<span class="number">2</span>], [<span class="number">3</span>], [<span class="number">4</span>], [<span class="number">5</span>]])</span><br><span class="line">y = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create and train model</span></span><br><span class="line">model = SVR(kernel=<span class="string">&#x27;linear&#x27;</span>)</span><br><span class="line">model.fit(X, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict new value</span></span><br><span class="line">y_pred = model.predict(np.array([[<span class="number">6</span>]]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Prediction for X=6: <span class="subst">&#123;y_pred[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="6-K-Nearest-Neighbors-KNN-Regression"><a href="#6-K-Nearest-Neighbors-KNN-Regression" class="headerlink" title="6. K-Nearest Neighbors (KNN) Regression"></a>6. K-Nearest Neighbors (KNN) Regression</h2><p><strong>KNN Regression</strong> finds the k-nearest data points to the input and predicts the value based on their average.</p>
<h3 id="Example-Diagram-5"><a href="#Example-Diagram-5" class="headerlink" title="Example Diagram:"></a>Example Diagram:</h3><p><img src="/images/Introduction-to-Regression-Algorithms/KnnClassification.png" alt="KNN"></p>
<h3 id="Python-Code-Example-5"><a href="#Python-Code-Example-5" class="headerlink" title="Python Code Example:"></a>Python Code Example:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsRegressor</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sample data</span></span><br><span class="line">X = np.array([[<span class="number">1</span>], [<span class="number">2</span>], [<span class="number">3</span>], [<span class="number">4</span>], [<span class="number">5</span>]])</span><br><span class="line">y = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">1.5</span>, <span class="number">3.5</span>, <span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create and train model</span></span><br><span class="line">model = KNeighborsRegressor(n_neighbors=<span class="number">2</span>)</span><br><span class="line">model.fit(X, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict new value</span></span><br><span class="line">y_pred = model.predict(np.array([[<span class="number">6</span>]]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Prediction for X=6: <span class="subst">&#123;y_pred[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="7-Bayesian-Linear-Regression"><a href="#7-Bayesian-Linear-Regression" class="headerlink" title="7. Bayesian Linear Regression"></a>7. Bayesian Linear Regression</h2><p><strong>Bayesian Linear Regression</strong> adds probability to the linear regression model, providing a measure of uncertainty in predictions.</p>
<h3 id="Python-Code-Example-6"><a href="#Python-Code-Example-6" class="headerlink" title="Python Code Example:"></a>Python Code Example:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> BayesianRidge</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sample data</span></span><br><span class="line">X = np.array([[<span class="number">1</span>], [<span class="number">2</span>], [<span class="number">3</span>], [<span class="number">4</span>], [<span class="number">5</span>]])</span><br><span class="line">y = np.array([<span class="number">1.2</span>, <span class="number">2.3</span>, <span class="number">3.1</span>, <span class="number">4.8</span>, <span class="number">5.5</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create and train model</span></span><br><span class="line">model = BayesianRidge()</span><br><span class="line">model.fit(X, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict new value</span></span><br><span class="line">y_pred = model.predict(np.array([[<span class="number">6</span>]]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Prediction for X=6: <span class="subst">&#123;y_pred[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="8-Lasso-and-Ridge-Regression"><a href="#8-Lasso-and-Ridge-Regression" class="headerlink" title="8. Lasso and Ridge Regression"></a>8. Lasso and Ridge Regression</h2><p><strong>Lasso Regression</strong> and <strong>Ridge Regression</strong> add regularization to reduce overfitting in linear regression. Lasso uses L1 regularization (shrinking coefficients to zero), while Ridge uses L2 regularization.</p>
<h3 id="Lasso-Regression-Code-Example"><a href="#Lasso-Regression-Code-Example" class="headerlink" title="Lasso Regression Code Example:"></a>Lasso Regression Code Example:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> Lasso</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sample data</span></span><br><span class="line">X = np.array([[<span class="number">1</span>], [<span class="number">2</span>], [<span class="number">3</span>], [<span class="number">4</span>], [<span class="number">5</span>]])</span><br><span class="line">y = np.array([<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create and train model</span></span><br><span class="line">model = Lasso(alpha=<span class="number">0.1</span>)</span><br><span class="line">model.fit(X, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict new value</span></span><br><span class="line">y_pred = model.predict(np.array([[<span class="number">6</span>]]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Prediction for X=6: <span class="subst">&#123;y_pred[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Ridge-Regression-Code-Example"><a href="#Ridge-Regression-Code-Example" class="headerlink" title="Ridge Regression Code Example:"></a>Ridge Regression Code Example:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> Ridge</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create and train model</span></span><br><span class="line">model = Ridge(alpha=<span class="number">1.0</span>)</span><br><span class="line">model.fit(X, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict new value</span></span><br><span class="line">y_pred = model.predict(np.array([[<span class="number">6</span>]]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Prediction for X=6: <span class="subst">&#123;y_pred[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="9-Regression-Analysis"><a href="#9-Regression-Analysis" class="headerlink" title="9. Regression Analysis"></a>9. Regression Analysis</h2><p><strong>Regression Analysis</strong> helps understand the relationships between variables, often used in fields such as economics and biology.</p>
<hr>
<h2 id="10-Neural-Networks-with-Regression"><a href="#10-Neural-Networks-with-Regression" class="headerlink" title="10. Neural Networks with Regression"></a>10. Neural Networks with Regression</h2><p><strong>Neural Networks</strong> can capture complex relationships between variables. For regression, the output layer of the network predicts continuous values.</p>
<h3 id="Example-Diagram-6"><a href="#Example-Diagram-6" class="headerlink" title="Example Diagram:"></a>Example Diagram:</h3><p><img src="/images/Introduction-to-Regression-Algorithms/Artificial_neural_network.png" alt="Neural Networks"></p>
<h3 id="Python-Code-Example-Using-Keras"><a href="#Python-Code-Example-Using-Keras" class="headerlink" title="Python Code Example (Using Keras):"></a>Python Code Example (Using Keras):</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers <span class="keyword">import</span> Dense</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sample data</span></span><br><span class="line">X = np.array([[<span class="number">1</span>], [<span class="number">2</span>], [<span class="number">3</span>], [<span class="number">4</span>], [<span class="number">5</span>]])</span><br><span class="line">y = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create neural network model</span></span><br><span class="line">model = Sequential()</span><br><span class="line">model.add(Dense(<span class="number">10</span>, input_dim=<span class="number">1</span>, activation=<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">model.add(Dense(<span class="number">1</span>))  <span class="comment"># Output layer</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Compile and train model</span></span><br><span class="line">model.<span class="built_in">compile</span>(optimizer=<span class="string">&#x27;adam&#x27;</span>, loss=<span class="string">&#x27;mean_squared_error&#x27;</span>)</span><br><span class="line">model.fit(X, y, epochs=<span class="number">100</span>, verbose=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict new value</span></span><br><span class="line">y_pred = model.predict(np</span><br><span class="line"></span><br><span class="line">.array([[<span class="number">6</span>]]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Prediction for X=6: <span class="subst">&#123;y_pred[<span class="number">0</span>][<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Each regression algorithm has its strengths and is suited for different tasks. <strong>Linear regression</strong> works well for simple data, while <strong>Random Forests</strong> and <strong>Neural Networks</strong> are ideal for more complex datasets. Learning and experimenting with these algorithms will help you solve a variety of predictive problems.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/22/Introduction-to-5-AI-Generation-Models/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/22/Introduction-to-5-AI-Generation-Models/" class="post-title-link" itemprop="url">Introduction to 5 AI Generation Models</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-22 16:34:21" itemprop="dateCreated datePublished" datetime="2024-10-22T16:34:21-04:00">2024-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/AI/" itemprop="url" rel="index"><span itemprop="name">AI</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction-to-5-ai-generation-models">Introduction to 5 AI Generation Models</a><ul>
<li><a href="#1-variational-autoencoders-vae">1. Variational Autoencoders (VAE)</a><ul>
<li><a href="#how-vae-works">How VAE Works:</a></li>
<li><a href="#example-diagram">Example Diagram:</a></li>
<li><a href="#python-code-example">Python Code Example:</a></li>
</ul>
</li>
<li><a href="#2-generative-adversarial-networks-gan">2. Generative Adversarial Networks (GAN)</a><ul>
<li><a href="#how-gan-works">How GAN Works:</a></li>
<li><a href="#example-diagram-1">Example Diagram:</a></li>
<li><a href="#python-code-example-1">Python Code Example:</a></li>
</ul>
</li>
<li><a href="#3-autoregressive-models-ar">3. Autoregressive Models (AR)</a><ul>
<li><a href="#how-ar-works">How AR Works:</a></li>
<li><a href="#example-diagram-transformer">Example Diagram (Transformer):</a></li>
<li><a href="#python-code-example-using-ar">Python Code Example (Using AR):</a></li>
</ul>
</li>
<li><a href="#4-flow-models">4. Flow Models</a><ul>
<li><a href="#how-flow-models-work">How Flow Models Work:</a></li>
<li><a href="#example-diagram-2">Example Diagram:</a></li>
<li><a href="#python-code-example-2">Python Code Example:</a></li>
</ul>
</li>
<li><a href="#5-diffusion-models">5. Diffusion Models</a><ul>
<li><a href="#how-diffusion-models-work">How Diffusion Models Work:</a></li>
<li><a href="#example-diagram-3">Example Diagram:</a></li>
<li><a href="#python-code-example-3">Python Code Example:</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a><ul>
<li><a href="#key-takeaways">Key Takeaways:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h1 id="Introduction-to-5-AI-Generation-Models"><a href="#Introduction-to-5-AI-Generation-Models" class="headerlink" title="Introduction to 5 AI Generation Models"></a>Introduction to 5 AI Generation Models</h1><p>In this article, we will explore some of the most common AI models used for generating data, images, or other types of content. These models use deep learning techniques and are called <strong>generative models</strong> because they create new data based on the patterns they have learned. We will cover the following models:</p>
<hr>
<h2 id="1-Variational-Autoencoders-VAE"><a href="#1-Variational-Autoencoders-VAE" class="headerlink" title="1. Variational Autoencoders (VAE)"></a>1. Variational Autoencoders (VAE)</h2><p><a name="1-variational-autoencoders-vae"></a></p>
<p><strong>VAE</strong> is a type of generative model that learns to compress data into a smaller format and then decompress it back to its original form. Unlike a normal autoencoder, VAE introduces randomness, allowing it to generate new data that looks like the original data but is slightly different.</p>
<h3 id="How-VAE-Works"><a href="#How-VAE-Works" class="headerlink" title="How VAE Works:"></a>How VAE Works:</h3><ol>
<li><strong>Encoder</strong>: Compresses the input data into a smaller “latent space.”</li>
<li><strong>Decoder</strong>: Reconstructs the data from the latent space.</li>
<li><strong>Variational</strong>: Adds randomness (a probability distribution) to the latent space, allowing the model to generate new data.</li>
</ol>
<h3 id="Example-Diagram"><a href="#Example-Diagram" class="headerlink" title="Example Diagram:"></a>Example Diagram:</h3><p><img src="/images/Introduction-to-5-AI-Generation-Models/VAE.webp" alt="VAE Diagram"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+</span><br><span class="line">|    Input Data     |</span><br><span class="line">|        x          |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|    Encoder        |</span><br><span class="line">| (Neural Network)  |</span><br><span class="line">|                   |</span><br><span class="line">|  Outputs:         |</span><br><span class="line">|  - μ (Mean)       |</span><br><span class="line">|  - log σ² (Log    |</span><br><span class="line">|    Variance)      |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">| Reparameterization|</span><br><span class="line">| Trick:            |</span><br><span class="line">| z = μ + σ * ε     |</span><br><span class="line">| (ε ~ N(0, I))     |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|    Decoder        |</span><br><span class="line">| (Neural Network)  |</span><br><span class="line">|                   |</span><br><span class="line">|  Outputs:         |</span><br><span class="line">|  - Reconstructed  |</span><br><span class="line">|    Data x&#x27;        |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|    Loss Function  |</span><br><span class="line">|                   |</span><br><span class="line">|  - Reconstruction |</span><br><span class="line">|    Loss           |</span><br><span class="line">|  - KL Divergence  |</span><br><span class="line">+-------------------+</span><br></pre></td></tr></table></figure>

<h3 id="Python-Code-Example"><a href="#Python-Code-Example" class="headerlink" title="Python Code Example:"></a>Python Code Example:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> layers</span><br><span class="line"></span><br><span class="line"><span class="comment"># Encoder</span></span><br><span class="line">input_img = tf.keras.Input(shape=(<span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>))</span><br><span class="line">x = layers.Flatten()(input_img)</span><br><span class="line">x = layers.Dense(<span class="number">256</span>, activation=<span class="string">&#x27;relu&#x27;</span>)(x)</span><br><span class="line">z_mean = layers.Dense(<span class="number">2</span>)(x)</span><br><span class="line">z_log_var = layers.Dense(<span class="number">2</span>)(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sampling layer</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sampling</span>(<span class="params">args</span>):</span><br><span class="line">    z_mean, z_log_var = args</span><br><span class="line">    batch = tf.shape(z_mean)[<span class="number">0</span>]</span><br><span class="line">    dim = tf.shape(z_mean)[<span class="number">1</span>]</span><br><span class="line">    epsilon = tf.keras.backend.random_normal(shape=(batch, dim))</span><br><span class="line">    <span class="keyword">return</span> z_mean + tf.exp(<span class="number">0.5</span> * z_log_var) * epsilon</span><br><span class="line"></span><br><span class="line">z = layers.Lambda(sampling)([z_mean, z_log_var])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Decoder</span></span><br><span class="line">decoder_input = layers.Input(shape=(<span class="number">2</span>,))</span><br><span class="line">x = layers.Dense(<span class="number">256</span>, activation=<span class="string">&#x27;relu&#x27;</span>)(decoder_input)</span><br><span class="line">x = layers.Dense(<span class="number">28</span> * <span class="number">28</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>)(x)</span><br><span class="line">output_img = layers.Reshape((<span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>))(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create VAE model</span></span><br><span class="line">vae = tf.keras.Model(input_img, output_img)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="2-Generative-Adversarial-Networks-GAN"><a href="#2-Generative-Adversarial-Networks-GAN" class="headerlink" title="2. Generative Adversarial Networks (GAN)"></a>2. Generative Adversarial Networks (GAN)</h2><p><a name="2-generative-adversarial-networks-gan"></a></p>
<p><strong>GAN</strong> is a generative model consisting of two parts: a <strong>generator</strong> and a <strong>discriminator</strong>. The generator tries to create fake data, and the discriminator tries to detect whether the data is real or fake. Over time, the generator gets better at fooling the discriminator.</p>
<h3 id="How-GAN-Works"><a href="#How-GAN-Works" class="headerlink" title="How GAN Works:"></a>How GAN Works:</h3><ol>
<li><strong>Generator</strong>: Creates fake data.</li>
<li><strong>Discriminator</strong>: Tries to differentiate between real and fake data.</li>
<li><strong>Adversarial Training</strong>: The two networks compete, helping the generator improve.</li>
</ol>
<h3 id="Example-Diagram-1"><a href="#Example-Diagram-1" class="headerlink" title="Example Diagram:"></a>Example Diagram:</h3><p><img src="/images/Introduction-to-5-AI-Generation-Models/gan.svg" alt="GAN Diagram"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+</span><br><span class="line">|   Random Noise    |</span><br><span class="line">|        z          |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|    Generator      |</span><br><span class="line">| (Neural Network)  |</span><br><span class="line">|                   |</span><br><span class="line">|  Outputs:         |</span><br><span class="line">|  - Generated Data |</span><br><span class="line">|    G(z)           |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|    Discriminator  |</span><br><span class="line">| (Neural Network)  |</span><br><span class="line">|                   |</span><br><span class="line">|  Inputs:          |</span><br><span class="line">|  - Real Data x    |</span><br><span class="line">|  - Generated Data |</span><br><span class="line">|    G(z)           |</span><br><span class="line">|                   |</span><br><span class="line">|  Outputs:         |</span><br><span class="line">|  - Probability    |</span><br><span class="line">|    Score (0 to 1) |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|    Loss Function  |</span><br><span class="line">|                   |</span><br><span class="line">|  - Generator Loss |</span><br><span class="line">|  - Discriminator  |</span><br><span class="line">|    Loss           |</span><br><span class="line">+-------------------+</span><br></pre></td></tr></table></figure>

<h3 id="Python-Code-Example-1"><a href="#Python-Code-Example-1" class="headerlink" title="Python Code Example:"></a>Python Code Example:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> layers</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generator</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_generator</span>():</span><br><span class="line">    model = tf.keras.Sequential([</span><br><span class="line">        layers.Dense(<span class="number">256</span>, activation=<span class="string">&#x27;relu&#x27;</span>, input_dim=<span class="number">100</span>),</span><br><span class="line">        layers.Dense(<span class="number">512</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">        layers.Dense(<span class="number">1024</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">        layers.Dense(<span class="number">28</span> * <span class="number">28</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>),</span><br><span class="line">        layers.Reshape((<span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>))</span><br><span class="line">    ])</span><br><span class="line">    <span class="keyword">return</span> model</span><br><span class="line"></span><br><span class="line"><span class="comment"># Discriminator</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_discriminator</span>():</span><br><span class="line">    model = tf.keras.Sequential([</span><br><span class="line">        layers.Flatten(input_shape=(<span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)),</span><br><span class="line">        layers.Dense(<span class="number">512</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">        layers.Dense(<span class="number">256</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">        layers.Dense(<span class="number">1</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>)</span><br><span class="line">    ])</span><br><span class="line">    <span class="keyword">return</span> model</span><br><span class="line"></span><br><span class="line"><span class="comment"># Instantiate models</span></span><br><span class="line">generator = build_generator()</span><br><span class="line">discriminator = build_discriminator()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create GAN model</span></span><br><span class="line">gan_input = tf.keras.Input(shape=(<span class="number">100</span>,))</span><br><span class="line">generated_img = generator(gan_input)</span><br><span class="line">discriminator.trainable = <span class="literal">False</span></span><br><span class="line">validity = discriminator(generated_img)</span><br><span class="line">gan = tf.keras.Model(gan_input, validity)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="3-Autoregressive-Models-AR"><a href="#3-Autoregressive-Models-AR" class="headerlink" title="3. Autoregressive Models (AR)"></a>3. Autoregressive Models (AR)</h2><p><a name="3-autoregressive-models-ar"></a></p>
<p><strong>Autoregressive Models</strong> predict the next data point based on previous data points. For example, in language models like <strong>Transformers</strong>, the model predicts the next word in a sentence based on the words that came before it.</p>
<h3 id="How-AR-Works"><a href="#How-AR-Works" class="headerlink" title="How AR Works:"></a>How AR Works:</h3><ul>
<li>It uses past information to predict future information.</li>
<li>Often used in natural language processing (NLP) and time series data.</li>
</ul>
<h3 id="Example-Diagram-Transformer"><a href="#Example-Diagram-Transformer" class="headerlink" title="Example Diagram (Transformer):"></a>Example Diagram (Transformer):</h3><p><img src="/images/Introduction-to-5-AI-Generation-Models/Development-of-autoregressive-models-based-on-Transformer-architecture-1-basic-model.png" alt="Transformer"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+</span><br><span class="line">|   Input Sequence  |</span><br><span class="line">|        x          |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|   Positional      |</span><br><span class="line">|   Encoding        |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|   Transformer     |</span><br><span class="line">|   Encoder         |</span><br><span class="line">|                   |</span><br><span class="line">|  - Multi-Head     |</span><br><span class="line">|    Attention      |</span><br><span class="line">|  - Feed-Forward   |</span><br><span class="line">|    Layers         |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|   Output Layer    |</span><br><span class="line">|                   |</span><br><span class="line">|  - Softmax        |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|   Predicted Token |</span><br><span class="line">|        y          |</span><br><span class="line">+-------------------+</span><br></pre></td></tr></table></figure>

<h3 id="Python-Code-Example-Using-AR"><a href="#Python-Code-Example-Using-AR" class="headerlink" title="Python Code Example (Using AR):"></a>Python Code Example (Using AR):</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example of a simple autoregressive model for time series data</span></span><br><span class="line">model = tf.keras.Sequential([</span><br><span class="line">    layers.Input(shape=(<span class="number">10</span>, <span class="number">1</span>)),</span><br><span class="line">    layers.SimpleRNN(<span class="number">50</span>, return_sequences=<span class="literal">True</span>),</span><br><span class="line">    layers.Dense(<span class="number">1</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">model.<span class="built_in">compile</span>(optimizer=<span class="string">&#x27;adam&#x27;</span>, loss=<span class="string">&#x27;mean_squared_error&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Dummy data</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">X = np.random.rand(<span class="number">1000</span>, <span class="number">10</span>, <span class="number">1</span>)</span><br><span class="line">y = np.random.rand(<span class="number">1000</span>, <span class="number">10</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Train the AR model</span></span><br><span class="line">model.fit(X, y, epochs=<span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="4-Flow-Models"><a href="#4-Flow-Models" class="headerlink" title="4. Flow Models"></a>4. Flow Models</h2><p><a name="4-flow-models"></a></p>
<p><strong>Flow Models</strong> are generative models that work by learning how to reverse a complex transformation back to a simple distribution, like a Gaussian distribution. They are designed to model complex data distributions.</p>
<h3 id="How-Flow-Models-Work"><a href="#How-Flow-Models-Work" class="headerlink" title="How Flow Models Work:"></a>How Flow Models Work:</h3><ul>
<li>They transform simple data distributions (e.g., Gaussian) into complex ones.</li>
<li>They are invertible, meaning the process can be reversed easily.</li>
</ul>
<h3 id="Example-Diagram-2"><a href="#Example-Diagram-2" class="headerlink" title="Example Diagram:"></a>Example Diagram:</h3><p><img src="/images/Introduction-to-5-AI-Generation-Models/The-flow-based-generative-models.png" alt="Flow Diagram"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+</span><br><span class="line">|   Simple          |</span><br><span class="line">|   Distribution    |</span><br><span class="line">|        z          |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|   Flow Model      |</span><br><span class="line">|                   |</span><br><span class="line">|  - Coupling Layers|</span><br><span class="line">|  - Invertible     |</span><br><span class="line">|    Transformations|</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|   Complex         |</span><br><span class="line">|   Distribution    |</span><br><span class="line">|        x          |</span><br><span class="line">+-------------------+</span><br></pre></td></tr></table></figure>

<h3 id="Python-Code-Example-2"><a href="#Python-Code-Example-2" class="headerlink" title="Python Code Example:"></a>Python Code Example:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> tensorflow_probability <span class="keyword">as</span> tfp</span><br><span class="line"></span><br><span class="line"><span class="comment"># Simple Normalizing Flow example</span></span><br><span class="line">tfd = tfp.distributions</span><br><span class="line"></span><br><span class="line">base_dist = tfd.MultivariateNormalDiag(loc=[<span class="number">0.</span>, <span class="number">0.</span>])</span><br><span class="line">flow = tfp.bijectors.RealNVP(num_masked=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Transformed distribution</span></span><br><span class="line">transformed_dist = tfd.TransformedDistribution(distribution=base_dist, bijector=flow)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sample from the flow model</span></span><br><span class="line">samples = transformed_dist.sample(<span class="number">1000</span>)</span><br><span class="line"><span class="built_in">print</span>(samples)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="5-Diffusion-Models"><a href="#5-Diffusion-Models" class="headerlink" title="5. Diffusion Models"></a>5. Diffusion Models</h2><p><a name="5-diffusion-models"></a></p>
<p><strong>Diffusion Models</strong> generate data by slowly adding random noise to a dataset and then learning to reverse the process. These models are great for creating realistic images from noise.</p>
<h3 id="How-Diffusion-Models-Work"><a href="#How-Diffusion-Models-Work" class="headerlink" title="How Diffusion Models Work:"></a>How Diffusion Models Work:</h3><ol>
<li>Noise is added to the data step by step.</li>
<li>The model learns to reverse this process, removing the noise and recovering the original data.</li>
</ol>
<h3 id="Example-Diagram-3"><a href="#Example-Diagram-3" class="headerlink" title="Example Diagram:"></a>Example Diagram:</h3><p><img src="/images/Introduction-to-5-AI-Generation-Models/Diffusion-Models.png" alt="Diffusion Models"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+</span><br><span class="line">|   Real Data       |</span><br><span class="line">|        x          |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|   Forward         |</span><br><span class="line">|   Diffusion       |</span><br><span class="line">|   Process         |</span><br><span class="line">|                   |</span><br><span class="line">|  - Add Noise      |</span><br><span class="line">|  - Gaussian Noise |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|   Noisy Data      |</span><br><span class="line">|        x_t        |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|   Reverse         |</span><br><span class="line">|   Diffusion       |</span><br><span class="line">|   Process         |</span><br><span class="line">|                   |</span><br><span class="line">|  - Denoise        |</span><br><span class="line">|  - Neural Network |</span><br><span class="line">+-------------------+</span><br><span class="line">         |</span><br><span class="line">         v</span><br><span class="line">+-------------------+</span><br><span class="line">|   Generated Data  |</span><br><span class="line">|        x_0        |</span><br><span class="line">+-------------------+</span><br></pre></td></tr></table></figure>

<h3 id="Python-Code-Example-3"><a href="#Python-Code-Example-3" class="headerlink" title="Python Code Example:"></a>Python Code Example:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DiffusionModel</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(DiffusionModel, <span class="variable language_">self</span>).__init__()</span><br><span class="line">        <span class="variable language_">self</span>.fc = nn.Linear(<span class="number">28</span>*<span class="number">28</span>, <span class="number">28</span>*<span class="number">28</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        noise = torch.randn_like(x)</span><br><span class="line">        <span class="keyword">return</span> x + noise</span><br><span class="line"></span><br><span class="line"><span class="comment"># Dummy diffusion process</span></span><br><span class="line">model = DiffusionModel()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example data (images flattened)</span></span><br><span class="line">X = torch.randn(<span class="number">64</span>, <span class="number">28</span>*<span class="number">28</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Adding noise through the model</span></span><br><span class="line">noisy_X = model(X)</span><br><span class="line"><span class="built_in">print</span>(noisy_X)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p><a name="conclusion"></a></p>
<p>Each of these models serves a different purpose in the field of AI. <strong>VAE</strong> and <strong>GAN</strong> are great for image generation, while <strong>AR</strong> models excel in sequential data like language or time series. <strong>Flow</strong> and <strong>Diffusion</strong> models are newer but powerful tools for generating complex, realistic data. Learning about these models can help you understand how machines can create art, music, text, and more!</p>
<h3 id="Key-Takeaways"><a href="#Key-Takeaways" class="headerlink" title="Key Takeaways:"></a>Key Takeaways:</h3><ul>
<li><strong>VAE</strong>: Generates new data by introducing randomness in the latent space.</li>
<li><strong>GAN</strong>: Uses adversarial training to improve the quality of generated data.</li>
<li><strong>AR</strong>: Predicts future data points based on past information.</li>
<li><strong>Flow Models</strong>: Transform simple distributions into complex ones using invertible transformations.</li>
<li><strong>Diffusion Models</strong>: Generate data by reversing a diffusion process that adds noise.</li>
</ul>
<p>By mastering these techniques, you can build robust and creative AI systems that generate high-quality content.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/22/Most-Beautiful-Mathematical-Equations/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/22/Most-Beautiful-Mathematical-Equations/" class="post-title-link" itemprop="url">Most Beautiful Mathematical Equations</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-22 00:18:01" itemprop="dateCreated datePublished" datetime="2024-10-22T00:18:01-04:00">2024-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Math/" itemprop="url" rel="index"><span itemprop="name">Math</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr>
<h3 id="Mass–energy-equivalence"><a href="#Mass–energy-equivalence" class="headerlink" title="Mass–energy equivalence"></a>Mass–energy equivalence</h3><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><mi>m</mi><msup><mi>c</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">E=mc^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord mathnormal">m</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>
<hr>
<h3 id="Euler’s-equation"><a href="#Euler’s-equation" class="headerlink" title="Euler’s equation"></a>Euler’s equation</h3><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mrow><mi>i</mi><mi>π</mi></mrow></msup><mo>+</mo><mn>1</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">e^{i\pi} + 1 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.908em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">iπ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>
<hr>
<h3 id="Pythagorean-theorem"><a href="#Pythagorean-theorem" class="headerlink" title="Pythagorean theorem"></a>Pythagorean theorem</h3><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mn>2</mn></msup><mo>+</mo><msup><mi>b</mi><mn>2</mn></msup><mo>=</mo><msup><mi>c</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">a^2 + b^2 = c^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/13/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Dazhi Zhang</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.1/mermaid.min.js","integrity":"sha256-YbM1pG3wWnzhyYN49g5fPnen+2CKEFaZfopkkwSpNtY="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  





</body>
</html>
