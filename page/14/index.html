<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.whereq.com","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.21.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="WhereQ">
<meta property="og:url" content="https://www.whereq.com/page/14/index.html">
<meta property="og:site_name" content="WhereQ">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Dazhi Zhang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.whereq.com/page/14/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/14/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>WhereQ</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">WhereQ</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-articles"><a href="/articles/" rel="section"><i class="fa fa-file fa-fw"></i>Articles</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Dazhi Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">149</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">132</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">87</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/24/Reactive-Programming-in-Spring-WebFlux-Series-VI/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/24/Reactive-Programming-in-Spring-WebFlux-Series-VI/" class="post-title-link" itemprop="url">Reactive Programming in Spring WebFlux Series - VI</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-24 14:06:43" itemprop="dateCreated datePublished" datetime="2024-10-24T14:06:43-04:00">2024-10-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/" itemprop="url" rel="index"><span itemprop="name">WebFlux</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/Spring-Boot/Reactive/" itemprop="url" rel="index"><span itemprop="name">Reactive</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#reactive-programming-in-complex-scenarios">Reactive Programming in Complex Scenarios</a><ul>
<li><a href="#complex-scenario-1-flow-control-and-backpressure-handling">Complex Scenario 1: Flow Control and Backpressure Handling</a><ul>
<li><a href="#1-using-limitrate">1. Using <code>limitRate</code></a></li>
<li><a href="#2-using-onbackpressurebuffer">2. Using <code>onBackpressureBuffer</code></a></li>
<li><a href="#3-using-onbackpressuredrop">3. Using <code>onBackpressureDrop</code></a></li>
</ul>
</li>
<li><a href="#complex-scenario-2-integrating-external-services">Complex Scenario 2: Integrating External Services</a><ul>
<li><a href="#1-using-webclient-to-call-rest-apis">1. Using <code>WebClient</code> to Call REST APIs</a></li>
<li><a href="#2-using-reactive-kafka-for-message-processing">2. Using Reactive Kafka for Message Processing</a></li>
</ul>
</li>
<li><a href="#complex-scenario-3-handling-large-files">Complex Scenario 3: Handling Large Files</a></li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#furthermore">Furthermore</a></li>
</ul>
</li>
</ul>
<hr>
<h1 id="Reactive-Programming-in-Complex-Scenarios"><a href="#Reactive-Programming-in-Complex-Scenarios" class="headerlink" title="Reactive Programming in Complex Scenarios"></a>Reactive Programming in Complex Scenarios</h1><p>In previous articles, we discussed the foundational concepts of Spring WebFlux, Reactor, error handling, data flow transformation, reactive database access, and performance optimization. This article explores how to apply reactive programming in complex scenarios, including flow control, backpressure handling, and integrating external services.</p>
<p><a name="complex-scenario-1-flow-control-and-backpressure-handling"></a></p>
<h2 id="Complex-Scenario-1-Flow-Control-and-Backpressure-Handling"><a href="#Complex-Scenario-1-Flow-Control-and-Backpressure-Handling" class="headerlink" title="Complex Scenario 1: Flow Control and Backpressure Handling"></a>Complex Scenario 1: Flow Control and Backpressure Handling</h2><p>In high-concurrency environments, controlling data flow and managing backpressure are critical for ensuring system stability. Backpressure occurs when downstream consumers cannot keep up with the speed of upstream producers, leading to data accumulation and resource exhaustion. Reactor provides various ways to handle backpressure issues.</p>
<h3 id="1-Using-limitRate"><a href="#1-Using-limitRate" class="headerlink" title="1. Using limitRate"></a>1. Using <code>limitRate</code></h3><p>The <code>limitRate</code> operator limits the amount of data requested at a time, thereby controlling the speed of data flow.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Flux.range(<span class="number">1</span>, <span class="number">1000</span>)</span><br><span class="line">    .limitRate(<span class="number">100</span>)</span><br><span class="line">    .subscribe(System.out::println);</span><br></pre></td></tr></table></figure>

<h3 id="2-Using-onBackpressureBuffer"><a href="#2-Using-onBackpressureBuffer" class="headerlink" title="2. Using onBackpressureBuffer"></a>2. Using <code>onBackpressureBuffer</code></h3><p>The <code>onBackpressureBuffer</code> operator buffers data during backpressure until the downstream can process it.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Flux.range(<span class="number">1</span>, <span class="number">1000</span>)</span><br><span class="line">    .onBackpressureBuffer(<span class="number">50</span>)</span><br><span class="line">    .subscribe(System.out::println);</span><br></pre></td></tr></table></figure>

<h3 id="3-Using-onBackpressureDrop"><a href="#3-Using-onBackpressureDrop" class="headerlink" title="3. Using onBackpressureDrop"></a>3. Using <code>onBackpressureDrop</code></h3><p>The <code>onBackpressureDrop</code> operator drops data during backpressure to prevent downstream overload.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Flux.range(<span class="number">1</span>, <span class="number">1000</span>)</span><br><span class="line">    .onBackpressureDrop()</span><br><span class="line">    .subscribe(System.out::println);</span><br></pre></td></tr></table></figure>

<p><a name="complex-scenario-2-integrating-external-services"></a></p>
<h2 id="Complex-Scenario-2-Integrating-External-Services"><a href="#Complex-Scenario-2-Integrating-External-Services" class="headerlink" title="Complex Scenario 2: Integrating External Services"></a>Complex Scenario 2: Integrating External Services</h2><p>In real projects, interactions with external services are common, such as calling REST APIs or using message queues. Spring WebFlux provides powerful integration capabilities.</p>
<h3 id="1-Using-WebClient-to-Call-REST-APIs"><a href="#1-Using-WebClient-to-Call-REST-APIs" class="headerlink" title="1. Using WebClient to Call REST APIs"></a>1. Using <code>WebClient</code> to Call REST APIs</h3><p><code>WebClient</code> is a non-blocking HTTP client provided by Spring WebFlux, suitable for interacting with external REST services.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.client.WebClient;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebClientExample</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">WebClient</span> <span class="variable">webClient</span> <span class="operator">=</span> WebClient.create(<span class="string">&quot;http://example.com&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;String&gt; <span class="title function_">fetchData</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> webClient.get()</span><br><span class="line">                .uri(<span class="string">&quot;/data&quot;</span>)</span><br><span class="line">                .retrieve()</span><br><span class="line">                .bodyToMono(String.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-Using-Reactive-Kafka-for-Message-Processing"><a href="#2-Using-Reactive-Kafka-for-Message-Processing" class="headerlink" title="2. Using Reactive Kafka for Message Processing"></a>2. Using Reactive Kafka for Message Processing</h3><p>Spring WebFlux integrates seamlessly with Reactive Kafka to achieve non-blocking message processing.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.kafka<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-kafka<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.kafka<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-kafka-reactive<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.kafka.annotation.KafkaListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.FluxSink;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KafkaConsumer</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> FluxSink&lt;String&gt; sink;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">KafkaConsumer</span><span class="params">(FluxSink&lt;String&gt; sink)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.sink = sink;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@KafkaListener(topics = &quot;example-topic&quot;, groupId = &quot;group_id&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">listen</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        sink.next(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="complex-scenario-3-handling-large-files"></a></p>
<h2 id="Complex-Scenario-3-Handling-Large-Files"><a href="#Complex-Scenario-3-Handling-Large-Files" class="headerlink" title="Complex Scenario 3: Handling Large Files"></a>Complex Scenario 3: Handling Large Files</h2><p>When processing large files, traditional reading methods can lead to excessive memory consumption. Using Spring WebFlux allows for non-blocking, streaming file processing.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.core.io.buffer.DataBuffer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.codec.multipart.FilePart;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.ServerRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.ServerResponse;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Flux;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileHandler</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Mono&lt;ServerResponse&gt; <span class="title function_">uploadFile</span><span class="params">(ServerRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> request.multipartData()</span><br><span class="line">                .flatMap(parts -&gt; &#123;</span><br><span class="line">                    <span class="type">FilePart</span> <span class="variable">filePart</span> <span class="operator">=</span> (FilePart) parts.toSingleValueMap().get(<span class="string">&quot;file&quot;</span>);</span><br><span class="line">                    Flux&lt;DataBuffer&gt; content = filePart.content();</span><br><span class="line">                    <span class="keyword">return</span> ServerResponse.ok().body(content, DataBuffer.class);</span><br><span class="line">                &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>In this article, we explored several strategies and methods for applying Spring WebFlux in complex scenarios. By effectively managing backpressure, integrating external services, and processing large files in a streaming fashion, we can build more robust and efficient reactive applications. </p>
<p><a name="furthermore"></a></p>
<h2 id="Furthermore"><a href="#Furthermore" class="headerlink" title="Furthermore"></a>Furthermore</h2><ol>
<li><strong>Kubernetes for Deployment</strong>: Consider deploying your reactive applications using Kubernetes for better scalability and management.</li>
<li><strong>Reactive Programming Patterns</strong>: Implement design patterns such as Circuit Breaker and Rate Limiter to enhance application resilience.</li>
<li><strong>Monitoring with Micrometer</strong>: Use Micrometer to instrument your reactive applications for better observability and performance metrics.</li>
<li><strong>Serverless Architecture</strong>: Explore serverless solutions to handle unpredictable workloads efficiently, integrating with AWS Lambda or Azure Functions.</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/24/Reactive-Programming-in-Spring-WebFlux-Series-V/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/24/Reactive-Programming-in-Spring-WebFlux-Series-V/" class="post-title-link" itemprop="url">Reactive Programming in Spring WebFlux Series - V</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-24 14:06:39" itemprop="dateCreated datePublished" datetime="2024-10-24T14:06:39-04:00">2024-10-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/" itemprop="url" rel="index"><span itemprop="name">WebFlux</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/Spring-Boot/Reactive/" itemprop="url" rel="index"><span itemprop="name">Reactive</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#reactive-database-access">Reactive Database Access</a><ul>
<li><a href="#why-choose-reactive-database-access">Why Choose Reactive Database Access?</a></li>
<li><a href="#spring-data-r2dbc">Spring Data R2DBC</a><ul>
<li><a href="#1-project-setup">1. Project Setup</a></li>
<li><a href="#2-database-connection-configuration">2. Database Connection Configuration</a></li>
<li><a href="#-3-data-model"> 3. Data Model</a></li>
<li><a href="#4-creating-a-repository">4. Creating a Repository</a></li>
<li><a href="#5-data-initialization">5. Data Initialization</a></li>
<li><a href="#6-handler-functions-and-route-configuration">6. Handler Functions and Route Configuration</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
<hr>
<h1 id="Reactive-Database-Access"><a href="#Reactive-Database-Access" class="headerlink" title="Reactive Database Access"></a>Reactive Database Access</h1><hr>
<p><a name="why-choose-reactive-database-access"></a></p>
<h2 id="Why-Choose-Reactive-Database-Access"><a href="#Why-Choose-Reactive-Database-Access" class="headerlink" title="Why Choose Reactive Database Access?"></a>Why Choose Reactive Database Access?</h2><p>Traditional database access methods are usually blocking, meaning that when a query is executing, the thread is blocked until the query is completed. This can lead to performance bottlenecks in highly concurrent environments. Reactive database access uses non-blocking I&#x2F;O operations, allowing applications to handle more concurrent requests, improving system throughput and response times.</p>
<hr>
<p><a name="spring-data-r2dbc"></a></p>
<h2 id="Spring-Data-R2DBC"><a href="#Spring-Data-R2DBC" class="headerlink" title="Spring Data R2DBC"></a>Spring Data R2DBC</h2><p>Spring Data R2DBC (Reactive Relational Database Connectivity) is a project in the Spring ecosystem that provides reactive programming support for relational databases. R2DBC is a new database connection specification designed to support reactive programming models.</p>
<p><a name="project-setup"></a></p>
<h3 id="1-Project-Setup"><a href="#1-Project-Setup" class="headerlink" title="1. Project Setup"></a>1. Project Setup</h3><p>First, create a Spring Boot project and include the necessary dependencies:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-r2dbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.r2dbc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>r2dbc-h2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a name="database-connection-configuration"></a></p>
<h3 id="2-Database-Connection-Configuration"><a href="#2-Database-Connection-Configuration" class="headerlink" title="2. Database Connection Configuration"></a>2. Database Connection Configuration</h3><p>Configure the H2 database in <code>application.properties</code>:</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.r2dbc.url</span>=<span class="string">r2dbc:h2:mem:///testdb</span></span><br><span class="line"><span class="attr">spring.r2dbc.username</span>=<span class="string">sa</span></span><br><span class="line"><span class="attr">spring.r2dbc.password</span>=<span class="string"></span></span><br><span class="line"><span class="attr">spring.r2dbc.generate-unique-name</span>=<span class="string">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring.h2.console.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">spring.h2.console.settings.web-allow-others</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure>

<h3 id="3-Data-Model"><a href="#3-Data-Model" class="headerlink" title=" 3. Data Model"></a><a name="data-model"></a> 3. Data Model</h3><p>Define a simple <code>User</code> entity:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.data.annotation.Id;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.relational.core.mapping.Table;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Table(&quot;users&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Getters and Setters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="creating-a-repository"></a></p>
<h3 id="4-Creating-a-Repository"><a href="#4-Creating-a-Repository" class="headerlink" title="4. Creating a Repository"></a>4. Creating a Repository</h3><p>Create a reactive <code>UserRepository</code> interface:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.data.repository.reactive.ReactiveCrudRepository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserRepository</span> <span class="keyword">extends</span> <span class="title class_">ReactiveCrudRepository</span>&lt;User, Long&gt; &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="data-initialization"></a></p>
<h3 id="5-Data-Initialization"><a href="#5-Data-Initialization" class="headerlink" title="5. Data Initialization"></a>5. Data Initialization</h3><p>Use an initializer class to preload some data:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.CommandLineRunner;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Flux;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataInitializer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    CommandLineRunner <span class="title function_">init</span><span class="params">(UserRepository repository)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> args -&gt; &#123;</span><br><span class="line">            Flux&lt;User&gt; userFlux = Flux.just(</span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">User</span>(<span class="literal">null</span>, <span class="string">&quot;John Doe&quot;</span>),</span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">User</span>(<span class="literal">null</span>, <span class="string">&quot;Jane Doe&quot;</span>),</span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">User</span>(<span class="literal">null</span>, <span class="string">&quot;Sam Smith&quot;</span>))</span><br><span class="line">                .flatMap(repository::save);</span><br><span class="line"></span><br><span class="line">            userFlux</span><br><span class="line">                .thenMany(repository.findAll())</span><br><span class="line">                .subscribe(user -&gt; System.out.println(<span class="string">&quot;Saving &quot;</span> + user.toString()));</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="handler-functions-and-route-configuration"></a></p>
<h3 id="6-Handler-Functions-and-Route-Configuration"><a href="#6-Handler-Functions-and-Route-Configuration" class="headerlink" title="6. Handler Functions and Route Configuration"></a>6. Handler Functions and Route Configuration</h3><p>Create handler functions and route configurations to handle HTTP requests and return responses:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.RouterFunction;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.ServerRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.ServerResponse;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.RouterFunctions;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserHandler</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> UserRepository userRepository;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserHandler</span><span class="params">(UserRepository userRepository)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userRepository = userRepository;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;ServerResponse&gt; <span class="title function_">getUser</span><span class="params">(ServerRequest request)</span> &#123;</span><br><span class="line">        <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> Long.valueOf(request.pathVariable(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> userRepository.findById(userId)</span><br><span class="line">            .flatMap(user -&gt; ServerResponse.ok().body(Mono.just(user), User.class))</span><br><span class="line">            .switchIfEmpty(ServerResponse.notFound().build());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;ServerResponse&gt; <span class="title function_">getAllUsers</span><span class="params">(ServerRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ServerResponse.ok().body(userRepository.findAll(), User.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;ServerResponse&gt; <span class="title function_">createUser</span><span class="params">(ServerRequest request)</span> &#123;</span><br><span class="line">        Mono&lt;User&gt; userMono = request.bodyToMono(User.class);</span><br><span class="line">        <span class="keyword">return</span> userMono.flatMap(userRepository::save)</span><br><span class="line">            .flatMap(user -&gt; ServerResponse.ok().body(Mono.just(user), User.class));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RouterConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RouterFunction&lt;ServerResponse&gt; <span class="title function_">route</span><span class="params">(UserHandler handler)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> RouterFunctions.route()</span><br><span class="line">            .GET(<span class="string">&quot;/user/&#123;id&#125;&quot;</span>, handler::getUser)</span><br><span class="line">            .GET(<span class="string">&quot;/users&quot;</span>, handler::getAllUsers)</span><br><span class="line">            .POST(<span class="string">&quot;/user&quot;</span>, handler::createUser)</span><br><span class="line">            .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>In this article, we explored how to perform reactive database access in Spring WebFlux. With Spring Data R2DBC, we can easily achieve non-blocking access to relational databases, greatly improving the performance and concurrency handling of applications.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/24/Reactive-Programming-in-Spring-WebFlux-Series-IV/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/24/Reactive-Programming-in-Spring-WebFlux-Series-IV/" class="post-title-link" itemprop="url">Reactive Programming in Spring WebFlux Series - IV</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-24 14:06:07" itemprop="dateCreated datePublished" datetime="2024-10-24T14:06:07-04:00">2024-10-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/" itemprop="url" rel="index"><span itemprop="name">WebFlux</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/Spring-Boot/Reactive/" itemprop="url" rel="index"><span itemprop="name">Reactive</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#data-stream-transformation-and-operations">Data Stream Transformation and Operations</a><ul>
<li><a href="#data-stream-transformation">Data Stream Transformation</a><ul>
<li><a href="#1-map-operator">1. map Operator</a></li>
<li><a href="#2-flatmap-operator">2. flatMap Operator</a></li>
<li><a href="#3-filter-operator">3. filter Operator</a></li>
<li><a href="#4-reduce-operator">4. reduce Operator</a></li>
</ul>
</li>
<li><a href="#practical-example-building-a-complex-data-stream-processing-application">Practical Example: Building a Complex Data Stream Processing Application</a><ul>
<li><a href="#1-project-setup">1. Project Setup</a></li>
<li><a href="#2-data-model">2. Data Model</a></li>
<li><a href="#3-mock-data-source">3. Mock Data Source</a></li>
<li><a href="#4-handler-functions-and-route-configuration">4. Handler Functions and Route Configuration</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
<hr>
<h1 id="Data-Stream-Transformation-and-Operations"><a href="#Data-Stream-Transformation-and-Operations" class="headerlink" title="Data Stream Transformation and Operations"></a>Data Stream Transformation and Operations</h1><hr>
<p><a name="data-stream-transformation"></a> </p>
<h2 id="Data-Stream-Transformation"><a href="#Data-Stream-Transformation" class="headerlink" title="Data Stream Transformation"></a>Data Stream Transformation</h2><p>In reactive programming, transforming and operating on data streams is a core aspect. Using different operators, we can handle data streams flexibly, applying transformations, filtering, aggregating, and more. Below are some common data stream operations and examples.</p>
<p><a name="map-operator"></a></p>
<h3 id="1-map-Operator"><a href="#1-map-Operator" class="headerlink" title="1. map Operator"></a>1. map Operator</h3><p>The <code>map</code> operator transforms each element in a data stream. It takes a function as an argument and applies it to each element.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Flux&lt;Integer&gt; numbers = Flux.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">    .map(n -&gt; n * n);</span><br><span class="line"></span><br><span class="line">numbers.subscribe(System.out::println); <span class="comment">// Output: 1, 4, 9, 16, 25</span></span><br></pre></td></tr></table></figure>

<p><a name="flatmap-operator"></a></p>
<h3 id="2-flatMap-Operator"><a href="#2-flatMap-Operator" class="headerlink" title="2. flatMap Operator"></a>2. flatMap Operator</h3><p>The <code>flatMap</code> operator maps each element to a new <code>Publisher</code> and merges them into a single <code>Flux</code>. It is often used for asynchronous processing.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Flux&lt;String&gt; ids = Flux.just(<span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>);</span><br><span class="line">Flux&lt;User&gt; users = ids.flatMap(id -&gt; userRepository.findById(id));</span><br><span class="line"></span><br><span class="line">users.subscribe(System.out::println);</span><br></pre></td></tr></table></figure>

<p><a name="filter-operator"></a></p>
<h3 id="3-filter-Operator"><a href="#3-filter-Operator" class="headerlink" title="3. filter Operator"></a>3. filter Operator</h3><p>The <code>filter</code> operator filters data streams, keeping only elements that meet a certain condition.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Flux&lt;Integer&gt; numbers = Flux.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">    .filter(n -&gt; n % <span class="number">2</span> == <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">numbers.subscribe(System.out::println); <span class="comment">// Output: 2, 4</span></span><br></pre></td></tr></table></figure>

<p><a name="reduce-operator"></a></p>
<h3 id="4-reduce-Operator"><a href="#4-reduce-Operator" class="headerlink" title="4. reduce Operator"></a>4. reduce Operator</h3><p>The <code>reduce</code> operator aggregates all elements in a data stream into a single value. It takes an accumulator function, combining the previous result with the current element.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Flux&lt;Integer&gt; numbers = Flux.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">Mono&lt;Integer&gt; sum = numbers.reduce((a, b) -&gt; a + b);</span><br><span class="line"></span><br><span class="line">sum.subscribe(System.out::println); <span class="comment">// Output: 15</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="practical-example-building-a-complex-data-stream-processing-application"></a></p>
<h2 id="Practical-Example-Building-a-Complex-Data-Stream-Processing-Application"><a href="#Practical-Example-Building-a-Complex-Data-Stream-Processing-Application" class="headerlink" title="Practical Example: Building a Complex Data Stream Processing Application"></a>Practical Example: Building a Complex Data Stream Processing Application</h2><p>Below is an example showing how to use these operators to build a complex reactive application in Spring WebFlux.</p>
<p><a name="project-setup"></a></p>
<h3 id="1-Project-Setup"><a href="#1-Project-Setup" class="headerlink" title="1. Project Setup"></a>1. Project Setup</h3><p>Ensure that the following dependencies are included in your project:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.projectreactor<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>reactor-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a name="data-model"></a></p>
<h3 id="2-Data-Model"><a href="#2-Data-Model" class="headerlink" title="2. Data Model"></a>2. Data Model</h3><p>Define a simple user data model:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Constructors, Getters and Setters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="mock-data-source"></a></p>
<h3 id="3-Mock-Data-Source"><a href="#3-Mock-Data-Source" class="headerlink" title="3. Mock Data Source"></a>3. Mock Data Source</h3><p>Create a mock data source:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> reactor.core.publisher.Flux;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserRepository</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> List&lt;User&gt; users = Arrays.asList(</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;1&quot;</span>, <span class="string">&quot;John Doe&quot;</span>),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;2&quot;</span>, <span class="string">&quot;Jane Doe&quot;</span>),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;3&quot;</span>, <span class="string">&quot;Sam Smith&quot;</span>)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;User&gt; <span class="title function_">findById</span><span class="params">(String id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Mono.justOrEmpty(users.stream()</span><br><span class="line">            .filter(user -&gt; user.getId().equals(id))</span><br><span class="line">            .findFirst());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Flux&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Flux.fromIterable(users);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="handler-functions-and-route-configuration"></a></p>
<h3 id="4-Handler-Functions-and-Route-Configuration"><a href="#4-Handler-Functions-and-Route-Configuration" class="headerlink" title="4. Handler Functions and Route Configuration"></a>4. Handler Functions and Route Configuration</h3><p>Set up handler functions and route configuration:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.RouterFunction;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.ServerRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.ServerResponse;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.RouterFunctions;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserHandler</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> UserRepository userRepository;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserHandler</span><span class="params">(UserRepository userRepository)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userRepository = userRepository;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;ServerResponse&gt; <span class="title function_">getUser</span><span class="params">(ServerRequest request)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">userId</span> <span class="operator">=</span> request.pathVariable(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> userRepository.findById(userId)</span><br><span class="line">            .flatMap(user -&gt; ServerResponse.ok().body(Mono.just(user), User.class))</span><br><span class="line">            .switchIfEmpty(ServerResponse.notFound().build());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;ServerResponse&gt; <span class="title function_">getAllUsers</span><span class="params">(ServerRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ServerResponse.ok().body(userRepository.findAll(), User.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RouterConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RouterFunction&lt;ServerResponse&gt; <span class="title function_">route</span><span class="params">(UserHandler handler)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> RouterFunctions.route()</span><br><span class="line">            .GET(<span class="string">&quot;/user/&#123;id&#125;&quot;</span>, handler::getUser)</span><br><span class="line">            .GET(<span class="string">&quot;/users&quot;</span>, handler::getAllUsers)</span><br><span class="line">            .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>In this article, we explored how to transform and operate on data streams in Spring WebFlux. Using different operators, we can flexibly handle data streams, building complex reactive applications.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/24/Reactive-Programming-in-Spring-WebFlux-Series-III/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/24/Reactive-Programming-in-Spring-WebFlux-Series-III/" class="post-title-link" itemprop="url">Reactive Programming in Spring WebFlux Series - III</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-24 13:57:04" itemprop="dateCreated datePublished" datetime="2024-10-24T13:57:04-04:00">2024-10-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/" itemprop="url" rel="index"><span itemprop="name">WebFlux</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/Spring-Boot/Reactive/" itemprop="url" rel="index"><span itemprop="name">Reactive</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#error-handling-and-debugging">Error Handling and Debugging</a><ul>
<li><a href="#error-handling">Error Handling</a><ul>
<li><a href="#1-onerrorreturn">1. onErrorReturn</a></li>
<li><a href="#2-onerrorresume">2. onErrorResume</a></li>
<li><a href="#3-onerrormap">3. onErrorMap</a></li>
<li><a href="#global-error-handling-in-webflux">Global Error Handling in WebFlux</a></li>
<li><a href="#1-defining-a-custom-exception-class">1. Defining a Custom Exception Class</a></li>
<li><a href="#2-creating-an-exception-handler">2. Creating an Exception Handler</a></li>
<li><a href="#debugging-reactive-applications">Debugging Reactive Applications</a></li>
<li><a href="#1-using-the-log-operator">1. Using the log Operator</a></li>
<li><a href="#2-breakpoint-debugging">2. Breakpoint Debugging</a></li>
<li><a href="#-3-using-reactor-debugger"> 3. Using Reactor Debugger</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
<hr>
<h1 id="Error-Handling-and-Debugging"><a href="#Error-Handling-and-Debugging" class="headerlink" title="Error Handling and Debugging"></a>Error Handling and Debugging</h1><hr>
<p><a name="error-handling"></a> </p>
<h2 id="Error-Handling"><a href="#Error-Handling" class="headerlink" title="Error Handling"></a>Error Handling</h2><p>Error handling in reactive programming is different from traditional synchronous programming due to the asynchronous nature of reactive streams. In Reactor, errors are handled in various ways:</p>
<p><a name="onerrorreturn"></a> </p>
<h3 id="1-onErrorReturn"><a href="#1-onErrorReturn" class="headerlink" title="1. onErrorReturn"></a>1. onErrorReturn</h3><p>This operator allows returning a default value when an error occurs. Example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Flux&lt;String&gt; flux = Flux.just(<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>)</span><br><span class="line">    .concatWith(Flux.error(<span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Exception occurred&quot;</span>)))</span><br><span class="line">    .onErrorReturn(<span class="string">&quot;Default&quot;</span>);</span><br><span class="line"></span><br><span class="line">flux.subscribe(System.out::println);</span><br></pre></td></tr></table></figure>

<p>In this example, when an error occurs, the default value <code>&quot;Default&quot;</code> is returned.</p>
<p><a name="onerrorresume"></a></p>
<h3 id="2-onErrorResume"><a href="#2-onErrorResume" class="headerlink" title="2. onErrorResume"></a>2. onErrorResume</h3><p>This operator allows switching to another <code>Publisher</code> when an error occurs. Example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Flux&lt;String&gt; flux = Flux.just(<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>)</span><br><span class="line">    .concatWith(Flux.error(<span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Exception occurred&quot;</span>)))</span><br><span class="line">    .onErrorResume(e -&gt; &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Error: &quot;</span> + e.getMessage());</span><br><span class="line">        <span class="keyword">return</span> Flux.just(<span class="string">&quot;D&quot;</span>, <span class="string">&quot;E&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">flux.subscribe(System.out::println);</span><br></pre></td></tr></table></figure>

<p>Here, when an error occurs, it switches to another <code>Flux</code> sequence to continue processing new data.</p>
<p><a name="onerrormap"></a></p>
<h3 id="3-onErrorMap"><a href="#3-onErrorMap" class="headerlink" title="3. onErrorMap"></a>3. onErrorMap</h3><p>This operator allows converting an error into a different type of error. Example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Flux&lt;String&gt; flux = Flux.just(<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>)</span><br><span class="line">    .concatWith(Flux.error(<span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Exception occurred&quot;</span>)))</span><br><span class="line">    .onErrorMap(e -&gt; <span class="keyword">new</span> <span class="title class_">CustomException</span>(<span class="string">&quot;Custom message&quot;</span>, e));</span><br><span class="line"></span><br><span class="line">flux.subscribe(System.out::println, e -&gt; System.out.println(<span class="string">&quot;Error: &quot;</span> + e.getMessage()));</span><br></pre></td></tr></table></figure>

<p>In this case, a <code>RuntimeException</code> is converted into a custom <code>CustomException</code>.</p>
<hr>
<p><a name="global-error-handling-in-webflux"></a></p>
<h3 id="Global-Error-Handling-in-WebFlux"><a href="#Global-Error-Handling-in-WebFlux" class="headerlink" title="Global Error Handling in WebFlux"></a>Global Error Handling in WebFlux</h3><p>In addition to handling errors in streams, Spring WebFlux also allows defining a global error handler for managing errors across the application.</p>
<p><a name="defining-a-custom-exception-class"></a></p>
<h3 id="1-Defining-a-Custom-Exception-Class"><a href="#1-Defining-a-Custom-Exception-Class" class="headerlink" title="1. Defining a Custom Exception Class"></a>1. Defining a Custom Exception Class</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomException</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CustomException</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="creating-an-exception-handler"></a></p>
<h3 id="2-Creating-an-Exception-Handler"><a href="#2-Creating-an-Exception-Handler" class="headerlink" title="2. Creating an Exception Handler"></a>2. Creating an Exception Handler</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.core.annotation.Order;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.HttpStatus;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.ServerRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.ServerResponse;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.ServerResponse.BodyBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.server.ServerWebExchange;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.server.WebExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Order(-2)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalErrorHandler</span> <span class="keyword">implements</span> <span class="title class_">WebExceptionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;Void&gt; <span class="title function_">handle</span><span class="params">(ServerWebExchange exchange, Throwable ex)</span> &#123;</span><br><span class="line">        <span class="type">BodyBuilder</span> <span class="variable">response</span> <span class="operator">=</span> ServerResponse.status(HttpStatus.INTERNAL_SERVER_ERROR)</span><br><span class="line">                .contentType(MediaType.APPLICATION_JSON);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ex <span class="keyword">instanceof</span> CustomException) &#123;</span><br><span class="line">            response = ServerResponse.status(HttpStatus.BAD_REQUEST);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response.bodyValue(<span class="keyword">new</span> <span class="title class_">ErrorResponse</span>(ex.getMessage()))</span><br><span class="line">                .flatMap(resp -&gt; resp.writeTo(exchange, <span class="keyword">new</span> <span class="title class_">Context</span>()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ErrorResponse</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> String message;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ErrorResponse</span><span class="params">(String message)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.message = message;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> message;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="debugging-reactive-applications"></a></p>
<h3 id="Debugging-Reactive-Applications"><a href="#Debugging-Reactive-Applications" class="headerlink" title="Debugging Reactive Applications"></a>Debugging Reactive Applications</h3><p>Debugging reactive applications can be more challenging than debugging traditional synchronous applications. Here are some debugging techniques:</p>
<p><a name="using-the-log-operator"></a></p>
<h3 id="1-Using-the-log-Operator"><a href="#1-Using-the-log-Operator" class="headerlink" title="1. Using the log Operator"></a>1. Using the log Operator</h3><p>Reactor provides the <code>log</code> operator to output log information for each step. Example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Flux&lt;String&gt; flux = Flux.just(<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>)</span><br><span class="line">    .concatWith(Flux.error(<span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Exception occurred&quot;</span>)))</span><br><span class="line">    .log();</span><br><span class="line"></span><br><span class="line">flux.subscribe(System.out::println);</span><br></pre></td></tr></table></figure>

<p><a name="breakpoint-debugging"></a></p>
<h3 id="2-Breakpoint-Debugging"><a href="#2-Breakpoint-Debugging" class="headerlink" title="2. Breakpoint Debugging"></a>2. Breakpoint Debugging</h3><p>Setting breakpoints in an IDE allows you to step through the execution. Be mindful of thread switching and asynchronous execution details when debugging reactive code.</p>
<h3 id="3-Using-Reactor-Debugger"><a href="#3-Using-Reactor-Debugger" class="headerlink" title=" 3. Using Reactor Debugger"></a><a name="using-reactor-debugger"></a> 3. Using Reactor Debugger</h3><p>Reactor provides a special debug tool <code>Hooks.onOperatorDebug</code> to help understand and debug operations in reactive streams.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Hooks.onOperatorDebug();</span><br><span class="line"></span><br><span class="line">Flux&lt;String&gt; flux = Flux.just(<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>)</span><br><span class="line">    .concatWith(Flux.error(<span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Exception occurred&quot;</span>)));</span><br><span class="line"></span><br><span class="line">flux.subscribe(System.out::println);</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>In this article, we explored how to handle errors and debug reactive applications in Spring WebFlux, providing techniques for both stream-level and global error handling.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/24/Reactive-Programming-in-Spring-WebFlux-Series-II/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/24/Reactive-Programming-in-Spring-WebFlux-Series-II/" class="post-title-link" itemprop="url">Reactive Programming in Spring WebFlux Series - II</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-24 13:10:13" itemprop="dateCreated datePublished" datetime="2024-10-24T13:10:13-04:00">2024-10-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/" itemprop="url" rel="index"><span itemprop="name">WebFlux</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/Spring-Boot/Reactive/" itemprop="url" rel="index"><span itemprop="name">Reactive</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h2><ul>
<li><a href="#in-depth-understanding-of-reactor-and-asynchronous-data-streams">In-depth Understanding of Reactor and Asynchronous Data Streams</a><ul>
<li><a href="#introduction-to-reactor">Introduction to Reactor</a></li>
<li><a href="#mono-and-flux">Mono and Flux</a><ul>
<li><a href="#mono">Mono</a></li>
<li><a href="#flux">Flux</a></li>
</ul>
</li>
<li><a href="#basic-operations">Basic Operations</a></li>
<li><a href="#practical-example-building-a-reactive-application-with-reactor">Practical Example: Building a Reactive Application with Reactor</a><ul>
<li><a href="#1-project-setup">1. Project Setup</a></li>
<li><a href="#2-define-data-model">2. Define Data Model</a></li>
<li><a href="#3-simulated-data-source">3. Simulated Data Source</a></li>
<li><a href="#4-handlers-and-router-configuration">4. Handlers and Router Configuration</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
<hr>
<h1 id="In-depth-Understanding-of-Reactor-and-Asynchronous-Data-Streams"><a href="#In-depth-Understanding-of-Reactor-and-Asynchronous-Data-Streams" class="headerlink" title="In-depth Understanding of Reactor and Asynchronous Data Streams"></a>In-depth Understanding of Reactor and Asynchronous Data Streams</h1><hr>
<p><a name="introduction-to-reactor"></a> </p>
<h2 id="Introduction-to-Reactor"><a href="#Introduction-to-Reactor" class="headerlink" title="Introduction to Reactor"></a>Introduction to Reactor</h2><p>Reactor is at the core of Spring WebFlux, providing powerful reactive programming support based on the Reactive Streams standard. Reactor mainly offers two core classes: <strong>Mono</strong> and <strong>Flux</strong>, which are used to represent asynchronous sequences of one or multiple elements, respectively.</p>
<hr>
<p><a name="mono-and-flux"></a></p>
<h2 id="Mono-and-Flux"><a href="#Mono-and-Flux" class="headerlink" title="Mono and Flux"></a>Mono and Flux</h2><p><a name="mono"></a></p>
<h3 id="Mono"><a href="#Mono" class="headerlink" title="Mono"></a>Mono</h3><p>Mono represents an asynchronous sequence of 0 or 1 element. It is typically used when dealing with operations that might return a single result or no result at all.</p>
<p><a name="flux"></a></p>
<h3 id="Flux"><a href="#Flux" class="headerlink" title="Flux"></a>Flux</h3><p>Flux represents an asynchronous sequence of 0 to N elements. It is suitable for cases where multiple results need to be handled, such as querying a database that returns multiple records.</p>
<hr>
<p><a name="basic-operations"></a></p>
<h2 id="Basic-Operations"><a href="#Basic-Operations" class="headerlink" title="Basic Operations"></a>Basic Operations</h2><p>Reactor provides a rich set of operators for manipulating data streams, such as transformations, filtering, and aggregations. Some of the commonly used operators include:</p>
<ul>
<li><strong>map</strong>: Transforms each element in the data stream.</li>
<li><strong>filter</strong>: Filters elements in the data stream, retaining only those that meet the criteria.</li>
<li><strong>flatMap</strong>: Maps each element to a new Publisher and merges these Publishers into a single Flux.</li>
<li><strong>concatMap</strong>: Similar to flatMap but maintains the order of the elements.</li>
<li><strong>zip</strong>: Combines multiple Publishers by pairing elements based on their indices.</li>
</ul>
<hr>
<p><a name="practical-example-building-a-reactive-application-with-reactor"></a></p>
<h2 id="Practical-Example-Building-a-Reactive-Application-with-Reactor"><a href="#Practical-Example-Building-a-Reactive-Application-with-Reactor" class="headerlink" title="Practical Example: Building a Reactive Application with Reactor"></a>Practical Example: Building a Reactive Application with Reactor</h2><p><a name="1-project-setup"></a></p>
<h3 id="1-Project-Setup"><a href="#1-Project-Setup" class="headerlink" title="1. Project Setup"></a>1. Project Setup</h3><p>Ensure your project contains the following dependencies:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.projectreactor<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>reactor-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a name="2-define-data-model"></a></p>
<h3 id="2-Define-Data-Model"><a href="#2-Define-Data-Model" class="headerlink" title="2. Define Data Model"></a>2. Define Data Model</h3><p>Define a simple user data model:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Constructors, Getters and Setters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="3-simulated-data-source"></a></p>
<h3 id="3-Simulated-Data-Source"><a href="#3-Simulated-Data-Source" class="headerlink" title="3. Simulated Data Source"></a>3. Simulated Data Source</h3><p>Create a simulated data source to generate user data:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> reactor.core.publisher.Flux;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserRepository</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> List&lt;User&gt; users = Arrays.asList(</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;1&quot;</span>, <span class="string">&quot;John Doe&quot;</span>),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;2&quot;</span>, <span class="string">&quot;Jane Doe&quot;</span>),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;3&quot;</span>, <span class="string">&quot;Sam Smith&quot;</span>)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;User&gt; <span class="title function_">findById</span><span class="params">(String id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Mono.justOrEmpty(users.stream()</span><br><span class="line">            .filter(user -&gt; user.getId().equals(id))</span><br><span class="line">            .findFirst());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Flux&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Flux.fromIterable(users);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="4-handlers-and-router-configuration"></a></p>
<h3 id="4-Handlers-and-Router-Configuration"><a href="#4-Handlers-and-Router-Configuration" class="headerlink" title="4. Handlers and Router Configuration"></a>4. Handlers and Router Configuration</h3><p>Create handler functions and router configurations to handle HTTP requests and return responses:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.RouterFunction;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.ServerRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.ServerResponse;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.reactive.function.server.RouterFunctions;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserHandler</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> UserRepository userRepository;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserHandler</span><span class="params">(UserRepository userRepository)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userRepository = userRepository;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;ServerResponse&gt; <span class="title function_">getUser</span><span class="params">(ServerRequest request)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">userId</span> <span class="operator">=</span> request.pathVariable(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> userRepository.findById(userId)</span><br><span class="line">            .flatMap(user -&gt; ServerResponse.ok().body(Mono.just(user), User.class))</span><br><span class="line">            .switchIfEmpty(ServerResponse.notFound().build());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;ServerResponse&gt; <span class="title function_">getAllUsers</span><span class="params">(ServerRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ServerResponse.ok().body(userRepository.findAll(), User.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RouterConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RouterFunction&lt;ServerResponse&gt; <span class="title function_">route</span><span class="params">(UserHandler handler)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> RouterFunctions.route()</span><br><span class="line">            .GET(<span class="string">&quot;/user/&#123;id&#125;&quot;</span>, handler::getUser)</span><br><span class="line">            .GET(<span class="string">&quot;/users&quot;</span>, handler::getAllUsers)</span><br><span class="line">            .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a> </p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>In this article, we took a deep dive into Reactor and its application in Spring WebFlux. By understanding <strong>Mono</strong> and <strong>Flux</strong> and how to handle asynchronous data streams with these tools, we can build more efficient reactive applications.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/24/Reactive-Programming-in-Spring-WebFlux-Series-I/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/24/Reactive-Programming-in-Spring-WebFlux-Series-I/" class="post-title-link" itemprop="url">Reactive Programming in Spring WebFlux Series - I </a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-24 12:55:22" itemprop="dateCreated datePublished" datetime="2024-10-24T12:55:22-04:00">2024-10-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/" itemprop="url" rel="index"><span itemprop="name">WebFlux</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/WebFlux/Spring-Boot/Reactive/" itemprop="url" rel="index"><span itemprop="name">Reactive</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#overview-and-fundamentals">Overview and Fundamentals</a><ul>
<li><a href="#what-is-reactive-programming">What is Reactive Programming?</a></li>
<li><a href="#why-choose-spring-webflux">Why Choose Spring WebFlux?</a></li>
<li><a href="#core-concepts-and-components">Core Concepts and Components</a><ul>
<li><a href="#1-reactive-streams">1. Reactive Streams</a></li>
<li><a href="#2-project-reactor">2. Project Reactor</a></li>
<li><a href="#3-webflux">3. WebFlux</a></li>
</ul>
</li>
<li><a href="#practical-example-building-a-simple-webflux-application">Practical Example: Building a Simple WebFlux Application</a><ul>
<li><a href="#1-project-setup">1. Project Setup</a></li>
<li><a href="#2-define-data-model">2. Define Data Model</a></li>
<li><a href="#3-create-handler-and-router">3. Create Handler and Router</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
<hr>
<h1 id="Overview-and-Fundamentals"><a href="#Overview-and-Fundamentals" class="headerlink" title="Overview and Fundamentals"></a>Overview and Fundamentals</h1><p><a name="what-is-reactive-programming"></a> </p>
<h2 id="What-is-Reactive-Programming"><a href="#What-is-Reactive-Programming" class="headerlink" title="What is Reactive Programming?"></a>What is Reactive Programming?</h2><p>Reactive programming is a programming paradigm oriented around data flows and the propagation of changes. Unlike traditional imperative programming, reactive programming allows you to declare data dependencies, and changes are automatically propagated when the data source changes. The core idea of reactive programming involves asynchronous data stream processing and non-blocking operations, making applications more efficient in utilizing system resources.</p>
<hr>
<p><a name="why-choose-spring-webflux"></a> </p>
<h2 id="Why-Choose-Spring-WebFlux"><a href="#Why-Choose-Spring-WebFlux" class="headerlink" title="Why Choose Spring WebFlux?"></a>Why Choose Spring WebFlux?</h2><p>Spring WebFlux is an asynchronous, non-blocking web framework introduced in Spring 5 that handles non-blocking asynchronous requests. Unlike traditional Spring MVC, Spring WebFlux is built on the Reactive Streams specification and supports a fully non-blocking reactive programming model. Some key reasons to choose Spring WebFlux include:</p>
<ul>
<li><strong>Non-blocking I&#x2F;O</strong>: Allows handling of more concurrent requests, improving system throughput and response times.</li>
<li><strong>Reactive Programming Model</strong>: Offers reactive programming support based on Project Reactor, making the code more concise and maintainable.</li>
<li><strong>Flexible Programming Model</strong>: Supports both annotation-driven and functional programming models, catering to different developer needs.</li>
<li><strong>High Scalability</strong>: Ideal for microservices and distributed systems, making it easy to scale and integrate.</li>
</ul>
<hr>
<p><a name="core-concepts-and-components"></a> </p>
<h2 id="Core-Concepts-and-Components"><a href="#Core-Concepts-and-Components" class="headerlink" title="Core Concepts and Components"></a>Core Concepts and Components</h2><p><a name="1-reactive-streams"></a> </p>
<h3 id="1-Reactive-Streams"><a href="#1-Reactive-Streams" class="headerlink" title="1. Reactive Streams"></a>1. Reactive Streams</h3><p>Reactive Streams is the foundation of reactive programming, defining the standards for asynchronous stream processing. It consists of four core interfaces:</p>
<ul>
<li><strong>Publisher</strong>: Responsible for producing data.</li>
<li><strong>Subscriber</strong>: Consumes data.</li>
<li><strong>Subscription</strong>: Manages the relationship between publishers and subscribers.</li>
<li><strong>Processor</strong>: Acts as both a publisher and a subscriber.</li>
</ul>
<p><a name="2-project-reactor"></a> </p>
<h3 id="2-Project-Reactor"><a href="#2-Project-Reactor" class="headerlink" title="2. Project Reactor"></a>2. Project Reactor</h3><p>Project Reactor is the underlying implementation for Spring WebFlux, providing support for reactive streams. It has two main types:</p>
<ul>
<li><strong>Mono</strong>: Represents an asynchronous sequence of 0 or 1 element.</li>
<li><strong>Flux</strong>: Represents an asynchronous sequence of 0 to N elements.</li>
</ul>
<p><a name="3-webflux"></a> </p>
<h3 id="3-WebFlux"><a href="#3-WebFlux" class="headerlink" title="3. WebFlux"></a>3. WebFlux</h3><p>Spring WebFlux is an asynchronous, non-blocking web framework based on Reactive Streams API and Project Reactor. The main components include:</p>
<ul>
<li><strong>Router Functions</strong>: Define mappings between requests and handlers in a functional style.</li>
<li><strong>Handler Functions</strong>: Handle HTTP requests and return responses.</li>
</ul>
<hr>
<p><a name="practical-example-building-a-simple-webflux-application"></a> </p>
<h2 id="Practical-Example-Building-a-Simple-WebFlux-Application"><a href="#Practical-Example-Building-a-Simple-WebFlux-Application" class="headerlink" title="Practical Example: Building a Simple WebFlux Application"></a>Practical Example: Building a Simple WebFlux Application</h2><p><a name="1-project-setup"></a> </p>
<h3 id="1-Project-Setup"><a href="#1-Project-Setup" class="headerlink" title="1. Project Setup"></a>1. Project Setup</h3><p>Start by creating a Spring Boot project and adding the necessary dependencies:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.projectreactor<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>reactor-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a name="2-define-data-model"></a> </p>
<h3 id="2-Define-Data-Model"><a href="#2-Define-Data-Model" class="headerlink" title="2. Define Data Model"></a>2. Define Data Model</h3><p>Define a simple user data model:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Constructors, Getters and Setters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="3-create-handler-and-router"></a> </p>
<h3 id="3-Create-Handler-and-Router"><a href="#3-Create-Handler-and-Router" class="headerlink" title="3. Create Handler and Router"></a>3. Create Handler and Router</h3><p>Create a handler function and a router function:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserHandler</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Mono&lt;ServerResponse&gt; <span class="title function_">getUser</span><span class="params">(ServerRequest request)</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;1&quot;</span>, <span class="string">&quot;John Doe&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ServerResponse.ok().body(Mono.just(user), User.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RouterConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RouterFunction&lt;ServerResponse&gt; <span class="title function_">route</span><span class="params">(UserHandler handler)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> RouterFunctions.route(RequestPredicates.GET(<span class="string">&quot;/user&quot;</span>), handler::getUser);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a> </p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>In this article, we introduced the basic concepts and core components of Spring WebFlux and demonstrated how to build a simple reactive application using WebFlux.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/24/ElasticSearch-Index-Lifecycle-Policy-ILM-%E2%80%93-Deep-Dive/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/24/ElasticSearch-Index-Lifecycle-Policy-ILM-%E2%80%93-Deep-Dive/" class="post-title-link" itemprop="url">ElasticSearch Index Lifecycle Policy (ILM)  Deep Dive</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-24 12:39:24" itemprop="dateCreated datePublished" datetime="2024-10-24T12:39:24-04:00">2024-10-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Elasticsearch/" itemprop="url" rel="index"><span itemprop="name">Elasticsearch</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction-to-index-lifecycle-management-ilm">Introduction to Index Lifecycle Management (ILM)</a></li>
<li><a href="#elasticsearch-ilm-phases">ElasticSearch ILM Phases</a><ul>
<li><a href="#1-hot-phase">1. Hot Phase</a></li>
<li><a href="#2-warm-phase">2. Warm Phase</a></li>
<li><a href="#3-cold-phase">3. Cold Phase</a></li>
<li><a href="#4-delete-phase">4. Delete Phase</a></li>
</ul>
</li>
<li><a href="#creating-an-index-lifecycle-policy">Creating an Index Lifecycle Policy</a></li>
<li><a href="#real-life-scenarios-of-ilm">Real-Life Scenarios of ILM</a><ul>
<li><a href="#scenario-1-logs-retention-policy">Scenario 1: Logs Retention Policy</a></li>
<li><a href="#scenario-2-time-based-data-management">Scenario 2: Time-Based Data Management</a></li>
</ul>
</li>
<li><a href="#ilm-best-practices">ILM Best Practices</a></li>
<li><a href="#useful-commands-and-operations">Useful Commands and Operations</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<hr>
<h2 id="Introduction-to-Index-Lifecycle-Management-ILM"><a href="#Introduction-to-Index-Lifecycle-Management-ILM" class="headerlink" title="Introduction to Index Lifecycle Management (ILM)"></a>Introduction to Index Lifecycle Management (ILM)</h2><hr>
<p>ElasticSearchs <strong>Index Lifecycle Management (ILM)</strong> allows you to define and automate how indices are managed throughout their lifecycle. This is critical for controlling the size, performance, and cost of your Elasticsearch cluster by ensuring data is stored in appropriate storage tiers as it ages.</p>
<p>An ILM policy divides an indexs lifecycle into phases, during which specific actions are applied to the data. These actions include closing, freezing, moving to different nodes, or deleting indices.</p>
<hr>
<p><a name="elasticsearch-ilm-phases"></a> </p>
<h2 id="ElasticSearch-ILM-Phases"><a href="#ElasticSearch-ILM-Phases" class="headerlink" title="ElasticSearch ILM Phases"></a>ElasticSearch ILM Phases</h2><p><a name="1-hot-phase"></a> </p>
<h3 id="1-Hot-Phase"><a href="#1-Hot-Phase" class="headerlink" title="1. Hot Phase"></a>1. Hot Phase</h3><ul>
<li>The hot phase is for indexing and querying fresh data.</li>
<li>Data is stored on high-performance nodes for rapid access.</li>
<li>Indices in this phase are actively written and read.</li>
</ul>
<p><strong>Operations:</strong></p>
<ul>
<li>Force merge segments</li>
<li>Shrink the index</li>
<li>Roll over to a new index when the current one is too large</li>
</ul>
<p><strong>Command:</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;policy&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;phases&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;hot&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;actions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;rollover&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;max_size&quot;</span><span class="punctuation">:</span> <span class="string">&quot;50gb&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;max_age&quot;</span><span class="punctuation">:</span> <span class="string">&quot;30d&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><a name="2-warm-phase"></a> </p>
<h3 id="2-Warm-Phase"><a href="#2-Warm-Phase" class="headerlink" title="2. Warm Phase"></a>2. Warm Phase</h3><ul>
<li>The warm phase is for data that is no longer being actively written but still queried.</li>
<li>Data is stored on less powerful nodes.</li>
<li>The index can be optimized by reducing the number of replicas and relocating shards to nodes with less CPU and memory resources.</li>
</ul>
<p><strong>Operations:</strong></p>
<ul>
<li>Shrink index to fewer shards</li>
<li>Reduce the number of replicas</li>
<li>Move the index to nodes with less powerful resources</li>
</ul>
<p><strong>Command:</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;policy&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;phases&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;warm&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;actions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;allocate&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;require&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;box_type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;warm&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><a name="3-cold-phase"></a> </p>
<h3 id="3-Cold-Phase"><a href="#3-Cold-Phase" class="headerlink" title="3. Cold Phase"></a>3. Cold Phase</h3><ul>
<li>The cold phase is for data that is rarely accessed but needs to be retained.</li>
<li>Data is stored on the least powerful nodes, with a focus on cost-effectiveness over performance.</li>
<li>Indices can be marked as read-only.</li>
</ul>
<p><strong>Operations:</strong></p>
<ul>
<li>Set the index as read-only</li>
<li>Move the index to cold storage nodes</li>
<li>Freeze the index (lowers resource consumption even further)</li>
</ul>
<p><strong>Command:</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;policy&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;phases&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;cold&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;actions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;allocate&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;require&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;box_type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cold&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;freeze&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><a name="4-delete-phase"></a> </p>
<h3 id="4-Delete-Phase"><a href="#4-Delete-Phase" class="headerlink" title="4. Delete Phase"></a>4. Delete Phase</h3><ul>
<li>The delete phase removes indices once they are no longer needed, preventing unnecessary resource usage.</li>
</ul>
<p><strong>Operations:</strong></p>
<ul>
<li>Delete the index after a specific time period or based on certain criteria.</li>
</ul>
<p><strong>Command:</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;policy&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;phases&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;delete&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;actions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;delete&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="creating-an-index-lifecycle-policy"></a> </p>
<h2 id="Creating-an-Index-Lifecycle-Policy"><a href="#Creating-an-Index-Lifecycle-Policy" class="headerlink" title="Creating an Index Lifecycle Policy"></a>Creating an Index Lifecycle Policy</h2><p>To create a custom ILM policy, use the following steps:</p>
<ol>
<li>Define the policy by specifying the different phases (hot, warm, cold, delete).</li>
<li>Apply the policy to your indices using an alias or direct index management.</li>
</ol>
<p><strong>Command Example:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">PUT _ilm/policy/my_policy</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;policy&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;phases&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;hot&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;actions&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;rollover&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;max_size&quot;</span>: <span class="string">&quot;50gb&quot;</span>,</span><br><span class="line">            <span class="string">&quot;max_age&quot;</span>: <span class="string">&quot;7d&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&quot;delete&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;min_age&quot;</span>: <span class="string">&quot;30d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;actions&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;delete&quot;</span>: &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="real-life-scenarios-of-ilm"></a> </p>
<h2 id="Real-Life-Scenarios-of-ILM"><a href="#Real-Life-Scenarios-of-ILM" class="headerlink" title="Real-Life Scenarios of ILM"></a>Real-Life Scenarios of ILM</h2><p><a name="scenario-1-logs-retention-policy"></a> </p>
<h3 id="Scenario-1-Logs-Retention-Policy"><a href="#Scenario-1-Logs-Retention-Policy" class="headerlink" title="Scenario 1: Logs Retention Policy"></a>Scenario 1: Logs Retention Policy</h3><p>In a logging system (e.g., centralized logging with ElasticSearch), the hot phase may consist of daily log ingestion, followed by moving the logs to the warm phase after 30 days. Finally, after 90 days, the logs are deleted.</p>
<p><strong>Policy Example:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">PUT _ilm/policy/log_retention_policy</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;policy&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;phases&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;hot&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;min_age&quot;</span>: <span class="string">&quot;0ms&quot;</span>,</span><br><span class="line">        <span class="string">&quot;actions&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;rollover&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;max_size&quot;</span>: <span class="string">&quot;50gb&quot;</span>,</span><br><span class="line">            <span class="string">&quot;max_age&quot;</span>: <span class="string">&quot;1d&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&quot;warm&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;min_age&quot;</span>: <span class="string">&quot;30d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;actions&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;allocate&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;include&quot;</span>: &#123;</span><br><span class="line">              <span class="string">&quot;box_type&quot;</span>: <span class="string">&quot;warm&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="string">&quot;shrink&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;number_of_shards&quot;</span>: 1</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&quot;delete&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;min_age&quot;</span>: <span class="string">&quot;90d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;actions&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;delete&quot;</span>: &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="scenario-2-time-based-data-management"></a> </p>
<h3 id="Scenario-2-Time-Based-Data-Management"><a href="#Scenario-2-Time-Based-Data-Management" class="headerlink" title="Scenario 2: Time-Based Data Management"></a>Scenario 2: Time-Based Data Management</h3><p>For applications dealing with time-based data (e.g., financial transactions or event logs), ILM helps archive data efficiently. You might retain recent data in the hot phase for instant querying, move older data to warm nodes, and eventually store data in cold nodes before deleting it.</p>
<hr>
<p><a name="ilm-best-practices"></a> </p>
<h2 id="ILM-Best-Practices"><a href="#ILM-Best-Practices" class="headerlink" title="ILM Best Practices"></a>ILM Best Practices</h2><ol>
<li><strong>Define Clear Retention Policies:</strong> Tailor lifecycle policies to the nature of your data.</li>
<li><strong>Monitor Resource Usage:</strong> Ensure you have enough storage in warm and cold nodes.</li>
<li><strong>Test Policy Changes:</strong> Roll out new policies incrementally to avoid production outages.</li>
<li><strong>Leverage Aliases:</strong> Use index aliases to manage indices during rollovers without affecting search queries.</li>
</ol>
<hr>
<p><a name="useful-commands-and-operations"></a> </p>
<h2 id="Useful-Commands-and-Operations"><a href="#Useful-Commands-and-Operations" class="headerlink" title="Useful Commands and Operations"></a>Useful Commands and Operations</h2><ul>
<li><strong>Create a policy:</strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUT _ilm/policy/my_policy</span><br></pre></td></tr></table></figure></li>
<li><strong>Get details of an existing policy:</strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET _ilm/policy/my_policy</span><br></pre></td></tr></table></figure></li>
<li><strong>Delete a policy:</strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE _ilm/policy/my_policy</span><br></pre></td></tr></table></figure></li>
<li><strong>Apply a policy to an index:</strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PUT /my_index/_settings</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;index.lifecycle.name&quot;</span>: <span class="string">&quot;my_policy&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<p><a name="conclusion"></a> </p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>ElasticSearchs Index Lifecycle Management (ILM) is a powerful tool that helps organizations manage their indices lifecycle by automating transitions between different storage phases (hot, warm, cold, and delete). By optimizing storage and performance, ILM policies improve the overall cost-effectiveness and scalability of your ElasticSearch cluster. Proper use of ILM ensures your data remains accessible and performant while controlling operational costs effectively.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/23/Deep-Dive-Backpressure-Flow-Control-with-WebClient-in-Spring-Boot/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/23/Deep-Dive-Backpressure-Flow-Control-with-WebClient-in-Spring-Boot/" class="post-title-link" itemprop="url">Deep Dive Backpressure Flow Control with WebClient in Spring Boot</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-23 23:11:08" itemprop="dateCreated datePublished" datetime="2024-10-23T23:11:08-04:00">2024-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/WebFlux/" itemprop="url" rel="index"><span itemprop="name">WebFlux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#1-introduction-to-backpressure">1. Introduction to Backpressure</a></li>
<li><a href="#2-why-backpressure-is-important">2. Why Backpressure is Important</a></li>
<li><a href="#3-webclient-enabling-backpressure">3. WebClient: Enabling Backpressure</a></li>
<li><a href="#4-use-case">4. Use Case</a><ul>
<li><a href="#example-streaming-large-dataset-with-backpressure">Example: Streaming Large Dataset with Backpressure</a><ul>
<li><a href="#code-example">Code Example:</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#5-backpressure-strategies-in-webclient">5. Backpressure Strategies in WebClient</a><ul>
<li><a href="#strategy-1-limitrate">Strategy 1: <code>limitRate</code></a></li>
<li><a href="#strategy-2-onbackpressurebuffer">Strategy 2: <code>onBackpressureBuffer</code></a></li>
<li><a href="#strategy-3-onbackpressuredrop">Strategy 3: <code>onBackpressureDrop</code></a></li>
<li><a href="#strategy-4-using-fluxwindow">Strategy 4: Using <code>Flux.window()</code></a></li>
<li><a href="#strategy-5-combining-flatmap-with-concurrency">Strategy 5: Combining <code>flatMap</code> with Concurrency</a></li>
</ul>
</li>
<li><a href="#6-diagrams">6. Diagrams</a><ul>
<li><a href="#diagram-1-basic-backpressure-flow">Diagram 1: Basic Backpressure Flow</a></li>
<li><a href="#diagram-2-streaming-data-with-concurrency-and-backpressure">Diagram 2: Streaming Data with Concurrency and Backpressure</a></li>
</ul>
</li>
<li><a href="#7-conclusion">7. Conclusion</a></li>
</ul>
<hr>
<p><a name="1-introduction-to-backpressure"></a> </p>
<h2 id="1-Introduction-to-Backpressure"><a href="#1-Introduction-to-Backpressure" class="headerlink" title="1. Introduction to Backpressure"></a>1. Introduction to Backpressure</h2><p><strong>Backpressure</strong> is the mechanism in reactive systems that helps manage the flow of data between producers and consumers. In systems where data is produced at high rates, backpressure allows consumers to signal how much data they can process, preventing overload.</p>
<p>Without backpressure, if the producer emits data faster than the consumer can process, it can lead to memory overflows, crashes, or degraded system performance.</p>
<hr>
<p><a name="2-why-backpressure-is-important"></a> </p>
<h2 id="2-Why-Backpressure-is-Important"><a href="#2-Why-Backpressure-is-Important" class="headerlink" title="2. Why Backpressure is Important"></a>2. Why Backpressure is Important</h2><p>Backpressure ensures:</p>
<ul>
<li>Efficient resource management</li>
<li>Prevents overwhelming downstream services</li>
<li>Provides resilience against data surges</li>
<li>Allows consumers to control the data inflow rate</li>
</ul>
<p>Reactive systems like Springs <strong>WebClient</strong> use backpressure to provide flow control, especially when dealing with streaming data or high-throughput APIs.</p>
<hr>
<p><a name="3-webclient-enabling-backpressure"></a> </p>
<h2 id="3-WebClient-Enabling-Backpressure"><a href="#3-WebClient-Enabling-Backpressure" class="headerlink" title="3. WebClient: Enabling Backpressure"></a>3. WebClient: Enabling Backpressure</h2><p><strong>WebClient</strong>, built on <strong>Project Reactor</strong>, supports backpressure natively through <strong>Flux</strong> and <strong>Mono</strong> types. By controlling the rate at which data is processed, WebClient ensures that reactive streams can handle large datasets or slow consumers.</p>
<p>Example initialization:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">WebClient</span> <span class="variable">webClient</span> <span class="operator">=</span> WebClient.builder()</span><br><span class="line">        .baseUrl(<span class="string">&quot;https://dummy.restapiexample.com/api/v1/employees&quot;</span>)</span><br><span class="line">        .build();</span><br></pre></td></tr></table></figure>

<p>WebClient operates on non-blocking, reactive pipelines where consumers can request more data as needed, unlike traditional blocking REST clients.</p>
<hr>
<p><a name="4-use-case"></a> </p>
<h2 id="4-Use-Case"><a href="#4-Use-Case" class="headerlink" title="4. Use Case"></a>4. Use Case</h2><p><a name="example-streaming-large-dataset-with-backpressure"></a> </p>
<h3 id="Example-Streaming-Large-Dataset-with-Backpressure"><a href="#Example-Streaming-Large-Dataset-with-Backpressure" class="headerlink" title="Example: Streaming Large Dataset with Backpressure"></a>Example: Streaming Large Dataset with Backpressure</h3><p>Imagine youre building a data ingestion service that consumes streaming data from an external API, such as real-time stock market prices. The API provides thousands of updates per second. Your system must process this data without overwhelming downstream services (e.g., databases or other microservices).</p>
<p>You can use <strong>WebClient</strong> with backpressure to process these updates at a controlled rate, avoiding memory overloads and ensuring stability.</p>
<p><a name="code-example"></a> </p>
<h4 id="Code-Example"><a href="#Code-Example" class="headerlink" title="Code Example:"></a>Code Example:</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">WebClient</span> <span class="variable">webClient</span> <span class="operator">=</span> WebClient.create(<span class="string">&quot;https://dummy.restapiexample.com/api/v1/employees&quot;</span>);</span><br><span class="line"></span><br><span class="line">Flux&lt;StockPrice&gt; stockPriceStream = webClient.get()</span><br><span class="line">    .uri(<span class="string">&quot;/stream&quot;</span>)</span><br><span class="line">    .retrieve()</span><br><span class="line">    .bodyToFlux(StockPrice.class)</span><br><span class="line">    .limitRate(<span class="number">100</span>); <span class="comment">// Limit the rate of data processing</span></span><br><span class="line"></span><br><span class="line">stockPriceStream</span><br><span class="line">    .doOnNext(stock -&gt; processStockPrice(stock))</span><br><span class="line">    .doOnError(error -&gt; handleError(error))</span><br><span class="line">    .subscribe();</span><br></pre></td></tr></table></figure>
<p>Here, <code>limitRate(100)</code> ensures that only 100 stock price updates are processed at a time, preventing overload.</p>
<hr>
<p><a name="5-backpressure-strategies-in-webclient"></a> </p>
<h2 id="5-Backpressure-Strategies-in-WebClient"><a href="#5-Backpressure-Strategies-in-WebClient" class="headerlink" title="5. Backpressure Strategies in WebClient"></a>5. Backpressure Strategies in WebClient</h2><p><a name="strategy-1-limitrate"></a> </p>
<h3 id="Strategy-1-limitRate"><a href="#Strategy-1-limitRate" class="headerlink" title="Strategy 1: limitRate"></a>Strategy 1: <code>limitRate</code></h3><p>The simplest method to apply backpressure is by limiting the rate at which data is processed using <code>limitRate()</code>.</p>
<p><strong>Example:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Flux&lt;StockPrice&gt; stockPriceStream = webClient.get()</span><br><span class="line">    .uri(<span class="string">&quot;/stream&quot;</span>)</span><br><span class="line">    .retrieve()</span><br><span class="line">    .bodyToFlux(StockPrice.class)</span><br><span class="line">    .limitRate(<span class="number">50</span>); <span class="comment">// Controls backpressure with 50 items at a time</span></span><br></pre></td></tr></table></figure>

<p>This limits the number of items requested and processed at a time.</p>
<hr>
<p><a name="strategy-2-onbackpressurebuffer"></a> </p>
<h3 id="Strategy-2-onBackpressureBuffer"><a href="#Strategy-2-onBackpressureBuffer" class="headerlink" title="Strategy 2: onBackpressureBuffer"></a>Strategy 2: <code>onBackpressureBuffer</code></h3><p>The <code>onBackpressureBuffer</code> operator buffers data when backpressure occurs, until the downstream can handle it.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Flux.range(<span class="number">1</span>, <span class="number">1000</span>)</span><br><span class="line">    .onBackpressureBuffer(<span class="number">50</span>)</span><br><span class="line">    .subscribe(System.out::println);</span><br></pre></td></tr></table></figure>

<p><a name="strategy-3-onbackpressuredrop"></a> </p>
<h3 id="Strategy-3-onBackpressureDrop"><a href="#Strategy-3-onBackpressureDrop" class="headerlink" title="Strategy 3: onBackpressureDrop"></a>Strategy 3: <code>onBackpressureDrop</code></h3><p>The <code>onBackpressureDrop</code> operator discards data when backpressure occurs to prevent downstream overload.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Flux.range(<span class="number">1</span>, <span class="number">1000</span>)</span><br><span class="line">    .onBackpressureDrop()</span><br><span class="line">    .subscribe(System.out::println);</span><br></pre></td></tr></table></figure>

<p><a name="strategy-4-using-fluxwindow"></a> </p>
<h3 id="Strategy-4-Using-Flux-window"><a href="#Strategy-4-Using-Flux-window" class="headerlink" title="Strategy 4: Using Flux.window()"></a>Strategy 4: Using <code>Flux.window()</code></h3><p>Another method is using <strong><code>window()</code></strong>, which batches items into smaller chunks for processing.</p>
<p><strong>Example:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Flux&lt;StockPrice&gt; stockPriceStream = webClient.get()</span><br><span class="line">    .uri(<span class="string">&quot;/stream&quot;</span>)</span><br><span class="line">    .retrieve()</span><br><span class="line">    .bodyToFlux(StockPrice.class)</span><br><span class="line">    .window(<span class="number">10</span>)  <span class="comment">// Process in windows of 10</span></span><br><span class="line">    .flatMap(window -&gt; window.collectList())</span><br><span class="line">    .doOnNext(batch -&gt; processBatch(batch))</span><br><span class="line">    .subscribe();</span><br></pre></td></tr></table></figure>

<p>This groups items into windows of 10 before processing, providing an additional layer of control.</p>
<hr>
<p><a name="sstrategy-5-combining-flatmap-with-concurrency"></a> </p>
<h3 id="Strategy-5-Combining-flatMap-with-Concurrency"><a href="#Strategy-5-Combining-flatMap-with-Concurrency" class="headerlink" title="Strategy 5: Combining flatMap with Concurrency"></a>Strategy 5: Combining <code>flatMap</code> with Concurrency</h3><p>For more complex backpressure control, you can combine <code>flatMap()</code> with concurrency settings. This allows concurrent processing of items with backpressure.</p>
<p><strong>Example:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">webClient.get()</span><br><span class="line">    .uri(<span class="string">&quot;/stream&quot;</span>)</span><br><span class="line">    .retrieve()</span><br><span class="line">    .bodyToFlux(StockPrice.class)</span><br><span class="line">    .flatMap(price -&gt; processStockPrice(price), <span class="number">5</span>) <span class="comment">// Concurrently process 5 items</span></span><br><span class="line">    .subscribe();</span><br></pre></td></tr></table></figure>
<p>Here, <code>flatMap()</code> ensures that a maximum of 5 stock prices are processed concurrently at any given time.</p>
<hr>
<p><a name="6-diagrams"></a> </p>
<h2 id="6-Diagrams"><a href="#6-Diagrams" class="headerlink" title="6. Diagrams"></a>6. Diagrams</h2><p><a name="diagram-1-basic-backpressure-flow"></a> </p>
<h3 id="Diagram-1-Basic-Backpressure-Flow"><a href="#Diagram-1-Basic-Backpressure-Flow" class="headerlink" title="Diagram 1: Basic Backpressure Flow"></a>Diagram 1: Basic Backpressure Flow</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[Producer] ---&gt; [Backpressure Mechanism (limitRate, window)] ---&gt; [Consumer]</span><br><span class="line">  ^                                                             |</span><br><span class="line">  |                                                             v</span><br><span class="line">  +--------------------------------------------------------------</span><br></pre></td></tr></table></figure>

<ol>
<li>Producer sends data.</li>
<li>Backpressure mechanism (e.g., <code>limitRate</code>) controls the flow.</li>
<li>Consumer processes data at a controlled rate.</li>
</ol>
<hr>
<p><a name="diagram-2-streaming-data-with-concurrency-and-backpressure"></a> </p>
<h3 id="Diagram-2-Streaming-Data-with-Concurrency-and-Backpressure"><a href="#Diagram-2-Streaming-Data-with-Concurrency-and-Backpressure" class="headerlink" title="Diagram 2: Streaming Data with Concurrency and Backpressure"></a>Diagram 2: Streaming Data with Concurrency and Backpressure</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[API] ---&gt; [WebClient (Stream)] ---&gt; [Backpressure] ---&gt; [Concurrent Processing] ---&gt; [Final Consumer]</span><br><span class="line">  ^                ^                        |                     |                                |</span><br><span class="line">  |                |                        |                     +---&gt; [Worker 1]                 |</span><br><span class="line">  |                +------------------------+                     +---&gt; [Worker 2]                 |</span><br><span class="line">  +------------------------------------------------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="7-conclusion"></a> </p>
<h2 id="7-Conclusion"><a href="#7-Conclusion" class="headerlink" title="7. Conclusion"></a>7. Conclusion</h2><p>In reactive systems, <strong>backpressure</strong> is a key mechanism that prevents overload and ensures stable operation by allowing consumers to control the rate of data consumption. With <strong>WebClient</strong>, backpressure can be easily managed using strategies like <code>limitRate</code>, <code>window</code>, and <code>flatMap</code> with concurrency.</p>
<p>Compared to traditional, blocking clients like <strong>RestTemplate</strong>, WebClients backpressure control is a major advantage for high-throughput, non-blocking operations.</p>
<p>By implementing these techniques, you can design robust, scalable applications that handle large datasets and high-velocity data streams with ease.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/23/WebClient-and-RestTemplate-in-Spring-Boot/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/23/WebClient-and-RestTemplate-in-Spring-Boot/" class="post-title-link" itemprop="url">WebClient and RestTemplate in Spring Boot</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-23 22:16:39" itemprop="dateCreated datePublished" datetime="2024-10-23T22:16:39-04:00">2024-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/WebFlux/" itemprop="url" rel="index"><span itemprop="name">WebFlux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#webclient-and-resttemplate-in-spring-boot">WebClient and RestTemplate in Spring Boot</a><ul>
<li><a href="#1-overview">1. Overview</a></li>
<li><a href="#2-what-is-resttemplate">2. What is RestTemplate?</a><ul>
<li><a href="#characteristics">Characteristics:</a></li>
<li><a href="#code-sample">Code Sample:</a></li>
</ul>
</li>
<li><a href="#3-what-is-webclient">3. What is WebClient?</a><ul>
<li><a href="#characteristics-1">Characteristics:</a></li>
<li><a href="#code-sample-1">Code Sample:</a></li>
</ul>
</li>
<li><a href="#4-key-differences">4. Key Differences</a><ul>
<li><a href="#41-synchronous-vs-asynchronous">4.1 Synchronous vs Asynchronous</a></li>
<li><a href="#42-reactive-support">4.2 Reactive Support</a></li>
<li><a href="#43-error-handling">4.3 Error Handling</a></li>
<li><a href="#44-performance">4.4 Performance</a></li>
<li><a href="#45-flexibility--features">4.5 Flexibility &amp; Features</a></li>
</ul>
</li>
<li><a href="#5-best-practices-and-use-cases">5. Best Practices and Use Cases</a><ul>
<li><a href="#best-practices">Best Practices:</a></li>
</ul>
</li>
<li><a href="#6-real-life-use-case-example">6. Real-Life Use Case Example</a><ul>
<li><a href="#61-using-resttemplate-synchronous">6.1 Using RestTemplate (Synchronous)</a></li>
<li><a href="#62-using-webclient-asynchronous">6.2 Using WebClient (Asynchronous)</a></li>
<li><a href="#63-adding-retry-and-fallback-webclient">6.3 Adding Retry and Fallback (WebClient)</a></li>
</ul>
</li>
<li><a href="#7-conclusion">7. Conclusion</a></li>
<li><a href="#8-diagrams">8. Diagrams</a><ul>
<li><a href="#81-synchronous-resttemplate-workflow">8.1 Synchronous RestTemplate Workflow</a></li>
<li><a href="#82-asynchronous-webclient-workflow">8.2 Asynchronous WebClient Workflow</a></li>
</ul>
</li>
<li><a href="#9-deep-dive-into-backpressure">9. Deep Dive into Backpressure</a><ul>
<li><a href="#91-what-is-backpressure-in-reactive-systems">9.1 What is Backpressure in Reactive Systems?</a></li>
<li><a href="#92-is-backpressure-good-or-bad">9.2 Is Backpressure Good or Bad?</a></li>
<li><a href="#93-how-webclient-supports-backpressure">9.3 How WebClient Supports Backpressure</a></li>
<li><a href="#94-code-example-of-webclient-supporting-backpressure">9.4 Code Example of WebClient Supporting Backpressure</a></li>
<li><a href="#95-why-resttemplate-doesnt-have-backpressure">9.5 Why RestTemplate Doesnt Have Backpressure</a></li>
<li><a href="#96-when-to-use-resttemplate">9.6 When to Use RestTemplate</a></li>
<li><a href="#97-conclusion">9.7 Conclusion</a></li>
<li><a href="#key-takeaways">Key Takeaways:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h1 id="WebClient-and-RestTemplate-in-Spring-Boot"><a href="#WebClient-and-RestTemplate-in-Spring-Boot" class="headerlink" title="WebClient and RestTemplate in Spring Boot"></a>WebClient and RestTemplate in Spring Boot</h1><hr>
<h2 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h2><p><a name="1-overview"></a></p>
<p>Spring Boot offers two primary ways to make HTTP requests: <code>RestTemplate</code> and <code>WebClient</code>. While both can be used to interact with external APIs, they differ significantly in features, capabilities, and usage. In this article, well explore the key differences, when to use each, and best practices through practical examples.</p>
<h2 id="2-What-is-RestTemplate"><a href="#2-What-is-RestTemplate" class="headerlink" title="2. What is RestTemplate?"></a>2. What is RestTemplate?</h2><p><a name="2-what-is-resttemplate"></a></p>
<p><code>RestTemplate</code> is a synchronous client designed to perform HTTP requests and handle responses. It has been around for a long time and is simple to use but is gradually being deprecated in favor of <code>WebClient</code> for reactive programming.</p>
<h3 id="Characteristics"><a href="#Characteristics" class="headerlink" title="Characteristics:"></a>Characteristics:</h3><ul>
<li><strong>Synchronous&#x2F;blocking operations</strong>: Each request blocks the thread until the response is received.</li>
<li><strong>Easy to use</strong>: Simplified API for HTTP interactions.</li>
<li><strong>Wide range of RESTful operations</strong>: Supports GET, POST, PUT, DELETE, etc.</li>
<li><strong>Deprecated</strong>: Spring team recommends using <code>WebClient</code> for new applications.</li>
</ul>
<h3 id="Code-Sample"><a href="#Code-Sample" class="headerlink" title="Code Sample:"></a>Code Sample:</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">RestTemplate</span> <span class="variable">restTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;https://catfact.ninja/facts&quot;</span>;</span><br><span class="line">ResponseEntity&lt;String&gt; response = restTemplate.getForEntity(url, String.class);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;Response: &quot;</span> + response.getBody());</span><br></pre></td></tr></table></figure>

<h2 id="3-What-is-WebClient"><a href="#3-What-is-WebClient" class="headerlink" title="3. What is WebClient?"></a>3. What is WebClient?</h2><p><a name="3-what-is-webclient"></a></p>
<p><code>WebClient</code> is the successor to <code>RestTemplate</code>, introduced in Spring 5. It supports both synchronous and asynchronous (non-blocking) calls and is designed for reactive programming, making it more suitable for modern web applications.</p>
<h3 id="Characteristics-1"><a href="#Characteristics-1" class="headerlink" title="Characteristics:"></a>Characteristics:</h3><ul>
<li><strong>Asynchronous and non-blocking</strong>: Allows multiple requests to be handled concurrently without blocking threads.</li>
<li><strong>Part of Spring WebFlux</strong>: Built on top of the reactive stack.</li>
<li><strong>Supports backpressure</strong>: Crucial for reactive streams to manage data flow.</li>
<li><strong>Chaining operations</strong>: Allows declarative chaining of multiple operations.</li>
</ul>
<h3 id="Code-Sample-1"><a href="#Code-Sample-1" class="headerlink" title="Code Sample:"></a>Code Sample:</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">WebClient</span> <span class="variable">webClient</span> <span class="operator">=</span> WebClient.create(<span class="string">&quot;https://catfact.ninja&quot;</span>);</span><br><span class="line"></span><br><span class="line">Mono&lt;String&gt; response = webClient.get()</span><br><span class="line">    .uri(<span class="string">&quot;/facts&quot;</span>)</span><br><span class="line">    .retrieve()</span><br><span class="line">    .bodyToMono(String.class);</span><br><span class="line"></span><br><span class="line">response.subscribe(System.out::println);</span><br></pre></td></tr></table></figure>

<h2 id="4-Key-Differences"><a href="#4-Key-Differences" class="headerlink" title="4. Key Differences"></a>4. Key Differences</h2><p><a name="4-key-differences"></a></p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>RestTemplate</th>
<th>WebClient</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Type</strong></td>
<td>Synchronous</td>
<td>Asynchronous and Reactive</td>
</tr>
<tr>
<td><strong>Concurrency</strong></td>
<td>Blocking (each request waits)</td>
<td>Non-blocking (multiple requests in parallel)</td>
</tr>
<tr>
<td><strong>Backpressure</strong></td>
<td>No (Processes whole response at once)</td>
<td>Yes, Supports backpressure in reactive systems, flow control</td>
</tr>
<tr>
<td><strong>Error Handling</strong></td>
<td>Simple but lacks flexibility</td>
<td>Advanced error handling with <code>.onStatus()</code></td>
</tr>
<tr>
<td><strong>Support for Streams</strong></td>
<td>No</td>
<td>Yes, can handle large streams of data</td>
</tr>
<tr>
<td><strong>Flexibility</strong></td>
<td>Limited customizations</td>
<td>Highly flexible and configurable</td>
</tr>
</tbody></table>
<h3 id="4-1-Synchronous-vs-Asynchronous"><a href="#4-1-Synchronous-vs-Asynchronous" class="headerlink" title="4.1 Synchronous vs Asynchronous"></a>4.1 Synchronous vs Asynchronous</h3><p><a name="41-synchronous-vs-asynchronous"></a></p>
<ul>
<li><strong>RestTemplate</strong>: Operates in a synchronous&#x2F;blocking fashion, meaning the thread is blocked until the response arrives.</li>
<li><strong>WebClient</strong>: Can operate both synchronously and asynchronously, allowing for non-blocking I&#x2F;O and better scalability.</li>
</ul>
<h3 id="4-2-Reactive-Support"><a href="#4-2-Reactive-Support" class="headerlink" title="4.2 Reactive Support"></a>4.2 Reactive Support</h3><p><a name="42-reactive-support"></a></p>
<p><code>WebClient</code> is built to support the reactive paradigm of programming, which allows applications to handle a massive number of requests efficiently by leveraging non-blocking I&#x2F;O operations. RestTemplate does not have this support.</p>
<h3 id="4-3-Error-Handling"><a href="#4-3-Error-Handling" class="headerlink" title="4.3 Error Handling"></a>4.3 Error Handling</h3><p><a name="43-error-handling"></a></p>
<p><code>WebClient</code> provides more flexible error handling with methods like <code>.onStatus()</code> for dealing with specific HTTP status codes.</p>
<h3 id="4-4-Performance"><a href="#4-4-Performance" class="headerlink" title="4.4 Performance"></a>4.4 Performance</h3><p><a name="44-performance"></a></p>
<p>Due to its asynchronous nature, <code>WebClient</code> typically offers better performance in handling multiple HTTP requests concurrently, making it more suitable for high-performance applications.</p>
<h3 id="4-5-Flexibility-Features"><a href="#4-5-Flexibility-Features" class="headerlink" title="4.5 Flexibility &amp; Features"></a>4.5 Flexibility &amp; Features</h3><p><a name="45-flexibility--features"></a></p>
<p><code>WebClient</code> can be configured with timeouts, retries, and fallbacks more easily compared to <code>RestTemplate</code>. It supports streaming large amounts of data and provides reactive streams to manage data flow.</p>
<h2 id="5-Best-Practices-and-Use-Cases"><a href="#5-Best-Practices-and-Use-Cases" class="headerlink" title="5. Best Practices and Use Cases"></a>5. Best Practices and Use Cases</h2><p><a name="5-best-practices-and-use-cases"></a></p>
<ul>
<li><p><strong>When to use RestTemplate</strong>:</p>
<ul>
<li>Small applications with minimal requirements for concurrency.</li>
<li>Use cases where synchronous&#x2F;blocking operations are acceptable.</li>
</ul>
</li>
<li><p><strong>When to use WebClient</strong>:</p>
<ul>
<li>Modern applications requiring scalability and performance.</li>
<li>When working with large-scale microservices architectures.</li>
<li>For non-blocking and reactive API calls.</li>
</ul>
</li>
</ul>
<h3 id="Best-Practices"><a href="#Best-Practices" class="headerlink" title="Best Practices:"></a>Best Practices:</h3><ul>
<li>Use <code>WebClient</code> for new applications that need to scale.</li>
<li>Avoid using <code>RestTemplate</code> for large-scale systems due to its synchronous nature.</li>
<li>Handle errors properly using <code>onStatus()</code> in <code>WebClient</code>.</li>
</ul>
<h2 id="6-Real-Life-Use-Case-Example"><a href="#6-Real-Life-Use-Case-Example" class="headerlink" title="6. Real-Life Use Case Example"></a>6. Real-Life Use Case Example</h2><p><a name="6-real-life-use-case-example"></a></p>
<p>Lets assume a situation where you are building a service to fetch data from multiple APIs concurrently. <code>RestTemplate</code> would block on each request, but <code>WebClient</code> would allow you to make all the calls concurrently and return the responses as they come in.</p>
<h3 id="6-1-Using-RestTemplate-Synchronous"><a href="#6-1-Using-RestTemplate-Synchronous" class="headerlink" title="6.1 Using RestTemplate (Synchronous)"></a>6.1 Using RestTemplate (Synchronous)</h3><p><a name="61-using-resttemplate-synchronous"></a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApiController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">RestTemplate</span> <span class="variable">restTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/data&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">fetchData</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">api1Response</span> <span class="operator">=</span> restTemplate.getForObject(<span class="string">&quot;https://catfact.ninja/facts&quot;</span>, String.class);</span><br><span class="line">        <span class="type">String</span> <span class="variable">api2Response</span> <span class="operator">=</span> restTemplate.getForObject(<span class="string">&quot;https://catfact.ninja/fact&quot;</span>, String.class);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Data from API1: &quot;</span> + api1Response + <span class="string">&quot; and API2: &quot;</span> + api2Response;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-2-Using-WebClient-Asynchronous"><a href="#6-2-Using-WebClient-Asynchronous" class="headerlink" title="6.2 Using WebClient (Asynchronous)"></a>6.2 Using WebClient (Asynchronous)</h3><p><a name="62-using-webclient-asynchronous"></a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApiController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">WebClient</span> <span class="variable">webClient</span> <span class="operator">=</span> WebClient.create();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/data&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;String&gt; <span class="title function_">fetchData</span><span class="params">()</span> &#123;</span><br><span class="line">        Mono&lt;String&gt; api1Response = webClient.get().uri(<span class="string">&quot;https://catfact.ninja/facts&quot;</span>).retrieve().bodyToMono(String.class);</span><br><span class="line">        Mono&lt;String&gt; api2Response = webClient.get().uri(<span class="string">&quot;https://catfact.ninja/fact&quot;</span>).retrieve().bodyToMono(String.class);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Mono.zip(api1Response, api2Response, (api1, api2) -&gt; <span class="string">&quot;Data from API1: &quot;</span> + api1 + <span class="string">&quot; and API2: &quot;</span> + api2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-3-Adding-Retry-and-Fallback-WebClient"><a href="#6-3-Adding-Retry-and-Fallback-WebClient" class="headerlink" title="6.3 Adding Retry and Fallback (WebClient)"></a>6.3 Adding Retry and Fallback (WebClient)</h3><p><a name="63-adding-retry-and-fallback-webclient"></a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApiService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">WebClient</span> <span class="variable">webClient</span> <span class="operator">=</span> WebClient.builder()</span><br><span class="line">        .baseUrl(<span class="string">&quot;https://catfact.ninja&quot;</span>)</span><br><span class="line">        .filter(ExchangeFilterFunctions.statusError(HttpStatus::is4xxClientError, clientResponse -&gt; <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;API Error&quot;</span>)))</span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Retryable(value = &#123;RuntimeException.class&#125;, maxAttempts = 3)</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;String&gt; <span class="title function_">fetchDataWithRetry</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> webClient.get()</span><br><span class="line">            .uri(<span class="string">&quot;/data&quot;</span>)</span><br><span class="line">            .retrieve()</span><br><span class="line">            .bodyToMono(String.class)</span><br><span class="line">            .onErrorReturn(<span class="string">&quot;Fallback Data&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-Conclusion"><a href="#7-Conclusion" class="headerlink" title="7. Conclusion"></a>7. Conclusion</h2><p><a name="7-conclusion"></a></p>
<p><code>RestTemplate</code> is simple and suitable for synchronous applications, but for modern, scalable applications, <code>WebClient</code> is the clear choice due to its non-blocking and reactive features. In Spring Boot applications, its recommended to move towards <code>WebClient</code> for future-proofing your code.</p>
<h2 id="8-Diagrams"><a href="#8-Diagrams" class="headerlink" title="8. Diagrams"></a>8. Diagrams</h2><p><a name="8-diagrams"></a></p>
<h3 id="8-1-Synchronous-RestTemplate-Workflow"><a href="#8-1-Synchronous-RestTemplate-Workflow" class="headerlink" title="8.1 Synchronous RestTemplate Workflow"></a>8.1 Synchronous RestTemplate Workflow</h3><p><a name="81-synchronous-resttemplate-workflow"></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Request -&gt; Server -&gt; Blocking I/O -&gt; Response -&gt; Client</span><br></pre></td></tr></table></figure>

<h3 id="8-2-Asynchronous-WebClient-Workflow"><a href="#8-2-Asynchronous-WebClient-Workflow" class="headerlink" title="8.2 Asynchronous WebClient Workflow"></a>8.2 Asynchronous WebClient Workflow</h3><p><a name="82-asynchronous-webclient-workflow"></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Request -&gt; Server -&gt; Non-Blocking I/O -&gt; Reactive Stream -&gt; Response -&gt; Client</span><br></pre></td></tr></table></figure>

<h2 id="9-Deep-Dive-into-Backpressure"><a href="#9-Deep-Dive-into-Backpressure" class="headerlink" title="9. Deep Dive into Backpressure"></a>9. Deep Dive into Backpressure</h2><p><a name="9-deep-dive-into-backpressure"></a></p>
<h3 id="9-1-What-is-Backpressure-in-Reactive-Systems"><a href="#9-1-What-is-Backpressure-in-Reactive-Systems" class="headerlink" title="9.1 What is Backpressure in Reactive Systems?"></a>9.1 What is Backpressure in Reactive Systems?</h3><p><a name="91-what-is-backpressure-in-reactive-systems"></a></p>
<p>Backpressure refers to a mechanism used in reactive systems to control the flow of data between producers and consumers. It allows the consumer to handle data at a rate it can manage, preventing overload or crashes. If the producer is emitting data faster than the consumer can process, backpressure signals the producer to slow down or pause until the consumer catches up.</p>
<h3 id="9-2-Is-Backpressure-Good-or-Bad"><a href="#9-2-Is-Backpressure-Good-or-Bad" class="headerlink" title="9.2 Is Backpressure Good or Bad?"></a>9.2 Is Backpressure Good or Bad?</h3><p><a name="92-is-backpressure-good-or-bad"></a></p>
<p><strong>Good</strong>:</p>
<ul>
<li><strong>Efficient Resource Management</strong>: Backpressure prevents resource exhaustion by controlling how much data is in the system.</li>
<li><strong>System Stability</strong>: It helps prevent overloading a service, ensuring it operates smoothly without being overwhelmed by data.</li>
<li><strong>Improved Scalability</strong>: In distributed systems, especially when handling streams of real-time data, backpressure enables better scalability and responsiveness.</li>
</ul>
<p><strong>Challenges</strong>:</p>
<ul>
<li><strong>Increased Complexity</strong>: While beneficial, backpressure introduces more complexity in system design. Developers need to think carefully about flow control.</li>
<li><strong>Latency</strong>: If not managed properly, backpressure can introduce latency because the producer has to wait until the consumer is ready to receive more data.</li>
</ul>
<h3 id="9-3-How-WebClient-Supports-Backpressure"><a href="#9-3-How-WebClient-Supports-Backpressure" class="headerlink" title="9.3 How WebClient Supports Backpressure"></a>9.3 How WebClient Supports Backpressure</h3><p><a name="93-how-webclient-supports-backpressure"></a></p>
<p>In Spring WebFlux, <code>WebClient</code> works in a reactive, non-blocking way and is integrated with Project Reactor to support backpressure. When fetching large streams of data, WebClient can handle them without overwhelming the system. Heres how it works:</p>
<ul>
<li><p><strong>Reactive Streams</strong>: WebClient communicates using <code>Publisher</code> and <code>Subscriber</code> patterns, which allows it to handle streams of data asynchronously. If the subscriber (consumer) is slower than the publisher (producer), it can request data at a manageable rate, applying backpressure when needed.</p>
</li>
<li><p><strong>Flow Control</strong>: In a typical scenario, the subscriber can signal how much data it wants to receive at any given moment. This avoids a flood of data that could cause the system to run out of resources. WebClient ensures that consumers can throttle the data based on their processing capacity.</p>
</li>
</ul>
<h3 id="9-4-Code-Example-of-WebClient-Supporting-Backpressure"><a href="#9-4-Code-Example-of-WebClient-Supporting-Backpressure" class="headerlink" title="9.4 Code Example of WebClient Supporting Backpressure"></a>9.4 Code Example of WebClient Supporting Backpressure</h3><p><a name="94-code-example-of-webclient-supporting-backpressure"></a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">WebClient</span> <span class="variable">webClient</span> <span class="operator">=</span> WebClient.create();</span><br><span class="line"></span><br><span class="line">Flux&lt;String&gt; response = webClient.get()</span><br><span class="line">    .uri(<span class="string">&quot;/large-data-stream&quot;</span>)</span><br><span class="line">    .retrieve()</span><br><span class="line">    .bodyToFlux(String.class)</span><br><span class="line">    .limitRate(<span class="number">10</span>); <span class="comment">// apply backpressure by limiting the rate of consumption</span></span><br><span class="line"></span><br><span class="line">response.subscribe(data -&gt; &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Processing: &quot;</span> + data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>In this example, the <code>limitRate()</code> method ensures the consumer processes the data stream at a manageable rate, effectively applying backpressure.</p>
<h3 id="9-5-Why-RestTemplate-Doesnt-Have-Backpressure"><a href="#9-5-Why-RestTemplate-Doesnt-Have-Backpressure" class="headerlink" title="9.5 Why RestTemplate Doesnt Have Backpressure"></a>9.5 Why RestTemplate Doesnt Have Backpressure</h3><p><a name="95-why-resttemplate-doesnt-have-backpressure"></a></p>
<p>RestTemplate is built on a blocking I&#x2F;O model, which means it waits for each HTTP request to complete before proceeding to the next task. This approach works well for synchronous operations, but it lacks the flow control mechanisms needed for backpressure. Heres why RestTemplate doesnt support backpressure:</p>
<ol>
<li><p><strong>Blocking Nature</strong>: RestTemplate blocks the current thread while waiting for a response, handling each request in sequence, which inherently prevents a need for backpressure.</p>
</li>
<li><p><strong>Lack of Reactive Streams</strong>: Unlike WebClient, which is built around reactive streams and the non-blocking <code>Publisher-Subscriber</code> pattern, RestTemplate doesnt have the underlying architecture to request data in chunks or manage flow control. It processes the entire response in a blocking call and holds it in memory until the response is complete.</p>
</li>
<li><p><strong>Thread-per-request Model</strong>: RestTemplate uses a traditional thread-per-request model, which consumes a thread for the entire duration of a request. This model isnt designed to handle large streams of data efficiently or manage backpressure when dealing with data that arrives at varying rates.</p>
</li>
</ol>
<h3 id="9-6-When-to-Use-RestTemplate"><a href="#9-6-When-to-Use-RestTemplate" class="headerlink" title="9.6 When to Use RestTemplate"></a>9.6 When to Use RestTemplate</h3><p><a name="96-when-to-use-resttemplate"></a></p>
<p>RestTemplate is still useful for simple, synchronous tasks that dont require fine-grained control over how data is processed, particularly when working with legacy systems or simple API interactions that dont involve heavy real-time data streaming.</p>
<p>However, for reactive programming, high throughput, and complex asynchronous data handling, WebClient is the better choice, as it is designed to handle backpressure effectively.</p>
<h3 id="9-7-Conclusion"><a href="#9-7-Conclusion" class="headerlink" title="9.7 Conclusion"></a>9.7 Conclusion</h3><p><a name="97-conclusion"></a></p>
<p>Backpressure is essential in reactive systems for maintaining stability and scalability. Spring WebClient leverages Project Reactor to support it, making it an excellent choice for modern applications handling large streams of data. While it adds some complexity, the benefits of resource management and smooth performance outweigh the drawbacks.</p>
<h3 id="Key-Takeaways"><a href="#Key-Takeaways" class="headerlink" title="Key Takeaways:"></a>Key Takeaways:</h3><ul>
<li><strong>Backpressure</strong>: A mechanism to control data flow in reactive systems.</li>
<li><strong>WebClient</strong>: Supports backpressure and is suitable for modern, scalable applications.</li>
<li><strong>RestTemplate</strong>: Synchronous and blocking, not suitable for handling large streams of data.</li>
<li><strong>Best Practices</strong>: Use WebClient for new applications requiring scalability and performance.</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/23/Deep-Dive-Spring-Boot-Retry-Mechanism-and-Implementation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/23/Deep-Dive-Spring-Boot-Retry-Mechanism-and-Implementation/" class="post-title-link" itemprop="url">Deep Dive Spring Boot Retry Mechanism and Implementation</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-10-23 20:52:55" itemprop="dateCreated datePublished" datetime="2024-10-23T20:52:55-04:00">2024-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-11-21 16:23:35" itemprop="dateModified" datetime="2025-11-21T16:23:35-05:00">2025-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/WebFlux/" itemprop="url" rel="index"><span itemprop="name">WebFlux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#spring-boot-retry-mechanism---detailed-guide-with-sample-code">Spring Boot Retry Mechanism - Detailed Guide with Sample Code</a><ul>
<li><a href="#1-introduction-to-spring-retry">1. Introduction to Spring Retry</a><ul>
<li><a href="#key-features">Key Features:</a></li>
</ul>
</li>
<li><a href="#2-how-retry-mechanism-works">2. How Retry Mechanism Works</a><ul>
<li><a href="#flow-of-retry-mechanism">Flow of Retry Mechanism:</a></li>
</ul>
</li>
<li><a href="#3-plain-retry-implementation-using-retrytemplate">3. Plain Retry Implementation using <code>RetryTemplate</code></a><ul>
<li><a href="#step-by-step-guide">Step-by-Step Guide:</a></li>
<li><a href="#key-points">Key Points:</a></li>
</ul>
</li>
<li><a href="#4-annotation-based-retry-implementation-using-retryable">4. Annotation-Based Retry Implementation using <code>@Retryable</code></a><ul>
<li><a href="#step-by-step-guide-1">Step-by-Step Guide:</a></li>
<li><a href="#key-points-1">Key Points:</a></li>
</ul>
</li>
<li><a href="#5-recovering-from-failure-using-recover">5. Recovering from Failure using <code>@Recover</code></a><ul>
<li><a href="#key-points-2">Key Points:</a></li>
<li><a href="#advanced-recovery">Advanced Recovery:</a></li>
</ul>
</li>
<li><a href="#6-flowchart-retry-mechanism">6. Flowchart: Retry Mechanism</a><ul>
<li><a href="#key-points-3">Key Points:</a></li>
</ul>
</li>
<li><a href="#7-multiple-recover-methods">7. Multiple Recover Methods</a><ul>
<li><a href="#example-multiple-recover-methods">Example: Multiple <code>@Recover</code> Methods</a></li>
<li><a href="#key-points-4">Key Points:</a></li>
<li><a href="#how-it-works">How It Works:</a></li>
<li><a href="#summary">Summary:</a></li>
</ul>
</li>
<li><a href="#8-conclusion">8. Conclusion</a><ul>
<li><a href="#key-takeaways">Key Takeaways:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h1 id="Spring-Boot-Retry-Mechanism-Detailed-Guide-with-Sample-Code"><a href="#Spring-Boot-Retry-Mechanism-Detailed-Guide-with-Sample-Code" class="headerlink" title="Spring Boot Retry Mechanism - Detailed Guide with Sample Code"></a>Spring Boot Retry Mechanism - Detailed Guide with Sample Code</h1><hr>
<h2 id="1-Introduction-to-Spring-Retry"><a href="#1-Introduction-to-Spring-Retry" class="headerlink" title="1. Introduction to Spring Retry"></a>1. Introduction to Spring Retry</h2><p><a name="1-introduction-to-spring-retry"></a></p>
<p>Spring Boot provides a robust retry mechanism through the <strong>Spring Retry</strong> module. This module allows developers to automatically retry operations that fail due to certain exceptions, making it highly useful for handling transient faults in distributed systems, such as network issues, service unavailability, and more.</p>
<p>Spring Retry can be implemented in two primary ways:</p>
<ul>
<li><strong>Programmatically</strong> using <code>RetryTemplate</code>.</li>
<li><strong>Declaratively</strong> using the <code>@Retryable</code> annotation.</li>
</ul>
<p>Additionally, Spring Retry supports recovery methods using the <code>@Recover</code> annotation, which can be invoked when all retry attempts are exhausted.</p>
<h3 id="Key-Features"><a href="#Key-Features" class="headerlink" title="Key Features:"></a>Key Features:</h3><ul>
<li><strong>Retry Policies</strong>: Define the number of retry attempts and conditions for retrying.</li>
<li><strong>Backoff Policies</strong>: Implement delays between retries, including fixed, exponential, and custom backoff strategies.</li>
<li><strong>Exception Handling</strong>: Retry based on specific exceptions or generic conditions.</li>
<li><strong>Recovery Mechanism</strong>: Gracefully handle failures using <code>@Recover</code> methods.</li>
</ul>
<hr>
<h2 id="2-How-Retry-Mechanism-Works"><a href="#2-How-Retry-Mechanism-Works" class="headerlink" title="2. How Retry Mechanism Works"></a>2. How Retry Mechanism Works</h2><p><a name="2-how-retry-mechanism-works"></a></p>
<p>The retry mechanism in Spring operates as follows:</p>
<ul>
<li>When a method annotated with <code>@Retryable</code> or executed via <code>RetryTemplate</code> encounters an exception, Spring can automatically retry that method a configurable number of times.</li>
<li>The retry logic can be customized based on specific exceptions or broader conditions.</li>
<li>Spring supports various backoff policies, such as fixed delays, exponential backoff, and custom backoff strategies, to manage the interval between retry attempts.</li>
<li>After exhausting the maximum retry attempts, a <code>@Recover</code> method can be invoked to handle the failure gracefully.</li>
</ul>
<h3 id="Flow-of-Retry-Mechanism"><a href="#Flow-of-Retry-Mechanism" class="headerlink" title="Flow of Retry Mechanism:"></a>Flow of Retry Mechanism:</h3><ol>
<li><strong>Method Invocation</strong>: The retryable method is invoked.</li>
<li><strong>Exception Occurs</strong>: If an exception occurs, Spring checks if the method is retryable.</li>
<li><strong>Retry Policy</strong>: The retry policy determines whether to retry the method.</li>
<li><strong>Backoff Policy</strong>: If retries are allowed, the backoff policy defines the delay before the next retry.</li>
<li><strong>Retry Execution</strong>: The method is retried according to the defined policy.</li>
<li><strong>Recovery</strong>: If all retries fail, the <code>@Recover</code> method is invoked.</li>
</ol>
<hr>
<h2 id="3-Plain-Retry-Implementation-using-RetryTemplate"><a href="#3-Plain-Retry-Implementation-using-RetryTemplate" class="headerlink" title="3. Plain Retry Implementation using RetryTemplate"></a>3. Plain Retry Implementation using <code>RetryTemplate</code></h2><p><a name="3-plain-retry-implementation-using-retrytemplate"></a></p>
<p>The <code>RetryTemplate</code> is used to implement the retry mechanism programmatically. This approach provides fine-grained control over the retry logic and is ideal for complex scenarios.</p>
<h3 id="Step-by-Step-Guide"><a href="#Step-by-Step-Guide" class="headerlink" title="Step-by-Step Guide:"></a>Step-by-Step Guide:</h3><ol>
<li><p><strong>Add Dependencies</strong> in <code>pom.xml</code> (if using Maven):</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.retry<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-retry<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Define <code>RetryTemplate</code> Bean</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RetryConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RetryTemplate <span class="title function_">retryTemplate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">RetryTemplate</span> <span class="variable">retryTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RetryTemplate</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Define retry policy (e.g., 3 attempts for any exception)</span></span><br><span class="line">        <span class="type">SimpleRetryPolicy</span> <span class="variable">retryPolicy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleRetryPolicy</span>();</span><br><span class="line">        retryPolicy.setMaxAttempts(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Define backoff policy (e.g., 2 seconds between retries)</span></span><br><span class="line">        <span class="type">FixedBackOffPolicy</span> <span class="variable">backOffPolicy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FixedBackOffPolicy</span>();</span><br><span class="line">        backOffPolicy.setBackOffPeriod(<span class="number">2000</span>); <span class="comment">// 2000 ms = 2 seconds</span></span><br><span class="line"></span><br><span class="line">        retryTemplate.setRetryPolicy(retryPolicy);</span><br><span class="line">        retryTemplate.setBackOffPolicy(backOffPolicy);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> retryTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Use <code>RetryTemplate</code> in Business Logic</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RetryTemplate retryTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">performTask</span><span class="params">()</span> &#123;</span><br><span class="line">        retryTemplate.execute(context -&gt; &#123;</span><br><span class="line">            <span class="comment">// Logic that might fail</span></span><br><span class="line">            System.out.println(<span class="string">&quot;Attempting task...&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(<span class="number">10</span>) &lt; <span class="number">8</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Failed task&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;Task succeeded&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Main Application</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RetryApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(RetryApplication.class, args);</span><br><span class="line">        <span class="type">MyService</span> <span class="variable">service</span> <span class="operator">=</span> context.getBean(MyService.class);</span><br><span class="line">        service.performTask();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="Key-Points"><a href="#Key-Points" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>RetryTemplate</strong>: Provides a flexible way to define retry policies and backoff strategies.</li>
<li><strong>SimpleRetryPolicy</strong>: Defines the maximum number of retry attempts.</li>
<li><strong>FixedBackOffPolicy</strong>: Sets a fixed delay between retry attempts.</li>
<li><strong>execute() Method</strong>: Executes the retry logic within a lambda expression.</li>
</ul>
<hr>
<h2 id="4-Annotation-Based-Retry-Implementation-using-Retryable"><a href="#4-Annotation-Based-Retry-Implementation-using-Retryable" class="headerlink" title="4. Annotation-Based Retry Implementation using @Retryable"></a>4. Annotation-Based Retry Implementation using <code>@Retryable</code></h2><p><a name="4-annotation-based-retry-implementation-using-retryable"></a></p>
<p>The annotation-based approach uses the <code>@Retryable</code> annotation to automatically retry methods without explicitly defining a <code>RetryTemplate</code>. This method is simpler and more concise, making it ideal for straightforward retry scenarios.</p>
<h3 id="Step-by-Step-Guide-1"><a href="#Step-by-Step-Guide-1" class="headerlink" title="Step-by-Step Guide:"></a>Step-by-Step Guide:</h3><ol>
<li><p><strong>Add Dependencies</strong> (same as in <code>RetryTemplate</code> approach).</p>
</li>
<li><p><strong>Enable Retry in Spring Boot Application</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableRetry</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RetryApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(RetryApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Use <code>@Retryable</code> Annotation</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Retryable(</span></span><br><span class="line"><span class="meta">        value = &#123; RuntimeException.class &#125;, // Retry on specific exceptions</span></span><br><span class="line"><span class="meta">        maxAttempts = 3,                     // Retry up to 3 times</span></span><br><span class="line"><span class="meta">        backoff = @Backoff(delay = 2000)     // 2 seconds delay between retries</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">performTask</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Attempting task...&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(<span class="number">10</span>) &lt; <span class="number">8</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Task failed&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;Task succeeded&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Recover from Failure using <code>@Recover</code></strong>:<br>You can define a recovery method that will be called when all retry attempts are exhausted.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Retryable(</span></span><br><span class="line"><span class="meta">        value = &#123; RuntimeException.class &#125;,</span></span><br><span class="line"><span class="meta">        maxAttempts = 3,</span></span><br><span class="line"><span class="meta">        backoff = @Backoff(delay = 2000)</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">performTask</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Attempting task...&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(<span class="number">10</span>) &lt; <span class="number">8</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Task failed&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;Task succeeded&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Recover</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">recover</span><span class="params">(RuntimeException e)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Recovering from failure: &quot;</span> + e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="Key-Points-1"><a href="#Key-Points-1" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>@Retryable</strong>: Specifies the method to be retried, along with the retry conditions and backoff policy.</li>
<li><strong>@Recover</strong>: Defines a fallback method to handle failures after all retries are exhausted.</li>
<li><strong>@EnableRetry</strong>: Enables the retry mechanism in the Spring Boot application.</li>
</ul>
<hr>
<h2 id="5-Recovering-from-Failure-using-Recover"><a href="#5-Recovering-from-Failure-using-Recover" class="headerlink" title="5. Recovering from Failure using @Recover"></a>5. Recovering from Failure using <code>@Recover</code></h2><p><a name="5-recovering-from-failure-using-recover"></a></p>
<p>The <code>@Recover</code> annotation is used to define a fallback method that will be called when all retry attempts fail. This method allows you to handle the failure gracefully and provide a fallback response.</p>
<h3 id="Key-Points-2"><a href="#Key-Points-2" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li>The method annotated with <code>@Recover</code> must have the same return type as the retryable method.</li>
<li>It must accept the exception type being handled as a parameter.</li>
</ul>
<p>Example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Recover</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">recoverFromFailure</span><span class="params">(RuntimeException e)</span> &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Recovery logic for exception: &quot;</span> + e.getMessage());</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Fallback result&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In the above example, when all retries fail, the <code>recoverFromFailure()</code> method will be called, and the fallback result will be returned.</p>
<h3 id="Advanced-Recovery"><a href="#Advanced-Recovery" class="headerlink" title="Advanced Recovery:"></a>Advanced Recovery:</h3><ul>
<li><strong>Multiple <code>@Recover</code> Methods</strong>: You can define multiple recovery methods for different exception types, allowing for more granular error handling.</li>
<li><strong>Parameter Matching</strong>: The recovery methods parameters must match the retryable methods parameters, except for the first parameter, which must be the exception type.</li>
</ul>
<hr>
<h2 id="6-Flowchart-Retry-Mechanism"><a href="#6-Flowchart-Retry-Mechanism" class="headerlink" title="6. Flowchart: Retry Mechanism"></a>6. Flowchart: Retry Mechanism</h2><p><a name="6-flowchart-retry-mechanism"></a></p>
<p>Below is a textual representation of the Spring Boot retry mechanism flowchart:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">+------------------------------------------+</span><br><span class="line">|      Start Application                   |</span><br><span class="line">+------------------------------------------+</span><br><span class="line">               |</span><br><span class="line">               V</span><br><span class="line">+------------------------------------------+</span><br><span class="line">|  Method Invoked (e.g., performTask)      |</span><br><span class="line">+------------------------------------------+</span><br><span class="line">               |</span><br><span class="line">               V</span><br><span class="line">+---------------------------------------------------+</span><br><span class="line">|  Is Retryable? (Check @Retryable or RT)           |</span><br><span class="line">+---------------------------------------------------+</span><br><span class="line">   Yes |                                     No |</span><br><span class="line">       V                                        V</span><br><span class="line">+-------------------------------------+  +-----------------------------+</span><br><span class="line">|  Try Method Execution               |  |  No retry, continue normal  |</span><br><span class="line">|                                     |  |  method execution           |</span><br><span class="line">+-------------------------------------+  +-----------------------------+</span><br><span class="line">               |</span><br><span class="line">               V</span><br><span class="line">+--------------------------------------------------+</span><br><span class="line">|  Method Execution Fails?                         |</span><br><span class="line">+--------------------------------------------------+</span><br><span class="line">   Yes |                                       No |</span><br><span class="line">       V                                          V</span><br><span class="line">+------------------------------------------+ +-----------------------------+</span><br><span class="line">|  Retry Policy Check (max attempts?)      | |  Method succeeds, continue  |</span><br><span class="line">+------------------------------------------+ +-----------------------------+</span><br><span class="line">   Yes |                                          No |</span><br><span class="line">       V                                             V</span><br><span class="line">+------------------------------------------+ +-----------------------------+</span><br><span class="line">|  Retry Backoff (delay before retry)      | |  Call @Recover method       |</span><br><span class="line">+------------------------------------------+ +-----------------------------+</span><br><span class="line">               |</span><br><span class="line">               V</span><br><span class="line">+------------------------------------------+</span><br><span class="line">|  Retry Method Execution                  |</span><br><span class="line">+------------------------------------------+</span><br><span class="line">               |</span><br><span class="line">               V</span><br><span class="line">+-------------------------------------------------------+</span><br><span class="line">|  Retry Limit Reached or Success?                      |</span><br><span class="line">+-------------------------------------------------------+</span><br><span class="line">  Retry Limit |                                 Success |</span><br><span class="line">              V                                         V</span><br><span class="line">+------------------------------------------+ +-----------------------------+</span><br><span class="line">|  Call @Recover method                    | |  Continue normal execution  |</span><br><span class="line">+------------------------------------------+ +-----------------------------+</span><br></pre></td></tr></table></figure>

<h3 id="Key-Points-3"><a href="#Key-Points-3" class="headerlink" title="Key Points:"></a>Key Points:</h3><ul>
<li><strong>Retryable Check</strong>: Determines if the method is eligible for retries.</li>
<li><strong>Retry Policy</strong>: Defines the number of retry attempts and conditions.</li>
<li><strong>Backoff Policy</strong>: Manages the delay between retry attempts.</li>
<li><strong>Recovery Method</strong>: Handles failures after all retries are exhausted.</li>
</ul>
<hr>
<h2 id="7-Multiple-Recover-Methods"><a href="#7-Multiple-Recover-Methods" class="headerlink" title="7. Multiple Recover Methods"></a>7. Multiple Recover Methods</h2><p><a name="7-multiple-recover-methods"></a></p>
<p>In Spring Retry, while it might seem like there is no explicit way to specify a recover method in the <code>@Retryable</code> annotation itself, you can still have multiple recover methods in the same class. Spring Retry allows you to define <strong>different recovery methods</strong> by relying on <strong>method signatures</strong>.</p>
<p>The framework will match the appropriate recovery method based on the <strong>parameters</strong> of the method, so each <code>@Recover</code> method corresponds to a specific exception type (or a list of exception types) that its designed to handle.</p>
<h3 id="Example-Multiple-Recover-Methods"><a href="#Example-Multiple-Recover-Methods" class="headerlink" title="Example: Multiple @Recover Methods"></a>Example: Multiple <code>@Recover</code> Methods</h3><p><a name="example-multiple-recover-methods"></a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApiService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ApiService</span><span class="params">(RestTemplateBuilder restTemplateBuilder)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.restTemplate = restTemplateBuilder.build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Retryable method for HTTP client errors</span></span><br><span class="line">    <span class="meta">@Retryable(</span></span><br><span class="line"><span class="meta">        value = &#123; HttpClientErrorException.class &#125;,</span></span><br><span class="line"><span class="meta">        maxAttempts = 4,</span></span><br><span class="line"><span class="meta">        backoff = @Backoff(delay = 1000)</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">invokeClientApi</span><span class="params">(String url)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(url, String.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Retryable method for HTTP server errors</span></span><br><span class="line">    <span class="meta">@Retryable(</span></span><br><span class="line"><span class="meta">        value = &#123; HttpServerErrorException.class &#125;,</span></span><br><span class="line"><span class="meta">        maxAttempts = 4,</span></span><br><span class="line"><span class="meta">        backoff = @Backoff(delay = 1000)</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">invokeServerApi</span><span class="params">(String url)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(url, String.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Recovery method for HTTP client errors</span></span><br><span class="line">    <span class="meta">@Recover</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">recoverClientError</span><span class="params">(HttpClientErrorException e, String url)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Client error fallback for URL: &quot;</span> + url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Recovery method for HTTP server errors</span></span><br><span class="line">    <span class="meta">@Recover</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">recoverServerError</span><span class="params">(HttpServerErrorException e, String url)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Server error fallback for URL: &quot;</span> + url;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Key-Points-4"><a href="#Key-Points-4" class="headerlink" title="Key Points:"></a>Key Points:</h3><p><a name="key-points-1"></a></p>
<ul>
<li><strong>Different <code>@Recover</code> methods</strong> are defined based on the exception type (e.g., <code>HttpClientErrorException</code> vs. <code>HttpServerErrorException</code>).</li>
<li>The recovery methods <strong>first parameter</strong> is the exception type that triggered the retry failure. This is how Spring determines which recover method to invoke.</li>
<li><strong>Additional parameters</strong> (like <code>url</code> in the example) must match the parameters of the corresponding retryable method.</li>
</ul>
<h3 id="How-It-Works"><a href="#How-It-Works" class="headerlink" title="How It Works:"></a>How It Works:</h3><p><a name="how-it-works"></a></p>
<ol>
<li>If the retryable method (<code>invokeClientApi</code> or <code>invokeServerApi</code>) fails after exhausting the retry attempts, Spring will look for a recovery method based on the exception type.</li>
<li>The recovery method (<code>recoverClientError</code> or <code>recoverServerError</code>) will be called depending on whether a <code>HttpClientErrorException</code> or a <code>HttpServerErrorException</code> occurred.</li>
</ol>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary:"></a>Summary:</h3><p><a name="summary"></a><br>A class can have <strong>multiple <code>@Recover</code> methods</strong>. Spring matches the correct recovery method based on the exception type and method signature, so you can create recover methods for different types of exceptions in the same class.</p>
<hr>
<h2 id="8-Conclusion"><a href="#8-Conclusion" class="headerlink" title="8. Conclusion"></a>8. Conclusion</h2><p><a name="8-conclusion"></a></p>
<p>Spring Boots retry mechanism provides a simple and powerful way to retry failed operations, with both <strong>programmatic</strong> (<code>RetryTemplate</code>) and <strong>declarative</strong> (<code>@Retryable</code>) support. Additionally, recovery methods allow handling failure gracefully after retry attempts are exhausted.</p>
<p>Whether you choose to use <code>RetryTemplate</code> or <code>@Retryable</code>, both approaches are robust solutions for retrying failed methods in Spring applications.</p>
<h3 id="Key-Takeaways"><a href="#Key-Takeaways" class="headerlink" title="Key Takeaways:"></a>Key Takeaways:</h3><ul>
<li><strong>RetryTemplate</strong>: Offers fine-grained control over retry logic.</li>
<li><strong>@Retryable</strong>: Provides a simpler, declarative approach to retries.</li>
<li><strong>@Recover</strong>: Enables graceful handling of failures after retries are exhausted.</li>
<li><strong>Multiple Recover Methods</strong>: Allows for granular error handling based on exception types.</li>
</ul>
<p>By leveraging Spring Retry, developers can build resilient applications that can handle transient faults effectively, ensuring higher availability and reliability.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/13/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/15/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Dazhi Zhang</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.1/mermaid.min.js","integrity":"sha256-YbM1pG3wWnzhyYN49g5fPnen+2CKEFaZfopkkwSpNtY="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  





</body>
</html>
