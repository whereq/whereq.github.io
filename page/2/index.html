<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.whereq.com","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.21.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="WhereQ">
<meta property="og:url" content="https://www.whereq.com/page/2/index.html">
<meta property="og:site_name" content="WhereQ">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Dazhi Zhang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.whereq.com/page/2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/2/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>WhereQ</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">WhereQ</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-articles"><a href="/articles/" rel="section"><i class="fa fa-file fa-fw"></i>Articles</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Dazhi Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">100</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">90</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">56</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/03/Best-Practices-of-Linux-System-Performance-Analysis-and-Tuning-with-CLI/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/03/Best-Practices-of-Linux-System-Performance-Analysis-and-Tuning-with-CLI/" class="post-title-link" itemprop="url">Best Practices of Linux System Performance Analysis and Tuning with CLI</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-03 12:06:47 / Modified: 12:07:44" itemprop="dateCreated datePublished" datetime="2024-11-03T12:06:47-05:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/" itemprop="url" rel="index"><span itemprop="name">Best Practices</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/System/" itemprop="url" rel="index"><span itemprop="name">System</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/System/Performance/" itemprop="url" rel="index"><span itemprop="name">Performance</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/System/Performance/Troubleshooting/" itemprop="url" rel="index"><span itemprop="name">Troubleshooting</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/System/Performance/Troubleshooting/CLI/" itemprop="url" rel="index"><span itemprop="name">CLI</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-system-monitoring">Basic System Monitoring</a><ul>
<li><a href="#-check-cpu-usage"> Check CPU Usage</a></li>
<li><a href="#-check-memory-usage"> Check Memory Usage</a></li>
<li><a href="#-check-disk-io"> Check Disk I&#x2F;O</a></li>
<li><a href="#-check-network-traffic"> Check Network Traffic</a></li>
</ul>
</li>
<li><a href="#process-monitoring">Process Monitoring</a><ul>
<li><a href="#-list-running-processes"> List Running Processes</a></li>
<li><a href="#-check-process-status"> Check Process Status</a></li>
<li><a href="#-kill-a-process"> Kill a Process</a></li>
</ul>
</li>
<li><a href="#advanced-performance-tuning">Advanced Performance Tuning</a><ul>
<li><a href="#-top"> Top</a></li>
<li><a href="#-htop"> Htop</a></li>
<li><a href="#-iotop"> Iotop</a></li>
<li><a href="#-sar"> Sar</a></li>
</ul>
</li>
<li><a href="#troubleshooting-real-production-issues">Troubleshooting Real Production Issues</a><ul>
<li><a href="#-high-cpu-usage"> High CPU Usage</a></li>
<li><a href="#-high-memory-usage"> High Memory Usage</a></li>
<li><a href="#-high-disk-io"> High Disk I&#x2F;O</a></li>
<li><a href="#-network-latency"> Network Latency</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Monitoring and tuning Linux system performance is crucial for maintaining the health and efficiency of your infrastructure. Command line tools like <code>top</code>, <code>htop</code>, <code>iotop</code>, <code>sar</code>, <code>ps</code>, <code>free</code>, <code>vmstat</code>, and <code>netstat</code> provide powerful capabilities for analyzing and optimizing system performance. This article provides a comprehensive guide to the best practices of using these tools, covering various scenarios such as checking CPU and memory usage, monitoring processes, and troubleshooting real production issues.</p>
<hr>
<p><a name="basic-system-monitoring"></a></p>
<h2 id="Basic-System-Monitoring"><a href="#Basic-System-Monitoring" class="headerlink" title="Basic System Monitoring"></a>Basic System Monitoring</h2><h3 id="Check-CPU-Usage"><a href="#Check-CPU-Usage" class="headerlink" title=" Check CPU Usage"></a><a name="check-cpu-usage"></a> Check CPU Usage</h3><p>To check CPU usage, use the <code>top</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top</span><br></pre></td></tr></table></figure>

<p>This command displays real-time CPU and memory usage, along with a list of running processes.</p>
<h3 id="Check-Memory-Usage"><a href="#Check-Memory-Usage" class="headerlink" title=" Check Memory Usage"></a><a name="check-memory-usage"></a> Check Memory Usage</h3><p>To check memory usage, use the <code>free</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">free -h</span><br></pre></td></tr></table></figure>

<p>This command displays the total, used, and free memory in a human-readable format.</p>
<h3 id="Check-Disk-I-O"><a href="#Check-Disk-I-O" class="headerlink" title=" Check Disk I&#x2F;O"></a><a name="check-disk-io"></a> Check Disk I&#x2F;O</h3><p>To check disk I&#x2F;O, use the <code>iostat</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat -x 1</span><br></pre></td></tr></table></figure>

<p>This command displays detailed I&#x2F;O statistics, including read and write rates.</p>
<h3 id="Check-Network-Traffic"><a href="#Check-Network-Traffic" class="headerlink" title=" Check Network Traffic"></a><a name="check-network-traffic"></a> Check Network Traffic</h3><p>To check network traffic, use the <code>iftop</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iftop -i eth0</span><br></pre></td></tr></table></figure>

<p>This command displays real-time network traffic on the <code>eth0</code> interface.</p>
<hr>
<p><a name="process-monitoring"></a></p>
<h2 id="Process-Monitoring"><a href="#Process-Monitoring" class="headerlink" title="Process Monitoring"></a>Process Monitoring</h2><h3 id="List-Running-Processes"><a href="#List-Running-Processes" class="headerlink" title=" List Running Processes"></a><a name="list-running-processes"></a> List Running Processes</h3><p>To list all running processes, use the <code>ps</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux</span><br></pre></td></tr></table></figure>

<p>This command displays a detailed list of all running processes.</p>
<h3 id="Check-Process-Status"><a href="#Check-Process-Status" class="headerlink" title=" Check Process Status"></a><a name="check-process-status"></a> Check Process Status</h3><p>To check the status of a specific process, use the <code>ps</code> command with the process ID (PID):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -p &lt;PID&gt; -o pid,ppid,cmd,%cpu,%mem,state</span><br></pre></td></tr></table></figure>

<p>This command displays the status of the process with the specified PID.</p>
<h3 id="Kill-a-Process"><a href="#Kill-a-Process" class="headerlink" title=" Kill a Process"></a><a name="kill-a-process"></a> Kill a Process</h3><p>To kill a process, use the <code>kill</code> command with the process ID (PID):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> &lt;PID&gt;</span><br></pre></td></tr></table></figure>

<p>This command sends a termination signal to the process with the specified PID.</p>
<hr>
<p><a name="advanced-performance-tuning"></a></p>
<h2 id="Advanced-Performance-Tuning"><a href="#Advanced-Performance-Tuning" class="headerlink" title="Advanced Performance Tuning"></a>Advanced Performance Tuning</h2><h3 id="Top"><a href="#Top" class="headerlink" title=" Top"></a><a name="top"></a> Top</h3><p>To monitor system performance in real-time, use the <code>top</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top</span><br></pre></td></tr></table></figure>

<p>This command provides a dynamic view of system resources and running processes.</p>
<h3 id="Htop"><a href="#Htop" class="headerlink" title=" Htop"></a><a name="htop"></a> Htop</h3><p>To monitor system performance with a more user-friendly interface, use <code>htop</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">htop</span><br></pre></td></tr></table></figure>

<p>This command provides a colorful and interactive view of system resources and running processes.</p>
<h3 id="Iotop"><a href="#Iotop" class="headerlink" title=" Iotop"></a><a name="iotop"></a> Iotop</h3><p>To monitor disk I&#x2F;O in real-time, use the <code>iotop</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iotop</span><br></pre></td></tr></table></figure>

<p>This command displays real-time disk I&#x2F;O statistics for running processes.</p>
<h3 id="Sar"><a href="#Sar" class="headerlink" title=" Sar"></a><a name="sar"></a> Sar</h3><p>To collect and report system activity, use the <code>sar</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sar -u 1 5</span><br></pre></td></tr></table></figure>

<p>This command collects CPU usage statistics every second for 5 seconds.</p>
<hr>
<p><a name="troubleshooting-real-production-issues"></a></p>
<h2 id="Troubleshooting-Real-Production-Issues"><a href="#Troubleshooting-Real-Production-Issues" class="headerlink" title="Troubleshooting Real Production Issues"></a>Troubleshooting Real Production Issues</h2><h3 id="High-CPU-Usage"><a href="#High-CPU-Usage" class="headerlink" title=" High CPU Usage"></a><a name="high-cpu-usage"></a> High CPU Usage</h3><p>To identify processes causing high CPU usage, use <code>top</code> or <code>htop</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top</span><br></pre></td></tr></table></figure>

<p>Sort processes by CPU usage by pressing <code>P</code>.</p>
<h3 id="High-Memory-Usage"><a href="#High-Memory-Usage" class="headerlink" title=" High Memory Usage"></a><a name="high-memory-usage"></a> High Memory Usage</h3><p>To identify processes causing high memory usage, use <code>top</code> or <code>htop</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top</span><br></pre></td></tr></table></figure>

<p>Sort processes by memory usage by pressing <code>M</code>.</p>
<h3 id="High-Disk-I-O"><a href="#High-Disk-I-O" class="headerlink" title=" High Disk I&#x2F;O"></a><a name="high-disk-io"></a> High Disk I&#x2F;O</h3><p>To identify processes causing high disk I&#x2F;O, use <code>iotop</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iotop</span><br></pre></td></tr></table></figure>

<p>This command displays real-time disk I&#x2F;O statistics for running processes.</p>
<h3 id="Network-Latency"><a href="#Network-Latency" class="headerlink" title=" Network Latency"></a><a name="network-latency"></a> Network Latency</h3><p>To diagnose network latency, use <code>ping</code> and <code>traceroute</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ping google.com</span><br><span class="line">traceroute google.com</span><br></pre></td></tr></table></figure>

<p>These commands help identify network latency and routing issues.</p>
<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Monitoring and tuning Linux system performance is essential for maintaining the health and efficiency of your infrastructure. By mastering the various options and scenarios covered in this article, you can effectively use command line tools like <code>top</code>, <code>htop</code>, <code>iotop</code>, <code>sar</code>, <code>ps</code>, <code>free</code>, <code>vmstat</code>, and <code>netstat</code> to analyze and optimize system performance.</p>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/top.1.html">top Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://hisham.hm/htop/index.php?page=documentation">htop Man Page</a></li>
<li><a target="_blank" rel="noopener" href="http://www.ex-parrot.com/pdw/iftop/iftop-man.html">iotop Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/sar.1.html">sar Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/ps.1.html">ps Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/free.1.html">free Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man8/iostat.8.html">iostat Man Page</a></li>
<li><a target="_blank" rel="noopener" href="http://www.ex-parrot.com/pdw/iftop/iftop-man.html">iftop Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man8/ping.8.html">ping Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man8/traceroute.8.html">traceroute Man Page</a></li>
</ol>
<p>By following these best practices, you can leverage these system performance tools to their full potential and efficiently manage your monitoring and tuning tasks.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/03/Best-Practices-of-Using-Command-Line-Tools-for-Network-Analysis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/03/Best-Practices-of-Using-Command-Line-Tools-for-Network-Analysis/" class="post-title-link" itemprop="url">Best Practices of Using Command Line Tools for Network Analysis</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-03 12:02:12 / Modified: 12:02:44" itemprop="dateCreated datePublished" datetime="2024-11-03T12:02:12-05:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/" itemprop="url" rel="index"><span itemprop="name">Best Practices</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/Network/" itemprop="url" rel="index"><span itemprop="name">Network</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/Network/CLI/" itemprop="url" rel="index"><span itemprop="name">CLI</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-network-analysis">Basic Network Analysis</a><ul>
<li><a href="#-ping"> Ping</a></li>
<li><a href="#-traceroute"> Traceroute</a></li>
<li><a href="#-netstat"> Netstat</a></li>
<li><a href="#-netcat"> Netcat</a></li>
</ul>
</li>
<li><a href="#advanced-network-analysis">Advanced Network Analysis</a><ul>
<li><a href="#-tcpdump"> Tcpdump</a></li>
<li><a href="#-wireshark"> Wireshark</a></li>
<li><a href="#-nmap"> Nmap</a></li>
<li><a href="#-iftop"> Iftop</a></li>
</ul>
</li>
<li><a href="#combining-commands">Combining Commands</a><ul>
<li><a href="#-using-grep-with-tcpdump"> Using <code>grep</code> with <code>tcpdump</code></a></li>
<li><a href="#-using-awk-with-netstat"> Using <code>awk</code> with <code>netstat</code></a></li>
<li><a href="#-using-sed-with-nmap"> Using <code>sed</code> with <code>nmap</code></a></li>
</ul>
</li>
<li><a href="#advanced-scenarios">Advanced Scenarios</a><ul>
<li><a href="#-analyzing-http-traffic"> Analyzing HTTP Traffic</a></li>
<li><a href="#-monitoring-real-time-traffic"> Monitoring Real-Time Traffic</a></li>
<li><a href="#-diagnosing-network-issues"> Diagnosing Network Issues</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Network analysis is a critical skill for system administrators and network engineers. Command line tools like <code>ping</code>, <code>traceroute</code>, <code>netstat</code>, <code>tcpdump</code>, <code>nmap</code>, <code>iftop</code>, and <code>wireshark</code> provide powerful capabilities for monitoring, diagnosing, and troubleshooting network issues. This article provides a comprehensive guide to the best practices of using these tools, covering various scenarios such as capturing and filtering network traffic, displaying network statistics, and diagnosing network issues.</p>
<hr>
<p><a name="basic-network-analysis"></a></p>
<h2 id="Basic-Network-Analysis"><a href="#Basic-Network-Analysis" class="headerlink" title="Basic Network Analysis"></a>Basic Network Analysis</h2><h3 id="Ping"><a href="#Ping" class="headerlink" title=" Ping"></a><a name="ping"></a> Ping</h3><p>To check connectivity to a host, use the <code>ping</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping google.com</span><br></pre></td></tr></table></figure>

<p>This command sends ICMP echo requests to the specified host and displays the response time.</p>
<h3 id="Traceroute"><a href="#Traceroute" class="headerlink" title=" Traceroute"></a><a name="traceroute"></a> Traceroute</h3><p>To trace the route to a host, use the <code>traceroute</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">traceroute google.com</span><br></pre></td></tr></table></figure>

<p>This command shows the path packets take to reach the specified host.</p>
<h3 id="Netstat"><a href="#Netstat" class="headerlink" title=" Netstat"></a><a name="netstat"></a> Netstat</h3><p>To display network statistics and active connections, use the <code>netstat</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -a</span><br></pre></td></tr></table></figure>

<p>This command displays all active connections and listening ports.</p>
<h3 id="Netcat"><a href="#Netcat" class="headerlink" title=" Netcat"></a><a name="netcat"></a> Netcat</h3><p>To test network connections and transfer data, use the <code>nc</code> (netcat) command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -zv google.com 80</span><br></pre></td></tr></table></figure>

<p>This command checks if port 80 is open on <code>google.com</code>.</p>
<hr>
<p><a name="advanced-network-analysis"></a></p>
<h2 id="Advanced-Network-Analysis"><a href="#Advanced-Network-Analysis" class="headerlink" title="Advanced Network Analysis"></a>Advanced Network Analysis</h2><h3 id="Tcpdump"><a href="#Tcpdump" class="headerlink" title=" Tcpdump"></a><a name="tcpdump"></a> Tcpdump</h3><p>To capture and analyze network traffic, use the <code>tcpdump</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -i eth0</span><br></pre></td></tr></table></figure>

<p>This command captures all traffic on the <code>eth0</code> interface.</p>
<h3 id="Wireshark"><a href="#Wireshark" class="headerlink" title=" Wireshark"></a><a name="wireshark"></a> Wireshark</h3><p>To capture and analyze network traffic with a graphical interface, use <code>wireshark</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wireshark</span><br></pre></td></tr></table></figure>

<p>This tool provides advanced filtering and analysis capabilities.</p>
<h3 id="Nmap"><a href="#Nmap" class="headerlink" title=" Nmap"></a><a name="nmap"></a> Nmap</h3><p>To scan for open ports and services on a host, use the <code>nmap</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap 192.168.1.1</span><br></pre></td></tr></table></figure>

<p>This command scans the specified IP address for open ports and services.</p>
<h3 id="Iftop"><a href="#Iftop" class="headerlink" title=" Iftop"></a><a name="iftop"></a> Iftop</h3><p>To monitor network traffic in real-time, use the <code>iftop</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iftop -i eth0</span><br></pre></td></tr></table></figure>

<p>This command displays real-time network traffic on the <code>eth0</code> interface.</p>
<hr>
<p><a name="combining-commands"></a></p>
<h2 id="Combining-Commands"><a href="#Combining-Commands" class="headerlink" title="Combining Commands"></a>Combining Commands</h2><h3 id="Using-grep-with-tcpdump"><a href="#Using-grep-with-tcpdump" class="headerlink" title=" Using grep with tcpdump"></a><a name="using-grep-with-tcpdump"></a> Using <code>grep</code> with <code>tcpdump</code></h3><p>To filter <code>tcpdump</code> output, use <code>grep</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -i eth0 | grep <span class="string">&quot;HTTP&quot;</span></span><br></pre></td></tr></table></figure>

<p>This command filters <code>tcpdump</code> output to show only HTTP traffic.</p>
<h3 id="Using-awk-with-netstat"><a href="#Using-awk-with-netstat" class="headerlink" title=" Using awk with netstat"></a><a name="using-awk-with-netstat"></a> Using <code>awk</code> with <code>netstat</code></h3><p>To process <code>netstat</code> output, use <code>awk</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -an | awk <span class="string">&#x27;/:80 / &#123;print $5&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>This command extracts the IP addresses of connections on port 80.</p>
<h3 id="Using-sed-with-nmap"><a href="#Using-sed-with-nmap" class="headerlink" title=" Using sed with nmap"></a><a name="using-sed-with-nmap"></a> Using <code>sed</code> with <code>nmap</code></h3><p>To process <code>nmap</code> output, use <code>sed</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap 192.168.1.1 | sed -n <span class="string">&#x27;/open/p&#x27;</span></span><br></pre></td></tr></table></figure>

<p>This command filters <code>nmap</code> output to show only open ports.</p>
<hr>
<p><a name="advanced-scenarios"></a></p>
<h2 id="Advanced-Scenarios"><a href="#Advanced-Scenarios" class="headerlink" title="Advanced Scenarios"></a>Advanced Scenarios</h2><h3 id="Analyzing-HTTP-Traffic"><a href="#Analyzing-HTTP-Traffic" class="headerlink" title=" Analyzing HTTP Traffic"></a><a name="analyzing-http-traffic"></a> Analyzing HTTP Traffic</h3><p>To capture and analyze HTTP traffic, use <code>tcpdump</code> with port filtering:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -i eth0 port 80</span><br></pre></td></tr></table></figure>

<h3 id="Monitoring-Real-Time-Traffic"><a href="#Monitoring-Real-Time-Traffic" class="headerlink" title=" Monitoring Real-Time Traffic"></a><a name="monitoring-real-time-traffic"></a> Monitoring Real-Time Traffic</h3><p>To monitor real-time traffic on a specific interface, use <code>iftop</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iftop -i eth0</span><br></pre></td></tr></table></figure>

<h3 id="Diagnosing-Network-Issues"><a href="#Diagnosing-Network-Issues" class="headerlink" title=" Diagnosing Network Issues"></a><a name="diagnosing-network-issues"></a> Diagnosing Network Issues</h3><p>To diagnose network issues, use a combination of <code>ping</code>, <code>traceroute</code>, and <code>tcpdump</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ping google.com</span><br><span class="line">traceroute google.com</span><br><span class="line">tcpdump -i eth0 host google.com</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Network analysis is a critical skill for maintaining and troubleshooting network infrastructure. By mastering the various options and scenarios covered in this article, you can effectively use command line tools like <code>ping</code>, <code>traceroute</code>, <code>netstat</code>, <code>tcpdump</code>, <code>nmap</code>, <code>iftop</code>, and <code>wireshark</code> to monitor, diagnose, and troubleshoot network issues.</p>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man8/ping.8.html">ping Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man8/traceroute.8.html">traceroute Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man8/netstat.8.html">netstat Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/nc.1.html">nc (netcat) Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://www.tcpdump.org/manpages/tcpdump.1.html">tcpdump Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://www.wireshark.org/docs/">Wireshark Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://nmap.org/book/man.html">nmap Man Page</a></li>
<li><a target="_blank" rel="noopener" href="http://www.ex-parrot.com/pdw/iftop/iftop-man.html">iftop Man Page</a></li>
</ol>
<p>By following these best practices, you can leverage these network analysis tools to their full potential and efficiently manage your network monitoring and troubleshooting tasks.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/03/Best-Practices-of-tcpdump-and-netstat/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/03/Best-Practices-of-tcpdump-and-netstat/" class="post-title-link" itemprop="url">Best Practices of tcpdump and netstat</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-03 12:01:11 / Modified: 12:01:50" itemprop="dateCreated datePublished" datetime="2024-11-03T12:01:11-05:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/" itemprop="url" rel="index"><span itemprop="name">Best Practices</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/Network/" itemprop="url" rel="index"><span itemprop="name">Network</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/Network/CLI/" itemprop="url" rel="index"><span itemprop="name">CLI</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#tcpdump">tcpdump</a><ul>
<li><a href="#-basic-usage"> Basic Usage</a></li>
<li><a href="#-filtering-traffic"> Filtering Traffic</a></li>
<li><a href="#-saving-captures"> Saving Captures</a></li>
<li><a href="#-reading-captures"> Reading Captures</a></li>
</ul>
</li>
<li><a href="#netstat">netstat</a><ul>
<li><a href="#-basic-usage-1"> Basic Usage</a></li>
<li><a href="#-displaying-active-connections"> Displaying Active Connections</a></li>
<li><a href="#-displaying-listening-ports"> Displaying Listening Ports</a></li>
<li><a href="#-displaying-network-statistics"> Displaying Network Statistics</a></li>
</ul>
</li>
<li><a href="#other-network-analysis-commands">Other Network Analysis Commands</a><ul>
<li><a href="#-ping"> ping</a></li>
<li><a href="#-traceroute"> traceroute</a></li>
<li><a href="#-nmap"> nmap</a></li>
<li><a href="#-iftop"> iftop</a></li>
</ul>
</li>
<li><a href="#advanced-scenarios">Advanced Scenarios</a><ul>
<li><a href="#-analyzing-http-traffic"> Analyzing HTTP Traffic</a></li>
<li><a href="#-monitoring-real-time-traffic"> Monitoring Real-Time Traffic</a></li>
<li><a href="#-diagnosing-network-issues"> Diagnosing Network Issues</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Network analysis is a critical skill for system administrators and network engineers. Tools like <code>tcpdump</code>, <code>netstat</code>, <code>ping</code>, <code>traceroute</code>, <code>nmap</code>, and <code>iftop</code> provide powerful capabilities for monitoring, diagnosing, and troubleshooting network issues. This article provides a comprehensive guide to the best practices of using these commands, covering various scenarios such as capturing and filtering network traffic, displaying network statistics, and diagnosing network issues.</p>
<hr>
<p><a name="tcpdump"></a></p>
<h2 id="tcpdump"><a href="#tcpdump" class="headerlink" title="tcpdump"></a>tcpdump</h2><h3 id="Basic-Usage"><a href="#Basic-Usage" class="headerlink" title=" Basic Usage"></a><a name="basic-usage-tcpdump"></a> Basic Usage</h3><p>To start capturing network traffic, use the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump</span><br></pre></td></tr></table></figure>

<p>This command captures all traffic on the default network interface.</p>
<h3 id="Filtering-Traffic"><a href="#Filtering-Traffic" class="headerlink" title=" Filtering Traffic"></a><a name="filtering-traffic-tcpdump"></a> Filtering Traffic</h3><p>To filter traffic by protocol, use the <code>-i</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -i eth0</span><br></pre></td></tr></table></figure>

<p>To filter traffic by IP address, use the <code>host</code> keyword:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump host 192.168.1.1</span><br></pre></td></tr></table></figure>

<p>To filter traffic by port, use the <code>port</code> keyword:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump port 80</span><br></pre></td></tr></table></figure>

<h3 id="Saving-Captures"><a href="#Saving-Captures" class="headerlink" title=" Saving Captures"></a><a name="saving-captures-tcpdump"></a> Saving Captures</h3><p>To save captured traffic to a file, use the <code>-w</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -w capture.pcap</span><br></pre></td></tr></table></figure>

<h3 id="Reading-Captures"><a href="#Reading-Captures" class="headerlink" title=" Reading Captures"></a><a name="reading-captures-tcpdump"></a> Reading Captures</h3><p>To read a saved capture file, use the <code>-r</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -r capture.pcap</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="netstat"></a></p>
<h2 id="netstat"><a href="#netstat" class="headerlink" title="netstat"></a>netstat</h2><h3 id="Basic-Usage-1"><a href="#Basic-Usage-1" class="headerlink" title=" Basic Usage"></a><a name="basic-usage-netstat"></a> Basic Usage</h3><p>To display all active connections, use the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -a</span><br></pre></td></tr></table></figure>

<h3 id="Displaying-Active-Connections"><a href="#Displaying-Active-Connections" class="headerlink" title=" Displaying Active Connections"></a><a name="displaying-active-connections-netstat"></a> Displaying Active Connections</h3><p>To display active TCP connections, use the <code>-t</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -at</span><br></pre></td></tr></table></figure>

<h3 id="Displaying-Listening-Ports"><a href="#Displaying-Listening-Ports" class="headerlink" title=" Displaying Listening Ports"></a><a name="displaying-listening-ports-netstat"></a> Displaying Listening Ports</h3><p>To display listening ports, use the <code>-l</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -lt</span><br></pre></td></tr></table></figure>

<h3 id="Displaying-Network-Statistics"><a href="#Displaying-Network-Statistics" class="headerlink" title=" Displaying Network Statistics"></a><a name="displaying-network-statistics-netstat"></a> Displaying Network Statistics</h3><p>To display network statistics, use the <code>-s</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -s</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="other-network-analysis-commands"></a></p>
<h2 id="Other-Network-Analysis-Commands"><a href="#Other-Network-Analysis-Commands" class="headerlink" title="Other Network Analysis Commands"></a>Other Network Analysis Commands</h2><h3 id="ping"><a href="#ping" class="headerlink" title=" ping"></a><a name="ping"></a> ping</h3><p>To check connectivity to a host, use the <code>ping</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping google.com</span><br></pre></td></tr></table></figure>

<h3 id="traceroute"><a href="#traceroute" class="headerlink" title=" traceroute"></a><a name="traceroute"></a> traceroute</h3><p>To trace the route to a host, use the <code>traceroute</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">traceroute google.com</span><br></pre></td></tr></table></figure>

<h3 id="nmap"><a href="#nmap" class="headerlink" title=" nmap"></a><a name="nmap"></a> nmap</h3><p>To scan for open ports on a host, use the <code>nmap</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap 192.168.1.1</span><br></pre></td></tr></table></figure>

<h3 id="iftop"><a href="#iftop" class="headerlink" title=" iftop"></a><a name="iftop"></a> iftop</h3><p>To monitor network traffic in real-time, use the <code>iftop</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iftop -i eth0</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="advanced-scenarios"></a></p>
<h2 id="Advanced-Scenarios"><a href="#Advanced-Scenarios" class="headerlink" title="Advanced Scenarios"></a>Advanced Scenarios</h2><h3 id="Analyzing-HTTP-Traffic"><a href="#Analyzing-HTTP-Traffic" class="headerlink" title=" Analyzing HTTP Traffic"></a><a name="analyzing-http-traffic"></a> Analyzing HTTP Traffic</h3><p>To capture and analyze HTTP traffic, use <code>tcpdump</code> with port filtering:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -i eth0 port 80</span><br></pre></td></tr></table></figure>

<h3 id="Monitoring-Real-Time-Traffic"><a href="#Monitoring-Real-Time-Traffic" class="headerlink" title=" Monitoring Real-Time Traffic"></a><a name="monitoring-real-time-traffic"></a> Monitoring Real-Time Traffic</h3><p>To monitor real-time traffic on a specific interface, use <code>iftop</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iftop -i eth0</span><br></pre></td></tr></table></figure>

<h3 id="Diagnosing-Network-Issues"><a href="#Diagnosing-Network-Issues" class="headerlink" title=" Diagnosing Network Issues"></a><a name="diagnosing-network-issues"></a> Diagnosing Network Issues</h3><p>To diagnose network issues, use a combination of <code>ping</code>, <code>traceroute</code>, and <code>tcpdump</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ping google.com</span><br><span class="line">traceroute google.com</span><br><span class="line">tcpdump -i eth0 host google.com</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Network analysis is a critical skill for maintaining and troubleshooting network infrastructure. By mastering the various options and scenarios covered in this article, you can effectively use tools like <code>tcpdump</code>, <code>netstat</code>, <code>ping</code>, <code>traceroute</code>, <code>nmap</code>, and <code>iftop</code> to monitor, diagnose, and troubleshoot network issues.</p>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://www.tcpdump.org/manpages/tcpdump.1.html">tcpdump Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man8/netstat.8.html">netstat Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man8/ping.8.html">ping Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man8/traceroute.8.html">traceroute Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://nmap.org/book/man.html">nmap Man Page</a></li>
<li><a target="_blank" rel="noopener" href="http://www.ex-parrot.com/pdw/iftop/iftop-man.html">iftop Man Page</a></li>
</ol>
<p>By following these best practices, you can leverage these network analysis tools to their full potential and efficiently manage your network monitoring and troubleshooting tasks.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/03/Best-Practices-of-Using-the-sed-Command/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/03/Best-Practices-of-Using-the-sed-Command/" class="post-title-link" itemprop="url">Best Practices of Using the sed Command</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-03 11:54:16 / Modified: 11:54:47" itemprop="dateCreated datePublished" datetime="2024-11-03T11:54:16-05:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/" itemprop="url" rel="index"><span itemprop="name">Best Practices</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/CLI/" itemprop="url" rel="index"><span itemprop="name">CLI</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-usage">Basic Usage</a><ul>
<li><a href="#-substitution"> Substitution</a></li>
<li><a href="#-deleting-lines"> Deleting Lines</a></li>
<li><a href="#-printing-lines"> Printing Lines</a></li>
</ul>
</li>
<li><a href="#advanced-usage">Advanced Usage</a><ul>
<li><a href="#-pattern-matching"> Pattern Matching</a></li>
<li><a href="#-in-place-editing"> In-Place Editing</a></li>
<li><a href="#-multiple-commands"> Multiple Commands</a></li>
<li><a href="#-address-ranges"> Address Ranges</a></li>
</ul>
</li>
<li><a href="#combining-with-other-commands">Combining with Other Commands</a><ul>
<li><a href="#-using-sed-with-grep"> Using <code>sed</code> with <code>grep</code></a></li>
<li><a href="#-using-sed-with-awk"> Using <code>sed</code> with <code>awk</code></a></li>
<li><a href="#-using-sed-with-find"> Using <code>sed</code> with <code>find</code></a></li>
</ul>
</li>
<li><a href="#advanced-scenarios">Advanced Scenarios</a><ul>
<li><a href="#-inserting-text"> Inserting Text</a></li>
<li><a href="#-appending-text"> Appending Text</a></li>
<li><a href="#-replacing-multiple-patterns"> Replacing Multiple Patterns</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>The <code>sed</code> command is a powerful stream editor for filtering and transforming text in Unix-like operating systems. It is particularly useful for performing search-and-replace operations, deleting lines, and modifying text files. This article provides a comprehensive guide to the best practices of using the <code>sed</code> command, covering various scenarios such as substitution, pattern matching, in-place editing, and combining <code>sed</code> with other commands using pipelines.</p>
<hr>
<p><a name="basic-usage"></a></p>
<h2 id="Basic-Usage"><a href="#Basic-Usage" class="headerlink" title="Basic Usage"></a>Basic Usage</h2><h3 id="Substitution"><a href="#Substitution" class="headerlink" title=" Substitution"></a><a name="substitution"></a> Substitution</h3><p>To replace a pattern with another string, use the <code>s</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;s/old/new/&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command replaces the first occurrence of <code>old</code> with <code>new</code> in each line.</p>
<h3 id="Deleting-Lines"><a href="#Deleting-Lines" class="headerlink" title=" Deleting Lines"></a><a name="deleting-lines"></a> Deleting Lines</h3><p>To delete lines that match a pattern, use the <code>d</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;/pattern/d&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command deletes all lines containing the pattern.</p>
<h3 id="Printing-Lines"><a href="#Printing-Lines" class="headerlink" title=" Printing Lines"></a><a name="printing-lines"></a> Printing Lines</h3><p>To print lines that match a pattern, use the <code>p</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -n <span class="string">&#x27;/pattern/p&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command prints all lines containing the pattern.</p>
<hr>
<p><a name="advanced-usage"></a></p>
<h2 id="Advanced-Usage"><a href="#Advanced-Usage" class="headerlink" title="Advanced Usage"></a>Advanced Usage</h2><h3 id="Pattern-Matching"><a href="#Pattern-Matching" class="headerlink" title=" Pattern Matching"></a><a name="pattern-matching"></a> Pattern Matching</h3><p>To match patterns using regular expressions, use the <code>s</code> command with regex:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;s/[0-9]+/number/&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command replaces all sequences of digits with the word <code>number</code>.</p>
<h3 id="In-Place-Editing"><a href="#In-Place-Editing" class="headerlink" title=" In-Place Editing"></a><a name="in-place-editing"></a> In-Place Editing</h3><p>To edit a file in place, use the <code>-i</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s/old/new/&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command replaces <code>old</code> with <code>new</code> in the file <code>filename.txt</code> and saves the changes.</p>
<h3 id="Multiple-Commands"><a href="#Multiple-Commands" class="headerlink" title=" Multiple Commands"></a><a name="multiple-commands"></a> Multiple Commands</h3><p>To execute multiple commands, use the <code>-e</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -e <span class="string">&#x27;s/old/new/&#x27;</span> -e <span class="string">&#x27;/pattern/d&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command replaces <code>old</code> with <code>new</code> and deletes lines containing <code>pattern</code>.</p>
<h3 id="Address-Ranges"><a href="#Address-Ranges" class="headerlink" title=" Address Ranges"></a><a name="address-ranges"></a> Address Ranges</h3><p>To apply commands to specific lines or ranges of lines, use address ranges:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;1,3s/old/new/&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command replaces <code>old</code> with <code>new</code> in lines 1 to 3.</p>
<hr>
<p><a name="combining-with-other-commands"></a></p>
<h2 id="Combining-with-Other-Commands"><a href="#Combining-with-Other-Commands" class="headerlink" title="Combining with Other Commands"></a>Combining with Other Commands</h2><h3 id="Using-sed-with-grep"><a href="#Using-sed-with-grep" class="headerlink" title=" Using sed with grep"></a><a name="using-sed-with-grep"></a> Using <code>sed</code> with <code>grep</code></h3><p>To combine <code>sed</code> with <code>grep</code>, use a pipeline:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep <span class="string">&quot;pattern&quot;</span> filename.txt | sed <span class="string">&#x27;s/old/new/&#x27;</span></span><br></pre></td></tr></table></figure>

<p>This command first filters lines containing <code>pattern</code> and then replaces <code>old</code> with <code>new</code>.</p>
<h3 id="Using-sed-with-awk"><a href="#Using-sed-with-awk" class="headerlink" title=" Using sed with awk"></a><a name="using-sed-with-awk"></a> Using <code>sed</code> with <code>awk</code></h3><p>To combine <code>sed</code> with <code>awk</code>, use a pipeline:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span> filename.txt | sed <span class="string">&#x27;s/old/new/&#x27;</span></span><br></pre></td></tr></table></figure>

<p>This command first prints the first field of each line and then replaces <code>old</code> with <code>new</code>.</p>
<h3 id="Using-sed-with-find"><a href="#Using-sed-with-find" class="headerlink" title=" Using sed with find"></a><a name="using-sed-with-find"></a> Using <code>sed</code> with <code>find</code></h3><p>To combine <code>sed</code> with <code>find</code>, use a pipeline:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -name <span class="string">&quot;*.log&quot;</span> -<span class="built_in">exec</span> sed -i <span class="string">&#x27;s/old/new/&#x27;</span> &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<p>This command finds all <code>.log</code> files and replaces <code>old</code> with <code>new</code> in each file.</p>
<hr>
<p><a name="advanced-scenarios"></a></p>
<h2 id="Advanced-Scenarios"><a href="#Advanced-Scenarios" class="headerlink" title="Advanced Scenarios"></a>Advanced Scenarios</h2><h3 id="Inserting-Text"><a href="#Inserting-Text" class="headerlink" title=" Inserting Text"></a><a name="inserting-text"></a> Inserting Text</h3><p>To insert text before or after a pattern, use the <code>i</code> or <code>a</code> command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;/pattern/i\Insert this line before pattern&#x27;</span> filename.txt</span><br><span class="line">sed <span class="string">&#x27;/pattern/a\Append this line after pattern&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<h3 id="Appending-Text"><a href="#Appending-Text" class="headerlink" title=" Appending Text"></a><a name="appending-text"></a> Appending Text</h3><p>To append text to the end of a line, use the <code>s</code> command with a <code>&amp;</code> to reference the matched pattern:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;s/pattern/&amp; append/&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command appends <code> append</code> to the end of lines containing <code>pattern</code>.</p>
<h3 id="Replacing-Multiple-Patterns"><a href="#Replacing-Multiple-Patterns" class="headerlink" title=" Replacing Multiple Patterns"></a><a name="replacing-multiple-patterns"></a> Replacing Multiple Patterns</h3><p>To replace multiple patterns, use multiple <code>s</code> commands:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;s/old1/new1/; s/old2/new2/&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command replaces <code>old1</code> with <code>new1</code> and <code>old2</code> with <code>new2</code>.</p>
<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>The <code>sed</code> command is a versatile and powerful tool for text processing and transformation. By mastering the various options and scenarios covered in this article, you can effectively use <code>sed</code> for a wide range of tasks, from simple text substitution to complex text manipulation and file editing.</p>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/sed.1.html">sed Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://www.gnu.org/software/sed/manual/sed.html">GNU sed Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/grep.1.html">grep Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/awk.1p.html">awk Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/find.1.html">find Man Page</a></li>
</ol>
<p>By following these best practices, you can leverage the <code>sed</code> command to its full potential and efficiently manage your text processing and file editing tasks from the command line.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/03/Best-Practices-of-Using-the-awk-Command/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/03/Best-Practices-of-Using-the-awk-Command/" class="post-title-link" itemprop="url">Best Practices of Using the awk Command</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-03 11:50:44 / Modified: 11:51:35" itemprop="dateCreated datePublished" datetime="2024-11-03T11:50:44-05:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/" itemprop="url" rel="index"><span itemprop="name">Best Practices</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/CLI/" itemprop="url" rel="index"><span itemprop="name">CLI</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-usage">Basic Usage</a><ul>
<li><a href="#-printing-lines"> Printing Lines</a></li>
<li><a href="#-field-separator"> Field Separator</a></li>
<li><a href="#-printing-specific-fields"> Printing Specific Fields</a></li>
</ul>
</li>
<li><a href="#advanced-usage">Advanced Usage</a><ul>
<li><a href="#-pattern-matching"> Pattern Matching</a></li>
<li><a href="#-conditional-statements"> Conditional Statements</a></li>
<li><a href="#-looping"> Looping</a></li>
<li><a href="#-arrays"> Arrays</a></li>
</ul>
</li>
<li><a href="#combining-with-other-commands">Combining with Other Commands</a><ul>
<li><a href="#-using-awk-with-grep"> Using <code>awk</code> with <code>grep</code></a></li>
<li><a href="#-using-awk-with-sed"> Using <code>awk</code> with <code>sed</code></a></li>
<li><a href="#-using-awk-with-find"> Using <code>awk</code> with <code>find</code></a></li>
</ul>
</li>
<li><a href="#advanced-scenarios">Advanced Scenarios</a><ul>
<li><a href="#-summing-columns"> Summing Columns</a></li>
<li><a href="#-calculating-averages"> Calculating Averages</a></li>
<li><a href="#-formatting-output"> Formatting Output</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>The <code>awk</code> command is a powerful text processing tool in Unix-like operating systems. It is particularly useful for manipulating and analyzing structured text data, such as log files, CSV files, and other tabular data. This article provides a comprehensive guide to the best practices of using the <code>awk</code> command, covering various scenarios such as printing lines, field manipulation, pattern matching, and combining <code>awk</code> with other commands using pipelines.</p>
<hr>
<p><a name="basic-usage"></a></p>
<h2 id="Basic-Usage"><a href="#Basic-Usage" class="headerlink" title="Basic Usage"></a>Basic Usage</h2><h3 id="Printing-Lines"><a href="#Printing-Lines" class="headerlink" title=" Printing Lines"></a><a name="printing-lines"></a> Printing Lines</h3><p>To print all lines from a file, use the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;print&#125;&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<h3 id="Field-Separator"><a href="#Field-Separator" class="headerlink" title=" Field Separator"></a><a name="field-separator"></a> Field Separator</h3><p>To specify a custom field separator, use the <code>-F</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F, <span class="string">&#x27;&#123;print&#125;&#x27;</span> filename.csv</span><br></pre></td></tr></table></figure>

<h3 id="Printing-Specific-Fields"><a href="#Printing-Specific-Fields" class="headerlink" title=" Printing Specific Fields"></a><a name="printing-specific-fields"></a> Printing Specific Fields</h3><p>To print specific fields, use the <code>$</code> notation:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;print $1, $3&#125;&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command prints the first and third fields of each line.</p>
<hr>
<p><a name="advanced-usage"></a></p>
<h2 id="Advanced-Usage"><a href="#Advanced-Usage" class="headerlink" title="Advanced Usage"></a>Advanced Usage</h2><h3 id="Pattern-Matching"><a href="#Pattern-Matching" class="headerlink" title=" Pattern Matching"></a><a name="pattern-matching"></a> Pattern Matching</h3><p>To print lines that match a specific pattern, use the <code>~</code> operator:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;/pattern/ &#123;print&#125;&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<h3 id="Conditional-Statements"><a href="#Conditional-Statements" class="headerlink" title=" Conditional Statements"></a><a name="conditional-statements"></a> Conditional Statements</h3><p>To use conditional statements, use the <code>if</code> statement:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;if ($1 &gt; 10) print $0&#125;&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command prints lines where the first field is greater than 10.</p>
<h3 id="Looping"><a href="#Looping" class="headerlink" title=" Looping"></a><a name="looping"></a> Looping</h3><p>To use loops, use the <code>for</code> loop:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;for (i=1; i&lt;=NF; i++) print $i&#125;&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command prints each field on a new line.</p>
<h3 id="Arrays"><a href="#Arrays" class="headerlink" title=" Arrays"></a><a name="arrays"></a> Arrays</h3><p>To use arrays, use the <code>array[index]</code> notation:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;array[$1]++&#125; END &#123;for (i in array) print i, array[i]&#125;&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command counts the occurrences of each value in the first field.</p>
<hr>
<p><a name="combining-with-other-commands"></a></p>
<h2 id="Combining-with-Other-Commands"><a href="#Combining-with-Other-Commands" class="headerlink" title="Combining with Other Commands"></a>Combining with Other Commands</h2><h3 id="Using-awk-with-grep"><a href="#Using-awk-with-grep" class="headerlink" title=" Using awk with grep"></a><a name="using-awk-with-grep"></a> Using <code>awk</code> with <code>grep</code></h3><p>To combine <code>awk</code> with <code>grep</code>, use a pipeline:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep <span class="string">&quot;pattern&quot;</span> filename.txt | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>This command prints the second field of lines that match the pattern.</p>
<h3 id="Using-awk-with-sed"><a href="#Using-awk-with-sed" class="headerlink" title=" Using awk with sed"></a><a name="using-awk-with-sed"></a> Using <code>awk</code> with <code>sed</code></h3><p>To combine <code>awk</code> with <code>sed</code>, use a pipeline:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;s/old/new/g&#x27;</span> filename.txt | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>This command replaces <code>old</code> with <code>new</code> in each line and then prints the first field.</p>
<h3 id="Using-awk-with-find"><a href="#Using-awk-with-find" class="headerlink" title=" Using awk with find"></a><a name="using-awk-with-find"></a> Using <code>awk</code> with <code>find</code></h3><p>To combine <code>awk</code> with <code>find</code>, use a pipeline:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -name <span class="string">&quot;*.log&quot;</span> | awk -F/ <span class="string">&#x27;&#123;print $NF&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>This command prints the base name of each <code>.log</code> file found by <code>find</code>.</p>
<hr>
<p><a name="advanced-scenarios"></a></p>
<h2 id="Advanced-Scenarios"><a href="#Advanced-Scenarios" class="headerlink" title="Advanced Scenarios"></a>Advanced Scenarios</h2><h3 id="Summing-Columns"><a href="#Summing-Columns" class="headerlink" title=" Summing Columns"></a><a name="summing-columns"></a> Summing Columns</h3><p>To sum the values in a column, use the <code>+</code> operator:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;sum += $1&#125; END &#123;print sum&#125;&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command sums the values in the first column.</p>
<h3 id="Calculating-Averages"><a href="#Calculating-Averages" class="headerlink" title=" Calculating Averages"></a><a name="calculating-averages"></a> Calculating Averages</h3><p>To calculate the average of a column, use the <code>+</code> operator and divide by the number of lines:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;sum += $1&#125; END &#123;print sum/NR&#125;&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command calculates the average of the first column.</p>
<h3 id="Formatting-Output"><a href="#Formatting-Output" class="headerlink" title=" Formatting Output"></a><a name="formatting-output"></a> Formatting Output</h3><p>To format the output, use the <code>printf</code> function:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;printf &quot;%-10s %s\n&quot;, $1, $2&#125;&#x27;</span> filename.txt</span><br></pre></td></tr></table></figure>

<p>This command formats the first field to be left-aligned with a width of 10 characters.</p>
<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>The <code>awk</code> command is a versatile and powerful tool for text processing and data analysis. By mastering the various options and scenarios covered in this article, you can effectively use <code>awk</code> for a wide range of tasks, from simple text manipulation to complex data processing and analysis.</p>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/awk.1p.html">awk Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://www.gnu.org/software/gawk/manual/gawk.html">GNU awk Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/grep.1.html">grep Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/sed.1.html">sed Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/find.1.html">find Man Page</a></li>
</ol>
<p>By following these best practices, you can leverage the <code>awk</code> command to its full potential and efficiently manage your text processing and data analysis tasks from the command line.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/03/Best-Practices-of-Using-the-find-Command/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/03/Best-Practices-of-Using-the-find-Command/" class="post-title-link" itemprop="url">Best Practices of Using the find Command</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-03 11:34:35 / Modified: 11:51:16" itemprop="dateCreated datePublished" datetime="2024-11-03T11:34:35-05:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/" itemprop="url" rel="index"><span itemprop="name">Best Practices</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/CLI/" itemprop="url" rel="index"><span itemprop="name">CLI</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-usage">Basic Usage</a><ul>
<li><a href="#-find-files-by-name"> Find Files by Name</a></li>
<li><a href="#-find-files-by-wildcard-pattern"> Find Files by Wildcard Pattern</a></li>
<li><a href="#-find-files-by-content"> Find Files by Content</a></li>
<li><a href="#-search-in-subdirectories"> Search in Subdirectories</a></li>
</ul>
</li>
<li><a href="#advanced-search-criteria">Advanced Search Criteria</a><ul>
<li><a href="#-find-files-by-owner"> Find Files by Owner</a></li>
<li><a href="#-find-files-by-date-and-time"> Find Files by Date and Time</a></li>
</ul>
</li>
<li><a href="#combining-with-other-commands">Combining with Other Commands</a><ul>
<li><a href="#-using-xargs"> Using <code>xargs</code></a></li>
<li><a href="#-using-grep"> Using <code>grep</code></a></li>
<li><a href="#-using-awk"> Using <code>awk</code></a></li>
</ul>
</li>
<li><a href="#advanced-scenarios">Advanced Scenarios</a><ul>
<li><a href="#-find-and-delete-files"> Find and Delete Files</a></li>
<li><a href="#-find-and-move-files"> Find and Move Files</a></li>
<li><a href="#-find-and-copy-files"> Find and Copy Files</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#appendix">Appendix</a><ul>
<li><a href="#using-xargs">Using <code>xargs</code></a></li>
<li><a href="#explanation">Explanation</a></li>
<li><a href="#benefits-of-using-xargs">Benefits of Using <code>xargs</code></a></li>
<li><a href="#example">Example</a></li>
<li><a href="#using-curly-brackets-">Using curly brackets <code>&#123;&#125;</code></a></li>
<li><a href="#command-breakdown">Command Breakdown</a></li>
<li><a href="#example-1">Example</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>The <code>find</code> command is a powerful tool in Unix-like operating systems for searching files and directories based on various criteria such as name, type, size, owner, date, and more. This article provides a comprehensive guide to the best practices of using the <code>find</code> command, covering various scenarios such as finding files by name, content, owner, date, and combining <code>find</code> with other commands using pipelines.</p>
<hr>
<p><a name="basic-usage"></a></p>
<h2 id="Basic-Usage"><a href="#Basic-Usage" class="headerlink" title="Basic Usage"></a>Basic Usage</h2><h3 id="Find-Files-by-Name"><a href="#Find-Files-by-Name" class="headerlink" title=" Find Files by Name"></a><a name="find-files-by-name"></a> Find Files by Name</h3><p>To find files by name, use the <code>-name</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -name <span class="string">&quot;filename.txt&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="Find-Files-by-Wildcard-Pattern"><a href="#Find-Files-by-Wildcard-Pattern" class="headerlink" title=" Find Files by Wildcard Pattern"></a><a name="find-files-by-wildcard-pattern"></a> Find Files by Wildcard Pattern</h3><p>To find files using a wildcard pattern, use the <code>-name</code> option with wildcards:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -name <span class="string">&quot;*.log&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="Find-Files-by-Content"><a href="#Find-Files-by-Content" class="headerlink" title=" Find Files by Content"></a><a name="find-files-by-content"></a> Find Files by Content</h3><p>To find files containing specific content, use the <code>-exec</code> option with <code>grep</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -<span class="built_in">type</span> f -<span class="built_in">exec</span> grep -l <span class="string">&quot;search_string&quot;</span> &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<h3 id="Search-in-Subdirectories"><a href="#Search-in-Subdirectories" class="headerlink" title=" Search in Subdirectories"></a><a name="search-in-subdirectories"></a> Search in Subdirectories</h3><p>By default, <code>find</code> searches in all subdirectories. You can specify the starting directory:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -name <span class="string">&quot;filename.txt&quot;</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="advanced-search-criteria"></a></p>
<h2 id="Advanced-Search-Criteria"><a href="#Advanced-Search-Criteria" class="headerlink" title="Advanced Search Criteria"></a>Advanced Search Criteria</h2><h3 id="Find-Files-by-Owner"><a href="#Find-Files-by-Owner" class="headerlink" title=" Find Files by Owner"></a><a name="find-files-by-owner"></a> Find Files by Owner</h3><p>To find files owned by a specific user, use the <code>-user</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -user username</span><br></pre></td></tr></table></figure>

<h3 id="Find-Files-by-Date-and-Time"><a href="#Find-Files-by-Date-and-Time" class="headerlink" title=" Find Files by Date and Time"></a><a name="find-files-by-date-and-time"></a> Find Files by Date and Time</h3><p>To find files modified within a specific time range, use the <code>-mtime</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -mtime -7  <span class="comment"># Files modified in the last 7 days</span></span><br><span class="line">find /path/to/search -mtime +7  <span class="comment"># Files modified more than 7 days ago</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="combining-with-other-commands"></a></p>
<h2 id="Combining-with-Other-Commands"><a href="#Combining-with-Other-Commands" class="headerlink" title="Combining with Other Commands"></a>Combining with Other Commands</h2><h3 id="Using-xargs"><a href="#Using-xargs" class="headerlink" title=" Using xargs"></a><a name="using-xargs"></a> Using <code>xargs</code></h3><p>To perform an action on the found files, use <code>xargs</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -name <span class="string">&quot;*.log&quot;</span> | xargs <span class="built_in">rm</span></span><br></pre></td></tr></table></figure>

<h3 id="Using-grep"><a href="#Using-grep" class="headerlink" title=" Using grep"></a><a name="using-grep"></a> Using <code>grep</code></h3><p>To search for files containing specific content, use <code>grep</code> with <code>find</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -<span class="built_in">type</span> f -<span class="built_in">exec</span> grep -l <span class="string">&quot;search_string&quot;</span> &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<h3 id="Using-awk"><a href="#Using-awk" class="headerlink" title=" Using awk"></a><a name="using-awk"></a> Using <code>awk</code></h3><p>To process the output of <code>find</code> with <code>awk</code>, use a pipeline:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -name <span class="string">&quot;*.txt&quot;</span> | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="advanced-scenarios"></a></p>
<h2 id="Advanced-Scenarios"><a href="#Advanced-Scenarios" class="headerlink" title="Advanced Scenarios"></a>Advanced Scenarios</h2><h3 id="Find-and-Delete-Files"><a href="#Find-and-Delete-Files" class="headerlink" title=" Find and Delete Files"></a><a name="find-and-delete-files"></a> Find and Delete Files</h3><p>To find and delete files, use the <code>-delete</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -name <span class="string">&quot;*.bak&quot;</span> -delete</span><br></pre></td></tr></table></figure>

<h3 id="Find-and-Move-Files"><a href="#Find-and-Move-Files" class="headerlink" title=" Find and Move Files"></a><a name="find-and-move-files"></a> Find and Move Files</h3><p>To find and move files, use the <code>-exec</code> option with <code>mv</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -name <span class="string">&quot;*.log&quot;</span> -<span class="built_in">exec</span> <span class="built_in">mv</span> &#123;&#125; /path/to/destination/ \;</span><br></pre></td></tr></table></figure>

<h3 id="Find-and-Copy-Files"><a href="#Find-and-Copy-Files" class="headerlink" title=" Find and Copy Files"></a><a name="find-and-copy-files"></a> Find and Copy Files</h3><p>To find and copy files, use the <code>-exec</code> option with <code>cp</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -name <span class="string">&quot;*.txt&quot;</span> -<span class="built_in">exec</span> <span class="built_in">cp</span> &#123;&#125; /path/to/destination/ \;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>The <code>find</code> command is a versatile and powerful tool for searching files and directories based on various criteria. By mastering the various options and scenarios covered in this article, you can effectively use <code>find</code> for a wide range of tasks, from simple file searches to complex operations involving multiple commands and pipelines.</p>
<hr>
<p><a name="appendix"></a></p>
<h2 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h2><p><a name="using-xargs"></a></p>
<h3 id="Using-xargs-1"><a href="#Using-xargs-1" class="headerlink" title="Using xargs"></a>Using <code>xargs</code></h3><p>The command <code>find /path/to/search -type f -exec grep -l &quot;search_string&quot; &#123;&#125; \;</code> can be rewritten using <code>xargs</code>. The <code>xargs</code> command is useful for building and executing command lines from standard input. Here’s how you can rewrite the command using <code>xargs</code>:</p>
<p>Using <code>xargs</code> to rewrite the <code>find</code> command with <code>-exec</code> can make your command more efficient and easier to read. By leveraging <code>xargs</code>, you can handle large numbers of files more effectively and streamline your command-line operations.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -<span class="built_in">type</span> f | xargs grep -l <span class="string">&quot;search_string&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="Explanation"><a href="#Explanation" class="headerlink" title="Explanation"></a>Explanation</h3><ol>
<li><strong><code>find /path/to/search -type f</code></strong>: This part of the command finds all files (<code>-type f</code>) in the specified directory and its subdirectories.</li>
<li><strong><code>| xargs grep -l &quot;search_string&quot;</code></strong>: The <code>|</code> (pipe) symbol passes the list of files found by <code>find</code> to <code>xargs</code>. <code>xargs</code> then constructs and executes the <code>grep</code> command for each file, searching for the specified string (<code>&quot;search_string&quot;</code>) and printing the names of files that contain the string (<code>-l</code> option).</li>
</ol>
<h3 id="Benefits-of-Using-xargs"><a href="#Benefits-of-Using-xargs" class="headerlink" title="Benefits of Using xargs"></a>Benefits of Using <code>xargs</code></h3><ul>
<li><strong>Efficiency</strong>: <code>xargs</code> can handle a large number of files more efficiently than the <code>-exec</code> option, especially when dealing with a large number of files.</li>
<li><strong>Simplification</strong>: The <code>xargs</code> version is often simpler and more concise.</li>
</ul>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>Suppose you want to find all files in the <code>/var/log</code> directory that contain the string “error”. You can use the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /var/log -<span class="built_in">type</span> f | xargs grep -l <span class="string">&quot;error&quot;</span></span><br></pre></td></tr></table></figure>

<p>This command will output the names of all files in the <code>/var/log</code> directory and its subdirectories that contain the string “error”.</p>
<p><a name="using-curly-brackets-"></a></p>
<h3 id="Using-curly-brackets"><a href="#Using-curly-brackets" class="headerlink" title="Using curly brackets {}"></a>Using curly brackets <code>&#123;&#125;</code></h3><p>The <code>&#123;&#125;</code> in the command <code>find /path/to/search -name &quot;*.log&quot; -exec mv &#123;&#125; /path/to/destination/ \;</code> is a placeholder that represents the current file being processed by the <code>find</code> command. Let’s break down the command and understand the role of <code>&#123;&#125;</code>.</p>
<p>The <code>&#123;&#125;</code> placeholder in the <code>find</code> command with <code>-exec</code> is a powerful feature that allows you to dynamically insert the current file path into the command being executed. This makes it easy to perform operations on each file found by <code>find</code>, such as moving, copying, or deleting files.</p>
<h3 id="Command-Breakdown"><a href="#Command-Breakdown" class="headerlink" title="Command Breakdown"></a>Command Breakdown</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -name <span class="string">&quot;*.log&quot;</span> -<span class="built_in">exec</span> <span class="built_in">mv</span> &#123;&#125; /path/to/destination/ \;</span><br></pre></td></tr></table></figure>

<ol>
<li><p><strong><code>find /path/to/search -name &quot;*.log&quot;</code></strong>: This part of the command searches for all files in the <code>/path/to/search</code> directory and its subdirectories that match the pattern <code>*.log</code>.</p>
</li>
<li><p><strong><code>-exec mv &#123;&#125; /path/to/destination/ \;</code></strong>: This part of the command executes the <code>mv</code> command for each file found by <code>find</code>.</p>
<ul>
<li><strong><code>&#123;&#125;</code></strong>: This placeholder is replaced by the full path of the current file found by <code>find</code>. For example, if <code>find</code> finds a file named <code>example.log</code> in the directory <code>/path/to/search/subdir</code>, <code>&#123;&#125;</code> will be replaced by <code>/path/to/search/subdir/example.log</code>.</li>
<li><strong><code>/path/to/destination/</code></strong>: This is the destination directory where the files will be moved.</li>
<li><strong><code>\;</code></strong>: This is the terminator for the <code>-exec</code> command. It tells <code>find</code> that the command is complete.</li>
</ul>
</li>
</ol>
<h3 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h3><p>Suppose you have the following directory structure:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/path/to/search/</span><br><span class="line">├── file1.log</span><br><span class="line">├── file2.log</span><br><span class="line">└── subdir/</span><br><span class="line">    └── file3.log</span><br></pre></td></tr></table></figure>

<p>Running the command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /path/to/search -name <span class="string">&quot;*.log&quot;</span> -<span class="built_in">exec</span> <span class="built_in">mv</span> &#123;&#125; /path/to/destination/ \;</span><br></pre></td></tr></table></figure>

<p>will result in the following actions:</p>
<ol>
<li><code>find</code> will locate <code>file1.log</code>, <code>file2.log</code>, and <code>subdir/file3.log</code>.</li>
<li>For each file found, <code>find</code> will execute the <code>mv</code> command:<ul>
<li><code>mv /path/to/search/file1.log /path/to/destination/</code></li>
<li><code>mv /path/to/search/file2.log /path/to/destination/</code></li>
<li><code>mv /path/to/search/subdir/file3.log /path/to/destination/</code></li>
</ul>
</li>
</ol>
<p>After the command completes, all <code>.log</code> files will be moved to the <code>/path/to/destination/</code> directory.</p>
<p><a name="references"></a></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/find.1.html">find Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://www.gnu.org/software/findutils/manual/html_mono/find.html">GNU findutils Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/xargs.1.html">xargs Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/grep.1.html">grep Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man1/awk.1p.html">awk Man Page</a></li>
</ol>
<p>By following these best practices, you can leverage the <code>find</code> command to its full potential and efficiently manage your file searches and operations from the command line.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/03/Best-Practices-of-Using-curl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/03/Best-Practices-of-Using-curl/" class="post-title-link" itemprop="url">Best Practices of Using curl</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-03 11:26:54 / Modified: 12:01:57" itemprop="dateCreated datePublished" datetime="2024-11-03T11:26:54-05:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/" itemprop="url" rel="index"><span itemprop="name">Best Practices</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/Network/" itemprop="url" rel="index"><span itemprop="name">Network</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Best-Practices/Network/CLI/" itemprop="url" rel="index"><span itemprop="name">CLI</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-usage">Basic Usage</a><ul>
<li><a href="#-check-if-an-url-is-alive"> Check if an URL is Alive</a></li>
<li><a href="#-download-a-file"> Download a File</a></li>
</ul>
</li>
<li><a href="#http-methods">HTTP Methods</a><ul>
<li><a href="#-http-get"> HTTP GET</a></li>
<li><a href="#-http-post-with-json-payload"> HTTP POST with JSON Payload</a></li>
</ul>
</li>
<li><a href="#authentication">Authentication</a><ul>
<li><a href="#-http-basic-authentication"> HTTP Basic Authentication</a></li>
<li><a href="#-bearer-token-authentication"> Bearer Token Authentication</a></li>
</ul>
</li>
<li><a href="#https-and-certificates">HTTPS and Certificates</a><ul>
<li><a href="#-https-with-certificate"> HTTPS with Certificate</a></li>
<li><a href="#-ignore-https-certificate"> Ignore HTTPS Certificate</a></li>
</ul>
</li>
<li><a href="#advanced-scenarios">Advanced Scenarios</a><ul>
<li><a href="#-custom-headers"> Custom Headers</a></li>
<li><a href="#-follow-redirects"> Follow Redirects</a></li>
<li><a href="#-verbose-output"> Verbose Output</a></li>
<li><a href="#-timeouts"> Timeouts</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><code>curl</code> is a powerful command-line tool used for transferring data with URLs. It supports a wide range of protocols, including HTTP, HTTPS, FTP, and more. This article provides a comprehensive guide to the best practices of using <code>curl</code>, covering various scenarios such as checking if an URL is alive, downloading files, making HTTP GET&#x2F;POST requests, handling authentication, and dealing with HTTPS certificates.</p>
<hr>
<p><a name="basic-usage"></a></p>
<h2 id="Basic-Usage"><a href="#Basic-Usage" class="headerlink" title="Basic Usage"></a>Basic Usage</h2><h3 id="Check-if-an-URL-is-Alive"><a href="#Check-if-an-URL-is-Alive" class="headerlink" title=" Check if an URL is Alive"></a><a name="check-if-an-url-is-alive"></a> Check if an URL is Alive</h3><p>To check if an URL is alive, you can use the <code>-I</code> (or <code>--head</code>) option to send a HEAD request:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -I https://example.com</span><br></pre></td></tr></table></figure>

<p>This command will return the HTTP headers without downloading the content, allowing you to quickly check if the URL is accessible.</p>
<h3 id="Download-a-File"><a href="#Download-a-File" class="headerlink" title=" Download a File"></a><a name="download-a-file"></a> Download a File</h3><p>To download a file from a URL, simply use the <code>curl</code> command followed by the URL:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -O https://example.com/file.zip</span><br></pre></td></tr></table></figure>

<p>The <code>-O</code> option saves the file with the same name as the remote file. If you want to save the file with a different name, use the <code>-o</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -o myfile.zip https://example.com/file.zip</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="http-methods"></a></p>
<h2 id="HTTP-Methods"><a href="#HTTP-Methods" class="headerlink" title="HTTP Methods"></a>HTTP Methods</h2><h3 id="HTTP-GET"><a href="#HTTP-GET" class="headerlink" title=" HTTP GET"></a><a name="http-get"></a> HTTP GET</h3><p>To make an HTTP GET request, use the <code>curl</code> command followed by the URL:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://example.com/api/resource</span><br></pre></td></tr></table></figure>

<h3 id="HTTP-POST-with-JSON-Payload"><a href="#HTTP-POST-with-JSON-Payload" class="headerlink" title=" HTTP POST with JSON Payload"></a><a name="http-post-with-json-payload"></a> HTTP POST with JSON Payload</h3><p>To make an HTTP POST request with a JSON payload, use the <code>-X POST</code> option and specify the JSON data using the <code>-d</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST -H <span class="string">&quot;Content-Type: application/json&quot;</span> -d <span class="string">&#x27;&#123;&quot;key1&quot;:&quot;value1&quot;, &quot;key2&quot;:&quot;value2&quot;&#125;&#x27;</span> https://example.com/api/resource</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="authentication"></a></p>
<h2 id="Authentication"><a href="#Authentication" class="headerlink" title="Authentication"></a>Authentication</h2><h3 id="HTTP-Basic-Authentication"><a href="#HTTP-Basic-Authentication" class="headerlink" title=" HTTP Basic Authentication"></a><a name="http-basic-authentication"></a> HTTP Basic Authentication</h3><p>To use HTTP Basic Authentication, use the <code>-u</code> option to specify the username and password:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -u username:password https://example.com/api/resource</span><br></pre></td></tr></table></figure>

<h3 id="Bearer-Token-Authentication"><a href="#Bearer-Token-Authentication" class="headerlink" title=" Bearer Token Authentication"></a><a name="bearer-token-authentication"></a> Bearer Token Authentication</h3><p>To use Bearer Token Authentication, use the <code>-H</code> option to set the <code>Authorization</code> header:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -H <span class="string">&quot;Authorization: Bearer YOUR_TOKEN&quot;</span> https://example.com/api/resource</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="https-and-certificates"></a></p>
<h2 id="HTTPS-and-Certificates"><a href="#HTTPS-and-Certificates" class="headerlink" title="HTTPS and Certificates"></a>HTTPS and Certificates</h2><h3 id="HTTPS-with-Certificate"><a href="#HTTPS-with-Certificate" class="headerlink" title=" HTTPS with Certificate"></a><a name="https-with-certificate"></a> HTTPS with Certificate</h3><p>To use HTTPS with a client certificate, use the <code>--cert</code> and <code>--key</code> options:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl --cert client.crt --key client.key https://example.com/api/resource</span><br></pre></td></tr></table></figure>

<h3 id="Ignore-HTTPS-Certificate"><a href="#Ignore-HTTPS-Certificate" class="headerlink" title=" Ignore HTTPS Certificate"></a><a name="ignore-https-certificate"></a> Ignore HTTPS Certificate</h3><p>To ignore HTTPS certificate validation (not recommended for production), use the <code>-k</code> (or <code>--insecure</code>) option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -k https://example.com/api/resource</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="advanced-scenarios"></a></p>
<h2 id="Advanced-Scenarios"><a href="#Advanced-Scenarios" class="headerlink" title="Advanced Scenarios"></a>Advanced Scenarios</h2><h3 id="Custom-Headers"><a href="#Custom-Headers" class="headerlink" title=" Custom Headers"></a><a name="custom-headers"></a> Custom Headers</h3><p>To send custom headers, use the <code>-H</code> option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -H <span class="string">&quot;X-Custom-Header: value&quot;</span> https://example.com/api/resource</span><br></pre></td></tr></table></figure>

<h3 id="Follow-Redirects"><a href="#Follow-Redirects" class="headerlink" title=" Follow Redirects"></a><a name="follow-redirects"></a> Follow Redirects</h3><p>To follow HTTP redirects, use the <code>-L</code> (or <code>--location</code>) option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -L https://example.com/redirect</span><br></pre></td></tr></table></figure>

<h3 id="Verbose-Output"><a href="#Verbose-Output" class="headerlink" title=" Verbose Output"></a><a name="verbose-output"></a> Verbose Output</h3><p>To get verbose output, use the <code>-v</code> (or <code>--verbose</code>) option:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -v https://example.com/api/resource</span><br></pre></td></tr></table></figure>

<h3 id="Timeouts"><a href="#Timeouts" class="headerlink" title=" Timeouts"></a><a name="timeouts"></a> Timeouts</h3><p>To set a timeout for the request, use the <code>--connect-timeout</code> and <code>--max-time</code> options:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl --connect-timeout 5 --max-time 10 https://example.com/api/resource</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p><code>curl</code> is a versatile and powerful tool for interacting with web services and downloading files from the command line. By mastering the various options and scenarios covered in this article, you can effectively use <code>curl</code> for a wide range of tasks, from simple URL checks to complex HTTP requests with authentication and custom headers.</p>
<hr>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://curl.se/docs/">curl Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://curl.se/docs/manpage.html">curl Man Page</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods">HTTP Methods</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication">HTTP Authentication</a></li>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/HTTPS">HTTPS</a></li>
</ol>
<p>By following these best practices, you can leverage <code>curl</code> to its full potential and efficiently manage your web interactions from the command line.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/03/AI-LLM-Tool-Ollama-Architecture-and-Conversation-Processing-Flow-Analysis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/03/AI-LLM-Tool-Ollama-Architecture-and-Conversation-Processing-Flow-Analysis/" class="post-title-link" itemprop="url">AI LLM Tool Ollama: Architecture and Conversation Processing Flow Analysis</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-03 11:02:38 / Modified: 11:16:25" itemprop="dateCreated datePublished" datetime="2024-11-03T11:02:38-05:00">2024-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/AI/" itemprop="url" rel="index"><span itemprop="name">AI</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#overview-of-ollama">Overview of Ollama</a></li>
<li><a href="#ollama-architecture">Ollama Architecture</a></li>
<li><a href="#ollama-storage-structure">Ollama Storage Structure</a></li>
<li><a href="#ollama-conversation-processing-flow">Ollama Conversation Processing Flow</a></li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References:</a></li>
</ul>
<p><a name="overview-of-ollama"></a></p>
<h2 id="Overview-of-Ollama"><a href="#Overview-of-Ollama" class="headerlink" title="Overview of Ollama"></a>Overview of Ollama</h2><p><code>Ollama</code> is a convenient tool for running <code>LLM</code> (Large Language Models) quickly. With <code>Ollama</code>, users can easily interact with large language models without complex environment configurations.</p>
<p>This article will analyze the overall architecture of <code>Ollama</code> and detail the specific processing flow when users engage in conversations with <code>Ollama</code>.</p>
<p><a name="ollama-architecture"></a></p>
<h2 id="Ollama-Architecture"><a href="#Ollama-Architecture" class="headerlink" title="Ollama Architecture"></a>Ollama Architecture</h2><p><img src="/images/AI-LLM-Tool-Ollama-Architecture-and-Conversation-Processing-Flow-Analysis/image-1.png" alt="Ollama Architecture"></p>
<p><code>Ollama</code> employs a classic CS (Client-Server) architecture, where:</p>
<ul>
<li><strong>Client</strong>: Interacts with the user via the command line.</li>
<li><strong>Server</strong>: Can be started via the command line, desktop application (based on the Electron framework), or Docker. Regardless of the startup method, the same executable file is ultimately invoked.</li>
<li><strong>Communication</strong>: Client and Server communicate using HTTP.</li>
</ul>
<p>The <code>Ollama Server</code> consists of two core components:</p>
<ul>
<li><strong><code>ollama-http-server</code></strong>: Handles interactions with the client.</li>
<li><strong><code>llama.cpp</code></strong>: Serves as the LLM inference engine, responsible for loading and running large language models, processing inference requests, and returning results.</li>
<li><strong>Interaction</strong>: <code>ollama-http-server</code> and <code>llama.cpp</code> also communicate via HTTP.</li>
</ul>
<p><strong>Note</strong>: <code>llama.cpp</code> is an independent open-source project that is cross-platform and hardware-friendly, capable of running on devices without GPUs, including Raspberry Pi.</p>
<p><a name="ollama-storage-structure"></a></p>
<h2 id="Ollama-Storage-Structure"><a href="#Ollama-Storage-Structure" class="headerlink" title="Ollama Storage Structure"></a>Ollama Storage Structure</h2><p><img src="/images/AI-LLM-Tool-Ollama-Architecture-and-Conversation-Processing-Flow-Analysis/image-2.png" alt="Ollama Storage Architecture"></p>
<p><code>Ollama</code> uses the default local storage folder path <code>$HOME/.ollama</code>. The file structure is as follows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$HOME/.ollama/</span><br><span class="line">├── blobs/</span><br><span class="line">├── manifests/</span><br><span class="line">├── logs/</span><br><span class="line">│   └── server.log</span><br><span class="line">├── history</span><br><span class="line">├── id_ed25519</span><br><span class="line">└── id_ed25519.pub</span><br></pre></td></tr></table></figure>

<p>Files can be categorized into three types:</p>
<ul>
<li><strong>Log Files</strong>: Includes the <code>history</code> file, which records user conversation inputs, and the <code>logs/server.log</code> server log file.</li>
<li><strong>Key Files</strong>: Includes the <code>id_ed25519</code> private key and <code>id_ed25519.pub</code> public key.</li>
<li><strong>Model Files</strong>: Includes <code>blobs</code> raw data files and <code>manifests</code> metadata files.</li>
</ul>
<p>The metadata files, such as <code>models/manifests/registry.ollama.ai/library/llama3.2/latest</code>, contain the following content:</p>
<p><img src="/images/AI-LLM-Tool-Ollama-Architecture-and-Conversation-Processing-Flow-Analysis/image-3.png" alt="llama3.2-latest"></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;digest&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sha256:abcdef1234567890&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;size&quot;</span><span class="punctuation">:</span> <span class="number">123456789</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;annotations&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;org.opencontainers.image.title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;llama3.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;org.opencontainers.image.version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;latest&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>As shown above, <code>manifests</code> files are in JSON format and draw inspiration from the OCI spec (Open Container Initiative Specification) in cloud-native and container domains. The <code>digest</code> field in <code>manifests</code> corresponds to <code>blobs</code>.</p>
<p><a name="ollama-conversation-processing-flow"></a></p>
<h2 id="Ollama-Conversation-Processing-Flow"><a href="#Ollama-Conversation-Processing-Flow" class="headerlink" title="Ollama Conversation Processing Flow"></a>Ollama Conversation Processing Flow</h2><p><img src="/images/AI-LLM-Tool-Ollama-Architecture-and-Conversation-Processing-Flow-Analysis/image-4.png" alt="Ollama Conversation Processing Flow"></p>
<p>The general flow of a user conversation with <code>Ollama</code> is as follows:</p>
<ol>
<li><p><strong>User Initiates Conversation</strong>: The user executes the command <code>ollama run llama3.2</code> via the CLI to start a conversation (<code>llama3.2</code> is an open-source large language model; you can also use other LLMs).</p>
</li>
<li><p><strong>Preparation Phase</strong>:</p>
<ul>
<li>The CLI client sends an HTTP request to <code>ollama-http-server</code> to fetch model information. The server attempts to read the local <code>manifests</code> metadata files. If not found, it responds with a 404 not found.</li>
<li>When the model does not exist, the CLI client requests <code>ollama-http-server</code> to pull the model from the remote repository to the local storage.</li>
<li>The CLI client then requests the model information again.</li>
</ul>
</li>
<li><p><strong>Interactive Conversation Phase</strong>:</p>
<ul>
<li>The CLI sends an empty message <code>/api/generate</code> request to <code>ollama-http-server</code>, which internally handles some channel processing (using Go’s channels).</li>
<li>If the model information contains <code>messages</code>, they are printed. Users can save the current model and session conversation history as a new model, and the conversation history is saved as <code>messages</code>.</li>
<li>The conversation officially begins: The CLI calls the <code>/api/chat</code> interface to request <code>ollama-http-server</code>, which relies on the <code>llama.cpp</code> engine to load the model and perform inference (<code>llama.cpp</code> also serves as an HTTP server). <code>ollama-http-server</code> first sends a <code>/health</code> request to <code>llama.cpp</code> to confirm its health status, then sends a <code>/completion</code> request to obtain the conversation response, and finally returns it to the CLI for display.</li>
</ul>
</li>
</ol>
<p>Through the above steps, <code>Ollama</code> completes the interaction between the user and the large language model.</p>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p><code>Ollama</code> integrates the <code>llama.cpp</code> inference engine and further encapsulates it, making complex LLM technology accessible. It provides developers and technical personnel with an efficient and flexible tool, effectively supporting large language model inference and interaction in various application scenarios.</p>
<p><a name="references"></a></p>
<h2 id="References"><a href="#References" class="headerlink" title="References:"></a>References:</h2><ul>
<li>• <a target="_blank" rel="noopener" href="https://github.com/ollama/ollama">https://github.com/ollama/ollama</a></li>
<li>• <a target="_blank" rel="noopener" href="https://github.com/ggerganov/llama.cpp">https://github.com/ggerganov/llama.cpp</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/02/Troubleshooting-Pod-to-Pod-Communication-in-Kubernetes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/02/Troubleshooting-Pod-to-Pod-Communication-in-Kubernetes/" class="post-title-link" itemprop="url">Troubleshooting Pod-to-Pod Communication in Kubernetes</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-02 12:49:45 / Modified: 12:50:30" itemprop="dateCreated datePublished" datetime="2024-11-02T12:49:45-04:00">2024-11-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Kubernetes/Troubleshooting/" itemprop="url" rel="index"><span itemprop="name">Troubleshooting</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#problem-description">Problem Description</a></li>
<li><a href="#troubleshooting-steps">Troubleshooting Steps</a><ul>
<li><a href="#step-1-capture-network-traffic">Step 1: Capture Network Traffic</a></li>
<li><a href="#step-2-verify-service-ip">Step 2: Verify Service IP</a></li>
<li><a href="#step-3-check-dns-resolution">Step 3: Check DNS Resolution</a></li>
<li><a href="#step-4-investigate-service-ip">Step 4: Investigate Service IP</a></li>
<li><a href="#step-5-verify-outgoing-traffic-from-pod">Step 5: Verify Outgoing Traffic from Pod</a></li>
<li><a href="#step-6-simulate-traffic-from-pod">Step 6: Simulate Traffic from Pod</a></li>
<li><a href="#step-7-restart-pod">Step 7: Restart Pod</a></li>
<li><a href="#step-8-identify-java-dns-caching">Step 8: Identify Java DNS Caching</a></li>
</ul>
</li>
<li><a href="#solution">Solution</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>In a K8S cluster, PodA is experiencing issues when using a service name to access PodB. PodA is on <code>node1</code>, and PodB is on <code>node2</code>. This article will walk through the troubleshooting steps to identify and resolve the issue.</p>
<p><a name="problem-description"></a></p>
<h2 id="Problem-Description"><a href="#Problem-Description" class="headerlink" title="Problem Description"></a>Problem Description</h2><p>PodA is unable to access PodB using the service name, and the request is failing. PodA is on <code>node1</code>, and PodB is on <code>node2</code>.</p>
<p><a name="troubleshooting-steps"></a></p>
<h2 id="Troubleshooting-Steps"><a href="#Troubleshooting-Steps" class="headerlink" title="Troubleshooting Steps"></a>Troubleshooting Steps</h2><p><a name="step-1-capture-network-traffic"></a></p>
<h3 id="Step-1-Capture-Network-Traffic"><a href="#Step-1-Capture-Network-Traffic" class="headerlink" title="Step 1: Capture Network Traffic"></a>Step 1: Capture Network Traffic</h3><p>First, use <code>tcpdump</code> to capture network traffic and observe if there are any anomalies:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# tcpdump -n -i ens192 port 50300  </span><br><span class="line">...  </span><br><span class="line">13:48:17.630335 IP 177.177.176.150.distinct -&gt; 10.96.22.136.50300: UDP, length 214  </span><br><span class="line">13:48:17.630407 IP 192.168.7.21.distinct -&gt; 10.96.22.136.50300: UDP, length 214  </span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>From the captured packets, the source address and port are <code>177.177.176.150:50901</code>, and the destination address and port are <code>10.96.22.136:50300</code>. The destination IP <code>10.96.22.136</code> is the IP address obtained by PodA when using the <code>server-svc</code> service name.</p>
<p><a name="step-2-verify-service-ip"></a></p>
<h3 id="Step-2-Verify-Service-IP"><a href="#Step-2-Verify-Service-IP" class="headerlink" title="Step 2: Verify Service IP"></a>Step 2: Verify Service IP</h3><p>Check if the IP address <code>10.96.22.136</code> is correct:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# kubectl get pod -A -owide|grep server  </span><br><span class="line">ss  server-xxx-xxx  1/1  Running 0 20h  177.177.176.150  node1  </span><br><span class="line">ss  server-xxx-xxx  1/1  Running 0 20h  177.177.254.245  node2  </span><br><span class="line">ss  server-xxx-xxx  1/1  Running 0 20h  177.177.18.152   node3  </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# kubectl get svc -A -owide|grep server  </span><br><span class="line">ss  server-svc  ClusterIP  10.96.182.195 &lt;none&gt;  50300/UDP  </span><br></pre></td></tr></table></figure>

<p>The source IP is correct, but the destination IP does not match the expected <code>server-svc</code> IP <code>10.96.182.195</code>.</p>
<p><a name="step-3-check-dns-resolution"></a></p>
<h3 id="Step-3-Check-DNS-Resolution"><a href="#Step-3-Check-DNS-Resolution" class="headerlink" title="Step 3: Check DNS Resolution"></a>Step 3: Check DNS Resolution</h3><p>Since K8S uses <code>CoreDNS</code> for service discovery starting from v1.13, verify if the DNS resolution is correct inside PodA:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# kubectl <span class="built_in">exec</span> -it -n ss server-xxx-xxx -- <span class="built_in">cat</span> /etc/resolve.conf  </span><br><span class="line">nameserver 10.96.0.10  </span><br><span class="line">search ss.svc.cluster.local svc.cluster.local cluster.local  </span><br><span class="line">options ndots:5  </span><br><span class="line">  </span><br><span class="line">[root@node1 ~]# kubectl <span class="built_in">exec</span> -it -n ss server-xxx-xxx -- nslookup server-svc  </span><br><span class="line">Server: 10.96.0.10  </span><br><span class="line">  </span><br><span class="line">Name: ss  </span><br><span class="line">Address: 10.96.182.195</span><br></pre></td></tr></table></figure>

<p>The DNS resolution is correct, and PodA can resolve <code>server-svc</code> to <code>10.96.182.195</code>.</p>
<p><a name="step-4-investigate-service-ip"></a></p>
<h3 id="Step-4-Investigate-Service-IP"><a href="#Step-4-Investigate-Service-IP" class="headerlink" title="Step 4: Investigate Service IP"></a>Step 4: Investigate Service IP</h3><p>Check if <code>10.96.22.136</code> is associated with any other service, iptables rules, or routes:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# kubectl get svc -A -owide|grep 10.96.22.136  </span><br><span class="line">  </span><br><span class="line">[root@node1 ~]# iptables-save|grep 10.96.22.136  </span><br><span class="line">  </span><br><span class="line">[root@node1 ~]# ip route|grep 10.96.22.136  </span><br></pre></td></tr></table></figure>

<p>The IP <code>10.96.22.136</code> does not exist in the cluster.</p>
<p><a name="step-5-verify-outgoing-traffic-from-pod"></a></p>
<h3 id="Step-5-Verify-Outgoing-Traffic-from-Pod"><a href="#Step-5-Verify-Outgoing-Traffic-from-Pod" class="headerlink" title="Step 5: Verify Outgoing Traffic from Pod"></a>Step 5: Verify Outgoing Traffic from Pod</h3><p>Check the destination IP when the traffic leaves PodA:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# ip route|grep 177.177.176.150  </span><br><span class="line">177.177.176.150 dev cali9afa4438787 scope <span class="built_in">link</span>  </span><br><span class="line">  </span><br><span class="line">[root@node1 ~]# tcpdump -n -i cali9afa4438787 port 50300  </span><br><span class="line">...  </span><br><span class="line">14:16:40.821511 IP 177.177.176.150.50902 -&gt;  10.96.22.136.50300:  UDP, length 214  </span><br><span class="line">...  </span><br></pre></td></tr></table></figure>

<p>The destination IP is incorrect when leaving PodA.</p>
<p><a name="step-6-simulate-traffic-from-pod"></a></p>
<h3 id="Step-6-Simulate-Traffic-from-Pod"><a href="#Step-6-Simulate-Traffic-from-Pod" class="headerlink" title="Step 6: Simulate Traffic from Pod"></a>Step 6: Simulate Traffic from Pod</h3><p>Simulate a UDP packet from PodA using <code>nc</code> to verify if the destination IP is correct:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# kubectl <span class="built_in">exec</span> -it -n ss server-xxx-xxx -- <span class="built_in">echo</span> “<span class="built_in">test</span>” | nc -u server-svc 50300 -p 9999  </span><br><span class="line">  </span><br><span class="line">[root@node1 ~]# tcpdump -n -i cali9afa4438787 port 50300  </span><br><span class="line">...  </span><br><span class="line">15:46:45.871580 IP 177.177.176.150.50902 -&gt;  10.96.182.195.50300:  UDP, length 54  </span><br><span class="line">...  </span><br></pre></td></tr></table></figure>

<p>The simulated traffic has the correct destination IP.</p>
<p><a name="step-7-restart-pod"></a></p>
<h3 id="Step-7-Restart-Pod"><a href="#Step-7-Restart-Pod" class="headerlink" title="Step 7: Restart Pod"></a>Step 7: Restart Pod</h3><p>Restart PodA to see if the issue is resolved:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@node1 ~]# docker ps |grep server-xxx-xxx | grep -v POD |awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span> |xargs docker restart  </span><br><span class="line">  </span><br><span class="line">[root@node1 ~]# tcpdump -n -i ens192 port 50300  </span><br><span class="line">...  </span><br><span class="line">15:58:17.150535 IP 177.177.176.150.distinct -&gt; 10.96.182.195.50300:  UDP, length 214  </span><br><span class="line">15:58:17.150607 IP 192.168.7.21.distinct  -&gt;  10.96.182.195.50300:   UDP, length 214  </span><br><span class="line">...  </span><br></pre></td></tr></table></figure>

<p>The issue is resolved after restarting PodA.</p>
<p><a name="step-8-identify-java-dns-caching"></a></p>
<h3 id="Step-8-Identify-Java-DNS-Caching"><a href="#Step-8-Identify-Java-DNS-Caching" class="headerlink" title="Step 8: Identify Java DNS Caching"></a>Step 8: Identify Java DNS Caching</h3><p>Investigate if Java DNS caching is causing the issue:</p>
<blockquote>
<p>In Java, DNS caching is used to improve performance by storing DNS lookup results. When <code>InetAddress</code> is used to resolve a domain name, the result is cached by the JVM. This cache can cause stale DNS entries to be used.</p>
</blockquote>
<p>To resolve this, adjust the DNS caching settings:</p>
<ol>
<li>Set the <code>networkaddress.cache.ttl</code> property in the Java security settings.</li>
<li>Modify the <code>java.security</code> file to set the <code>networkaddress.cache.negative.ttl</code> property.</li>
</ol>
<p><a name="solution"></a></p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>Adjust the DNS caching settings in the business application based on the business scenario.</p>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>This article detailed the troubleshooting steps to identify and resolve an issue where PodA was unable to access PodB using a service name in a K8S cluster. The root cause was identified as Java DNS caching, and the issue was resolved by adjusting the DNS caching settings.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/31/Deep-Dive-into-Kubernetes-Ingress/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/31/Deep-Dive-into-Kubernetes-Ingress/" class="post-title-link" itemprop="url">Deep Dive into Kubernetes Ingress</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-10-31 13:20:57 / Modified: 13:22:00" itemprop="dateCreated datePublished" datetime="2024-10-31T13:20:57-04:00">2024-10-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/" itemprop="url" rel="index"><span itemprop="name">Deep Dive</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#what-is-kubernetes-ingress">What is Kubernetes Ingress?</a><ul>
<li><a href="#ingress-types">Ingress Types</a></li>
</ul>
</li>
<li><a href="#ingress-controllers">Ingress Controllers</a></li>
<li><a href="#ingress-rules-and-annotations">Ingress Rules and Annotations</a><ul>
<li><a href="#example-of-an-ingress-rule">Example of an Ingress Rule</a></li>
</ul>
</li>
<li><a href="#ingress-architecture-diagram">Ingress Architecture Diagram</a><ul>
<li><a href="#ingress-with-path-based-routing">Ingress with Path-Based Routing</a></li>
</ul>
</li>
</ul>
<hr>
<p>In Kubernetes, <strong>Ingress</strong> is a crucial component that manages external access to services within a cluster, typically via HTTP or HTTPS. It provides a centralized entry point for external traffic, applying routing rules to direct requests to appropriate services. This article explores the architecture and responsibilities of Kubernetes Ingress, how it interacts with other components, and provides visual architecture diagrams.</p>
<hr>
<p><a name="kubernetes-ingress"></a></p>
<h2 id="What-is-Kubernetes-Ingress"><a href="#What-is-Kubernetes-Ingress" class="headerlink" title="What is Kubernetes Ingress?"></a>What is Kubernetes Ingress?</h2><p><strong>Ingress</strong> in Kubernetes is an API object that manages external access to services, usually HTTP. Instead of exposing each service individually through a <strong>Service</strong> object of type <code>LoadBalancer</code> or <code>NodePort</code>, Ingress offers a central route, managing traffic with a single IP address or DNS name for the entire cluster. Key benefits include:</p>
<ul>
<li><strong>Centralized Traffic Management</strong>: Ingress consolidates traffic through a single point of entry, allowing easy route management.</li>
<li><strong>Path-Based Routing</strong>: Requests can be directed to specific services based on request paths or hostnames.</li>
<li><strong>SSL Termination</strong>: Ingress can terminate SSL&#x2F;TLS connections, ensuring secure HTTPS access.</li>
</ul>
<h3 id="Ingress-Types"><a href="#Ingress-Types" class="headerlink" title="Ingress Types"></a>Ingress Types</h3><p>Kubernetes supports two main Ingress types:</p>
<ul>
<li><strong>Simple Ingress</strong>: For straightforward routing to backend services based on path or hostname.</li>
<li><strong>Advanced Ingress</strong>: With more complex routing rules, integrating SSL termination, URL rewrites, and custom filtering.</li>
</ul>
<hr>
<p><a name="ingress-controllers"></a></p>
<h2 id="Ingress-Controllers"><a href="#Ingress-Controllers" class="headerlink" title="Ingress Controllers"></a>Ingress Controllers</h2><p>An <strong>Ingress Controller</strong> is the implementation that enforces Ingress rules, usually deployed as a Pod within the cluster. Popular Ingress controllers include <strong>NGINX</strong>, <strong>HAProxy</strong>, <strong>Traefik</strong>, and <strong>Istio</strong>. The Ingress Controller is responsible for:</p>
<ol>
<li><strong>Monitoring Ingress Resources</strong>: Watching for any changes in Ingress resources and updating routing rules accordingly.</li>
<li><strong>Load Balancing and SSL Termination</strong>: Providing efficient load balancing for HTTP&#x2F;HTTPS requests.</li>
<li><strong>Proxying and Forwarding</strong>: Accepting requests on behalf of the Ingress and forwarding them to the correct Service and Pod.</li>
</ol>
<p>The Ingress Controller must be installed in the cluster to interpret and apply Ingress resources, as Kubernetes does not ship with a default controller.</p>
<hr>
<p><a name="ingress-rules"></a></p>
<h2 id="Ingress-Rules-and-Annotations"><a href="#Ingress-Rules-and-Annotations" class="headerlink" title="Ingress Rules and Annotations"></a>Ingress Rules and Annotations</h2><p>Ingress rules define the routing policy for external traffic. These rules can direct traffic based on URL paths or hostnames, and each rule specifies the <code>Service</code> and <code>Port</code> the request should route to. Annotations add configurations like timeouts, request limits, and additional routing options.</p>
<h3 id="Example-of-an-Ingress-Rule"><a href="#Example-of-an-Ingress-Rule" class="headerlink" title="Example of an Ingress Rule"></a>Example of an Ingress Rule</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">example-ingress</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">nginx.ingress.kubernetes.io/rewrite-target:</span> <span class="string">/</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">example.com</span></span><br><span class="line">    <span class="attr">http:</span></span><br><span class="line">      <span class="attr">paths:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">path:</span> <span class="string">/app</span></span><br><span class="line">        <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">        <span class="attr">backend:</span></span><br><span class="line">          <span class="attr">service:</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">app-service</span></span><br><span class="line">            <span class="attr">port:</span></span><br><span class="line">              <span class="attr">number:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure>

<p>In this example, requests to <code>example.com/app</code> are routed to the <code>app-service</code> on port <code>80</code>.</p>
<hr>
<p><a name="architecture-diagram"></a></p>
<h2 id="Ingress-Architecture-Diagram"><a href="#Ingress-Architecture-Diagram" class="headerlink" title="Ingress Architecture Diagram"></a>Ingress Architecture Diagram</h2><h3 id="Ingress-with-Path-Based-Routing"><a href="#Ingress-with-Path-Based-Routing" class="headerlink" title="Ingress with Path-Based Routing"></a>Ingress with Path-Based Routing</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">+-----------------------------+</span><br><span class="line">|        External User        |</span><br><span class="line">+-----------------------------+</span><br><span class="line">              |</span><br><span class="line">              v</span><br><span class="line">+-----------------------------+</span><br><span class="line">|      Ingress Controller     |        &lt;-- Manages Ingress Rules</span><br><span class="line">+-----------------------------+</span><br><span class="line">              |</span><br><span class="line">      +-------+------+--------+</span><br><span class="line">      |              |        |</span><br><span class="line">      v              v        v</span><br><span class="line">+-----------+    +-----------+   +-----------+</span><br><span class="line">| Service A |    | Service B |   | Service C |</span><br><span class="line">+-----------+    +-----------+   +-----------+</span><br><span class="line">      |              |                |</span><br><span class="line">      v              v                v</span><br><span class="line">+-----------+    +-----------+   +-----------+</span><br><span class="line">| Pod A1    |    | Pod B1    |   | Pod C1    |</span><br><span class="line">+-----------+    +-----------+   +-----------+</span><br></pre></td></tr></table></figure>

<p>In this diagram:</p>
<ul>
<li><strong>Ingress Controller</strong> routes based on rules that direct traffic to Services.</li>
<li><strong>Services</strong> are abstractions that select Pods through labels.</li>
<li><strong>Pods</strong> run the actual applications and receive traffic forwarded by the Ingress Controller.</li>
</ul>
<p>This setup allows centralized and managed external access to cluster resources.</p>
<hr>
<p>By centralizing access with Ingress, Kubernetes can handle complex routing configurations, ensuring that traffic flows efficiently and securely across the cluster.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Dazhi Zhang</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.1/mermaid.min.js","integrity":"sha256-YbM1pG3wWnzhyYN49g5fPnen+2CKEFaZfopkkwSpNtY="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  





</body>
</html>
