<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.whereq.com","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.21.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="WhereQ">
<meta property="og:url" content="https://www.whereq.com/page/2/index.html">
<meta property="og:site_name" content="WhereQ">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Dazhi Zhang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.whereq.com/page/2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/2/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>WhereQ</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">WhereQ</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-articles"><a href="/articles/" rel="section"><i class="fa fa-file fa-fw"></i>Articles</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Dazhi Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">123</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">112</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">71</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2025/01/08/Building-a-Google-Maps-Application-with-React-and-TypeScript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/08/Building-a-Google-Maps-Application-with-React-and-TypeScript/" class="post-title-link" itemprop="url">Building a Google Maps Application with React and TypeScript</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2025-01-08 10:47:17 / Modified: 12:49:31" itemprop="dateCreated datePublished" datetime="2025-01-08T10:47:17-05:00">2025-01-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/" itemprop="url" rel="index"><span itemprop="name">ReactJS</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/TypeScript/" itemprop="url" rel="index"><span itemprop="name">TypeScript</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/TypeScript/GIS/" itemprop="url" rel="index"><span itemprop="name">GIS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><ul>
<li><strong>Node.js</strong> installed (version 14 or higher).</li>
<li><strong>npm</strong> or <strong>yarn</strong> for package management.</li>
<li>A Google Cloud Platform (GCP) account to obtain the API Key and set up the Map ID.</li>
</ul>
<h2 id="Project-Setup"><a href="#Project-Setup" class="headerlink" title="Project Setup"></a>Project Setup</h2><ol>
<li><p><strong>Create a React Application</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npx create-react-app google-maps-app --template typescript</span><br><span class="line"><span class="built_in">cd</span> google-maps-app</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Install Required Dependencies</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install @react-google-maps/api</span><br><span class="line">npm install react-hook-form</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Setup Google Cloud Platform</strong>:</p>
<ul>
<li><strong>Enable the Maps JavaScript API</strong>:<ol>
<li>Go to the <a target="_blank" rel="noopener" href="https://console.cloud.google.com/">Google Cloud Console</a>.</li>
<li>Create a new project or select an existing one.</li>
<li>Navigate to <code>APIs &amp; Services</code> &gt; <code>Library</code> and enable the <code>Maps JavaScript API</code>.</li>
</ol>
</li>
<li><strong>Generate an API Key</strong>:<ol>
<li>Go to <code>APIs &amp; Services</code> &gt; <code>Credentials</code> and create an API Key.</li>
<li>Restrict the API Key to ensure security by specifying HTTP referrers (your domain or <code>localhost</code>).</li>
</ol>
</li>
<li><strong>Create a Map ID</strong>:<ol>
<li>Go to <code>Google Maps Platform</code> &gt; <code>Maps</code> &gt; <code>Map Management</code>.</li>
<li>Create a new Map ID and configure it with desired styles and settings.</li>
</ol>
</li>
</ul>
</li>
</ol>
<h2 id="Project-Structure"><a href="#Project-Structure" class="headerlink" title="Project Structure"></a>Project Structure</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">google-maps-app/</span><br><span class="line">├── public/</span><br><span class="line">├── src/</span><br><span class="line">│   ├── components/</span><br><span class="line">│   │   ├── MapContainer.tsx</span><br><span class="line">│   │   ├── SearchBox.tsx</span><br><span class="line">│   ├── App.tsx</span><br><span class="line">│   ├── index.tsx</span><br><span class="line">│   ├── types/</span><br><span class="line">│   │   ├── index.d.ts</span><br><span class="line">│   ├── utils/</span><br><span class="line">│       ├── mapUtils.ts</span><br></pre></td></tr></table></figure>

<h2 id="Coding-the-Application"><a href="#Coding-the-Application" class="headerlink" title="Coding the Application"></a>Coding the Application</h2><h3 id="Step-1-Setup-TypeScript-Types"><a href="#Step-1-Setup-TypeScript-Types" class="headerlink" title="Step 1: Setup TypeScript Types"></a>Step 1: Setup TypeScript Types</h3><p>Create <code>src/types/index.d.ts</code> to define types for the Google Maps objects:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="variable language_">global</span> &#123;</span><br><span class="line">  <span class="keyword">interface</span> <span class="title class_">Window</span> &#123;</span><br><span class="line">    <span class="attr">google</span>: <span class="built_in">any</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">MarkerData</span> &#123;</span><br><span class="line">  <span class="attr">position</span>: google.<span class="property">maps</span>.<span class="property">LatLngLiteral</span>;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Step-2-Utility-Functions"><a href="#Step-2-Utility-Functions" class="headerlink" title="Step 2: Utility Functions"></a>Step 2: Utility Functions</h3><p>Create <code>src/utils/mapUtils.ts</code> to define helper functions:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> loadGoogleMapsScript = (<span class="attr">apiKey</span>: <span class="built_in">string</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">    script.<span class="property">src</span> = <span class="string">`https://maps.googleapis.com/maps/api/js?key=<span class="subst">$&#123;apiKey&#125;</span>&amp;libraries=places`</span>;</span><br><span class="line">    script.<span class="property">async</span> = <span class="literal">true</span>;</span><br><span class="line">    script.<span class="property">defer</span> = <span class="literal">true</span>;</span><br><span class="line">    script.<span class="property">onload</span> = <span class="function">() =&gt;</span> <span class="title function_">resolve</span>();</span><br><span class="line">    script.<span class="property">onerror</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> <span class="title function_">reject</span>(e);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(script);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="Step-3-Map-Container"><a href="#Step-3-Map-Container" class="headerlink" title="Step 3: Map Container"></a>Step 3: Map Container</h3><p>Create <code>src/components/MapContainer.tsx</code>:</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useRef, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">MarkerData</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../types&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MapContainerProps</span> = &#123;</span><br><span class="line">  <span class="attr">apiKey</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">mapId</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MapContainer</span>: <span class="title class_">React</span>.<span class="property">FC</span>&lt;<span class="title class_">MapContainerProps</span>&gt; = <span class="function">(<span class="params">&#123; apiKey, mapId &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mapRef = useRef&lt;<span class="title class_">HTMLDivElement</span>&gt;(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [map, setMap] = useState&lt;google.<span class="property">maps</span>.<span class="property">Map</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [markers, setMarkers] = useState&lt;google.<span class="property">maps</span>.<span class="property">Marker</span>[]&gt;([]);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">initMap</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">loadGoogleMapsScript</span>(apiKey);</span><br><span class="line">        <span class="keyword">if</span> (mapRef.<span class="property">current</span>) &#123;</span><br><span class="line">          <span class="keyword">const</span> mapInstance = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="title class_">Map</span>(mapRef.<span class="property">current</span>, &#123;</span><br><span class="line">            <span class="attr">center</span>: &#123; <span class="attr">lat</span>: <span class="number">37.7749</span>, <span class="attr">lng</span>: -<span class="number">122.4194</span> &#125;,</span><br><span class="line">            <span class="attr">zoom</span>: <span class="number">12</span>,</span><br><span class="line">            <span class="attr">mapId</span>: mapId,</span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="title function_">setMap</span>(mapInstance);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Failed to load Google Maps:&#x27;</span>, error);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">initMap</span>();</span><br><span class="line">  &#125;, [apiKey, mapId]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">addMarker</span> = (<span class="params"><span class="attr">markerData</span>: <span class="title class_">MarkerData</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (map) &#123;</span><br><span class="line">      <span class="keyword">const</span> marker = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="property">marker</span>.<span class="title class_">AdvancedMarkerElement</span>(&#123;</span><br><span class="line">        map,</span><br><span class="line">        <span class="attr">position</span>: markerData.<span class="property">position</span>,</span><br><span class="line">        <span class="attr">title</span>: markerData.<span class="property">title</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="title function_">setMarkers</span>(<span class="function">(<span class="params">prev</span>) =&gt;</span> [...prev, marker]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;mapRef&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27;, <span class="attr">height:</span> &#x27;<span class="attr">500px</span>&#x27; &#125;&#125; /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">MapContainer</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Step-4-Search-Box"><a href="#Step-4-Search-Box" class="headerlink" title="Step 4: Search Box"></a>Step 4: Search Box</h3><p>Create <code>src/components/SearchBox.tsx</code>:</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">SearchBoxProps</span> = &#123;</span><br><span class="line">  <span class="attr">onPlaceSelected</span>: <span class="function">(<span class="params"><span class="attr">place</span>: google.maps.places.<span class="title class_">PlaceResult</span></span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">SearchBox</span>: <span class="title class_">React</span>.<span class="property">FC</span>&lt;<span class="title class_">SearchBoxProps</span>&gt; = <span class="function">(<span class="params">&#123; onPlaceSelected &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> inputRef = useRef&lt;<span class="title class_">HTMLInputElement</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (inputRef.<span class="property">current</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> autocomplete = <span class="keyword">new</span> google.<span class="property">maps</span>.<span class="property">places</span>.<span class="title class_">Autocomplete</span>(inputRef.<span class="property">current</span>);</span><br><span class="line">      autocomplete.<span class="title function_">addListener</span>(<span class="string">&#x27;place_changed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> place = autocomplete.<span class="title function_">getPlace</span>();</span><br><span class="line">        <span class="keyword">if</span> (place) &#123;</span><br><span class="line">          <span class="title function_">onPlaceSelected</span>(place);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Search places...&quot;</span> /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">SearchBox</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Step-5-Combine-Components"><a href="#Step-5-Combine-Components" class="headerlink" title="Step 5: Combine Components"></a>Step 5: Combine Components</h3><p>Update <code>src/App.tsx</code>:</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MapContainer</span> <span class="keyword">from</span> <span class="string">&#x27;./components/MapContainer&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">SearchBox</span> <span class="keyword">from</span> <span class="string">&#x27;./components/SearchBox&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">MarkerData</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./types&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [markers, setMarkers] = useState&lt;<span class="title class_">MarkerData</span>[]&gt;([]);</span><br><span class="line">  <span class="keyword">const</span> apiKey = <span class="string">&#x27;YOUR_GOOGLE_MAPS_API_KEY&#x27;</span>;</span><br><span class="line">  <span class="keyword">const</span> mapId = <span class="string">&#x27;YOUR_MAP_ID&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handlePlaceSelected</span> = (<span class="params"><span class="attr">place</span>: google.maps.places.<span class="title class_">PlaceResult</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (place.<span class="property">geometry</span>?.<span class="property">location</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> markerData = &#123;</span><br><span class="line">        <span class="attr">position</span>: &#123;</span><br><span class="line">          <span class="attr">lat</span>: place.<span class="property">geometry</span>.<span class="property">location</span>.<span class="title function_">lat</span>(),</span><br><span class="line">          <span class="attr">lng</span>: place.<span class="property">geometry</span>.<span class="property">location</span>.<span class="title function_">lng</span>(),</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">title</span>: place.<span class="property">name</span> || <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="title function_">setMarkers</span>(<span class="function">(<span class="params">prev</span>) =&gt;</span> [...prev, markerData]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">SearchBox</span> <span class="attr">onPlaceSelected</span>=<span class="string">&#123;handlePlaceSelected&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">MapContainer</span> <span class="attr">apiKey</span>=<span class="string">&#123;apiKey&#125;</span> <span class="attr">mapId</span>=<span class="string">&#123;mapId&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<h2 id="Running-the-Application"><a href="#Running-the-Application" class="headerlink" title="Running the Application"></a>Running the Application</h2><ol>
<li>Replace <code>YOUR_GOOGLE_MAPS_API_KEY</code> and <code>YOUR_MAP_ID</code> in <code>App.tsx</code> with your actual values.</li>
<li>Start the application:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure></li>
<li>Open <code>http://localhost:3000</code> in your browser.</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/12/28/Resolving-Dependency-Issues-in-useEffect-for-a-React-Application/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/12/28/Resolving-Dependency-Issues-in-useEffect-for-a-React-Application/" class="post-title-link" itemprop="url">Resolving Dependency Issues in useEffect for a React Application</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-12-28 22:15:21 / Modified: 22:29:55" itemprop="dateCreated datePublished" datetime="2024-12-28T22:15:21-05:00">2024-12-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/React/" itemprop="url" rel="index"><span itemprop="name">React</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/React/useEffect/" itemprop="url" rel="index"><span itemprop="name">useEffect</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/React/useEffect/React-Hooks/" itemprop="url" rel="index"><span itemprop="name">React Hooks</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Last week, I was tasked with building a Parameters.tsx component, and let me tell you, the struggle was real! I got completely entangled in a web of useEffect dependencies. It was like trying to untangle a Christmas tree of wires! 🎄 But hey, I finally emerged victorious (mostly) and learned some valuable lessons along the way. Here’s the story…</p>
<h2 id="The-Product-Requirement"><a href="#The-Product-Requirement" class="headerlink" title="The Product Requirement"></a><strong>The Product Requirement</strong></h2><ol>
<li>Initializes a table with passed-in parameters (<code>Record&lt;string, string&gt;</code>).  </li>
<li>Allows in-place editing of table rows.  </li>
<li>Automatically persists updated parameters to local storage, using a passed-in URL as the key.</li>
</ol>
<hr>
<h2 id="Implementation"><a href="#Implementation" class="headerlink" title="Implementation"></a><strong>Implementation</strong></h2><p>The implementation involves two <code>useEffect</code> hooks:</p>
<ol>
<li><strong>First <code>useEffect</code></strong>: Loads the passed-in parameters into the table.</li>
<li><strong>Second <code>useEffect</code></strong>: Saves the updated parameters to local storage whenever the user makes changes to the table rows.</li>
</ol>
<hr>
<h2 id="The-Problem"><a href="#The-Problem" class="headerlink" title="The Problem"></a><strong>The Problem</strong></h2><p>The <strong>key issue</strong> arises from the second <code>useEffect</code>. Since the URL (used as the storage key) is passed into the component, it was added as a dependency. This caused unintended behavior when switching endpoints, leading to:</p>
<ul>
<li>Saving the parameters of a <strong>previous endpoint</strong> under the <strong>new endpoint’s URL</strong>.</li>
</ul>
<h3 id="Scenario-Details"><a href="#Scenario-Details" class="headerlink" title="Scenario Details"></a><strong>Scenario Details</strong></h3><p>When switching endpoints, the <code>restfulEndpointUrl</code> (passed-in URL) changes. Since the URL is used as the key for saving parameters to local storage, it was added as a dependency to the second <code>useEffect</code>. However, this led to incorrect behavior:</p>
<ul>
<li>When the URL changes, the <code>useEffect</code> is triggered.</li>
<li>At this point, the table still contains the parameters of the <strong>previous endpoint</strong>.</li>
<li>As a result, the parameters of the previous endpoint are saved under the <strong>new endpoint’s URL</strong>, which is incorrect.</li>
</ul>
<h3 id="Why-This-Happens"><a href="#Why-This-Happens" class="headerlink" title="Why This Happens"></a><strong>Why This Happens</strong></h3><p>The <code>useEffect</code> hook runs whenever any of its dependencies change. By including <code>restfulEndpointUrl</code> in the dependency array, the <code>useEffect</code> is triggered when the URL changes, even though the table content hasn’t been updated yet.</p>
<hr>
<h2 id="Root-Cause-Unnecessary-Dependencies-in-useEffect"><a href="#Root-Cause-Unnecessary-Dependencies-in-useEffect" class="headerlink" title="Root Cause: Unnecessary Dependencies in useEffect"></a><strong>Root Cause: Unnecessary Dependencies in <code>useEffect</code></strong></h2><p>Let’s break down why adding <code>restfulEndpointUrl</code> as a dependency caused the issue:</p>
<ol>
<li><p><strong>How <code>useEffect</code> Dependencies Work</strong><br>The dependencies in the <code>useEffect</code> array dictate when the hook is re-triggered. By including <code>restfulEndpointUrl</code>, the persistence logic was unnecessarily invoked whenever the URL changed.  </p>
</li>
<li><p><strong>Incorrect State Handling</strong><br>When the URL changed, the persistence logic was triggered prematurely, using the <strong>outdated state of <code>rows</code></strong>, leading to data being saved under the incorrect key.</p>
</li>
</ol>
<h3 id="Impact-of-This-Bug"><a href="#Impact-of-This-Bug" class="headerlink" title="Impact of This Bug"></a><strong>Impact of This Bug</strong></h3><p>Here’s a sequence of events that led to the bug:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. restfulEndpointUrl = &quot;endpoint_1&quot;</span><br><span class="line">   - Rows initialized and saved correctly under &quot;endpoint_1&quot;.</span><br><span class="line">2. restfulEndpointUrl changes to &quot;endpoint_2&quot;</span><br><span class="line">   - useEffect triggers immediately.</span><br><span class="line">   - Old rows (from &quot;endpoint_1&quot;) are saved under &quot;endpoint_2&quot;.</span><br><span class="line">3. User edits table.</span><br><span class="line">   - New rows are saved under &quot;endpoint_2&quot;, but previous data is corrupted.</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Solution-Leveraging-useRef"><a href="#Solution-Leveraging-useRef" class="headerlink" title="Solution: Leveraging useRef"></a><strong>Solution: Leveraging <code>useRef</code></strong></h2><p>To fix this, we need to ensure that the persistence logic <strong>only runs when <code>rows</code> changes</strong>, and <strong>not when the URL changes</strong>.<br>This can be achieved by:</p>
<ol>
<li>Removing <code>restfulEndpointUrl</code> from the dependency array of the <code>useEffect</code> that handles persistence.</li>
<li>Using a <code>useRef</code> to always access the latest URL without triggering the <code>useEffect</code>.</li>
</ol>
<p>The <code>useRef</code> hook provides a solution by holding a mutable reference to the latest URL without triggering re-renders or re-triggering the <code>useEffect</code>. Here’s why it works:</p>
<ul>
<li><strong>Avoiding Dependencies:</strong> By using <code>useRef</code>, we avoid adding <code>restfulEndpointUrl</code> to the dependency array. The persistence logic is now triggered only when <code>rows</code> change.  </li>
<li><strong>Always Up-to-Date:</strong> Updating the <code>useRef</code> in its own <code>useEffect</code> ensures it always holds the latest URL.</li>
</ul>
<hr>
<h2 id="Why-useRef-Fixes-the-Problem"><a href="#Why-useRef-Fixes-the-Problem" class="headerlink" title="Why useRef Fixes the Problem"></a><strong>Why <code>useRef</code> Fixes the Problem</strong></h2><p>The <code>useRef</code> hook allows us to store a mutable value that persists across renders without causing re-renders. By storing the URL in a <code>ref</code>, we can:</p>
<ul>
<li>Access the latest URL value without adding it as a dependency to <code>useEffect</code>.</li>
<li>Ensure that the persistence logic only runs when <code>rows</code> changes, avoiding incorrect saves.</li>
</ul>
<hr>
<h2 id="Code-Comparison"><a href="#Code-Comparison" class="headerlink" title="Code Comparison"></a><strong>Code Comparison</strong></h2><h3 id="Before-Fixing"><a href="#Before-Fixing" class="headerlink" title="Before Fixing"></a><strong>Before Fixing</strong></h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [rows, setRows] = useState&lt;<span class="title class_">Row</span>[]&gt;([]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Initialize rows</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> initialRows = <span class="title class_">Object</span>.<span class="title function_">entries</span>(initialParams).<span class="title function_">map</span>(<span class="function">(<span class="params">[key, value]</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">selected</span>: <span class="literal">true</span>,</span><br><span class="line">        key,</span><br><span class="line">        value,</span><br><span class="line">        <span class="attr">description</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    &#125;));</span><br><span class="line">    <span class="title function_">setRows</span>(initialRows);</span><br><span class="line">&#125;, [initialParams]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Persist changes</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (restfulEndpointUrl) &#123;</span><br><span class="line">        <span class="keyword">const</span> params = rows</span><br><span class="line">            .<span class="title function_">filter</span>(<span class="function">(<span class="params">row</span>) =&gt;</span> row.<span class="property">selected</span> &amp;&amp; row.<span class="property">key</span>)</span><br><span class="line">            .<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, row</span>) =&gt;</span> &#123;</span><br><span class="line">                acc[row.<span class="property">key</span>] = row.<span class="property">value</span>;</span><br><span class="line">                <span class="keyword">return</span> acc;</span><br><span class="line">            &#125;, &#123;&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="title class_">LocalStorageHelper</span>.<span class="title function_">setParams</span>(restfulEndpointUrl, params);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, [rows, restfulEndpointUrl]); <span class="comment">// restfulEndpointUrl as a dependency causes issues</span></span><br></pre></td></tr></table></figure>

<h3 id="After-Fixing"><a href="#After-Fixing" class="headerlink" title="After Fixing"></a><strong>After Fixing</strong></h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [rows, setRows] = useState&lt;<span class="title class_">Row</span>[]&gt;([]);</span><br><span class="line"><span class="keyword">const</span> restfulEndpointUrlRef = <span class="title function_">useRef</span>(restfulEndpointUrl);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Update ref when URL changes</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    restfulEndpointUrlRef.<span class="property">current</span> = restfulEndpointUrl;</span><br><span class="line">&#125;, [restfulEndpointUrl]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Initialize rows</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> initialRows = <span class="title class_">Object</span>.<span class="title function_">entries</span>(initialParams).<span class="title function_">map</span>(<span class="function">(<span class="params">[key, value]</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">selected</span>: <span class="literal">true</span>,</span><br><span class="line">        key,</span><br><span class="line">        value,</span><br><span class="line">        <span class="attr">description</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    &#125;));</span><br><span class="line">    <span class="title function_">setRows</span>(initialRows);</span><br><span class="line">&#125;, [initialParams]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Persist changes</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> params = rows</span><br><span class="line">        .<span class="title function_">filter</span>(<span class="function">(<span class="params">row</span>) =&gt;</span> row.<span class="property">selected</span> &amp;&amp; row.<span class="property">key</span>)</span><br><span class="line">        .<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, row</span>) =&gt;</span> &#123;</span><br><span class="line">            acc[row.<span class="property">key</span>] = row.<span class="property">value</span>;</span><br><span class="line">            <span class="keyword">return</span> acc;</span><br><span class="line">        &#125;, &#123;&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title class_">LocalStorageHelper</span>.<span class="title function_">setParams</span>(restfulEndpointUrlRef.<span class="property">current</span>, params);</span><br><span class="line">&#125;, [rows]); <span class="comment">// URL dependency removed</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Sequence-Diagram-Before-the-Fix"><a href="#Sequence-Diagram-Before-the-Fix" class="headerlink" title="Sequence Diagram: Before the Fix"></a><strong>Sequence Diagram: Before the Fix</strong></h2><pre><code class="highlight mermaid">sequenceDiagram
    participant User
    participant Component
    participant LocalStorage

    User-&gt;&gt;Component: Switches Endpoint
    Component-&gt;&gt;Component: restfulEndpointUrl changes
    Component-&gt;&gt;Component: useEffect (persistence) triggers
    Component-&gt;&gt;Component: Table still contains params of previous endpoint
    Component-&gt;&gt;LocalStorage: Incorrect params saved under new endpoint&#x27;s URL</code></pre>

<h3 id="Explanation"><a href="#Explanation" class="headerlink" title="Explanation"></a><strong>Explanation</strong></h3><ol>
<li>The user switches the endpoint.</li>
<li>The <code>restfulEndpointUrl</code> changes.</li>
<li>The <code>useEffect</code> (persistence) triggers because <code>restfulEndpointUrl</code> is a dependency.</li>
<li>The table still contains the parameters of the <strong>previous endpoint</strong>.</li>
<li>The incorrect parameters are saved under the <strong>new endpoint’s URL</strong>.</li>
</ol>
<hr>
<h2 id="Sequence-Diagram-After-the-Fix"><a href="#Sequence-Diagram-After-the-Fix" class="headerlink" title="Sequence Diagram: After the Fix"></a><strong>Sequence Diagram: After the Fix</strong></h2><pre><code class="highlight mermaid">sequenceDiagram
    participant User
    participant Component
    participant LocalStorage

    User-&gt;&gt;Component: Switches Endpoint
    Component-&gt;&gt;Component: restfulEndpointUrl changes
    Component-&gt;&gt;Component: ref updated with new URL
    Component-&gt;&gt;Component: Table updated with new endpoint&#x27;s params
    User-&gt;&gt;Component: Edits Table
    Component-&gt;&gt;Component: useEffect (persistence) triggers
    Component-&gt;&gt;LocalStorage: Correct params saved under new endpoint&#x27;s URL</code></pre>

<h3 id="Explanation-1"><a href="#Explanation-1" class="headerlink" title="Explanation"></a><strong>Explanation</strong></h3><ol>
<li>The user switches the endpoint.</li>
<li>The <code>restfulEndpointUrl</code> changes.</li>
<li>The <code>ref</code> is updated with the new URL.</li>
<li>The table is updated with the new endpoint’s parameters.</li>
<li>The user edits the table.</li>
<li>The <code>useEffect</code> (persistence) triggers because <code>rows</code> changed.</li>
<li>The correct parameters are saved under the <strong>new endpoint’s URL</strong>.</li>
</ol>
<hr>
<h2 id="Key-Differences-in-the-Diagrams"><a href="#Key-Differences-in-the-Diagrams" class="headerlink" title="Key Differences in the Diagrams"></a><strong>Key Differences in the Diagrams</strong></h2><table>
<thead>
<tr>
<th><strong>Before the Fix</strong></th>
<th><strong>After the Fix</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>useEffect</code> triggers when <code>restfulEndpointUrl</code> changes.</td>
<td><code>useEffect</code> triggers only when <code>rows</code> changes.</td>
</tr>
<tr>
<td>Incorrect parameters are saved because the table hasn’t been updated yet.</td>
<td>Correct parameters are saved because the table is updated before persistence.</td>
</tr>
<tr>
<td><code>restfulEndpointUrl</code> is a dependency in <code>useEffect</code>.</td>
<td><code>restfulEndpointUrl</code> is stored in a <code>ref</code> and not a dependency in <code>useEffect</code>.</td>
</tr>
</tbody></table>
<hr>
<hr>
<h2 id="Key-Takeaways"><a href="#Key-Takeaways" class="headerlink" title="Key Takeaways"></a><strong>Key Takeaways</strong></h2><h3 id="Why-Unnecessary-Dependencies-Are-Problematic"><a href="#Why-Unnecessary-Dependencies-Are-Problematic" class="headerlink" title="Why Unnecessary Dependencies Are Problematic"></a><strong>Why Unnecessary Dependencies Are Problematic</strong></h3><ol>
<li>They can cause re-triggers in <code>useEffect</code> that don’t align with the intended logic.  </li>
<li>This often leads to outdated or incorrect state usage.</li>
</ol>
<h3 id="Why-useRef-Is-the-Solution"><a href="#Why-useRef-Is-the-Solution" class="headerlink" title="Why useRef Is the Solution"></a><strong>Why <code>useRef</code> Is the Solution</strong></h3><ol>
<li><code>useRef</code> provides a mutable container that doesn’t cause re-renders or hook re-triggers.  </li>
<li>It allows us to maintain the latest value of a variable without adding it to <code>useEffect</code> dependencies.</li>
</ol>
<hr>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a><strong>Conclusion</strong></h2><p>Using <code>useEffect</code> effectively requires careful consideration of its dependencies. In this case, leveraging <code>useRef</code> eliminated unnecessary triggers, ensuring the correct behavior when switching endpoints. This approach is a best practice for similar scenarios where state changes need to be decoupled from unrelated external variables.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/12/27/Deep-Dive-into-Local-Storage-Usage-in-React-with-TypeScript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/12/27/Deep-Dive-into-Local-Storage-Usage-in-React-with-TypeScript/" class="post-title-link" itemprop="url">Deep Dive into Local Storage Usage in React with TypeScript</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-12-27 16:00:44 / Modified: 16:02:08" itemprop="dateCreated datePublished" datetime="2024-12-27T16:00:44-05:00">2024-12-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/" itemprop="url" rel="index"><span itemprop="name">Deep Dive</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/React/" itemprop="url" rel="index"><span itemprop="name">React</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/React/TypeScript/" itemprop="url" rel="index"><span itemprop="name">TypeScript</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Local storage is a simple yet powerful tool for persisting data in web applications. In this article, we’ll explore every detail of local storage usage in React with TypeScript, including best practices, sample code, and test cases. The illustrations are based on the latest versions of React (18.x) and TypeScript (5.x).</p>
<hr>
<h2 id="What-is-Local-Storage"><a href="#What-is-Local-Storage" class="headerlink" title="What is Local Storage?"></a><strong>What is Local Storage?</strong></h2><p>Local storage is a web API that allows developers to store key-value pairs in a web browser. The data persists even after the browser is closed, making it ideal for saving user preferences, authentication tokens, and other non-sensitive data.</p>
<h3 id="Key-Characteristics-of-Local-Storage"><a href="#Key-Characteristics-of-Local-Storage" class="headerlink" title="Key Characteristics of Local Storage:"></a>Key Characteristics of Local Storage:</h3><ul>
<li><strong>Synchronous API</strong>: Operations are blocking.</li>
<li><strong>Storage Limit</strong>: Approximately 5MB per domain.</li>
<li><strong>Data Lifetime</strong>: Persists until explicitly deleted.</li>
<li><strong>Data Scope</strong>: Accessible only within the same origin.</li>
</ul>
<hr>
<h2 id="Using-Local-Storage-in-React-with-TypeScript"><a href="#Using-Local-Storage-in-React-with-TypeScript" class="headerlink" title="Using Local Storage in React with TypeScript"></a><strong>Using Local Storage in React with TypeScript</strong></h2><h3 id="1-Basic-CRUD-Operations"><a href="#1-Basic-CRUD-Operations" class="headerlink" title="1. Basic CRUD Operations"></a>1. <strong>Basic CRUD Operations</strong></h3><p>Local storage provides three core methods:</p>
<ul>
<li><code>localStorage.setItem(key, value)</code></li>
<li><code>localStorage.getItem(key)</code></li>
<li><code>localStorage.removeItem(key)</code></li>
</ul>
<h3 id="Example-Wrapper-Utility-for-Local-Storage"><a href="#Example-Wrapper-Utility-for-Local-Storage" class="headerlink" title="Example: Wrapper Utility for Local Storage"></a>Example: Wrapper Utility for Local Storage</h3><p>We can create a type-safe utility to handle common operations:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// utils/localStorage.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">LocalStorageHelper</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> setItem&lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">value</span>: T): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> getItem&lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>): T | <span class="literal">null</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> value = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">        <span class="keyword">return</span> value ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(value) <span class="keyword">as</span> T : <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="title function_">removeItem</span>(<span class="attr">key</span>: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Test-Cases"><a href="#Test-Cases" class="headerlink" title="Test Cases"></a>Test Cases</h3><p>Using Jest, we can write unit tests to validate the utility:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// utils/localStorage.test.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LocalStorageHelper</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./localStorage&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;LocalStorageHelper&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">beforeEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">clear</span>();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;should set and retrieve an item&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title class_">LocalStorageHelper</span>.<span class="title function_">setItem</span>(<span class="string">&quot;key&quot;</span>, &#123; <span class="attr">name</span>: <span class="string">&quot;John&quot;</span> &#125;);</span><br><span class="line">        <span class="keyword">const</span> item = <span class="title class_">LocalStorageHelper</span>.<span class="property">getItem</span>&lt;&#123; <span class="attr">name</span>: <span class="built_in">string</span> &#125;&gt;(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">        <span class="title function_">expect</span>(item).<span class="title function_">toEqual</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;John&quot;</span> &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;should return null for non-existent keys&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> item = <span class="title class_">LocalStorageHelper</span>.<span class="title function_">getItem</span>(<span class="string">&quot;nonexistent&quot;</span>);</span><br><span class="line">        <span class="title function_">expect</span>(item).<span class="title function_">toBeNull</span>();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;should remove an item&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title class_">LocalStorageHelper</span>.<span class="title function_">setItem</span>(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">        <span class="title class_">LocalStorageHelper</span>.<span class="title function_">removeItem</span>(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> item = <span class="title class_">LocalStorageHelper</span>.<span class="title function_">getItem</span>(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">        <span class="title function_">expect</span>(item).<span class="title function_">toBeNull</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="2-Integrating-Local-Storage-in-React-Components"><a href="#2-Integrating-Local-Storage-in-React-Components" class="headerlink" title="2. Integrating Local Storage in React Components"></a>2. <strong>Integrating Local Storage in React Components</strong></h3><h4 id="Example-Using-Local-Storage-with-useState"><a href="#Example-Using-Local-Storage-with-useState" class="headerlink" title="Example: Using Local Storage with useState"></a>Example: Using Local Storage with <code>useState</code></h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// components/Counter.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LocalStorageHelper</span> &#125; <span class="keyword">from</span> <span class="string">&quot;../utils/localStorage&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Counter</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [count, setCount] = useState&lt;<span class="built_in">number</span>&gt;(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">LocalStorageHelper</span>.<span class="property">getItem</span>&lt;<span class="built_in">number</span>&gt;(<span class="string">&quot;count&quot;</span>) || <span class="number">0</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title class_">LocalStorageHelper</span>.<span class="title function_">setItem</span>(<span class="string">&quot;count&quot;</span>, count);</span><br><span class="line">    &#125;, [count]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Counter: &#123;count&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount((prev) =&gt; prev + 1)&#125;&gt;Increment<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount((prev) =&gt; prev - 1)&#125;&gt;Decrement<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Counter</span>;</span><br></pre></td></tr></table></figure>

<h4 id="Test-Cases-1"><a href="#Test-Cases-1" class="headerlink" title="Test Cases"></a>Test Cases</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// components/Counter.test.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render, screen, fireEvent &#125; <span class="keyword">from</span> <span class="string">&quot;@testing-library/react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Counter</span> <span class="keyword">from</span> <span class="string">&quot;./Counter&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Counter Component&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;should initialize with value from local storage&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;count&quot;</span>, <span class="string">&quot;5&quot;</span>);</span><br><span class="line">        <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Counter</span> /&gt;</span></span>);</span><br><span class="line">        <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="regexp">/Counter: 5/i</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;should increment the counter&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Counter</span> /&gt;</span></span>);</span><br><span class="line">        fireEvent.<span class="title function_">click</span>(screen.<span class="title function_">getByText</span>(<span class="regexp">/Increment/i</span>));</span><br><span class="line">        <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="regexp">/Counter: 1/i</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;should decrement the counter&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Counter</span> /&gt;</span></span>);</span><br><span class="line">        fireEvent.<span class="title function_">click</span>(screen.<span class="title function_">getByText</span>(<span class="regexp">/Decrement/i</span>));</span><br><span class="line">        <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="regexp">/Counter: -1/i</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-React-Hooks-for-Local-Storage"><a href="#3-React-Hooks-for-Local-Storage" class="headerlink" title="3. React Hooks for Local Storage"></a>3. <strong>React Hooks for Local Storage</strong></h3><p>We can create a custom hook to encapsulate the logic for interacting with local storage.</p>
<h4 id="Example-Custom-Hook"><a href="#Example-Custom-Hook" class="headerlink" title="Example: Custom Hook"></a>Example: Custom Hook</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// hooks/useLocalStorage.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> useLocalStorage&lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">initialValue</span>: T) &#123;</span><br><span class="line">    <span class="keyword">const</span> [storedValue, setStoredValue] = useState&lt;T&gt;(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> item = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">            <span class="keyword">return</span> item ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(item) : initialValue;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Error reading localStorage key&quot;</span>, key, error);</span><br><span class="line">            <span class="keyword">return</span> initialValue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">setValue</span> = (<span class="params"><span class="attr">value</span>: T</span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="title function_">setStoredValue</span>(value);</span><br><span class="line">            <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Error setting localStorage key&quot;</span>, key, error);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [storedValue, setValue] <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useLocalStorage;</span><br></pre></td></tr></table></figure>

<h4 id="Usage-Example"><a href="#Usage-Example" class="headerlink" title="Usage Example"></a>Usage Example</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// components/ThemeSwitcher.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> useLocalStorage <span class="keyword">from</span> <span class="string">&quot;../hooks/useLocalStorage&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ThemeSwitcher</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [theme, setTheme] = useLocalStorage&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;theme&quot;</span>, <span class="string">&quot;light&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">theme-</span>$&#123;<span class="attr">theme</span>&#125;`&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Current Theme: &#123;theme&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setTheme(&quot;light&quot;)&#125;&gt;Light<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setTheme(&quot;dark&quot;)&#125;&gt;Dark<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">ThemeSwitcher</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-Best-Practices-for-Local-Storage-in-React"><a href="#4-Best-Practices-for-Local-Storage-in-React" class="headerlink" title="4. Best Practices for Local Storage in React"></a>4. <strong>Best Practices for Local Storage in React</strong></h3><ol>
<li><strong>Avoid Storing Sensitive Data</strong>: Local storage is not secure; avoid storing sensitive information like passwords or tokens.</li>
<li><strong>Validate Stored Data</strong>: Always validate and sanitize data retrieved from local storage.</li>
<li><strong>Error Handling</strong>: Wrap local storage operations in <code>try-catch</code> blocks to handle potential errors.</li>
<li><strong>Abstract Logic</strong>: Use utilities or hooks to encapsulate local storage interactions for reusability and type safety.</li>
<li><strong>Synchronize Across Tabs</strong>: Use the <code>storage</code> event to synchronize data across multiple tabs.</li>
</ol>
<h4 id="Example-Tab-Synchronization"><a href="#Example-Tab-Synchronization" class="headerlink" title="Example: Tab Synchronization"></a>Example: Tab Synchronization</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// hooks/useSyncLocalStorage.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useSyncLocalStorage</span>(<span class="params"><span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">callback</span>: (newValue: <span class="built_in">string</span> | <span class="literal">null</span>) =&gt; <span class="built_in">void</span></span>) &#123;</span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">handler</span> = (<span class="params"><span class="attr">event</span>: <span class="title class_">StorageEvent</span></span>) =&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (event.<span class="property">key</span> === key) &#123;</span><br><span class="line">                <span class="title function_">callback</span>(event.<span class="property">newValue</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;storage&quot;</span>, handler);</span><br><span class="line">        <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&quot;storage&quot;</span>, handler);</span><br><span class="line">    &#125;, [key, callback]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/12/20/Deep-Dive-Modal-Dialog-Mechanism-in-React-Applications/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/12/20/Deep-Dive-Modal-Dialog-Mechanism-in-React-Applications/" class="post-title-link" itemprop="url">Deep Dive: Modal Dialog Mechanism in React Applications</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-12-20 11:28:22 / Modified: 11:30:15" itemprop="dateCreated datePublished" datetime="2024-12-20T11:28:22-05:00">2024-12-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ReactJS/" itemprop="url" rel="index"><span itemprop="name">ReactJS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Modal dialogs are a common UI pattern used to display important information, collect user input, or confirm actions. In React applications, implementing a modal dialog involves managing state, rendering the dialog conditionally, and ensuring proper styling and positioning. This article explores the modal dialog mechanism in React, using the popular <code>react-modal</code> library as an example. We’ll also provide a complete testing setup to ensure the modal works as expected.</p>
<hr>
<h3 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h3><ol>
<li><strong>Introduction to Modal Dialogs</strong></li>
<li><strong>Key Concepts in Modal Dialogs</strong></li>
<li><strong>Using <code>react-modal</code> in React</strong></li>
<li><strong>Styling and Positioning the Modal</strong></li>
<li><strong>Ensuring Proper Z-Index</strong></li>
<li><strong>Testing Modal Dialogs</strong></li>
<li><strong>Conclusion</strong></li>
</ol>
<hr>
<h3 id="1-Introduction-to-Modal-Dialogs"><a href="#1-Introduction-to-Modal-Dialogs" class="headerlink" title="1. Introduction to Modal Dialogs"></a>1. Introduction to Modal Dialogs</h3><p>A modal dialog is a UI component that overlays the main application content, forcing the user to interact with it before continuing. Modal dialogs are commonly used for:</p>
<ul>
<li>Alerts and confirmations</li>
<li>Form inputs</li>
<li>Loading indicators</li>
<li>Error messages</li>
</ul>
<p>In React, modal dialogs are typically implemented using state to control their visibility and lifecycle.</p>
<hr>
<h3 id="2-Key-Concepts-in-Modal-Dialogs"><a href="#2-Key-Concepts-in-Modal-Dialogs" class="headerlink" title="2. Key Concepts in Modal Dialogs"></a>2. Key Concepts in Modal Dialogs</h3><h4 id="a-State-Management"><a href="#a-State-Management" class="headerlink" title="a. State Management"></a>a. <strong>State Management</strong></h4><p>The visibility of a modal dialog is controlled by a boolean state variable (e.g., <code>isOpen</code>). When <code>isOpen</code> is <code>true</code>, the modal is rendered; otherwise, it is hidden.</p>
<h4 id="b-Conditional-Rendering"><a href="#b-Conditional-Rendering" class="headerlink" title="b. Conditional Rendering"></a>b. <strong>Conditional Rendering</strong></h4><p>The modal is rendered conditionally based on the state variable. This ensures that the modal is only added to the DOM when needed.</p>
<h4 id="c-Focus-Management"><a href="#c-Focus-Management" class="headerlink" title="c. Focus Management"></a>c. <strong>Focus Management</strong></h4><p>Modals should trap focus within their content to ensure accessibility. This prevents users from interacting with the background content while the modal is open.</p>
<h4 id="d-Z-Index"><a href="#d-Z-Index" class="headerlink" title="d. Z-Index"></a>d. <strong>Z-Index</strong></h4><p>The modal’s <code>z-index</code> must be higher than the parent component’s <code>z-index</code> to ensure it appears on top of other elements.</p>
<h4 id="e-Escape-Key-Handling"><a href="#e-Escape-Key-Handling" class="headerlink" title="e. Escape Key Handling"></a>e. <strong>Escape Key Handling</strong></h4><p>Users should be able to close the modal by pressing the <code>Escape</code> key.</p>
<hr>
<h3 id="3-Using-react-modal-in-React"><a href="#3-Using-react-modal-in-React" class="headerlink" title="3. Using react-modal in React"></a>3. Using <code>react-modal</code> in React</h3><p><code>react-modal</code> is a popular library for creating accessible and customizable modal dialogs in React. Below is an example of how to use it:</p>
<h4 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react-modal</span><br></pre></td></tr></table></figure>

<h4 id="Example-Code"><a href="#Example-Code" class="headerlink" title="Example Code"></a>Example Code</h4><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Modal</span> <span class="keyword">from</span> <span class="string">&quot;react-modal&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set the app element for accessibility (required by react-modal)</span></span><br><span class="line"><span class="title class_">Modal</span>.<span class="title function_">setAppElement</span>(<span class="string">&quot;#root&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> [isOpen, setIsOpen] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">openModal</span> = (<span class="params"></span>) =&gt; <span class="title function_">setIsOpen</span>(<span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">closeModal</span> = (<span class="params"></span>) =&gt; <span class="title function_">setIsOpen</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;openModal&#125;</span>&gt;</span>Open Modal<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Modal</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">isOpen</span>=<span class="string">&#123;isOpen&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">onRequestClose</span>=<span class="string">&#123;closeModal&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">contentLabel</span>=<span class="string">&quot;Example Modal&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">overlay:</span> &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">backgroundColor:</span> &quot;<span class="attr">rgba</span>(<span class="attr">0</span>, <span class="attr">0</span>, <span class="attr">0</span>, <span class="attr">0.5</span>)&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">zIndex:</span> <span class="attr">1000</span>, // <span class="attr">Ensure</span> <span class="attr">the</span> <span class="attr">modal</span> <span class="attr">is</span> <span class="attr">on</span> <span class="attr">top</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    <span class="attr">content:</span> &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">width:</span> &quot;<span class="attr">400px</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">height:</span> &quot;<span class="attr">200px</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">margin:</span> &quot;<span class="attr">auto</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">padding:</span> &quot;<span class="attr">20px</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">borderRadius:</span> &quot;<span class="attr">8px</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">boxShadow:</span> &quot;<span class="attr">0</span> <span class="attr">4px</span> <span class="attr">6px</span> <span class="attr">rgba</span>(<span class="attr">0</span>, <span class="attr">0</span>, <span class="attr">0</span>, <span class="attr">0.1</span>)&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                    &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Modal Title<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>This is the modal content.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;closeModal&#125;</span>&gt;</span>Close<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Modal</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-Styling-and-Positioning-the-Modal"><a href="#4-Styling-and-Positioning-the-Modal" class="headerlink" title="4. Styling and Positioning the Modal"></a>4. Styling and Positioning the Modal</h3><h4 id="a-Custom-Styles"><a href="#a-Custom-Styles" class="headerlink" title="a. Custom Styles"></a>a. <strong>Custom Styles</strong></h4><p><code>react-modal</code> allows you to customize the modal’s appearance using the <code>style</code> prop. The <code>overlay</code> style controls the background overlay, while the <code>content</code> style controls the modal’s content.</p>
<h4 id="b-Centering-the-Modal"><a href="#b-Centering-the-Modal" class="headerlink" title="b. Centering the Modal"></a>b. <strong>Centering the Modal</strong></h4><p>To center the modal, set the <code>margin</code> property of the <code>content</code> style to <code>auto</code>.</p>
<h4 id="c-Responsive-Design"><a href="#c-Responsive-Design" class="headerlink" title="c. Responsive Design"></a>c. <strong>Responsive Design</strong></h4><p>Use CSS media queries to adjust the modal’s size and position for different screen sizes.</p>
<hr>
<h3 id="5-Ensuring-Proper-Z-Index"><a href="#5-Ensuring-Proper-Z-Index" class="headerlink" title="5. Ensuring Proper Z-Index"></a>5. Ensuring Proper Z-Index</h3><p>The <code>z-index</code> property is crucial for ensuring the modal appears on top of other elements. Here’s how to handle it:</p>
<h4 id="a-Set-a-High-Z-Index-for-the-Modal"><a href="#a-Set-a-High-Z-Index-for-the-Modal" class="headerlink" title="a. Set a High Z-Index for the Modal"></a>a. <strong>Set a High Z-Index for the Modal</strong></h4><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Modal</span></span><br><span class="line">    isOpen=&#123;isOpen&#125;</span><br><span class="line">    style=&#123;&#123;</span><br><span class="line">        <span class="attr">overlay</span>: &#123;</span><br><span class="line">            <span class="attr">zIndex</span>: <span class="number">1000</span>, <span class="comment">// Higher than other elements</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>

<h4 id="b-Ensure-Parent-Components-Have-Lower-Z-Index"><a href="#b-Ensure-Parent-Components-Have-Lower-Z-Index" class="headerlink" title="b. Ensure Parent Components Have Lower Z-Index"></a>b. <strong>Ensure Parent Components Have Lower Z-Index</strong></h4><p>If the parent component has a high <code>z-index</code>, the modal will not appear on top. For example:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.parent-component</span> &#123;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">10</span>; <span class="comment">/* Lower than the modal&#x27;s z-index */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="6-Testing-Modal-Dialogs"><a href="#6-Testing-Modal-Dialogs" class="headerlink" title="6. Testing Modal Dialogs"></a>6. Testing Modal Dialogs</h3><p>Testing modal dialogs ensures they work as expected in different scenarios. Below is an example of testing a modal dialog using <code>react-testing-library</code>.</p>
<h4 id="Installation-1"><a href="#Installation-1" class="headerlink" title="Installation"></a>Installation</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @testing-library/react @testing-library/jest-dom</span><br></pre></td></tr></table></figure>

<h4 id="Testing-Code"><a href="#Testing-Code" class="headerlink" title="Testing Code"></a>Testing Code</h4><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render, screen, fireEvent &#125; <span class="keyword">from</span> <span class="string">&quot;@testing-library/react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Modal</span> <span class="keyword">from</span> <span class="string">&quot;react-modal&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Mock react-modal</span></span><br><span class="line">jest.<span class="title function_">mock</span>(<span class="string">&quot;react-modal&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">Modal</span> = (<span class="params">&#123; isOpen, children &#125;</span>) =&gt; (isOpen ? <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;children&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span> : <span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Modal</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Modal Dialog&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;opens and closes the modal&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Modal should not be visible initially</span></span><br><span class="line">        <span class="title function_">expect</span>(screen.<span class="title function_">queryByText</span>(<span class="string">&quot;Modal Title&quot;</span>)).<span class="property">not</span>.<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Open the modal</span></span><br><span class="line">        fireEvent.<span class="title function_">click</span>(screen.<span class="title function_">getByText</span>(<span class="string">&quot;Open Modal&quot;</span>));</span><br><span class="line">        <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="string">&quot;Modal Title&quot;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Close the modal</span></span><br><span class="line">        fireEvent.<span class="title function_">click</span>(screen.<span class="title function_">getByText</span>(<span class="string">&quot;Close&quot;</span>));</span><br><span class="line">        <span class="title function_">expect</span>(screen.<span class="title function_">queryByText</span>(<span class="string">&quot;Modal Title&quot;</span>)).<span class="property">not</span>.<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="7-Conclusion"><a href="#7-Conclusion" class="headerlink" title="7. Conclusion"></a>7. Conclusion</h3><p>Modal dialogs are a powerful tool for enhancing user interaction in React applications. By understanding key concepts like state management, conditional rendering, focus trapping, and <code>z-index</code>, you can create accessible and user-friendly modals. The <code>react-modal</code> library simplifies the process, and proper testing ensures your modals work as expected in all scenarios.</p>
<hr>
<h3 id="Additional-Resources"><a href="#Additional-Resources" class="headerlink" title="Additional Resources"></a>Additional Resources</h3><ul>
<li><a target="_blank" rel="noopener" href="https://reactcommunity.org/react-modal/">React Modal Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://testing-library.com/docs/react-testing-library/intro/">React Testing Library Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index">Z-Index and Stacking Contexts</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/12/19/Run-a-Proxy-Server-with-cors-anywhere/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/12/19/Run-a-Proxy-Server-with-cors-anywhere/" class="post-title-link" itemprop="url">Run a Proxy Server with cors-anywhere</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-12-19 12:14:20 / Modified: 12:16:53" itemprop="dateCreated datePublished" datetime="2024-12-19T12:14:20-05:00">2024-12-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Node-js/" itemprop="url" rel="index"><span itemprop="name">Node.js</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Node-js/Proxy/" itemprop="url" rel="index"><span itemprop="name">Proxy</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Node-js/Proxy/CORS/" itemprop="url" rel="index"><span itemprop="name">CORS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h4 id="1-Install-Node-js"><a href="#1-Install-Node-js" class="headerlink" title="1. Install Node.js"></a>1. <strong>Install Node.js</strong></h4><ul>
<li>Ensure you have Node.js installed on your machine. You can download it from <a target="_blank" rel="noopener" href="https://nodejs.org/">nodejs.org</a>.</li>
<li>Verify the installation by running:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="2-Create-a-New-Directory-for-Your-Proxy-Server"><a href="#2-Create-a-New-Directory-for-Your-Proxy-Server" class="headerlink" title="2. Create a New Directory for Your Proxy Server"></a>2. <strong>Create a New Directory for Your Proxy Server</strong></h4><ul>
<li>Create a new directory for your proxy server:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> cors-proxy-server</span><br><span class="line"><span class="built_in">cd</span> cors-proxy-server</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="3-Initialize-a-New-Node-js-Project"><a href="#3-Initialize-a-New-Node-js-Project" class="headerlink" title="3. Initialize a New Node.js Project"></a>3. <strong>Initialize a New Node.js Project</strong></h4><ul>
<li>Initialize a new Node.js project:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure></li>
<li>This will create a <code>package.json</code> file.</li>
</ul>
<h4 id="4-Install-cors-anywhere"><a href="#4-Install-cors-anywhere" class="headerlink" title="4. Install cors-anywhere"></a>4. <strong>Install <code>cors-anywhere</code></strong></h4><ul>
<li>Install the <code>cors-anywhere</code> package:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install cors-anywhere</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="5-Create-the-Proxy-Server-Script"><a href="#5-Create-the-Proxy-Server-Script" class="headerlink" title="5. Create the Proxy Server Script"></a>5. <strong>Create the Proxy Server Script</strong></h4><ul>
<li>Create a new file named <code>server.js</code> in the project directory:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> server.js</span><br></pre></td></tr></table></figure></li>
<li>Add the following code to <code>server.js</code>:</li>
</ul>
<hr>
<h3 id="server-js-JavaScript-Implementation"><a href="#server-js-JavaScript-Implementation" class="headerlink" title="server.js (JavaScript Implementation)"></a><code>server.js</code> (JavaScript Implementation)</h3><p>Here’s the complete implementation of the proxy server in <strong>JavaScript</strong>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cors_proxy = <span class="built_in">require</span>(<span class="string">&quot;cors-anywhere&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Define the host and port for the proxy server</span></span><br><span class="line"><span class="keyword">const</span> host = <span class="string">&quot;127.0.0.1&quot;</span>; <span class="comment">// Localhost</span></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">8080</span>; <span class="comment">// Port to run the proxy</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Create and start the proxy server</span></span><br><span class="line">cors_proxy</span><br><span class="line">    .<span class="title function_">createServer</span>(&#123;</span><br><span class="line">        <span class="attr">originWhitelist</span>: [], <span class="comment">// Allow all origins (you can restrict this to specific domains)</span></span><br><span class="line">        <span class="attr">requireHeader</span>: [<span class="string">&quot;origin&quot;</span>, <span class="string">&quot;x-requested-with&quot;</span>], <span class="comment">// Require these headers</span></span><br><span class="line">        <span class="attr">removeHeaders</span>: [<span class="string">&quot;cookie&quot;</span>, <span class="string">&quot;cookie2&quot;</span>], <span class="comment">// Remove sensitive headers</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">listen</span>(port, host, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CORS Anywhere proxy server is running on http://<span class="subst">$&#123;host&#125;</span>:<span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="6-Run-the-Proxy-Server"><a href="#6-Run-the-Proxy-Server" class="headerlink" title="6. Run the Proxy Server"></a>6. <strong>Run the Proxy Server</strong></h3><ul>
<li>Start the proxy server:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node server.js</span><br></pre></td></tr></table></figure></li>
<li>You should see the following output:<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CORS Anywhere proxy server is running on http://127.0.0.1:8080</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="Using-the-Proxy-Server-in-Your-Application"><a href="#Using-the-Proxy-Server-in-Your-Application" class="headerlink" title="Using the Proxy Server in Your Application"></a>Using the Proxy Server in Your Application</h3><p>Once the proxy server is running, you can use it in your application to bypass CORS restrictions.</p>
<h4 id="Example-Fetching-Data-in-a-React-Application"><a href="#Example-Fetching-Data-in-a-React-Application" class="headerlink" title="Example: Fetching Data in a React Application"></a>Example: Fetching Data in a React Application</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> proxyUrl = <span class="string">&quot;http://127.0.0.1:8080/&quot;</span>; <span class="comment">// Your local proxy server</span></span><br><span class="line"><span class="keyword">const</span> apiUrl = <span class="string">&quot;https://dog.ceo/api/breeds/list/all&quot;</span>; <span class="comment">// The API you want to access</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">fetch</span>(proxyUrl + apiUrl)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(data))</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Error:&quot;</span>, error));</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Summary-of-Steps"><a href="#Summary-of-Steps" class="headerlink" title="Summary of Steps"></a>Summary of Steps</h3><ol>
<li>Install Node.js and initialize a new project.</li>
<li>Install the <code>cors-anywhere</code> package.</li>
<li>Create a <code>server.js</code> file with the proxy server implementation.</li>
<li>Run the proxy server using <code>node server.js</code>.</li>
<li>Use the proxy server in your application by prefixing your API URL with the proxy URL.</li>
</ol>
<hr>
<h3 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h3><ul>
<li><strong>Security</strong>: By default, the proxy server allows all origins (<code>originWhitelist: []</code>). You can restrict this to specific domains for better security.</li>
<li><strong>Production</strong>: Running a local proxy server is fine for development, but for production, consider deploying the proxy server to a cloud service (e.g., Heroku, Vercel) or using a backend server as a middleman.</li>
<li><strong>Rate Limits</strong>: Some APIs may have rate limits or restrictions on the number of requests you can make. Be mindful of this when using a proxy.</li>
</ul>
<p>This setup will allow you to bypass CORS restrictions and make API requests from your application during development.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/12/09/Using-print-for-Python-Debugging-You-re-Outdated/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/12/09/Using-print-for-Python-Debugging-You-re-Outdated/" class="post-title-link" itemprop="url">Using print for Python Debugging? You're Outdated!</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-12-09 10:44:10 / Modified: 10:45:06" itemprop="dateCreated datePublished" datetime="2024-12-09T10:44:10-05:00">2024-12-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>In Python development practice, debugging is an indispensable part of the process. If you rely on <code>print()</code> statements to trace the execution flow of your program, you might encounter persistent exceptions that are difficult to pinpoint even after multiple code reviews. This is often due to the limitations of this debugging method as the terminal output grows, making it hard to correlate outputs with their corresponding function calls. This article introduces the IceCream library, a specialized debugging tool that significantly enhances debugging efficiency, making the entire process more systematic and standardized.</p>
<p><code>print()</code> is the most basic output function in Python and is the preferred debugging tool for most developers. However, when dealing with complex function calls and data structures, this method often leads to cluttered output, reducing debugging efficiency. The <code>ic()</code> function from the IceCream library is optimized for debugging scenarios, providing more practical features.</p>
<h3 id="Basic-Debugging-Example-Using-print"><a href="#Basic-Debugging-Example-Using-print" class="headerlink" title="Basic Debugging Example - Using print"></a><strong>Basic Debugging Example - Using <code>print</code></strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line"></span><br><span class="line"><span class="comment"># Using print() for function debugging</span></span><br><span class="line"><span class="built_in">print</span>(add(<span class="number">10</span>, <span class="number">20</span>))  <span class="comment"># Output: 30</span></span><br><span class="line"><span class="built_in">print</span>(add(<span class="number">30</span>, <span class="number">40</span>))  <span class="comment"># Output: 70</span></span><br></pre></td></tr></table></figure>

<p>The main issue with this traditional method is that when there are many output results, it becomes difficult to intuitively associate the output values with their corresponding function calls. Additional manual explanations are required.</p>
<h3 id="Using-ic-for-Debugging"><a href="#Using-ic-for-Debugging" class="headerlink" title="Using ic for Debugging"></a><strong>Using <code>ic</code> for Debugging</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> icecream <span class="keyword">import</span> ic</span><br><span class="line"></span><br><span class="line"><span class="comment"># Using ic() for function debugging</span></span><br><span class="line">ic(add(<span class="number">10</span>, <span class="number">20</span>))</span><br><span class="line">ic(add(<span class="number">30</span>, <span class="number">40</span>))</span><br></pre></td></tr></table></figure>

<p>Output:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ic| add(10, 20): 30</span><br><span class="line">ic| add(30, 40): 70</span><br></pre></td></tr></table></figure>

<p>By using the <code>ic()</code> function, each output clearly displays the complete information of the function call, including the function name, parameter values, and return results. This output format is particularly suitable for debugging complex sequences of function calls, allowing for quick problem identification.</p>
<h3 id="Core-Advantages-of-the-ic-Function"><a href="#Core-Advantages-of-the-ic-Function" class="headerlink" title="Core Advantages of the ic Function"></a><strong>Core Advantages of the <code>ic</code> Function</strong></h3><ol>
<li><p><strong>Detailed Execution Information Tracking</strong></p>
<p>The <code>ic()</code> function not only displays the execution results but also fully records the operation process, eliminating the need for manually writing debugging information and improving debugging efficiency.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">multiply</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> a * b</span><br><span class="line"></span><br><span class="line">ic(multiply(<span class="number">5</span>, <span class="number">5</span>))</span><br></pre></td></tr></table></figure>

<p>Output:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ic| multiply(5, 5): 25</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Integration of Debugging and Assignment Operations</strong></p>
<p>One notable feature of the <code>ic()</code> function is its support for simultaneous debugging and variable assignment, which is not possible with traditional <code>print()</code> functions:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># print() method</span></span><br><span class="line">result = <span class="built_in">print</span>(multiply(<span class="number">4</span>, <span class="number">6</span>))  <span class="comment"># Output: 24</span></span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># Output: None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ic() method</span></span><br><span class="line">result = ic(multiply(<span class="number">4</span>, <span class="number">6</span>))  <span class="comment"># Output: ic| multiply(4, 6): 24</span></span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># Output: 24</span></span><br></pre></td></tr></table></figure>

<p>Using the <code>ic()</code> function, you can not only view debugging information but also correctly obtain and store the return value, which is particularly useful during debugging.</p>
</li>
<li><p><strong>Visualization of Data Structure Access</strong></p>
<p>When dealing with data structures like dictionaries, the <code>ic()</code> function provides clearer access information:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Using ic() to track data access</span></span><br><span class="line">ic(data[<span class="string">&#x27;a&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p>Output:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ic| data[&#x27;a&#x27;]: 1</span><br></pre></td></tr></table></figure>

<p>The output clearly shows the access path and result, helping to understand the data operation process.</p>
</li>
<li><p><strong>Optimization of Complex Data Structure Display</strong></p>
<p>When dealing with nested dictionaries or JSON-like complex data structures, the <code>ic()</code> function provides better readability through structured formatting:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">complex_data = &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;John&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span>: <span class="number">30</span>,</span><br><span class="line">    <span class="string">&quot;languages&quot;</span>: [<span class="string">&quot;Python&quot;</span>, <span class="string">&quot;JavaScript&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ic(complex_data)</span><br></pre></td></tr></table></figure>

<p>The output uses structured formatting with color differentiation, significantly enhancing the readability of complex data structures, facilitating quick location and analysis of data.</p>
</li>
</ol>
<h3 id="Advanced-Features-of-the-IceCream-Library"><a href="#Advanced-Features-of-the-IceCream-Library" class="headerlink" title="Advanced Features of the IceCream Library"></a><strong>Advanced Features of the IceCream Library</strong></h3><p>In addition to basic debugging functions, the IceCream library offers a series of advanced features that can be customized according to specific needs:</p>
<ol>
<li><p><strong>Dynamic Control of Debugging Output</strong></p>
<p>During development, you can dynamically control the output of debugging information as needed:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ic.disable()  <span class="comment"># Pause debugging output</span></span><br><span class="line">ic(multiply(<span class="number">3</span>, <span class="number">3</span>))  <span class="comment"># No output here</span></span><br><span class="line"></span><br><span class="line">ic.enable()  <span class="comment"># Resume debugging output</span></span><br><span class="line">ic(multiply(<span class="number">3</span>, <span class="number">3</span>))  <span class="comment"># Output: ic| multiply(3, 3): 9</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Custom Configuration of Output Format</strong></p>
<p>IceCream supports custom output formats, allowing you to adjust the output method according to project requirements:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">log_to_file</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;debug.log&quot;</span>, <span class="string">&quot;a&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(text + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">ic.configureOutput(prefix=<span class="string">&quot;DEBUG| &quot;</span>, outputFunction=log_to_file)</span><br><span class="line"></span><br><span class="line">ic(multiply(<span class="number">7</span>, <span class="number">7</span>))</span><br></pre></td></tr></table></figure>

<p>This configuration can redirect debugging information to a log file and add a custom prefix, facilitating subsequent log analysis.</p>
</li>
</ol>
<h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a><strong>Conclusion</strong></h3><p>Although the <code>print()</code> function is widely used as a basic debugging tool in Python, it has obvious limitations in complex development scenarios. The IceCream library effectively addresses the shortcomings of traditional debugging methods by providing more professional debugging tools. Its rich features, flexible configuration options, and clear output format can significantly enhance the debugging efficiency of Python programs. In practical development, using the <code>ic()</code> function properly not only helps developers locate and solve problems faster but also improves code maintainability.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/12/09/Typescript-interface-vs-class-vs-type/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/12/09/Typescript-interface-vs-class-vs-type/" class="post-title-link" itemprop="url">TypeScript interface vs class vs type</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-12-09 10:23:53" itemprop="dateCreated datePublished" datetime="2024-12-09T10:23:53-05:00">2024-12-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-02-18 19:27:19" itemprop="dateModified" datetime="2025-02-18T19:27:19-05:00">2025-02-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/TypeScript/" itemprop="url" rel="index"><span itemprop="name">TypeScript</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>In TypeScript, <code>interface</code>, <code>class</code>, and <code>type</code> are all used to define the shape of objects, but they serve different purposes and have different use cases. Let’s delve into each of them in detail, including real-world scenarios with sample code, and discuss their pros and cons.</p>
<h3 id="1-Interface"><a href="#1-Interface" class="headerlink" title="1. Interface"></a>1. <strong>Interface</strong></h3><p>An <code>interface</code> is a way to define a contract for the shape of an object. It can describe the structure of an object, including properties and methods, but it cannot contain implementation details.</p>
<h4 id="Sample-Code"><a href="#Sample-Code" class="headerlink" title="Sample Code:"></a><strong>Sample Code:</strong></h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Defining an interface</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">email</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">isActive</span>: <span class="built_in">boolean</span>;</span><br><span class="line">    <span class="title function_">getDetails</span>(): <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Implementing the interface in a class</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RegisteredUser</span> <span class="keyword">implements</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">email</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">isActive</span>: <span class="built_in">boolean</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"><span class="attr">id</span>: <span class="built_in">number</span>, <span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">email</span>: <span class="built_in">string</span>, <span class="attr">isActive</span>: <span class="built_in">boolean</span></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">id</span> = id;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">email</span> = email;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isActive</span> = isActive;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">getDetails</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`ID: <span class="subst">$&#123;<span class="variable language_">this</span>.id&#125;</span>, Name: <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>, Email: <span class="subst">$&#123;<span class="variable language_">this</span>.email&#125;</span>, Active: <span class="subst">$&#123;<span class="variable language_">this</span>.isActive&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Using the class</span></span><br><span class="line"><span class="keyword">const</span> user = <span class="keyword">new</span> <span class="title class_">RegisteredUser</span>(<span class="number">1</span>, <span class="string">&quot;John Doe&quot;</span>, <span class="string">&quot;john@example.com&quot;</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(user.<span class="title function_">getDetails</span>()); <span class="comment">// Output: ID: 1, Name: John Doe, Email: john@example.com, Active: true</span></span><br></pre></td></tr></table></figure>

<h4 id="Pros"><a href="#Pros" class="headerlink" title="Pros:"></a><strong>Pros:</strong></h4><ul>
<li><strong>Contract Definition:</strong> Interfaces are great for defining contracts that classes or objects must adhere to.</li>
<li><strong>Extensibility:</strong> You can extend interfaces using the <code>extends</code> keyword, which allows for composition of types.</li>
<li><strong>Readability:</strong> Interfaces are often more readable and easier to understand than type aliases, especially for complex object shapes.</li>
</ul>
<h4 id="Cons"><a href="#Cons" class="headerlink" title="Cons:"></a><strong>Cons:</strong></h4><ul>
<li><strong>No Implementation:</strong> Interfaces cannot contain implementation details, so they are limited to defining the shape of objects.</li>
<li><strong>Cannot Be Used for Primitive Types:</strong> Interfaces cannot be used to define types for primitive values (e.g., <code>string</code>, <code>number</code>).</li>
</ul>
<h3 id="2-Class"><a href="#2-Class" class="headerlink" title="2. Class"></a>2. <strong>Class</strong></h3><p>A <code>class</code> in TypeScript is a blueprint for creating objects. It can define both the structure and the behavior of objects. Classes can implement interfaces and can also be extended.</p>
<h4 id="Sample-Code-1"><a href="#Sample-Code-1" class="headerlink" title="Sample Code:"></a><strong>Sample Code:</strong></h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Defining a class</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Product</span> &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">price</span>: <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"><span class="attr">id</span>: <span class="built_in">number</span>, <span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">price</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">id</span> = id;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">price</span> = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">getDiscountedPrice</span>(<span class="attr">discount</span>: <span class="built_in">number</span>): <span class="built_in">number</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">price</span> * (<span class="number">1</span> - discount);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Extending a class</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Electronics</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Product</span> &#123;</span><br><span class="line">    <span class="attr">warrantyPeriod</span>: <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"><span class="attr">id</span>: <span class="built_in">number</span>, <span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">price</span>: <span class="built_in">number</span>, <span class="attr">warrantyPeriod</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">        <span class="variable language_">super</span>(id, name, price);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">warrantyPeriod</span> = warrantyPeriod;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">getWarrantyDetails</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`Warranty Period: <span class="subst">$&#123;<span class="variable language_">this</span>.warrantyPeriod&#125;</span> years`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Using the class</span></span><br><span class="line"><span class="keyword">const</span> laptop = <span class="keyword">new</span> <span class="title class_">Electronics</span>(<span class="number">1</span>, <span class="string">&quot;Laptop&quot;</span>, <span class="number">1000</span>, <span class="number">2</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(laptop.<span class="title function_">getDiscountedPrice</span>(<span class="number">0.1</span>)); <span class="comment">// Output: 900</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(laptop.<span class="title function_">getWarrantyDetails</span>()); <span class="comment">// Output: Warranty Period: 2 years</span></span><br></pre></td></tr></table></figure>

<h4 id="Pros-1"><a href="#Pros-1" class="headerlink" title="Pros:"></a><strong>Pros:</strong></h4><ul>
<li><strong>Implementation:</strong> Classes can contain both properties and methods, allowing for full implementation of behavior.</li>
<li><strong>Inheritance:</strong> Classes can be extended, allowing for code reuse and hierarchical relationships.</li>
<li><strong>Encapsulation:</strong> Classes support encapsulation through access modifiers like <code>private</code>, <code>protected</code>, and <code>public</code>.</li>
</ul>
<h4 id="Cons-1"><a href="#Cons-1" class="headerlink" title="Cons:"></a><strong>Cons:</strong></h4><ul>
<li><strong>Complexity:</strong> Classes can become complex, especially when dealing with inheritance and polymorphism.</li>
<li><strong>Performance:</strong> Classes can introduce some overhead compared to plain objects, especially in scenarios where you don’t need the full OOP features.</li>
</ul>
<h3 id="3-Type"><a href="#3-Type" class="headerlink" title="3. Type"></a>3. <strong>Type</strong></h3><p>A <code>type</code> in TypeScript is a way to create a new name for a type. It can be used to alias existing types, combine types, or create complex types. Unlike interfaces, types can represent primitive types, union types, and intersection types.</p>
<h4 id="Sample-Code-2"><a href="#Sample-Code-2" class="headerlink" title="Sample Code:"></a><strong>Sample Code:</strong></h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Defining a type alias</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Point</span> = &#123;</span><br><span class="line">    <span class="attr">x</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">y</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Using the type alias</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">origin</span>: <span class="title class_">Point</span> = &#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Defining a union type</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Status</span> = <span class="string">&quot;active&quot;</span> | <span class="string">&quot;inactive&quot;</span> | <span class="string">&quot;pending&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Using the union type</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">userStatus</span>: <span class="title class_">Status</span> = <span class="string">&quot;active&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Defining an intersection type</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">User</span> = &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Admin</span> = &#123;</span><br><span class="line">    <span class="attr">permissions</span>: <span class="built_in">string</span>[];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">AdminUser</span> = <span class="title class_">User</span> &amp; <span class="title class_">Admin</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Using the intersection type</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">admin</span>: <span class="title class_">AdminUser</span> = &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Admin&quot;</span>,</span><br><span class="line">    <span class="attr">permissions</span>: [<span class="string">&quot;read&quot;</span>, <span class="string">&quot;write&quot;</span>],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="Pros-2"><a href="#Pros-2" class="headerlink" title="Pros:"></a><strong>Pros:</strong></h4><ul>
<li><strong>Flexibility:</strong> Types are very flexible and can be used to create complex types, including unions, intersections, and primitive types.</li>
<li><strong>Alias Existing Types:</strong> Types can be used to alias existing types, making code more readable and maintainable.</li>
<li><strong>No Declaration Merging:</strong> Unlike interfaces, types do not support declaration merging, which can be a pro in scenarios where you want to avoid accidental type extensions.</li>
</ul>
<h4 id="Cons-2"><a href="#Cons-2" class="headerlink" title="Cons:"></a><strong>Cons:</strong></h4><ul>
<li><strong>No Extensibility:</strong> Types cannot be extended or merged like interfaces. If you need to extend a type, you need to create a new type that includes the original type.</li>
<li><strong>Less Readable for Complex Objects:</strong> For complex object shapes, interfaces are often more readable and easier to understand than types.</li>
</ul>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a><strong>Summary</strong></h3><ul>
<li><strong>Interface:</strong> Best for defining contracts for object shapes, especially when you want to enforce a structure across multiple classes or objects.</li>
<li><strong>Class:</strong> Best for defining both the structure and behavior of objects, especially when you need inheritance, encapsulation, and polymorphism.</li>
<li><strong>Type:</strong> Best for creating complex types, including unions, intersections, and aliases for existing types.</li>
</ul>
<p>Each of these constructs has its own strengths and weaknesses, and the choice between them depends on the specific requirements of your project.</p>
<h3 id="Comparison-interface-type-and-class"><a href="#Comparison-interface-type-and-class" class="headerlink" title="Comparison: interface, type, and class"></a><strong>Comparison: <code>interface</code>, <code>type</code>, and <code>class</code></strong></h3><table>
<thead>
<tr>
<th><strong>Feature</strong></th>
<th><strong>interface</strong></th>
<th><strong>type</strong></th>
<th><strong>class</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>Object shapes</strong></td>
<td>✅ Yes</td>
<td>✅ Yes</td>
<td>✅ Yes</td>
</tr>
<tr>
<td><strong>Unions&#x2F;Intersections</strong></td>
<td>❌ Limited</td>
<td>✅ Fully supported</td>
<td>❌ Limited</td>
</tr>
<tr>
<td><strong>Extending existing types</strong></td>
<td>✅ Can extend multiple interfaces</td>
<td>✅ Supports unions and intersections for combining types</td>
<td>✅ Can extend other classes and implement interfaces</td>
</tr>
<tr>
<td><strong>Declaration merging</strong></td>
<td>✅ Yes (interfaces with the same name merge automatically)</td>
<td>❌ No</td>
<td>❌ No</td>
</tr>
<tr>
<td><strong>Runtime presence</strong></td>
<td>❌ Does not exist in runtime</td>
<td>❌ Does not exist in runtime</td>
<td>✅ Yes (exists in runtime as JavaScript classes)</td>
</tr>
<tr>
<td><strong>Instantiable (e.g., via <code>new</code>)</strong></td>
<td>❌ No</td>
<td>❌ No</td>
<td>✅ Yes</td>
</tr>
<tr>
<td><strong>Implementation</strong></td>
<td>❌ Cannot contain implementation details</td>
<td>❌ Cannot contain implementation details</td>
<td>✅ Can contain implementation details (methods, properties, etc.)</td>
</tr>
<tr>
<td><strong>Inheritance</strong></td>
<td>❌ No</td>
<td>❌ No</td>
<td>✅ Supports inheritance using <code>extends</code></td>
</tr>
<tr>
<td><strong>Encapsulation</strong></td>
<td>❌ No</td>
<td>❌ No</td>
<td>✅ Supports encapsulation through access modifiers (<code>private</code>, <code>protected</code>, <code>public</code>)</td>
</tr>
<tr>
<td><strong>Polymorphism</strong></td>
<td>❌ No</td>
<td>❌ No</td>
<td>✅ Supports polymorphism through method overriding and interface implementation</td>
</tr>
<tr>
<td><strong>Performance</strong></td>
<td>✅ Lightweight (only type checking)</td>
<td>✅ Lightweight (only type checking)</td>
<td>❌ Slightly heavier due to runtime presence and additional features (inheritance, encapsulation)</td>
</tr>
<tr>
<td><strong>Readability</strong></td>
<td>✅ Often more readable for complex object shapes</td>
<td>❌ Can become less readable for complex object shapes</td>
<td>✅ Often more readable for complex object shapes with behavior</td>
</tr>
<tr>
<td><strong>Use Case</strong></td>
<td>Best for defining contracts for object shapes, especially when enforcing structure across multiple classes&#x2F;objects</td>
<td>Best for creating complex types, including unions, intersections, and aliases for existing types</td>
<td>Best for defining both the structure and behavior of objects, especially when you need inheritance, encapsulation, and polymorphism</td>
</tr>
</tbody></table>
<hr>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/12/04/Setting-up-Node-js-development-environment-in-Windows/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/12/04/Setting-up-Node-js-development-environment-in-Windows/" class="post-title-link" itemprop="url">Setting up Node.js development environment in Windows</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-12-04 19:19:43 / Modified: 19:29:08" itemprop="dateCreated datePublished" datetime="2024-12-04T19:19:43-05:00">2024-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Node/" itemprop="url" rel="index"><span itemprop="name">Node</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Node/Type-Script/" itemprop="url" rel="index"><span itemprop="name">Type Script</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="1-Install-Node-js"><a href="#1-Install-Node-js" class="headerlink" title="1. Install Node.js"></a><strong>1. Install Node.js</strong></h2><ol>
<li>Download Node.js from the <a target="_blank" rel="noopener" href="https://nodejs.org/">official website</a>. Use the <strong>LTS version</strong> for stability.</li>
<li>Install Node.js by running the installer and ensure you check the box to install <strong>npm</strong> (Node Package Manager).</li>
<li>Verify the installation:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="2-Install-Yarn-Optional"><a href="#2-Install-Yarn-Optional" class="headerlink" title="2. Install Yarn (Optional)"></a><strong>2. Install Yarn (Optional)</strong></h2><p>While npm is included with Node.js, Yarn is a popular alternative for managing dependencies.</p>
<ol>
<li>Install Yarn globally:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --global yarn</span><br></pre></td></tr></table></figure></li>
<li>Verify the installation:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn -v</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="3-Install-Git"><a href="#3-Install-Git" class="headerlink" title="3. Install Git"></a><strong>3. Install Git</strong></h2><ol>
<li>Download and install Git from <a target="_blank" rel="noopener" href="https://git-scm.com/">git-scm.com</a>.</li>
<li>During installation, choose “Git Bash Here” and “Use Git from the Command Prompt.”</li>
<li>Verify Git installation:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git --version</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="4-Install-Visual-Studio-Code"><a href="#4-Install-Visual-Studio-Code" class="headerlink" title="4. Install Visual Studio Code"></a><strong>4. Install Visual Studio Code</strong></h2><ol>
<li>Download and install <a target="_blank" rel="noopener" href="https://code.visualstudio.com/">VS Code</a>.</li>
<li>Install the following extensions in VS Code:<ul>
<li><strong>ESLint</strong>: Linting and code quality.</li>
<li><strong>Prettier</strong>: Code formatting.</li>
<li><strong>TypeScript</strong>: Provides TypeScript language features.</li>
<li><strong>React Developer Tools</strong>: Debugging React apps.</li>
<li><strong>REST Client</strong>: For testing APIs.</li>
</ul>
</li>
</ol>
<hr>
<h2 id="5-Setup-Node-js-TypeScript-Project"><a href="#5-Setup-Node-js-TypeScript-Project" class="headerlink" title="5. Setup Node.js + TypeScript Project"></a><strong>5. Setup Node.js + TypeScript Project</strong></h2><h3 id="Step-1-Initialize-the-Project"><a href="#Step-1-Initialize-the-Project" class="headerlink" title="Step 1: Initialize the Project"></a><strong>Step 1: Initialize the Project</strong></h3><ol>
<li>Create a new folder for your project:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> my-node-react-app</span><br><span class="line"><span class="built_in">cd</span> my-node-react-app</span><br></pre></td></tr></table></figure></li>
<li>Initialize the project with Yarn or npm:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yarn init -y</span><br><span class="line"><span class="comment"># OR</span></span><br><span class="line">npm init -y</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="Step-2-Install-TypeScript"><a href="#Step-2-Install-TypeScript" class="headerlink" title="Step 2: Install TypeScript"></a><strong>Step 2: Install TypeScript</strong></h3><ol>
<li>Install TypeScript and Node.js types as dev dependencies:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D typescript @types/node</span><br></pre></td></tr></table></figure></li>
<li>Create a <code>tsconfig.json</code>:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx tsc --init</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>Example <code>tsconfig.json</code>:</strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ESNext&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ESNext&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;lib&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ESNext&quot;</span><span class="punctuation">,</span> <span class="string">&quot;DOM&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;strict&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;esModuleInterop&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;skipLibCheck&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;moduleResolution&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Node&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;resolveJsonModule&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;outDir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./dist&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;rootDir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./src&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;src/*&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;src&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;exclude&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;node_modules&quot;</span><span class="punctuation">,</span> <span class="string">&quot;dist&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Step-3-Setup-Front-End-React-Vite"><a href="#Step-3-Setup-Front-End-React-Vite" class="headerlink" title="Step 3: Setup Front-End (React + Vite)"></a><strong>Step 3: Setup Front-End (React + Vite)</strong></h3><ol>
<li>Create the React front-end:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn create vite react-frontend --template react-ts</span><br></pre></td></tr></table></figure></li>
<li>Navigate to the front-end folder:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> react-frontend</span><br></pre></td></tr></table></figure></li>
<li>Install dependencies for React development:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn add react react-dom</span><br><span class="line">yarn add -D @types/react @types/react-dom eslint prettier</span><br></pre></td></tr></table></figure></li>
<li>Install additional libraries:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add axios zustand zod clsx @tanstack/react-query</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="Step-4-Setup-Back-End-Node-js"><a href="#Step-4-Setup-Back-End-Node-js" class="headerlink" title="Step 4: Setup Back-End (Node.js)"></a><strong>Step 4: Setup Back-End (Node.js)</strong></h3><ol>
<li>Navigate back to the root directory.</li>
<li>Create a folder for the back-end:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> backend</span><br><span class="line"><span class="built_in">cd</span> backend</span><br></pre></td></tr></table></figure></li>
<li>Install Express and related types:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn add express</span><br><span class="line">yarn add -D @types/express nodemon</span><br></pre></td></tr></table></figure></li>
<li>Create a <code>src</code> folder and start building your API:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> src</span><br><span class="line"><span class="built_in">touch</span> src/index.ts</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>Example <code>src/index.ts</code>:</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">&#x27;express&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/api&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Hello from the back-end!&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PORT</span> = <span class="number">3001</span>;</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">PORT</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Server is running on http://localhost:<span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>Add a <code>nodemon</code> script to automatically restart the server during development:<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nodemon src/index.ts&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="Step-5-Configure-Path-Aliases"><a href="#Step-5-Configure-Path-Aliases" class="headerlink" title="Step 5: Configure Path Aliases"></a><strong>Step 5: Configure Path Aliases</strong></h3><ol>
<li><p>Add the following to both <code>react-frontend</code> and <code>backend</code> projects’ <code>tsconfig.json</code>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;src/*&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>In Vite’s <code>vite.config.ts</code> for the front-end, install and configure <code>vite-tsconfig-paths</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D vite-tsconfig-paths</span><br></pre></td></tr></table></figure>

<p><strong>vite.config.ts:</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> react <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> tsconfigPaths <span class="keyword">from</span> <span class="string">&#x27;vite-tsconfig-paths&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">react</span>(), <span class="title function_">tsconfigPaths</span>()],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="Step-6-Setup-Docker"><a href="#Step-6-Setup-Docker" class="headerlink" title="Step 6: Setup Docker"></a><strong>Step 6: Setup Docker</strong></h3><ol>
<li>Create a <code>Dockerfile</code> in the root directory for both front-end and back-end.</li>
</ol>
<p><strong>Front-End <code>Dockerfile</code>:</strong></p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> node:<span class="number">18</span>-alpine</span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> package.json yarn.lock ./</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yarn install</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;yarn&quot;</span>, <span class="string">&quot;dev&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<p><strong>Back-End <code>Dockerfile</code>:</strong></p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> node:<span class="number">18</span>-alpine</span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> package.json yarn.lock ./</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yarn install</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;yarn&quot;</span>, <span class="string">&quot;dev&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>Create a <code>docker-compose.yml</code>:<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">frontend:</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">./react-frontend</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;5173:5173&quot;</span></span><br><span class="line">  <span class="attr">backend:</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">./backend</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3001:3001&quot;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="Step-7-Debugging-in-VS-Code"><a href="#Step-7-Debugging-in-VS-Code" class="headerlink" title="Step 7: Debugging in VS Code"></a><strong>Step 7: Debugging in VS Code</strong></h3><ol>
<li><p>Install the <strong>Remote - Containers</strong> extension in VS Code.</p>
</li>
<li><p>Create a <code>.devcontainer</code> folder in the root directory.</p>
</li>
<li><p>Add a <code>devcontainer.json</code>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Node.js Dev&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;dockerComposeFile&quot;</span><span class="punctuation">:</span> <span class="string">&quot;docker-compose.yml&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;service&quot;</span><span class="punctuation">:</span> <span class="string">&quot;frontend&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;workspaceFolder&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/app&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;extensions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;dbaeumer.vscode-eslint&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;esbenp.prettier-vscode&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;settings&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;terminal.integrated.shell.linux&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/bin/bash&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Reopen the project in the container using the Command Palette (<code>Ctrl + Shift + P</code>).</p>
</li>
</ol>
<hr>
<h3 id="8-Start-Development"><a href="#8-Start-Development" class="headerlink" title="8. Start Development"></a><strong>8. Start Development</strong></h3><ol>
<li>Start the Docker containers:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up --build</span><br></pre></td></tr></table></figure></li>
<li>Access the front-end at <code>http://localhost:5173</code> and the back-end at <code>http://localhost:3001</code>.</li>
</ol>
<hr>
<h3 id="Project-Structure"><a href="#Project-Structure" class="headerlink" title="Project Structure"></a><strong>Project Structure</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">my-node-react-app/</span><br><span class="line">├── backend/</span><br><span class="line">│   ├── src/</span><br><span class="line">│   │   └── index.ts</span><br><span class="line">│   ├── package.json</span><br><span class="line">│   └── tsconfig.json</span><br><span class="line">├── react-frontend/</span><br><span class="line">│   ├── src/</span><br><span class="line">│   │   ├── App.tsx</span><br><span class="line">│   │   ├── main.tsx</span><br><span class="line">│   │   └── ...</span><br><span class="line">│   ├── package.json</span><br><span class="line">│   ├── tsconfig.json</span><br><span class="line">│   └── vite.config.ts</span><br><span class="line">├── docker-compose.yml</span><br><span class="line">└── .devcontainer/</span><br><span class="line">    └── devcontainer.json</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/07/Plain-Language-Explaination-of-LLMs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/07/Plain-Language-Explaination-of-LLMs/" class="post-title-link" itemprop="url">Plain Language Explanation of Large Models</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-07 11:58:04 / Modified: 16:48:32" itemprop="dateCreated datePublished" datetime="2024-11-07T11:58:04-05:00">2024-11-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/LLM/" itemprop="url" rel="index"><span itemprop="name">LLM</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#paper-introduction">Paper Introduction</a></li>
<li><a href="#llm-in-brief">LLM in Brief</a></li>
<li><a href="#token">Token</a><ul>
<li><a href="#example">Example</a></li>
<li><a href="#attempt">Attempt</a></li>
<li><a href="#predicting-the-next-token">Predicting the Next Token</a></li>
</ul>
</li>
<li><a href="#model-training">Model Training</a></li>
<li><a href="#context-window">Context Window</a></li>
<li><a href="#improving-the-context-window">Improving the Context Window</a><ul>
<li><a href="#from-markov-chains-to-neural-networks">From Markov Chains to Neural Networks</a></li>
</ul>
</li>
<li><a href="#transformer-and-attention-mechanism">Transformer and Attention Mechanism</a></li>
<li><a href="#self-attention-self-attention-mechanism">Self-Attention (Self-Attention Mechanism)</a><ul>
<li><a href="#self-attention-introduction">Self-Attention Introduction</a></li>
<li><a href="#workflow">Workflow</a></li>
<li><a href="#formula">Formula</a></li>
</ul>
</li>
<li><a href="#multi-head-attention">Multi-Head Attention</a><ul>
<li><a href="#summary">Summary</a></li>
</ul>
</li>
<li><a href="#add--norm-and-feed-forward">Add &amp; Norm and Feed Forward</a><ul>
<li><a href="#add--norm-residual-connection-and-layer-normalization">Add &amp; Norm (Residual Connection and Layer Normalization)</a><ul>
<li><a href="#residual-connection">Residual Connection</a></li>
<li><a href="#layer-normalization">Layer Normalization</a></li>
<li><a href="#combined-use">Combined Use</a></li>
</ul>
</li>
<li><a href="#feed-forward-neural-network">Feed Forward Neural Network</a><ul>
<li><a href="#purpose">Purpose</a></li>
<li><a href="#structure">Structure</a></li>
</ul>
</li>
<li><a href="#summary-1">Summary</a></li>
</ul>
</li>
<li><a href="#decoder-structure">Decoder Structure</a></li>
<li><a href="#appendix">Appendix</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>This document aims to provide a detailed explanation of the current mainstream large model architectures, such as the Transformer architecture. We will cover various aspects from a technical overview, architecture introduction to specific model implementations. Through this document, we hope to provide readers with a comprehensive understanding, helping them grasp the working principles of large models and enhance their technical foundation for communicating with clients. This document is suitable for individuals interested in large models.</p>
<p><a name="paper-introduction"></a></p>
<h2 id="Paper-Introduction"><a href="#Paper-Introduction" class="headerlink" title="Paper Introduction"></a>Paper Introduction</h2><p><strong>Paper Title:</strong> <em>Attention is all you need</em></p>
<p><strong>Release Date:</strong> 2017&#x2F;06&#x2F;12</p>
<p><strong>Published By:</strong> Google, University of Toronto</p>
<p><strong>Brief Summary:</strong> The progenitor of all LLMs, the foundational architecture for a new era in NLP.</p>
<p><strong>Chinese Summary:</strong> Traditional sequence-to-sequence models use complex recurrent or convolutional neural networks, including encoders and decoders. The best-performing models connect the encoder and decoder through attention mechanisms.</p>
<p>The author’s team proposes a new simple network structure, Transformer, which is entirely based on attention mechanisms and no longer uses recurrence and convolution.</p>
<p>Experiments on two machine translation tasks show that these models perform superiorly in quality and are easier to parallelize, significantly reducing the training time required.</p>
<p>The model achieved 28.4 BLEU on the WMT 2014 English-German translation task, over 2 BLEU higher than the best existing results (including ensemble models). On the WMT 2014 English-French translation task, the model achieved a new single-model best BLEU score of 41.8 after training on eight GPUs for 3.5 days, with training costs only a fraction of the best models in the literature.</p>
<p>The Transformer demonstrates generalization capabilities across other tasks, whether with extensive or limited training data, successfully applied to English constituency parsing.</p>
<p><strong>Paper Link:</strong> <a href="pdf/Plain-Language-Explaination-of-LLMs/Attention_Is_All_You_Need.pdf">Attention Is All You Need</a></p>
<p><strong>Core Technology:</strong> Model Architecture (here, leave a general impression of encode + decode)</p>
<p><img src="/images/Plain-Language-Explaination-of-LLMs/Image_01.jpg" alt="Model Architecture"></p>
<p><a name="llm-in-brief"></a></p>
<h2 id="LLM-in-Brief"><a href="#LLM-in-Brief" class="headerlink" title="LLM in Brief"></a>LLM in Brief</h2><p>Many believe that large models can directly answer questions or engage in conversations. However, their core function is to predict the next likely word, or “Token,” based on the input text. This predictive ability makes LLMs excel in various applications, including but not limited to:</p>
<ul>
<li><strong>Text Generation:</strong> LLMs can generate coherent and meaningful text passages for writing assistance, content creation, etc.</li>
<li><strong>Question Answering Systems:</strong> By understanding the context of a question, LLMs can generate accurate answers, widely used in intelligent customer service and information retrieval.</li>
<li><strong>Translation:</strong> LLMs can perform high-quality language translation based on context, supporting multilingual communication.</li>
<li><strong>Text Summarization:</strong> LLMs can extract key content from long documents to generate concise summaries, facilitating quick understanding.</li>
<li><strong>Dialogue Systems:</strong> LLMs can simulate human conversations, providing natural and smooth interaction experiences, applied in chatbots and virtual assistants.</li>
</ul>
<p>By understanding the concept of Tokens, we can better grasp the working principles of LLMs and their powerful capabilities in practical applications.</p>
<p><a name="token"></a></p>
<h2 id="Token"><a href="#Token" class="headerlink" title="Token"></a>Token</h2><p><a name="token-example"></a></p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>When discussing Tokens, it’s impossible not to mention a recent low-level error in a large model: “How many ‘r’s are in ‘Strawberry’?”</p>
<p><img src="/images/Plain-Language-Explaination-of-LLMs/Image_02.png" alt="Strawberry"></p>
<p>After the ridicule, people calmed down and began to think: what is the essence behind this low-level error?</p>
<p>It is generally believed that it is the fault of Tokenization.</p>
<p>In China, Tokenization is often translated as “word segmentation.” This translation is somewhat misleading because the Tokens in Tokenization do not necessarily refer to words; they can also be punctuation marks, numbers, or parts of a word. For example, in a tool provided by OpenAI, the word “Strawberry” is divided into three Tokens: Str-aw-berry. In this case, asking the AI large model to count how many ‘r’s are in the word is indeed a challenge for it.</p>
<p>To let everyone intuitively see the world of text in the eyes of large models, Karpathy specially wrote a small program to represent Tokens with emojis.</p>
<p><img src="/images/Plain-Language-Explaination-of-LLMs/Image_03.png" alt="Tokens With Emojis"></p>
<p><a name="token-attempt"></a></p>
<h3 id="Attempt"><a href="#Attempt" class="headerlink" title="Attempt"></a>Attempt</h3><p>A Token is the basic unit of text that LLMs understand. Although it is convenient to consider a Token as a word, for LLMs, the goal is to encode text as efficiently as possible. Therefore, in many cases, a Token represents a character sequence shorter or longer than an entire word. Punctuation marks and spaces are also represented as Tokens, either individually or combined with other characters. Each Token in the LLM vocabulary has a unique identifier, usually a number. LLMs use tokenizers to convert regular text strings into equivalent lists of Token numbers.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tiktoken</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get the encoder for the GPT-2 model</span></span><br><span class="line">encoding = tiktoken.encoding_for_model(<span class="string">&quot;gpt-2&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Encode example sentence</span></span><br><span class="line">encoded_text = encoding.encode(<span class="string">&quot;A journey of a thousand miles begins with a single step.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(encoded_text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Decode back to original text</span></span><br><span class="line">decoded_text = encoding.decode(encoded_text)</span><br><span class="line"><span class="built_in">print</span>(decoded_text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Encode and decode individual tokens</span></span><br><span class="line"><span class="built_in">print</span>(encoding.decode([<span class="number">32</span>]))  <span class="comment"># &#x27;A&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(encoding.decode([<span class="number">7002</span>])) <span class="comment"># &#x27; journey&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(encoding.decode([<span class="number">286</span>]))   <span class="comment"># &#x27;of&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Encode the word &quot;thousand&quot;</span></span><br><span class="line">thousand_encoded = encoding.encode(<span class="string">&quot;thousand&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(thousand_encoded)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Decode the encoded result of &quot;thousand&quot;</span></span><br><span class="line"><span class="built_in">print</span>(encoding.decode([<span class="number">400</span>])) <span class="comment"># &#x27;th&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(encoding.decode([<span class="number">29910</span>]))   <span class="comment"># &#x27;ousand&#x27;</span></span><br><span class="line"></span><br><span class="line">[<span class="number">32</span>, <span class="number">7002</span>, <span class="number">286</span>, <span class="number">257</span>, <span class="number">7319</span>, <span class="number">4608</span>, <span class="number">6140</span>, <span class="number">351</span>, <span class="number">257</span>, <span class="number">2060</span>, <span class="number">2239</span>, <span class="number">13</span>]</span><br><span class="line">A journey of a thousand miles begins <span class="keyword">with</span> a single step.</span><br><span class="line">A</span><br><span class="line"> journey</span><br><span class="line"> of</span><br><span class="line">[<span class="number">400</span>, <span class="number">29910</span>]</span><br><span class="line">th</span><br><span class="line">ousand</span><br></pre></td></tr></table></figure>

<p><a name="predicting-the-next-token"></a></p>
<h3 id="Predicting-the-Next-Token"><a href="#Predicting-the-Next-Token" class="headerlink" title="Predicting the Next Token"></a>Predicting the Next Token</h3><p>As mentioned above, given a piece of text, the task of a language model is to predict the next Token. If expressed in Python pseudocode, it looks like this:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">predictions = predict_next_token([<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;journey&#x27;</span>, <span class="string">&#x27;of&#x27;</span>, <span class="string">&#x27;a&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p>Here, the <code>predict_next_token</code> function receives a series of input Tokens converted from a user-provided prompt. In this example, we assume each word constitutes a separate Token. In reality, each Token is encoded as a number rather than being directly passed into the model as text. The output of the function is a data structure containing the probability values for each possible Token in the vocabulary to appear after the current input sequence.</p>
<p>The language model needs to learn to make such predictions through a training process. During training, the model is exposed to a large amount of text data, learning language patterns and rules. After training, the model can use the learned knowledge to estimate the probability of the next Token for any given Token sequence.</p>
<p>To generate continuous text, the model needs to repeatedly call itself, generating a new Token each time and adding it to the existing sequence until the preset length is reached. Below is a more detailed Python pseudocode showing this process:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">generate_text</span>(<span class="params">prompt, num_tokens, hyperparameters</span>):</span><br><span class="line">    tokens = tokenize(prompt)  <span class="comment"># Convert prompt to a list of Tokens</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(num_tokens):  <span class="comment"># Repeat for the specified number of Tokens</span></span><br><span class="line">        predictions = predict_next_token(tokens)  <span class="comment"># Get predictions for the next Token</span></span><br><span class="line">        next_token = select_next_token(predictions, hyperparameters)  <span class="comment"># Select the next Token based on probabilities</span></span><br><span class="line">        tokens.append(next_token)  <span class="comment"># Add the selected Token to the list</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(tokens)  <span class="comment"># Merge the Token list into a string</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Helper function to select the next Token</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">select_next_token</span>(<span class="params">predictions, hyperparameters</span>):</span><br><span class="line">    <span class="comment"># Adjust Token selection using strategies like temperature, top-k, or top-p</span></span><br><span class="line">    <span class="comment"># Implementation details depend on the specific hyperparameter settings</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>In this code, the <code>generate_text</code> function accepts a prompt string, the number of Tokens to generate, and a set of hyperparameters as input. The <code>tokenize</code> function is responsible for converting the prompt into a list of Tokens, while the <code>select_next_token</code> function selects the next Token based on the predicted probability distribution. By adjusting the hyperparameters in <code>select_next_token</code>, such as temperature, top-k, and top-p, the diversity and creativity of the generated text can be controlled. As the loop iterates, new Tokens are continuously added to the sequence, eventually forming coherent text output.</p>
<p><a name="model-training"></a></p>
<h2 id="Model-Training"><a href="#Model-Training" class="headerlink" title="Model Training"></a>Model Training</h2><p>Imagine we are training a model to predict the next word in a sentence. This is like playing a word-guessing game where the model needs to guess the next word based on the words already present. For a simplified vocabulary, let’s assume there are only five words:</p>
<p>[‘I’, ‘you’, ‘love’, ‘oranges’, ‘grapes’]</p>
<p>We do not consider spaces and punctuation, focusing only on these words.</p>
<p>We have three sentences as training data:</p>
<ul>
<li>I love oranges</li>
<li>I love grapes</li>
<li>you love oranges</li>
</ul>
<p>We can imagine a 5x5 table where each cell represents the number of times one word follows another. This table might look like this:</p>
<p><img src="/images/Plain-Language-Explaination-of-LLMs/Image_04.png" alt="Cell Matrix"></p>
<p>In this example, “I” is followed by “love” twice, and “love” is followed by “oranges” once and “grapes” twice. To make this table useful, we need to convert these counts into probabilities so that the model can predict the likelihood of the next word. For example, the probability of “oranges” following “love” is 1&#x2F;3 (about 33.3%), and the probability of “grapes” following “love” is 2&#x2F;3 (about 66.7%).</p>
<p>However, we encounter a problem: “oranges” and “grapes” do not appear after other words. This means that without additional information, the model will not be able to predict what might follow these words. To solve this problem, we can assume that any word in the vocabulary might follow any other word, although this is not perfect, it ensures that the model can make predictions even with limited training data.</p>
<p>In the real world, large language models (LLMs) use vast amounts of training data, reducing the chances of such “gaps” occurring. However, due to the infrequent occurrence of certain word combinations in the training data, LLMs may perform poorly in some cases, resulting in generated text that is grammatically correct but logically flawed or inconsistent. This phenomenon is sometimes referred to as “model hallucination.”</p>
<p><a name="context-window"></a></p>
<h2 id="Context-Window"><a href="#Context-Window" class="headerlink" title="Context Window"></a>Context Window</h2><p>In previous discussions, we mentioned using Markov chains to train small models, which rely on only the last Token to predict the next Token. This means that any text before the last Token does not affect the prediction, so the context window is very small, only one Token. Due to the small context window, the model easily “forgets” previous information, leading to generated text that lacks consistency, jumping from one word to another.</p>
<p><a name="improving-the-context-window"></a></p>
<h2 id="Improving-the-Context-Window"><a href="#Improving-the-Context-Window" class="headerlink" title="Improving the Context Window"></a>Improving the Context Window</h2><p>To improve the model’s prediction quality, we can try to increase the size of the context window. For example, if we use a two-Token context window, we need to build a larger probability matrix where each row represents all possible two-Token sequences. For a five-Token vocabulary, this will add 25 rows (5^2). Each time the <code>predict_next_token()</code> function is called, the last two Tokens of the input will be used to find the corresponding row in the probability table.</p>
<p>However, even with a two-Token context window, the generated text may still lack coherence. To generate more consistent and meaningful text, the context window size needs to be further increased. For example, increasing the context window to three Tokens will increase the number of rows in the probability table to 125 (5^3), but this is still insufficient to generate high-quality text.</p>
<p>As the context window increases, the size of the probability table grows exponentially. Taking the GPT-2 model as an example, it uses a 1024-Token context window. If we were to implement such a large context window using Markov chains as in the previous example, each row of the probability table would need to represent a sequence of length between 1 and 1024 Tokens. For a vocabulary of 5 Tokens, the number of possible sequences is 5^1024, an astronomical number. This number is so large that it is impractical to store and process such a massive probability table. Therefore, Markov chains face serious scalability issues when dealing with large context windows.</p>
<h3 id="From-Markov-Chains-to-Neural-Networks"><a href="#From-Markov-Chains-to-Neural-Networks" class="headerlink" title="From Markov Chains to Neural Networks"></a>From Markov Chains to Neural Networks</h3><p>Clearly, the probability table method is infeasible when dealing with large context windows. We need a more efficient method to predict the next Token. This is where neural networks come into play. Neural networks are special functions that accept input data, perform a series of calculations, and then output predictions. For language models, the input is a series of Tokens, and the output is the probability distribution of the next Token.</p>
<p>The key to neural networks lies in their parameters. These parameters are gradually adjusted during training to optimize the model’s prediction performance. The training process involves extensive mathematical operations, including forward propagation and backpropagation. Forward propagation refers to the input data passing through the network’s layers to generate predictions; backpropagation adjusts the network’s parameters based on the difference between the predictions and the true labels to reduce errors.</p>
<p>Modern language models, such as GPT-2, GPT-3, and GPT-4, use very deep neural networks with hundreds of millions or even trillions of parameters. The training process for these models is very complex and usually takes weeks or even months. Despite this, well-trained LLMs maintain high coherence and consistency in text generation, thanks to their powerful context understanding and generation capabilities.</p>
<p><a name="transformer-and-attention-mechanism"></a></p>
<h2 id="Transformer-and-Attention-Mechanism"><a href="#Transformer-and-Attention-Mechanism" class="headerlink" title="Transformer and Attention Mechanism"></a>Transformer and Attention Mechanism</h2><p>The Transformer is one of the most popular neural network architectures, particularly suited for natural language processing tasks. The core feature of the Transformer model is its attention mechanism. The attention mechanism allows the model to dynamically focus on different parts of the input sequence when processing it, thereby better capturing context information.</p>
<p>The attention mechanism was initially applied to machine translation tasks to help the model identify key information in the input sequence. Through the attention mechanism, the model can “focus” on important Tokens in the input sequence, thereby generating more accurate translation results. In language generation tasks, the attention mechanism plays an equally important role, enabling the model to consider multiple Tokens in the context window when generating the next Token, thereby generating more coherent and meaningful text.</p>
<p>In summary, although Markov chains provide a simple method for text generation, they have obvious limitations when dealing with large context windows. Modern language models overcome these limitations by using neural networks and attention mechanisms, achieving efficient and high-quality text generation.</p>
<p><img src="/images/Plain-Language-Explaination-of-LLMs/Image_05.jpg" alt="Framework-05"></p>
<p>Returning to the framework diagram, the input representation <strong>x</strong> of a word in the Transformer is obtained by adding the word <strong>Embedding</strong> and the position <strong>Embedding</strong> (Positional Encoding).</p>
<p>There are many ways to obtain the word Embedding, such as using pre-trained algorithms like Word2Vec, Glove, or training it in the Transformer.</p>
<p>In addition to the word Embedding, the Transformer also uses position Embedding to represent the position of a word in the sentence. <strong>Because the Transformer does not use an RNN structure but uses global information, it cannot utilize the order information of words, which is very important for NLP.</strong> Therefore, the Transformer uses position Embedding to preserve the relative or absolute position of words in the sequence.</p>
<p>In short: taking “apple” as an example</p>
<p>In “There are apples and bananas in the fruit store,” “apple” refers to the fruit, while in “The store has just launched the latest Apple 16,” “apple” represents the brand.</p>
<p><a name="self-attention"></a></p>
<h2 id="Self-Attention-Self-Attention-Mechanism"><a href="#Self-Attention-Self-Attention-Mechanism" class="headerlink" title="Self-Attention (Self-Attention Mechanism)"></a>Self-Attention (Self-Attention Mechanism)</h2><p><img src="/images/Plain-Language-Explaination-of-LLMs/Image_06.jpg" alt="Self Attention"></p>
<p>The above image is the internal structure diagram of the Transformer in the paper, with the left side being the Encoder block and the right side being the Decoder block. The part circled in red is <strong>Multi-Head Attention</strong>, which consists of multiple <strong>Self-Attention</strong> layers. It can be seen that the Encoder block contains one Multi-Head Attention, while the Decoder block contains two Multi-Head Attention (one of which uses Masked). Above the Multi-Head Attention is an Add &amp; Norm layer, where Add represents a residual connection (Residual Connection) to prevent network degradation, and Norm represents Layer Normalization to normalize the activation values of each layer.</p>
<p>Since <strong>Self-Attention</strong> is the key point of the Transformer, we focus on Multi-Head Attention and Self-Attention. First, let’s take a detailed look at the internal logic of Self-Attention.</p>
<p>Of course, we can understand the Self-Attention mechanism in a more concise way.</p>
<p><a name="self-attention-introduction"></a></p>
<h3 id="Self-Attention-Introduction"><a href="#Self-Attention-Introduction" class="headerlink" title="Self-Attention Introduction"></a>Self-Attention Introduction</h3><p><strong>Self-Attention</strong> is a method that allows the model to focus on different parts of the sequence data when processing it, especially suitable for handling long texts. It achieves this by calculating the relevance between each element in the sequence and all other elements.</p>
<p><a name="self-attention-workflow"></a></p>
<h3 id="Workflow"><a href="#Workflow" class="headerlink" title="Workflow"></a>Workflow</h3><ol>
<li><p><strong>Transformation:</strong></p>
<ul>
<li>Each input element (such as a word) is transformed into three vectors: <strong>Query (query), Key (key), and Value (value)</strong>. These vectors are obtained by multiplying the input vector by three different weight matrices WQ, WK, and WV.</li>
</ul>
</li>
<li><p><strong>Calculate Attention Scores:</strong></p>
<ul>
<li>For each element, use its <strong>Query</strong> vector to perform dot product operations with the <strong>Key</strong> vectors of all other elements, obtaining a list of scores. This score represents the relevance of the current element to all other elements.</li>
</ul>
</li>
<li><p><strong>Normalization:</strong></p>
<ul>
<li>Normalize these scores through the <strong>softmax</strong> function to obtain a probability distribution, representing the attention weights of the current element to all other elements.</li>
</ul>
</li>
<li><p><strong>Weighted Sum:</strong></p>
<ul>
<li>Use these attention weights to perform a weighted sum of the <strong>Value</strong> vectors of all elements, obtaining the final output vector.</li>
</ul>
</li>
</ol>
<p><a name="self-attention-formula"></a></p>
<h3 id="Formula"><a href="#Formula" class="headerlink" title="Formula"></a>Formula</h3><p>Suppose the input sequence is X &#x3D; [x1, x2, …, xn], where each xi is a vector.</p>
<ol>
<li>Transformation:</li>
</ol>
<p><img src="/images/Plain-Language-Explaination-of-LLMs/Image_07.png" alt="Transformation"></p>
<ol start="2">
<li>Calculate Attention Scores:</li>
</ol>
<p><img src="/images/Plain-Language-Explaination-of-LLMs/Image_08.png" alt="Calculate Attention"></p>
<p>   where dk is the dimension of the Key vector.</p>
<ol start="3">
<li><p>Normalization: Attention Weights &#x3D; softmax(Scores)</p>
</li>
<li><p>Weighted Sum: Output &#x3D; Attention Weights · V</p>
</li>
</ol>
<p><a name="multi-head-attention"></a></p>
<h2 id="Multi-Head-Attention"><a href="#Multi-Head-Attention" class="headerlink" title="Multi-Head Attention"></a>Multi-Head Attention</h2><ul>
<li><strong>Multi-Head Attention</strong> is designed to allow the model to capture information from multiple different perspectives. Specifically, multiple Self-Attention layers (each called a “head”) are run in parallel, and then all heads’ outputs are concatenated and passed through a linear transformation.</li>
</ul>
<p><a name="multi-head-attention-summary"></a></p>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><ul>
<li><strong>Self-Attention</strong> allows the model to focus on different parts of the sequence, thereby better capturing long-range dependencies.</li>
<li><strong>Multi-Head Attention</strong> enhances the model’s expressive power by using multiple Self-Attention layers, allowing it to consider information from multiple perspectives.</li>
</ul>
<p><a name="add-norm-and-feed-forward"></a></p>
<h2 id="Add-Norm-and-Feed-Forward"><a href="#Add-Norm-and-Feed-Forward" class="headerlink" title="Add &amp; Norm and Feed Forward"></a>Add &amp; Norm and Feed Forward</h2><p><a name="add-norm-residual-connection"></a></p>
<h3 id="Add-Norm-Residual-Connection-and-Layer-Normalization"><a href="#Add-Norm-Residual-Connection-and-Layer-Normalization" class="headerlink" title="Add &amp; Norm (Residual Connection and Layer Normalization)"></a>Add &amp; Norm (Residual Connection and Layer Normalization)</h3><h4 id="Residual-Connection"><a href="#Residual-Connection" class="headerlink" title="Residual Connection"></a>Residual Connection</h4><ul>
<li><strong>Purpose:</strong> The residual connection helps in training deep networks by allowing the gradient to flow directly through the network, mitigating the vanishing gradient problem.</li>
<li><strong>Operation:</strong> The residual connection adds the input of a layer directly to its output:<br>[<br>\text{Output} &#x3D; F(x) + x<br>]<br>where ( F(x) ) is the output of the layer.</li>
</ul>
<h4 id="Layer-Normalization"><a href="#Layer-Normalization" class="headerlink" title="Layer Normalization"></a>Layer Normalization</h4><ul>
<li><strong>Purpose:</strong> Layer normalization stabilizes the training process by normalizing the activations of each layer, ensuring that the mean and variance of the activations remain consistent.</li>
<li><strong>Operation:</strong> For each sample in the batch, layer normalization normalizes the activations across the feature dimension:<br>[<br>\text{LayerNorm}(x) &#x3D; \frac{x - \mu}{\sigma} \cdot \gamma + \beta<br>]<br>where ( \mu ) and ( \sigma ) are the mean and standard deviation of the activations, and ( \gamma ) and ( \beta ) are learnable parameters.</li>
</ul>
<h4 id="Combined-Use"><a href="#Combined-Use" class="headerlink" title="Combined Use"></a>Combined Use</h4><ul>
<li><p><strong>Steps:</strong></p>
<ol>
<li>First, calculate the output ( F(x) ) of a layer.</li>
<li>Add the input ( x ) to ( F(x) ), obtaining ( y &#x3D; F(x) + x ).</li>
<li>Perform layer normalization on ( y ) to obtain the final output.</li>
</ol>
</li>
</ul>
<p><a name="feed-forward-neural-network"></a></p>
<h3 id="Feed-Forward-Neural-Network"><a href="#Feed-Forward-Neural-Network" class="headerlink" title="Feed Forward Neural Network"></a>Feed Forward Neural Network</h3><h4 id="Purpose"><a href="#Purpose" class="headerlink" title="Purpose"></a>Purpose</h4><ul>
<li><strong>Add Nonlinearity:</strong> Makes the model more flexible, capable of handling more complex data.</li>
</ul>
<h4 id="Structure"><a href="#Structure" class="headerlink" title="Structure"></a>Structure</h4><ul>
<li><p><strong>Two-Layer Fully Connected Network:</strong></p>
<ol>
<li>The first layer: Transform the input through a linear transformation (multiply by a matrix), then process it with the ReLU activation function.</li>
<li>The second layer: Transform it again through a linear transformation (multiply by another matrix).</li>
</ol>
</li>
</ul>
<p><a name="feed-forward-summary"></a></p>
<h3 id="Summary-1"><a href="#Summary-1" class="headerlink" title="Summary"></a>Summary</h3><ul>
<li><strong>Add &amp; Norm:</strong> Through residual connections and layer normalization, the model becomes more stable and trains faster.</li>
<li><strong>Feed Forward:</strong> Through a two-layer fully connected network, it adds flexibility to the model, enabling it to handle more complex data.</li>
</ul>
<p><a name="decoder-structure"></a></p>
<h2 id="Decoder-Structure"><a href="#Decoder-Structure" class="headerlink" title="Decoder Structure"></a>Decoder Structure</h2><p><img src="/images/Plain-Language-Explaination-of-LLMs/Image_09.png" alt="Decoder Structure"></p>
<p>The red part in the above image is the structure of the Transformer’s Decoder block, similar to the Encoder block but with some differences:</p>
<ul>
<li>Contains two Multi-Head Attention layers.</li>
<li>The first Multi-Head Attention layer uses a Masked operation.</li>
<li>The second Multi-Head Attention layer’s <strong>K, V</strong> matrices use the Encoder’s <strong>encoded information matrix C</strong> for calculation, while <strong>Q</strong> uses the output of the previous Decoder block for calculation.</li>
<li>Finally, a Softmax layer calculates the probability of the next translated word.</li>
</ul>
<p><a name="appendix"></a></p>
<h2 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Import necessary libraries</span></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.optim <span class="keyword">as</span> optim</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define the positional encoding layer, used to add positional information to the input sequence</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PositionalEncoding</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, d_model, max_len=<span class="number">5000</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(PositionalEncoding, <span class="variable language_">self</span>).__init__()</span><br><span class="line">        <span class="comment"># Initialize the positional encoding tensor</span></span><br><span class="line">        pe = torch.zeros(max_len, d_model)</span><br><span class="line">        position = torch.arange(<span class="number">0</span>, max_len, dtype=torch.<span class="built_in">float</span>).unsqueeze(<span class="number">1</span>)</span><br><span class="line">        div_term = torch.exp(torch.arange(<span class="number">0</span>, d_model, <span class="number">2</span>).<span class="built_in">float</span>() * (-math.log(<span class="number">10000.0</span>) / d_model))</span><br><span class="line">        <span class="comment"># Calculate the sine and cosine values</span></span><br><span class="line">        pe[:, <span class="number">0</span>::<span class="number">2</span>] = torch.sin(position * div_term)</span><br><span class="line">        pe[:, <span class="number">1</span>::<span class="number">2</span>] = torch.cos(position * div_term)</span><br><span class="line">        pe = pe.unsqueeze(<span class="number">0</span>).transpose(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="comment"># Register the positional encoding as a buffer</span></span><br><span class="line">        <span class="variable language_">self</span>.register_buffer(<span class="string">&#x27;pe&#x27;</span>, pe)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="comment"># Add the positional encoding to the input</span></span><br><span class="line">        x = x + <span class="variable language_">self</span>.pe[:x.size(<span class="number">0</span>), :]</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define the Transformer-based model class</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TransformerModel</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, input_dim, output_dim, d_model=<span class="number">512</span>, nhead=<span class="number">8</span>, num_encoder_layers=<span class="number">6</span>, dim_feedforward=<span class="number">2048</span>, dropout=<span class="number">0.1</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(TransformerModel, <span class="variable language_">self</span>).__init__()</span><br><span class="line">        <span class="variable language_">self</span>.model_type = <span class="string">&#x27;Transformer&#x27;</span></span><br><span class="line">        <span class="comment"># Define the embedding layer</span></span><br><span class="line">        <span class="variable language_">self</span>.embedding = nn.Embedding(input_dim, d_model)</span><br><span class="line">        <span class="comment"># Define the positional encoding layer</span></span><br><span class="line">        <span class="variable language_">self</span>.pos_encoder = PositionalEncoding(d_model)</span><br><span class="line">        <span class="comment"># Define the encoder layers</span></span><br><span class="line">        encoder_layers = nn.TransformerEncoderLayer(d_model, nhead, dim_feedforward, dropout)</span><br><span class="line">        <span class="variable language_">self</span>.transformer_encoder = nn.TransformerEncoder(encoder_layers, num_encoder_layers)</span><br><span class="line">        <span class="variable language_">self</span>.d_model = d_model</span><br><span class="line">        <span class="comment"># Define the decoder layer</span></span><br><span class="line">        <span class="variable language_">self</span>.decoder = nn.Linear(d_model, output_dim)</span><br><span class="line">        <span class="comment"># Initialize the weights</span></span><br><span class="line">        <span class="variable language_">self</span>.init_weights()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">init_weights</span>(<span class="params">self</span>):</span><br><span class="line">        initrange = <span class="number">0.1</span></span><br><span class="line">        <span class="variable language_">self</span>.embedding.weight.data.uniform_(-initrange, initrange)</span><br><span class="line">        <span class="variable language_">self</span>.decoder.bias.data.zero_()</span><br><span class="line">        <span class="variable language_">self</span>.decoder.weight.data.uniform_(-initrange, initrange)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, src, src_mask</span>):</span><br><span class="line">        <span class="comment"># Embed the input and multiply by the square root of d_model</span></span><br><span class="line">        src = <span class="variable language_">self</span>.embedding(src) * math.sqrt(<span class="variable language_">self</span>.d_model)</span><br><span class="line">        src = <span class="variable language_">self</span>.pos_encoder(src)</span><br><span class="line">        <span class="comment"># Encode the input</span></span><br><span class="line">        output = <span class="variable language_">self</span>.transformer_encoder(src, src_mask)</span><br><span class="line">        <span class="comment"># Decode the output</span></span><br><span class="line">        output = <span class="variable language_">self</span>.decoder(output)</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate a triangular matrix as a mask</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_square_subsequent_mask</span>(<span class="params">sz</span>):</span><br><span class="line">    mask = (torch.triu(torch.ones(sz, sz)) == <span class="number">1</span>).transpose(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    mask = mask.<span class="built_in">float</span>().masked_fill(mask == <span class="number">0</span>, <span class="built_in">float</span>(<span class="string">&#x27;-inf&#x27;</span>)).masked_fill(mask == <span class="number">1</span>, <span class="built_in">float</span>(<span class="number">0.0</span>))</span><br><span class="line">    <span class="keyword">return</span> mask</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage</span></span><br><span class="line">input_dim = <span class="number">1000</span>  <span class="comment"># Vocabulary size</span></span><br><span class="line">output_dim = <span class="number">1000</span>  <span class="comment"># Output dimension</span></span><br><span class="line">seq_length = <span class="number">10</span>  <span class="comment"># Sequence length</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a model instance</span></span><br><span class="line">model = TransformerModel(input_dim=input_dim, output_dim=output_dim)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example data</span></span><br><span class="line">src = torch.randint(<span class="number">0</span>, input_dim, (seq_length, <span class="number">32</span>))  <span class="comment"># (sequence length, batch size)</span></span><br><span class="line">src_mask = generate_square_subsequent_mask(seq_length)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Forward propagation</span></span><br><span class="line">output = model(src, src_mask)</span><br><span class="line"><span class="built_in">print</span>(output.shape)  <span class="comment"># Expected output: [sequence length, batch size, output dimension]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Define a simple loss function and optimizer for training</span></span><br><span class="line">criterion = nn.CrossEntropyLoss()</span><br><span class="line">optimizer = optim.Adam(model.parameters(), lr=<span class="number">0.001</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example training loop</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):  <span class="comment"># Number of iterations</span></span><br><span class="line">    optimizer.zero_grad()</span><br><span class="line">    output = model(src, src_mask)</span><br><span class="line">    loss = criterion(output.view(-<span class="number">1</span>, output_dim), src.view(-<span class="number">1</span>))</span><br><span class="line">    loss.backward()</span><br><span class="line">    optimizer.step()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Epoch <span class="subst">&#123;epoch+<span class="number">1</span>&#125;</span>, Loss: <span class="subst">&#123;loss.item()&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/06/Deep-Dive-into-ReactJS-Hooks/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/11/06/Deep-Dive-into-ReactJS-Hooks/" class="post-title-link" itemprop="url">Deep Dive into ReactJS Hooks</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-06 17:44:46 / Modified: 17:46:45" itemprop="dateCreated datePublished" datetime="2024-11-06T17:44:46-05:00">2024-11-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/" itemprop="url" rel="index"><span itemprop="name">Deep Dive</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/ReactJS/" itemprop="url" rel="index"><span itemprop="name">ReactJS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="A-Deep-Dive-into-React-Hooks-for-Senior-Developers"><a href="#A-Deep-Dive-into-React-Hooks-for-Senior-Developers" class="headerlink" title="A Deep Dive into React Hooks for Senior Developers"></a>A Deep Dive into React Hooks for Senior Developers</h1><p>React Hooks, introduced in React 16.8, revolutionized functional components by adding state and lifecycle capabilities, enabling a simpler, more powerful way to manage logic within components. This guide will provide a deep dive into React’s core hooks, detailing how they work, the scenarios in which they shine, and best practices for leveraging them effectively. </p>
<hr>
<p><a name="introduction-to-hooks"></a></p>
<h2 id="Introduction-to-Hooks"><a href="#Introduction-to-Hooks" class="headerlink" title="Introduction to Hooks"></a>Introduction to Hooks</h2><p>Hooks allow you to use state, lifecycle methods, and other React features without writing a class. They provide a way to reuse logic across components in a more composable and understandable way, helping developers avoid the complex nesting and lifecycle clutter often encountered with higher-order components and render props.</p>
<h3 id="Why-Hooks"><a href="#Why-Hooks" class="headerlink" title="Why Hooks?"></a>Why Hooks?</h3><ul>
<li>Simplify state and side effect management in functional components.</li>
<li>Enhance code reuse with custom hooks.</li>
<li>Make components cleaner and more readable.</li>
</ul>
<hr>
<p><a name="basic-hooks"></a></p>
<h2 id="Basic-Hooks"><a href="#Basic-Hooks" class="headerlink" title="Basic Hooks"></a>Basic Hooks</h2><p>React offers several core hooks that cover common needs such as state, effects, and references.</p>
<h3 id="useState-Managing-State-in-Functional-Components"><a href="#useState-Managing-State-in-Functional-Components" class="headerlink" title="useState: Managing State in Functional Components"></a><a name="useState"></a><code>useState</code>: Managing State in Functional Components</h3><p><code>useState</code> is used to declare state within functional components. It returns an array with two values: the current state and a function to update it.</p>
<h4 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax:"></a>Syntax:</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [state, setState] = <span class="title function_">useState</span>(initialValue);</span><br></pre></td></tr></table></figure>

<h4 id="Practical-Scenario-Toggling-a-Modal"><a href="#Practical-Scenario-Toggling-a-Modal" class="headerlink" title="Practical Scenario: Toggling a Modal"></a>Practical Scenario: Toggling a Modal</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ModalToggle</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [isOpen, setIsOpen] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">toggleModal</span> = (<span class="params"></span>) =&gt; <span class="title function_">setIsOpen</span>(!isOpen);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;toggleModal&#125;</span>&gt;</span>Toggle Modal<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;isOpen &amp;&amp; <span class="tag">&lt;<span class="name">Modal</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="useEffect"></a></p>
<h3 id="useEffect-Side-Effects-and-Lifecycle-Events"><a href="#useEffect-Side-Effects-and-Lifecycle-Events" class="headerlink" title="useEffect: Side Effects and Lifecycle Events"></a><code>useEffect</code>: Side Effects and Lifecycle Events</h3><p><code>useEffect</code> manages side effects (such as data fetching, subscriptions, or DOM manipulation). It runs after the component renders and accepts a dependency array that controls when it should re-run.</p>
<h4 id="Syntax-1"><a href="#Syntax-1" class="headerlink" title="Syntax:"></a>Syntax:</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// effect code here</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// cleanup code here</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, [dependencies]);</span><br></pre></td></tr></table></figure>

<h4 id="Practical-Scenario-Fetching-Data-on-Component-Load"><a href="#Practical-Scenario-Fetching-Data-on-Component-Load" class="headerlink" title="Practical Scenario: Fetching Data on Component Load"></a>Practical Scenario: Fetching Data on Component Load</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">UserList</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [users, setUsers] = <span class="title function_">useState</span>([]);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchUsers</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/users&#x27;</span>);</span><br><span class="line">      <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">      <span class="title function_">setUsers</span>(data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">fetchUsers</span>();</span><br><span class="line">  &#125;, []); <span class="comment">// Empty array means this runs only once, similar to componentDidMount</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;users.map(user =&gt; <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;user.id&#125;</span>&gt;</span>&#123;user.name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Tips"><a href="#Tips" class="headerlink" title="Tips:"></a>Tips:</h4><ul>
<li><strong>Cleanup</strong>: Return a cleanup function to avoid memory leaks (e.g., unsubscribing from a WebSocket).</li>
<li><strong>Dependencies</strong>: Use the dependency array to specify when the effect should re-run.</li>
</ul>
<hr>
<p><a name="advanced-hooks"></a></p>
<h2 id="Advanced-Hooks"><a href="#Advanced-Hooks" class="headerlink" title="Advanced Hooks"></a>Advanced Hooks</h2><p>Beyond the basic hooks, React provides additional hooks for managing more specialized situations.</p>
<h3 id="useContext-Accessing-Context-Values"><a href="#useContext-Accessing-Context-Values" class="headerlink" title="useContext: Accessing Context Values"></a><a name="useContext"></a><code>useContext</code>: Accessing Context Values</h3><p><code>useContext</code> allows components to access and consume context values directly without needing to wrap them in a <code>Consumer</code>.</p>
<h4 id="Syntax-2"><a href="#Syntax-2" class="headerlink" title="Syntax:"></a>Syntax:</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> contextValue = <span class="title function_">useContext</span>(<span class="title class_">MyContext</span>);</span><br></pre></td></tr></table></figure>

<h4 id="Practical-Scenario-Global-Theme-Management"><a href="#Practical-Scenario-Global-Theme-Management" class="headerlink" title="Practical Scenario: Global Theme Management"></a>Practical Scenario: Global Theme Management</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ThemeContext</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./ThemeContext&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ThemedButton</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> theme = <span class="title function_">useContext</span>(<span class="title class_">ThemeContext</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">background:</span> <span class="attr">theme.background</span>, <span class="attr">color:</span> <span class="attr">theme.foreground</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      I am styled by theme context!</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="additional-hooks"></a></p>
<h2 id="Additional-Hooks"><a href="#Additional-Hooks" class="headerlink" title="Additional Hooks"></a>Additional Hooks</h2><h3 id="useReducer-Managing-Complex-State"><a href="#useReducer-Managing-Complex-State" class="headerlink" title="useReducer: Managing Complex State"></a><a name="useReducer"></a><code>useReducer</code>: Managing Complex State</h3><p><code>useReducer</code> is an alternative to <code>useState</code> for managing complex state transitions, typically in situations where you would use Redux or other state management libraries.</p>
<h4 id="Syntax-3"><a href="#Syntax-3" class="headerlink" title="Syntax:"></a>Syntax:</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [state, dispatch] = <span class="title function_">useReducer</span>(reducer, initialState);</span><br></pre></td></tr></table></figure>

<h4 id="Practical-Scenario-A-Counter-with-Increment-Decrement"><a href="#Practical-Scenario-A-Counter-with-Increment-Decrement" class="headerlink" title="Practical Scenario: A Counter with Increment&#x2F;Decrement"></a>Practical Scenario: A Counter with Increment&#x2F;Decrement</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useReducer &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;increment&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;decrement&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">count</span>: state.<span class="property">count</span> - <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Counter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [state, dispatch] = <span class="title function_">useReducer</span>(reducer, &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(&#123; type: &#x27;decrement&#x27; &#125;)&#125;&gt;-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;state.count&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(&#123; type: &#x27;increment&#x27; &#125;)&#125;&gt;+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="useRef-Persistent-Mutable-References"><a href="#useRef-Persistent-Mutable-References" class="headerlink" title="useRef: Persistent Mutable References"></a><a name="useRef"></a><code>useRef</code>: Persistent Mutable References</h3><p><code>useRef</code> creates a persistent reference that doesn’t cause re-renders, making it ideal for storing mutable values like DOM elements.</p>
<h4 id="Syntax-4"><a href="#Syntax-4" class="headerlink" title="Syntax:"></a>Syntax:</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ref = <span class="title function_">useRef</span>(initialValue);</span><br></pre></td></tr></table></figure>

<h4 id="Practical-Scenario-Focusing-an-Input-Element"><a href="#Practical-Scenario-Focusing-an-Input-Element" class="headerlink" title="Practical Scenario: Focusing an Input Element"></a>Practical Scenario: Focusing an Input Element</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">TextInputWithFocus</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    inputRef.<span class="property">current</span>.<span class="title function_">focus</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>Focus the input<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="useMemo-Memoizing-Expensive-Calculations"><a href="#useMemo-Memoizing-Expensive-Calculations" class="headerlink" title="useMemo: Memoizing Expensive Calculations"></a><a name="useMemo"></a><code>useMemo</code>: Memoizing Expensive Calculations</h3><p><code>useMemo</code> optimizes performance by memoizing expensive calculations, only recomputing them when dependencies change.</p>
<h4 id="Syntax-5"><a href="#Syntax-5" class="headerlink" title="Syntax:"></a>Syntax:</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> memoizedValue = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> <span class="title function_">computeExpensiveValue</span>(a, b), [a, b]);</span><br></pre></td></tr></table></figure>

<h4 id="Practical-Scenario-Filtering-a-Large-List"><a href="#Practical-Scenario-Filtering-a-Large-List" class="headerlink" title="Practical Scenario: Filtering a Large List"></a>Practical Scenario: Filtering a Large List</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useMemo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">FilterableList</span>(<span class="params">&#123; items &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [query, setQuery] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> filteredItems = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> items.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="title function_">toLowerCase</span>().<span class="title function_">includes</span>(query.<span class="title function_">toLowerCase</span>()));</span><br><span class="line">  &#125;, [items, query]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">&#123;query&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;e</span> =&gt;</span> setQuery(e.target.value)&#125; placeholder=&quot;Filter items&quot; /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;filteredItems.map(item =&gt; <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item&#125;</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="custom-hooks"></a></p>
<h2 id="Custom-Hooks"><a href="#Custom-Hooks" class="headerlink" title="Custom Hooks"></a>Custom Hooks</h2><p>Custom hooks are functions that allow you to extract and reuse stateful logic across components. They enable you to abstract complex logic in a cleaner, more maintainable way.</p>
<h3 id="Practical-Scenario-A-useFetch-Hook-for-Data-Fetching"><a href="#Practical-Scenario-A-useFetch-Hook-for-Data-Fetching" class="headerlink" title="Practical Scenario: A useFetch Hook for Data Fetching"></a>Practical Scenario: A <code>useFetch</code> Hook for Data Fetching</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useFetch</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [data, setData] = <span class="title function_">useState</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [loading, setLoading] = <span class="title function_">useState</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchData</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">setLoading</span>(<span class="literal">true</span>);</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(url);</span><br><span class="line">      <span class="keyword">const</span> result = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">      <span class="title function_">setData</span>(result);</span><br><span class="line">      <span class="title function_">setLoading</span>(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">fetchData</span>();</span><br><span class="line">  &#125;, [url]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; data, loading &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useFetch;</span><br></pre></td></tr></table></figure>

<h3 id="Using-useFetch-in-a-Component"><a href="#Using-useFetch-in-a-Component" class="headerlink" title="Using useFetch in a Component"></a>Using <code>useFetch</code> in a Component</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> useFetch <span class="keyword">from</span> <span class="string">&#x27;./useFetch&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Users</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; data, loading &#125; = <span class="title function_">useFetch</span>(<span class="string">&#x27;/api/users&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (loading) <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;data.map(user =&gt; <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;user.id&#125;</span>&gt;</span>&#123;user.name&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="error-handling-and-best-practices"></a></p>
<h2 id="Error-Handling-and-Best-Practices"><a href="#Error-Handling-and-Best-Practices" class="headerlink" title="Error Handling and Best Practices"></a>Error Handling and Best Practices</h2><h3 id="Error-Handling-in-Hooks"><a href="#Error-Handling-in-Hooks" class="headerlink" title="Error Handling in Hooks"></a>Error Handling in Hooks</h3><ol>
<li><strong>Wrap async operations</strong> with a try-catch to handle errors gracefully.</li>
<li><strong>Global error boundaries</strong> for handling errors in effects or custom hooks (using libraries like <code>react-error-boundary</code>).</li>
</ol>
<h3 id="Best-Practices"><a href="#Best-Practices" class="headerlink" title="Best Practices"></a>Best Practices</h3><ul>
<li><strong>Dependency Arrays</strong>: Always add dependencies in <code>useEffect</code> and <code>useMemo</code> dependency arrays to avoid stale closures.</li>
<li><strong>Avoid Side Effects in Render</strong>: Avoid triggering side effects inside render methods to prevent unexpected behavior.</li>
</ul>
<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>React Hooks provide powerful, flexible solutions for managing state, effects, and other logic in functional components. Mastering these core hooks, along with custom hooks, enables you to write cleaner, more maintainable code.</p>
<p>With practical examples, error handling tips, and performance optimizations, you’re now equipped to build complex React applications that harness the full power of hooks.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Dazhi Zhang</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.1/mermaid.min.js","integrity":"sha256-YbM1pG3wWnzhyYN49g5fPnen+2CKEFaZfopkkwSpNtY="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  





</body>
</html>
