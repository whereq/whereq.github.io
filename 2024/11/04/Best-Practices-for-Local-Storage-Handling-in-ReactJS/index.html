<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.whereq.com","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.21.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Introduction 1. Local Storage Basics 1.1 Project Setup Yarn Commands   1.2 Project Folder Structure 2.1 What is Local Storage? 2.2 Local Storage vs Session Storage   3. Local Storage Basics 3.1 Basic">
<meta property="og:type" content="article">
<meta property="og:title" content="Best Practices for Local Storage Handling in ReactJS">
<meta property="og:url" content="https://www.whereq.com/2024/11/04/Best-Practices-for-Local-Storage-Handling-in-ReactJS/index.html">
<meta property="og:site_name" content="WhereQ">
<meta property="og:description" content="Introduction 1. Local Storage Basics 1.1 Project Setup Yarn Commands   1.2 Project Folder Structure 2.1 What is Local Storage? 2.2 Local Storage vs Session Storage   3. Local Storage Basics 3.1 Basic">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-11-04T22:49:26.000Z">
<meta property="article:modified_time" content="2024-11-04T23:48:34.354Z">
<meta property="article:author" content="Dazhi Zhang">
<meta property="article:tag" content="Deep Dive">
<meta property="article:tag" content="ReactJS">
<meta property="article:tag" content="Redux">
<meta property="article:tag" content="Best Practices">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.whereq.com/2024/11/04/Best-Practices-for-Local-Storage-Handling-in-ReactJS/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://www.whereq.com/2024/11/04/Best-Practices-for-Local-Storage-Handling-in-ReactJS/","path":"2024/11/04/Best-Practices-for-Local-Storage-Handling-in-ReactJS/","title":"Best Practices for Local Storage Handling in ReactJS"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Best Practices for Local Storage Handling in ReactJS | WhereQ</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">WhereQ</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-articles"><a href="/articles/" rel="section"><i class="fa fa-file fa-fw"></i>Articles</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Introduction"><span class="nav-number">1.</span> <span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Local-Storage-Basics"><span class="nav-number">2.</span> <span class="nav-text">1. Local Storage Basics</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-Project-Setup"><span class="nav-number">3.</span> <span class="nav-text">1.1 Project Setup</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Yarn-Commands"><span class="nav-number">3.1.</span> <span class="nav-text">Yarn Commands</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-Project-Folder-Structure"><span class="nav-number">4.</span> <span class="nav-text">1.2 Project Folder Structure</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-What-is-Local-Storage"><span class="nav-number">4.1.</span> <span class="nav-text">2.1 What is Local Storage?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Local-Storage-vs-Session-Storage"><span class="nav-number">4.2.</span> <span class="nav-text">2.2 Local Storage vs Session Storage</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Local-Storage-Basics"><span class="nav-number">5.</span> <span class="nav-text">3. Local Storage Basics</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-Basic-API"><span class="nav-number">6.</span> <span class="nav-text">3.1 Basic API</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-Type-Safety"><span class="nav-number">6.1.</span> <span class="nav-text">3.2 Type Safety</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-Error-Handling"><span class="nav-number">6.2.</span> <span class="nav-text">3.3 Error Handling</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-Data-Serialization"><span class="nav-number">6.3.</span> <span class="nav-text">3.4 Data Serialization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-Expiration-Handling"><span class="nav-number">6.4.</span> <span class="nav-text">3.5 Expiration Handling</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Best-Practices"><span class="nav-number">7.</span> <span class="nav-text">4. Best Practices</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-Encapsulating-Local-Storage-Access"><span class="nav-number">7.1.</span> <span class="nav-text">4.1 Encapsulating Local Storage Access</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-More-Scenarios"><span class="nav-number">8.</span> <span class="nav-text">5 More Scenarios</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-Scenario-1-User-Preferences"><span class="nav-number">8.1.</span> <span class="nav-text">5.1 Scenario 1: User Preferences</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-Scenario-2-Shopping-Cart"><span class="nav-number">8.2.</span> <span class="nav-text">5.2 Scenario 2: Shopping Cart</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-Design-Diagrams"><span class="nav-number">9.</span> <span class="nav-text">6-Design Diagrams</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-Component-Diagram"><span class="nav-number">9.1.</span> <span class="nav-text">6.1 Component Diagram</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-Sequence-Diagram"><span class="nav-number">9.2.</span> <span class="nav-text">6.2 Sequence Diagram</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-Unit-Test-Cases"><span class="nav-number">10.</span> <span class="nav-text">7. Unit Test Cases</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-UserPreferencesComponent-test-tsx"><span class="nav-number">10.1.</span> <span class="nav-text">7.1 UserPreferencesComponent.test.tsx</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-ShoppingCartComponent-test-tsx"><span class="nav-number">10.2.</span> <span class="nav-text">7.2 ShoppingCartComponent.test.tsx</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-Commands-to-Init-and-Add-Dependencies"><span class="nav-number">11.</span> <span class="nav-text">8. Commands to Init and Add Dependencies</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-Conclusion"><span class="nav-number">12.</span> <span class="nav-text">9. Conclusion</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-More-Samples"><span class="nav-number">13.</span> <span class="nav-text">10. More Samples</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#10-1-Project-Setup"><span class="nav-number">13.1.</span> <span class="nav-text">10.1 Project Setup</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#References"><span class="nav-number">14.</span> <span class="nav-text">References</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Dazhi Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">121</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">112</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">71</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/11/04/Best-Practices-for-Local-Storage-Handling-in-ReactJS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Best Practices for Local Storage Handling in ReactJS | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Best Practices for Local Storage Handling in ReactJS
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-11-04 17:49:26 / Modified: 18:48:34" itemprop="dateCreated datePublished" datetime="2024-11-04T17:49:26-05:00">2024-11-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/" itemprop="url" rel="index"><span itemprop="name">Deep Dive</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/ReactJS/" itemprop="url" rel="index"><span itemprop="name">ReactJS</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/ReactJS/Redux/" itemprop="url" rel="index"><span itemprop="name">Redux</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/ReactJS/Redux/Best-Practices/" itemprop="url" rel="index"><span itemprop="name">Best Practices</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#1-local-storage-basics">1. Local Storage Basics</a></li>
<li><a href="#11-project-setup">1.1 Project Setup</a><ul>
<li><a href="#yarn-commands">Yarn Commands</a></li>
</ul>
</li>
<li><a href="#12-project-folder-structure">1.2 Project Folder Structure</a><ul>
<li><a href="#21-what-is-local-storage">2.1 What is Local Storage?</a></li>
<li><a href="#22-local-storage-vs-session-storage">2.2 Local Storage vs Session Storage</a></li>
</ul>
</li>
<li><a href="#3-local-storage-basics">3. Local Storage Basics</a></li>
<li><a href="#31-basic-api">3.1 Basic API</a><ul>
<li><a href="#32-type-safety">3.2 Type Safety</a></li>
<li><a href="#33-error-handling">3.3 Error Handling</a></li>
<li><a href="#34-data-serialization">3.4 Data Serialization</a></li>
<li><a href="#35-expiration-handling">3.5 Expiration Handling</a></li>
</ul>
</li>
<li><a href="#4-best-practices">4. Best Practices</a><ul>
<li><a href="#41-encapsulating-local-storage-access">4.1 Encapsulating Local Storage Access</a></li>
</ul>
</li>
<li><a href="#5-more-scenarios">5 More Scenarios</a><ul>
<li><a href="#51-scenario-1-user-preferences">5.1 Scenario 1: User Preferences</a></li>
<li><a href="#52-scenario-2-shopping-cart">5.2 Scenario 2: Shopping Cart</a></li>
</ul>
</li>
<li><a href="#6-design-diagrams">6-Design Diagrams</a><ul>
<li><a href="#61-component-diagram">6.1 Component Diagram</a></li>
<li><a href="#62-sequence-diagram">6.2 Sequence Diagram</a></li>
</ul>
</li>
<li><a href="#7-unit-test-cases">7. Unit Test Cases</a><ul>
<li><a href="#71-userpreferencescomponenttesttsx">7.1 UserPreferencesComponent.test.tsx</a></li>
<li><a href="#72-shoppingcartcomponenttesttsx">7.2 ShoppingCartComponent.test.tsx</a></li>
</ul>
</li>
<li><a href="#8-commands-to-init-and-add-dependencies">8. Commands to Init and Add Dependencies</a></li>
<li><a href="#9-conclusion">9. Conclusion</a></li>
<li><a href="#10-more-samples">10. More Samples</a><ul>
<li><a href="#101-project-setup">10.1 Project Setup</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Local storage is a powerful tool for persisting data in web applications. In ReactJS, local storage can be used to store user preferences, shopping cart items, and other data that needs to persist across sessions. This article will deep dive into best practices for handling local storage in ReactJS with TypeScript, focusing on functional components and the latest version of the tech stack. We will provide real production scenarios with TypeScript code samples, design diagrams, project folder structures, unit test cases, and commands to initialize and add dependencies using Yarn.</p>
<p><a name="1-local-storage-basics"></a></p>
<h2 id="1-Local-Storage-Basics"><a href="#1-Local-Storage-Basics" class="headerlink" title="1. Local Storage Basics"></a>1. Local Storage Basics</h2><p><a name="11-project-setup"></a></p>
<h2 id="1-1-Project-Setup"><a href="#1-1-Project-Setup" class="headerlink" title="1.1 Project Setup"></a>1.1 Project Setup</h2><p>To get started, we need to set up a React project with TypeScript and add the necessary dependencies using Yarn.</p>
<h3 id="Yarn-Commands"><a href="#Yarn-Commands" class="headerlink" title="Yarn Commands"></a>Yarn Commands</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a React project with TypeScript template</span></span><br><span class="line">yarn create react-app local-storage-app --template typescript</span><br><span class="line"></span><br><span class="line"><span class="comment"># Navigate into the project directory</span></span><br><span class="line"><span class="built_in">cd</span> local-storage-app</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add any additional dependencies if needed (e.g., testing libraries)</span></span><br><span class="line">yarn add @testing-library/react @testing-library/jest-dom</span><br></pre></td></tr></table></figure>

<p><a name="12-project-folder-structure"></a></p>
<h2 id="1-2-Project-Folder-Structure"><a href="#1-2-Project-Folder-Structure" class="headerlink" title="1.2 Project Folder Structure"></a>1.2 Project Folder Structure</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">project-root/</span><br><span class="line">├── src/</span><br><span class="line">│   ├── components/</span><br><span class="line">│   │   ├── UserPreferencesComponent.tsx</span><br><span class="line">│   │   ├── ShoppingCartComponent.tsx</span><br><span class="line">│   ├── hooks/</span><br><span class="line">│   │   └── useLocalStorage.ts</span><br><span class="line">│   ├── utils/</span><br><span class="line">│   │   ├── localStorageUtils.ts</span><br><span class="line">│   ├── App.tsx</span><br><span class="line">│   ├── index.tsx</span><br><span class="line">├── tests/</span><br><span class="line">│   ├── components/</span><br><span class="line">│   │   ├── UserPreferencesComponent.test.tsx</span><br><span class="line">│   │   ├── ShoppingCartComponent.test.tsx</span><br><span class="line">│   ├── utils/</span><br><span class="line">│   │   ├── localStorageUtils.test.ts</span><br><span class="line">├── package.json</span><br><span class="line">├── tsconfig.json</span><br><span class="line">├── yarn.lock</span><br></pre></td></tr></table></figure>

<p><a name="21-what-is-local-storage"></a></p>
<h3 id="2-1-What-is-Local-Storage"><a href="#2-1-What-is-Local-Storage" class="headerlink" title="2.1 What is Local Storage?"></a>2.1 What is Local Storage?</h3><p>Local storage is a web storage API that allows you to store key-value pairs in a web browser. It is a synchronous, persistent storage that allows developers to store data client-side. The data stored in local storage persists even after the browser is closed and reopened. Leveraging local storage in React applications with TypeScript can help maintain user state, save preferences, and reduce API calls.</p>
<p><a name="22-local-storage-vs-session-storage"></a></p>
<h3 id="2-2-Local-Storage-vs-Session-Storage"><a href="#2-2-Local-Storage-vs-Session-Storage" class="headerlink" title="2.2 Local Storage vs Session Storage"></a>2.2 Local Storage vs Session Storage</h3><ul>
<li><strong>Local Storage</strong>: Data persists across browser sessions.</li>
<li><strong>Session Storage</strong>: Data is cleared when the browser session ends (e.g., when the browser is closed).</li>
</ul>
<p><a name="3-local-storage-basics"></a></p>
<h2 id="3-Local-Storage-Basics"><a href="#3-Local-Storage-Basics" class="headerlink" title="3. Local Storage Basics"></a>3. Local Storage Basics</h2><p><a name="31-basic-api"></a></p>
<h2 id="3-1-Basic-API"><a href="#3-1-Basic-API" class="headerlink" title="3.1 Basic API"></a>3.1 Basic API</h2><p>Local storage provides a simple API: <code>setItem()</code>, <code>getItem()</code>, and <code>removeItem()</code>. Data stored in local storage is accessible across browser sessions.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Setting an item</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;key&#x27;</span>, <span class="string">&#x27;value&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Getting an item</span></span><br><span class="line"><span class="keyword">const</span> value = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;key&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Removing an item</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;key&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="32-type-safety"></a></p>
<h3 id="3-2-Type-Safety"><a href="#3-2-Type-Safety" class="headerlink" title="3.2 Type Safety"></a>3.2 Type Safety</h3><p>Use TypeScript to ensure type safety when interacting with local storage. Create utility functions or custom hooks in TypeScript to handle type-safe operations.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">UserPreferences</span> &#123;</span><br><span class="line">  <span class="attr">theme</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">notifications</span>: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> setUserPreferences = (<span class="attr">preferences</span>: <span class="title class_">UserPreferences</span>): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">setLocalStorageItem</span>(<span class="string">&#x27;userPreferences&#x27;</span>, preferences);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getUserPreferences = (): <span class="title class_">UserPreferences</span> | <span class="function"><span class="params">null</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> getLocalStorageItem&lt;<span class="title class_">UserPreferences</span>&gt;(<span class="string">&#x27;userPreferences&#x27;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><a name="33-error-handling"></a></p>
<h3 id="3-3-Error-Handling"><a href="#3-3-Error-Handling" class="headerlink" title="3.3 Error Handling"></a>3.3 Error Handling</h3><p>Handle errors gracefully when interacting with local storage. Wrap local storage operations in <code>try-catch</code> blocks to handle any potential errors gracefully.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> setLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">value</span>: T): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value));</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Error setting local storage item: <span class="subst">$&#123;error&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>): T | <span class="function"><span class="params">null</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> item = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">    <span class="keyword">return</span> item ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(item) : <span class="literal">null</span>;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Error getting local storage item: <span class="subst">$&#123;error&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><a name="34-data-serialization"></a></p>
<h3 id="3-4-Data-Serialization"><a href="#3-4-Data-Serialization" class="headerlink" title="3.4 Data Serialization"></a>3.4 Data Serialization</h3><p>Ensure that data is properly serialized and deserialized when storing and retrieving from local storage. Always serialize complex data structures as strings using <code>JSON.stringify()</code>.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> setLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">value</span>: T): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>): T | <span class="function"><span class="params">null</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> item = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">  <span class="keyword">return</span> item ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(item) : <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><a name="35-expiration-handling"></a></p>
<h3 id="3-5-Expiration-Handling"><a href="#3-5-Expiration-Handling" class="headerlink" title="3.5 Expiration Handling"></a>3.5 Expiration Handling</h3><p>Implement expiration handling for local storage items to ensure that stale data is not used.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">ExpirableItem</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="attr">value</span>: T;</span><br><span class="line">  <span class="attr">expiration</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> setExpirableLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">value</span>: T, <span class="attr">expirationInMinutes</span>: <span class="built_in">number</span>): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> expiration = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>() + expirationInMinutes * <span class="number">60</span> * <span class="number">1000</span>;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">item</span>: <span class="title class_">ExpirableItem</span>&lt;T&gt; = &#123; value, expiration &#125;;</span><br><span class="line">  <span class="title function_">setLocalStorageItem</span>(key, item);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getExpirableLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>): T | <span class="function"><span class="params">null</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> item = getLocalStorageItem&lt;<span class="title class_">ExpirableItem</span>&lt;T&gt;&gt;(key);</span><br><span class="line">  <span class="keyword">if</span> (item &amp;&amp; item.<span class="property">expiration</span> &gt; <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>()) &#123;</span><br><span class="line">    <span class="keyword">return</span> item.<span class="property">value</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">removeLocalStorageItem</span>(key);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>


<p><a name="4-best-practices"></a></p>
<h2 id="4-Best-Practices"><a href="#4-Best-Practices" class="headerlink" title="4. Best Practices"></a>4. Best Practices</h2><p><a name="41-encapsulating-local-storage-access"></a></p>
<h3 id="4-1-Encapsulating-Local-Storage-Access"><a href="#4-1-Encapsulating-Local-Storage-Access" class="headerlink" title="4.1 Encapsulating Local Storage Access"></a>4.1 Encapsulating Local Storage Access</h3><p>Encapsulate local storage logic inside React hooks or service functions to keep components clean. Encapsulate local storage access within utility functions to avoid code duplication and improve maintainability.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> setLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">value</span>: T): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>): T | <span class="function"><span class="params">null</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> item = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">  <span class="keyword">return</span> item ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(item) : <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> removeLocalStorageItem = (<span class="attr">key</span>: <span class="built_in">string</span>): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(key);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><a name="5-more-scenarios"></a></p>
<h2 id="5-More-Scenarios"><a href="#5-More-Scenarios" class="headerlink" title="5 More Scenarios"></a>5 More Scenarios</h2><p><a name="51-scenario-1-user-preferences"></a></p>
<h3 id="5-1-Scenario-1-User-Preferences"><a href="#5-1-Scenario-1-User-Preferences" class="headerlink" title="5.1 Scenario 1: User Preferences"></a>5.1 Scenario 1: User Preferences</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; setUserPreferences, getUserPreferences &#125; <span class="keyword">from</span> <span class="string">&#x27;./localStorageUtils&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">UserPreferences</span> &#123;</span><br><span class="line">  <span class="attr">theme</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">notifications</span>: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">UserPreferencesComponent</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [preferences, setPreferences] = useState&lt;<span class="title class_">UserPreferences</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> storedPreferences = <span class="title function_">getUserPreferences</span>();</span><br><span class="line">    <span class="keyword">if</span> (storedPreferences) &#123;</span><br><span class="line">      <span class="title function_">setPreferences</span>(storedPreferences);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleThemeChange</span> = (<span class="params"><span class="attr">theme</span>: <span class="built_in">string</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> updatedPreferences = &#123; ...preferences, theme &#125; <span class="keyword">as</span> <span class="title class_">UserPreferences</span>;</span><br><span class="line">    <span class="title function_">setUserPreferences</span>(updatedPreferences);</span><br><span class="line">    <span class="title function_">setPreferences</span>(updatedPreferences);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleNotificationsChange</span> = (<span class="params"><span class="attr">notifications</span>: <span class="built_in">boolean</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> updatedPreferences = &#123; ...preferences, notifications &#125; <span class="keyword">as</span> <span class="title class_">UserPreferences</span>;</span><br><span class="line">    <span class="title function_">setUserPreferences</span>(updatedPreferences);</span><br><span class="line">    <span class="title function_">setPreferences</span>(updatedPreferences);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>User Preferences<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>Theme:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">value</span>=<span class="string">&#123;preferences?.theme&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> handleThemeChange(e.target.value)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;light&quot;</span>&gt;</span>Light<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;dark&quot;</span>&gt;</span>Dark<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>Notifications:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">checked</span>=<span class="string">&#123;preferences?.notifications&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> handleNotificationsChange(e.target.checked)&#125;</span></span><br><span class="line"><span class="language-xml">        /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">UserPreferencesComponent</span>;</span><br></pre></td></tr></table></figure>

<p><a name="52-scenario-2-shopping-cart"></a></p>
<h3 id="5-2-Scenario-2-Shopping-Cart"><a href="#5-2-Scenario-2-Shopping-Cart" class="headerlink" title="5.2 Scenario 2: Shopping Cart"></a>5.2 Scenario 2: Shopping Cart</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; setLocalStorageItem, getLocalStorageItem, removeLocalStorageItem &#125; <span class="keyword">from</span> <span class="string">&#x27;./localStorageUtils&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">CartItem</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ShoppingCartComponent</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [cartItems, setCartItems] = useState&lt;<span class="title class_">CartItem</span>[]&gt;([]);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> storedCartItems = getLocalStorageItem&lt;<span class="title class_">CartItem</span>[]&gt;(<span class="string">&#x27;cartItems&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (storedCartItems) &#123;</span><br><span class="line">      <span class="title function_">setCartItems</span>(storedCartItems);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">addToCart</span> = (<span class="params"><span class="attr">item</span>: <span class="title class_">CartItem</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> updatedCartItems = [...cartItems, item];</span><br><span class="line">    <span class="title function_">setLocalStorageItem</span>(<span class="string">&#x27;cartItems&#x27;</span>, updatedCartItems);</span><br><span class="line">    <span class="title function_">setCartItems</span>(updatedCartItems);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">removeFromCart</span> = (<span class="params"><span class="attr">id</span>: <span class="built_in">number</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> updatedCartItems = cartItems.<span class="title function_">filter</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">id</span> !== id);</span><br><span class="line">    <span class="title function_">setLocalStorageItem</span>(<span class="string">&#x27;cartItems&#x27;</span>, updatedCartItems);</span><br><span class="line">    <span class="title function_">setCartItems</span>(updatedCartItems);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Shopping Cart<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;cartItems.map((item) =&gt; (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;item.name&#125; - $&#123;item.price&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> removeFromCart(item.id)&#125;&gt;Remove<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        ))&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> addToCart(&#123; id: Date.now(), name: &#x27;New Item&#x27;, price: 10 &#125;)&#125;&gt;Add Item<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">ShoppingCartComponent</span>;</span><br></pre></td></tr></table></figure>

<p><a name="6-design-diagrams"></a></p>
<h2 id="6-Design-Diagrams"><a href="#6-Design-Diagrams" class="headerlink" title="6-Design Diagrams"></a>6-Design Diagrams</h2><p><a name="61-component-diagram"></a></p>
<h3 id="6-1-Component-Diagram"><a href="#6-1-Component-Diagram" class="headerlink" title="6.1 Component Diagram"></a>6.1 Component Diagram</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| App               |       | UserPreferences   |       | ShoppingCart      |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (1) User Preferences      |                           |</span><br><span class="line">        |--------------------------&gt;|                           |</span><br><span class="line">        |                           | (2) Shopping Cart         |</span><br><span class="line">        |                           |--------------------------&gt;|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (3) Local Storage         |                           |</span><br><span class="line">        |&lt;--------------------------|                           |</span><br><span class="line">        |                           |                           |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| App               |       | UserPreferences   |       | ShoppingCart      |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br></pre></td></tr></table></figure>

<p><a name="62-sequence-diagram"></a></p>
<h3 id="6-2-Sequence-Diagram"><a href="#6-2-Sequence-Diagram" class="headerlink" title="6.2 Sequence Diagram"></a>6.2 Sequence Diagram</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| User              |       | UserPreferences   |       | Local Storage     |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (1) Change Theme          |                           |</span><br><span class="line">        |--------------------------&gt;|                           |</span><br><span class="line">        |                           | (2) Update Preferences    |</span><br><span class="line">        |                           |--------------------------&gt;|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (3) Store Preferences     |                           |</span><br><span class="line">        |&lt;--------------------------|                           |</span><br><span class="line">        |                           |                           |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| User              |       | UserPreferences   |       | Local Storage     |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br></pre></td></tr></table></figure>



<p><a name="7-unit-test-cases"></a></p>
<h2 id="7-Unit-Test-Cases"><a href="#7-Unit-Test-Cases" class="headerlink" title="7. Unit Test Cases"></a>7. Unit Test Cases</h2><p><a name="71-user-preferences-component-test"></a></p>
<h3 id="7-1-UserPreferencesComponent-test-tsx"><a href="#7-1-UserPreferencesComponent-test-tsx" class="headerlink" title="7.1 UserPreferencesComponent.test.tsx"></a>7.1 UserPreferencesComponent.test.tsx</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render, fireEvent &#125; <span class="keyword">from</span> <span class="string">&#x27;@testing-library/react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UserPreferencesComponent</span> <span class="keyword">from</span> <span class="string">&#x27;../../src/components/UserPreferencesComponent&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; setUserPreferences, getUserPreferences &#125; <span class="keyword">from</span> <span class="string">&#x27;../../src/utils/localStorageUtils&#x27;</span>;</span><br><span class="line"></span><br><span class="line">jest.<span class="title function_">mock</span>(<span class="string">&#x27;../../src/utils/localStorageUtils&#x27;</span>, <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">  <span class="attr">setUserPreferences</span>: jest.<span class="title function_">fn</span>(),</span><br><span class="line">  <span class="attr">getUserPreferences</span>: jest.<span class="title function_">fn</span>(),</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;UserPreferencesComponent updates and retrieves preferences&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  (getUserPreferences <span class="keyword">as</span> jest.<span class="property">Mock</span>).<span class="title function_">mockReturnValue</span>(&#123; <span class="attr">theme</span>: <span class="string">&#x27;light&#x27;</span>, <span class="attr">notifications</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; getByLabelText, getByText &#125; = <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">UserPreferencesComponent</span> /&gt;</span></span>);</span><br><span class="line"></span><br><span class="line">  fireEvent.<span class="title function_">change</span>(<span class="title function_">getByLabelText</span>(<span class="string">&#x27;Theme:&#x27;</span>), &#123; <span class="attr">target</span>: &#123; <span class="attr">value</span>: <span class="string">&#x27;dark&#x27;</span> &#125; &#125;);</span><br><span class="line">  <span class="title function_">expect</span>(setUserPreferences).<span class="title function_">toHaveBeenCalledWith</span>(&#123; <span class="attr">theme</span>: <span class="string">&#x27;dark&#x27;</span>, <span class="attr">notifications</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"></span><br><span class="line">  fireEvent.<span class="title function_">click</span>(<span class="title function_">getByLabelText</span>(<span class="string">&#x27;Notifications:&#x27;</span>));</span><br><span class="line">  <span class="title function_">expect</span>(setUserPreferences).<span class="title function_">toHaveBeenCalledWith</span>(&#123; <span class="attr">theme</span>: <span class="string">&#x27;dark&#x27;</span>, <span class="attr">notifications</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><a name="72-shopping-cart-component-test"></a></p>
<h3 id="7-2-ShoppingCartComponent-test-tsx"><a href="#7-2-ShoppingCartComponent-test-tsx" class="headerlink" title="7.2 ShoppingCartComponent.test.tsx"></a>7.2 ShoppingCartComponent.test.tsx</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render, fireEvent &#125; <span class="keyword">from</span> <span class="string">&#x27;@testing-library/react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ShoppingCartComponent</span> <span class="keyword">from</span> <span class="string">&#x27;../../src/components/ShoppingCartComponent&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; setLocalStorageItem, getLocalStorageItem, removeLocalStorageItem &#125; <span class="keyword">from</span> <span class="string">&#x27;../../src/utils/localStorageUtils&#x27;</span>;</span><br><span class="line"></span><br><span class="line">jest.<span class="title function_">mock</span>(<span class="string">&#x27;../../src/utils/localStorageUtils&#x27;</span>, <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">  <span class="attr">setLocalStorageItem</span>: jest.<span class="title function_">fn</span>(),</span><br><span class="line">  <span class="attr">getLocalStorageItem</span>: jest.<span class="title function_">fn</span>(),</span><br><span class="line">  <span class="attr">removeLocalStorageItem</span>: jest.<span class="title function_">fn</span>(),</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;ShoppingCartComponent adds and removes items&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  (getLocalStorageItem <span class="keyword">as</span> jest.<span class="property">Mock</span>).<span class="title function_">mockReturnValue</span>([&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;Item 1&#x27;</span>, <span class="attr">price</span>: <span class="number">10</span> &#125;]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; getByText &#125; = <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">ShoppingCartComponent</span> /&gt;</span></span>);</span><br><span class="line"></span><br><span class="line">  fireEvent.<span class="title function_">click</span>(<span class="title function_">getByText</span>(<span class="string">&#x27;Add Item&#x27;</span>));</span><br><span class="line">  <span class="title function_">expect</span>(setLocalStorageItem).<span class="title function_">toHaveBeenCalled</span>();</span><br><span class="line"></span><br><span class="line">  fireEvent.<span class="title function_">click</span>(<span class="title function_">getByText</span>(<span class="string">&#x27;Remove&#x27;</span>));</span><br><span class="line">  <span class="title function_">expect</span>(removeLocalStorageItem).<span class="title function_">toHaveBeenCalled</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><a name="8-commands-to-init-and-add-dependencies"></a></p>
<h2 id="8-Commands-to-Init-and-Add-Dependencies"><a href="#8-Commands-to-Init-and-Add-Dependencies" class="headerlink" title="8. Commands to Init and Add Dependencies"></a>8. Commands to Init and Add Dependencies</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Initialize a new React project with TypeScript</span></span><br><span class="line">yarn create react-app my-app --template typescript</span><br><span class="line"></span><br><span class="line"><span class="comment"># Navigate to the project directory</span></span><br><span class="line"><span class="built_in">cd</span> my-app</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add Testing Library</span></span><br><span class="line">yarn add --dev @testing-library/react @testing-library/jest-dom</span><br></pre></td></tr></table></figure>

<p><a name="9-conclusion"></a></p>
<h2 id="9-Conclusion"><a href="#9-Conclusion" class="headerlink" title="9. Conclusion"></a>9. Conclusion</h2><p>Local storage is a powerful tool for persisting data in web applications. This article provided a deep dive into best practices for handling local storage in ReactJS with TypeScript, focusing on functional components and the latest version of the tech stack. We explored real production scenarios with TypeScript code samples, design diagrams, project folder structures, unit test cases, and commands to initialize and add dependencies using Yarn.</p>
<p>By understanding and applying these best practices, developers can effectively manage local storage in their ReactJS applications, ensuring they remain scalable, maintainable, and performant.</p>
<p><a name="10-more-samples"></a></p>
<h2 id="10-More-Samples"><a href="#10-More-Samples" class="headerlink" title="10. More Samples"></a>10. More Samples</h2><p><a name="101-project-setup"></a></p>
<h3 id="10-1-Project-Setup"><a href="#10-1-Project-Setup" class="headerlink" title="10.1 Project Setup"></a>10.1 Project Setup</h3><p>To get started, we need to set up a React project with TypeScript and add the necessary dependencies using Yarn.</p>
<blockquote>
<p><strong>Yarn Commands</strong></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a React project with TypeScript template</span></span><br><span class="line">yarn create react-app local-storage-app --template typescript</span><br><span class="line"></span><br><span class="line"><span class="comment"># Navigate into the project directory</span></span><br><span class="line"><span class="built_in">cd</span> local-storage-app</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add any additional dependencies if needed (e.g., testing libraries)</span></span><br><span class="line">yarn add @testing-library/react @testing-library/jest-dom</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Project Folder Structure</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">local-storage-app/</span><br><span class="line">├── src/</span><br><span class="line">│   ├── components/</span><br><span class="line">│   │   ├── LocalStorageHandler.tsx</span><br><span class="line">│   │   └── UserPreferences.tsx</span><br><span class="line">│   ├── hooks/</span><br><span class="line">│   │   └── useLocalStorage.ts</span><br><span class="line">│   ├── tests/</span><br><span class="line">│   │   └── LocalStorageHandler.test.tsx</span><br><span class="line">│   ├── App.tsx</span><br><span class="line">│   └── index.tsx</span><br><span class="line">├── public/</span><br><span class="line">└── package.json</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>useLocalStorage.ts</strong></p>
</blockquote>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/hooks/useLocalStorage.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Custom hook for local storage handling</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">key</span> - The key under which data is stored in local storage</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">initialValue</span> - The initial value to use if no value is stored</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> A tuple containing the stored value and a function to set the value</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> useLocalStorage&lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">initialValue</span>: T) &#123;</span><br><span class="line">  <span class="keyword">const</span> [storedValue, setStoredValue] = useState&lt;T&gt;(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> item = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">      <span class="keyword">return</span> item ? (<span class="title class_">JSON</span>.<span class="title function_">parse</span>(item) <span class="keyword">as</span> T) : initialValue;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error reading from local storage&#x27;</span>, error);</span><br><span class="line">      <span class="keyword">return</span> initialValue;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Sets a new value in local storage</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> <span class="variable">value</span> - The new value to store</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">setValue</span> = (<span class="params"><span class="attr">value</span>: T</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="title function_">setStoredValue</span>(value);</span><br><span class="line">      <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error saving to local storage&#x27;</span>, error);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> [storedValue, setValue] <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useLocalStorage;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>UserPreferences</strong>: Detailed Code for Using <code>useLocalStorage</code> in a Component</p>
</blockquote>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/components/UserPreferences.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> useLocalStorage <span class="keyword">from</span> <span class="string">&#x27;../hooks/useLocalStorage&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">UserPreferences</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Using the custom hook to manage theme preference</span></span><br><span class="line">  <span class="keyword">const</span> [theme, setTheme] = useLocalStorage&lt;<span class="built_in">string</span>&gt;(<span class="string">&#x27;theme&#x27;</span>, <span class="string">&#x27;light&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Toggles between &#x27;light&#x27; and &#x27;dark&#x27; themes</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">toggleTheme</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setTheme</span>(theme === <span class="string">&#x27;light&#x27;</span> ? <span class="string">&#x27;dark&#x27;</span> : <span class="string">&#x27;light&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>User Preferences<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Current theme: &#123;theme&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;toggleTheme&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        Toggle Theme</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">UserPreferences</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Type-Safe</strong> Local Storage Utility Functions<br>For larger applications, you might prefer having utility functions to handle local storage logic:</p>
</blockquote>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/utils/localStorageUtils.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">defaultValue</span>: T): <span class="function"><span class="params">T</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> storedItem = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key);</span><br><span class="line">    <span class="keyword">return</span> storedItem ? (<span class="title class_">JSON</span>.<span class="title function_">parse</span>(storedItem) <span class="keyword">as</span> T) : defaultValue;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Error reading key &quot;<span class="subst">$&#123;key&#125;</span>&quot; from local storage`</span>, error);</span><br><span class="line">    <span class="keyword">return</span> defaultValue;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> setLocalStorageItem = &lt;T&gt;(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">value</span>: T): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(value));</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Error setting key &quot;<span class="subst">$&#123;key&#125;</span>&quot; in local storage`</span>, error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Detailed Unit Test Cases</p>
</blockquote>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/tests/useLocalStorage.test.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; renderHook, act &#125; <span class="keyword">from</span> <span class="string">&#x27;@testing-library/react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> useLocalStorage <span class="keyword">from</span> <span class="string">&#x27;../hooks/useLocalStorage&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;useLocalStorage hook&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">beforeEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">clear</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should return initial value if no value is stored&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; result &#125; = <span class="title function_">renderHook</span>(<span class="function">() =&gt;</span> <span class="title function_">useLocalStorage</span>(<span class="string">&#x27;testKey&#x27;</span>, <span class="string">&#x27;initialValue&#x27;</span>));</span><br><span class="line">    <span class="title function_">expect</span>(result.<span class="property">current</span>[<span class="number">0</span>]).<span class="title function_">toBe</span>(<span class="string">&#x27;initialValue&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should save and retrieve a value&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; result &#125; = <span class="title function_">renderHook</span>(<span class="function">() =&gt;</span> <span class="title function_">useLocalStorage</span>(<span class="string">&#x27;testKey&#x27;</span>, <span class="string">&#x27;initialValue&#x27;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="title function_">act</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      result.<span class="property">current</span>[<span class="number">1</span>](<span class="string">&#x27;newValue&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(result.<span class="property">current</span>[<span class="number">0</span>]).<span class="title function_">toBe</span>(<span class="string">&#x27;newValue&#x27;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;testKey&#x27;</span>)).<span class="title function_">toBe</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="string">&#x27;newValue&#x27;</span>));</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should handle JSON parsing errors gracefully&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;testKey&#x27;</span>, <span class="string">&#x27;&#123;invalid JSON&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> &#123; result &#125; = <span class="title function_">renderHook</span>(<span class="function">() =&gt;</span> <span class="title function_">useLocalStorage</span>(<span class="string">&#x27;testKey&#x27;</span>, <span class="string">&#x27;defaultValue&#x27;</span>));</span><br><span class="line">    <span class="title function_">expect</span>(result.<span class="property">current</span>[<span class="number">0</span>]).<span class="title function_">toBe</span>(<span class="string">&#x27;defaultValue&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Commands to Run Unit Tests</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Run unit tests with Yarn</span></span><br><span class="line">yarn <span class="built_in">test</span></span><br></pre></td></tr></table></figure>


<p><a name="references"></a></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://reactjs.org/docs/getting-started.html">React Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/">TypeScript Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API">Web Storage API</a></li>
<li><a target="_blank" rel="noopener" href="https://testing-library.com/docs/react-testing-library/intro">Testing Library</a></li>
</ul>
<hr>
<p>This article provides a comprehensive guide to best practices for local storage handling in ReactJS with TypeScript, including detailed code samples, design diagrams, project folder structures, unit test cases, and commands to initialize and add dependencies using Yarn. By understanding and applying these practices, developers can leverage the full potential of local storage in their ReactJS projects.</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Deep-Dive/" rel="tag"><i class="fa fa-tag"></i> Deep Dive</a>
              <a href="/tags/ReactJS/" rel="tag"><i class="fa fa-tag"></i> ReactJS</a>
              <a href="/tags/Redux/" rel="tag"><i class="fa fa-tag"></i> Redux</a>
              <a href="/tags/Best-Practices/" rel="tag"><i class="fa fa-tag"></i> Best Practices</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/11/04/Deep-Dive-into-State-Management-in-ReactJS/" rel="prev" title="Deep Dive into State Management in ReactJS">
                  <i class="fa fa-angle-left"></i> Deep Dive into State Management in ReactJS
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/11/04/Best-Practices-for-Spring-Application-Health-Check-and-Actuator/" rel="next" title="Best Practices for Spring Application Health Check and Actuator">
                  Best Practices for Spring Application Health Check and Actuator <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Dazhi Zhang</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.1/mermaid.min.js","integrity":"sha256-YbM1pG3wWnzhyYN49g5fPnen+2CKEFaZfopkkwSpNtY="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  





</body>
</html>
