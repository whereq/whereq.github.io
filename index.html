<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.whereq.com","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.21.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="WhereQ">
<meta property="og:url" content="https://www.whereq.com/index.html">
<meta property="og:site_name" content="WhereQ">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Dazhi Zhang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.whereq.com/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>WhereQ</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">WhereQ</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-articles"><a href="/articles/" rel="section"><i class="fa fa-file fa-fw"></i>Articles</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Dazhi Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">58</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">44</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">32</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/28/Spark-in-Kubernetes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/28/Spark-in-Kubernetes/" class="post-title-link" itemprop="url">Spark in Kubernetes</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-10-28 11:55:22 / Modified: 12:09:57" itemprop="dateCreated datePublished" datetime="2024-10-28T11:55:22-04:00">2024-10-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Kubernetes/Spark/" itemprop="url" rel="index"><span itemprop="name">Spark</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#architecture-overview">Architecture Overview</a><ul>
<li><a href="#diagram-architecture-overview">Diagram: Architecture Overview</a></li>
</ul>
</li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#1-configuring-google-cloud-storage-gcs-bucket">1. Configuring Google Cloud Storage (GCS) Bucket</a></li>
<li><a href="#2-deploying-postgresql-for-hive-metadata">2. Deploying PostgreSQL for Hive Metadata</a><ul>
<li><a href="#postgresql-yaml">PostgreSQL YAML</a></li>
</ul>
</li>
<li><a href="#3-installing-hive-metastore">3. Installing Hive Metastore</a><ul>
<li><a href="#hive-configuration">Hive Configuration</a></li>
</ul>
</li>
<li><a href="#4-deploying-spark-master-and-workers">4. Deploying Spark Master and Workers</a><ul>
<li><a href="#spark-master-and-worker-statefulset-yaml">Spark Master and Worker StatefulSet YAML</a></li>
</ul>
</li>
<li><a href="#5-setting-up-the-spark-history-server">5. Setting Up the Spark History Server</a><ul>
<li><a href="#spark-history-server-yaml">Spark History Server YAML</a></li>
</ul>
</li>
<li><a href="#6-configuring-ingress">6. Configuring Ingress</a><ul>
<li><a href="#ingress-yaml">Ingress YAML</a></li>
</ul>
</li>
<li><a href="#7-testing-the-deployment-with-spark-job">7. Testing the Deployment with Spark Job</a></li>
<li><a href="#furthermore">Furthermore</a><ul>
<li><a href="#statefulset-vs-deployment">StatefulSet vs Deployment</a></li>
<li><a href="#1-spark-master-and-worker-as-statefulsets">1. <strong>Spark Master and Worker as StatefulSets</strong></a></li>
<li><a href="#2-spark-history-server-as-a-deployment">2. <strong>Spark History Server as a Deployment</strong></a></li>
</ul>
</li>
<li><a href="#summary-table">Summary Table</a></li>
</ul>
<hr>
<p>This guide covers the steps to deploy an Apache Spark cluster with a master, two workers, and a Spark History Server on Kubernetes. It configures a GCS bucket as the default file system and installs Hive with PostgreSQL as its backend. An Ingress is set up for accessing the Spark UI and History Server.</p>
<p><a name="architecture-overview"></a></p>
<h2 id="Architecture-Overview"><a href="#Architecture-Overview" class="headerlink" title="Architecture Overview"></a>Architecture Overview</h2><p>The setup includes the following components:</p>
<ul>
<li><strong>Spark Master and Workers</strong>: Deployed using StatefulSets for stable identity and persistence.</li>
<li><strong>History Server</strong>: Deployed using a Deployment and configured to store Spark event logs in GCS.</li>
<li><strong>Hive and PostgreSQL</strong>: PostgreSQL is used as the backend for Hive metadata, and Hive is deployed to store Spark tables.</li>
<li><strong>Ingress</strong>: Provides external access to Spark Master UI and History Server UI.</li>
</ul>
<h3 id="Diagram-Architecture-Overview"><a href="#Diagram-Architecture-Overview" class="headerlink" title="Diagram: Architecture Overview"></a>Diagram: Architecture Overview</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">+---------------------------+</span><br><span class="line">|                           |</span><br><span class="line">|        Kubernetes         |</span><br><span class="line">|                           |</span><br><span class="line">+---------------------------+</span><br><span class="line">|                           |</span><br><span class="line">|  +---------+   +---------+|</span><br><span class="line">|  |  Spark  |   |  Spark  ||</span><br><span class="line">|  |  Master |   | Workers ||</span><br><span class="line">|  +---------+   +---------+|</span><br><span class="line">|                           |</span><br><span class="line">|        +-----------+      |</span><br><span class="line">|        |  History  |      |</span><br><span class="line">|        |  Server   |      |</span><br><span class="line">|        +-----------+      |</span><br><span class="line">|            |              |</span><br><span class="line">|         Ingress           |</span><br><span class="line">+---------------------------+</span><br><span class="line">           |</span><br><span class="line">    External Access</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="prerequisites"></a></p>
<h2 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h2><ul>
<li><strong>Kubernetes Cluster</strong> with access to deploy resources.</li>
<li><strong>kubectl</strong> command-line tool configured to access the cluster.</li>
<li><strong>Helm</strong> for deploying Hive and PostgreSQL.</li>
<li><strong>Google Cloud Storage (GCS)</strong> bucket created for Spark event logs.</li>
<li><strong>Google Cloud SDK</strong> installed and configured for authentication to GCS.</li>
</ul>
<hr>
<p><a name="1-configuring-google-cloud-storage-gcs-bucket"></a></p>
<h2 id="1-Configuring-Google-Cloud-Storage-GCS-Bucket"><a href="#1-Configuring-Google-Cloud-Storage-GCS-Bucket" class="headerlink" title="1. Configuring Google Cloud Storage (GCS) Bucket"></a>1. Configuring Google Cloud Storage (GCS) Bucket</h2><ol>
<li><p>Create a GCS bucket if not already created:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gsutil mb gs://your-spark-event-logs</span><br></pre></td></tr></table></figure>
</li>
<li><p>Set up a GCS service account key and save it as a Kubernetes secret. This will allow Spark to access GCS:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl create secret generic gcs-key \</span><br><span class="line">--from-file=key.json=/path/to/gcs-service-account-key.json</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<p><a name="2-deploying-postgresql-for-hive-metadata"></a></p>
<h2 id="2-Deploying-PostgreSQL-for-Hive-Metadata"><a href="#2-Deploying-PostgreSQL-for-Hive-Metadata" class="headerlink" title="2. Deploying PostgreSQL for Hive Metadata"></a>2. Deploying PostgreSQL for Hive Metadata</h2><p>PostgreSQL will act as the relational database for Hive’s metadata.</p>
<h3 id="PostgreSQL-YAML"><a href="#PostgreSQL-YAML" class="headerlink" title="PostgreSQL YAML"></a>PostgreSQL YAML</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolumeClaim</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">postgresql-pvc</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">accessModes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ReadWriteOnce</span></span><br><span class="line">  <span class="attr">resources:</span></span><br><span class="line">    <span class="attr">requests:</span></span><br><span class="line">      <span class="attr">storage:</span> <span class="string">5Gi</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">postgresql</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">postgresql</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">postgresql</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">postgresql</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">postgres:13</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">POSTGRES_DB</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;hive_metastore&quot;</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">POSTGRES_USER</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;hiveuser&quot;</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">POSTGRES_PASSWORD</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;hivepassword&quot;</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">&quot;/var/lib/postgresql/data&quot;</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">postgresql-data</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">postgresql-data</span></span><br><span class="line">        <span class="attr">persistentVolumeClaim:</span></span><br><span class="line">          <span class="attr">claimName:</span> <span class="string">postgresql-pvc</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="3-installing-hive-metastore"></a></p>
<h2 id="3-Installing-Hive-Metastore"><a href="#3-Installing-Hive-Metastore" class="headerlink" title="3. Installing Hive Metastore"></a>3. Installing Hive Metastore</h2><p>Hive Metastore will manage metadata for Spark. </p>
<h3 id="Hive-Configuration"><a href="#Hive-Configuration" class="headerlink" title="Hive Configuration"></a>Hive Configuration</h3><ol>
<li><p>Download and install Hive Helm chart:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">helm repo add bitnami https://charts.bitnami.com/bitnami</span><br><span class="line">helm install hive bitnami/hive --<span class="built_in">set</span> postgresql.enabled=<span class="literal">false</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Update Hive configuration to use PostgreSQL.</p>
</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Values.yaml for Hive</span></span><br><span class="line"><span class="attr">hive:</span></span><br><span class="line">  <span class="attr">metastore:</span></span><br><span class="line">    <span class="attr">databaseType:</span> <span class="string">postgres</span></span><br><span class="line">    <span class="attr">jdbcUrl:</span> <span class="string">jdbc:postgresql://postgresql-service/hive_metastore</span></span><br><span class="line">    <span class="attr">user:</span> <span class="string">hiveuser</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">hivepassword</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="4-deploying-spark-master-and-workers"></a></p>
<h2 id="4-Deploying-Spark-Master-and-Workers"><a href="#4-Deploying-Spark-Master-and-Workers" class="headerlink" title="4. Deploying Spark Master and Workers"></a>4. Deploying Spark Master and Workers</h2><h3 id="Spark-Master-and-Worker-StatefulSet-YAML"><a href="#Spark-Master-and-Worker-StatefulSet-YAML" class="headerlink" title="Spark Master and Worker StatefulSet YAML"></a>Spark Master and Worker StatefulSet YAML</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StatefulSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">spark-master</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">serviceName:</span> <span class="string">spark-master</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">spark</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">spark</span></span><br><span class="line">        <span class="attr">role:</span> <span class="string">master</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">spark-master</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">spark:latest</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">7077</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">8080</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">SPARK_MASTER_HOST</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;spark-master&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StatefulSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">spark-worker</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">spark</span></span><br><span class="line">      <span class="attr">role:</span> <span class="string">worker</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">spark</span></span><br><span class="line">        <span class="attr">role:</span> <span class="string">worker</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">spark-worker</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">spark:latest</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">8081</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">SPARK_WORKER_CORES</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;1&quot;</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">SPARK_WORKER_MEMORY</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;1G&quot;</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">SPARK_MASTER</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;spark://spark-master:7077&quot;</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="5-setting-up-the-spark-history-server"></a></p>
<h2 id="5-Setting-Up-the-Spark-History-Server"><a href="#5-Setting-Up-the-Spark-History-Server" class="headerlink" title="5. Setting Up the Spark History Server"></a>5. Setting Up the Spark History Server</h2><p>The History Server will read event logs from the GCS bucket for job history.</p>
<h3 id="Spark-History-Server-YAML"><a href="#Spark-History-Server-YAML" class="headerlink" title="Spark History Server YAML"></a>Spark History Server YAML</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">spark-history-server</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">spark-history</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">spark-history</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">spark-history-server</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">spark:latest</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">SPARK_HISTORY_OPTS</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;-Dspark.history.fs.logDirectory=gs://your-spark-event-logs&quot;</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/opt/spark/work-dir</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">gcs-key</span></span><br><span class="line">          <span class="attr">subPath:</span> <span class="string">key.json</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">gcs-key</span></span><br><span class="line">        <span class="attr">secret:</span></span><br><span class="line">          <span class="attr">secretName:</span> <span class="string">gcs-key</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="6-configuring-ingress"></a></p>
<h2 id="6-Configuring-Ingress"><a href="#6-Configuring-Ingress" class="headerlink" title="6. Configuring Ingress"></a>6. Configuring Ingress</h2><p>Ingress will expose the Spark Master UI and History Server UI.</p>
<h3 id="Ingress-YAML"><a href="#Ingress-YAML" class="headerlink" title="Ingress YAML"></a>Ingress YAML</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">spark-ingress</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">spark.example.com</span></span><br><span class="line">    <span class="attr">http:</span></span><br><span class="line">      <span class="attr">paths:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">path:</span> <span class="string">/master</span></span><br><span class="line">        <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">        <span class="attr">backend:</span></span><br><span class="line">          <span class="attr">service:</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">spark-master</span></span><br><span class="line">            <span class="attr">port:</span></span><br><span class="line">              <span class="attr">number:</span> <span class="number">8080</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">path:</span> <span class="string">/history</span></span><br><span class="line">        <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">        <span class="attr">backend:</span></span><br><span class="line">          <span class="attr">service:</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">spark-history-server</span></span><br><span class="line">            <span class="attr">port:</span></span><br><span class="line">              <span class="attr">number:</span> <span class="number">18080</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="7-testing-the-deployment-with-spark-job"></a></p>
<h2 id="7-Testing-the-Deployment-with-Spark-Job"><a href="#7-Testing-the-Deployment-with-Spark-Job" class="headerlink" title="7. Testing the Deployment with Spark Job"></a>7. Testing the Deployment with Spark Job</h2><p>To verify the installation, use <code>spark-submit</code> to run a simple calculation for PI.</p>
<ol>
<li><p>Submit a PI calculation job using <code>spark-submit</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kubectl <span class="built_in">exec</span> -it spark-master-0 -- spark-submit \</span><br><span class="line">--class org.apache.spark.examples.SparkPi \</span><br><span class="line">--master spark://spark-master:7077 \</span><br><span class="line">/opt/spark/examples/jars/spark-examples_2.12-3.0.1.jar 1000</span><br></pre></td></tr></table></figure>
</li>
<li><p>Check the Spark Master and History Server UIs</p>
</li>
</ol>
<p> to confirm job execution and view logs.</p>
<h2 id="Furthermore"><a href="#Furthermore" class="headerlink" title="Furthermore"></a>Furthermore</h2><h3 id="StatefulSet-vs-Deployment"><a href="#StatefulSet-vs-Deployment" class="headerlink" title="StatefulSet vs Deployment"></a>StatefulSet vs Deployment</h3><p>In the official Helm chart for Apache Spark, the choice of <strong>StatefulSet</strong> for Spark Master and Worker, and <strong>Deployment</strong> for the Spark History Server, aligns with the specific requirements and behaviors of each component. Here’s a breakdown of the reasons for these design choices:</p>
<h3 id="1-Spark-Master-and-Worker-as-StatefulSets"><a href="#1-Spark-Master-and-Worker-as-StatefulSets" class="headerlink" title="1. Spark Master and Worker as StatefulSets"></a>1. <strong>Spark Master and Worker as StatefulSets</strong></h3><ul>
<li><strong>Persistence and Stability</strong>: The Spark Master and Worker nodes need stable, unique identities to communicate reliably. Using <strong>StatefulSet</strong> ensures that each replica (instance) has a stable network identity (hostname) and, if configured, persistent storage.</li>
<li><strong>Leader Election and Failover</strong>: Spark Master in standalone mode has a primary leader and backup node architecture, where the leader is responsible for the cluster state. StatefulSets allow these nodes to maintain consistent, unique identifiers, which is crucial for leader election and failover without disrupting the Spark cluster.</li>
<li><strong>Worker Registration</strong>: Spark Workers register with the Master, and having a unique, stable network identity ensures workers don’t inadvertently re-register or conflict with each other after restarts or failures. StatefulSets are the preferred way to handle this kind of behavior.</li>
</ul>
<h3 id="2-Spark-History-Server-as-a-Deployment"><a href="#2-Spark-History-Server-as-a-Deployment" class="headerlink" title="2. Spark History Server as a Deployment"></a>2. <strong>Spark History Server as a Deployment</strong></h3><ul>
<li><strong>Stateless Operation</strong>: The Spark History Server is fundamentally a stateless application. It reads from a pre-configured storage (such as HDFS or S3) where application logs are stored but doesn’t require persistent storage for its own operation. Using a <strong>Deployment</strong> is appropriate here, as the history server can be easily replicated or scaled without maintaining unique identities.</li>
<li><strong>Easier Scaling and Update Management</strong>: Deployments provide automatic scaling and rolling updates, which are more suitable for stateless services. If you need to increase the availability of the history server, you can simply increase the replica count in the Deployment, and Kubernetes will handle the scaling automatically.</li>
<li><strong>Failure Recovery</strong>: Since there’s no dependency on unique network identities or persistent state, if the History Server pod fails, it can be easily recreated without any additional orchestration, which is exactly what Deployments are optimized for.</li>
</ul>
<h2 id="Summary-Table"><a href="#Summary-Table" class="headerlink" title="Summary Table"></a>Summary Table</h2><table>
<thead>
<tr>
<th>Component</th>
<th>Kubernetes Kind</th>
<th>Purpose</th>
<th>Reasoning</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Spark Master</strong></td>
<td>StatefulSet</td>
<td>Primary and backup master for Spark cluster</td>
<td>Needs stable identity for cluster coordination and leader election</td>
</tr>
<tr>
<td><strong>Spark Worker</strong></td>
<td>StatefulSet</td>
<td>Worker nodes that register with Spark Master</td>
<td>Stable network identity ensures reliable registration and communication with Master</td>
</tr>
<tr>
<td><strong>Spark History Server</strong></td>
<td>Deployment</td>
<td>Reads logs and provides historical application data</td>
<td>Stateless and doesn’t need unique identities; easier to scale and restart as a Deployment</td>
</tr>
</tbody></table>
<p>This setup optimizes the deployment structure for each Spark component’s unique requirements, leveraging Kubernetes’ StatefulSet and Deployment resources for their intended purposes.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/28/Comprehensive-Guide-to-Kubernetes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/28/Comprehensive-Guide-to-Kubernetes/" class="post-title-link" itemprop="url">Comprehensive Guide to Kubernetes</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-10-28 11:51:24 / Modified: 11:52:04" itemprop="dateCreated datePublished" datetime="2024-10-28T11:51:24-04:00">2024-10-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#cluster">Cluster</a></li>
<li><a href="#node">Node</a></li>
<li><a href="#pod">Pod</a></li>
<li><a href="#deployment">Deployment</a></li>
<li><a href="#service">Service</a></li>
<li><a href="#ingress">Ingress</a></li>
<li><a href="#configmap">ConfigMap</a></li>
<li><a href="#secret">Secret</a></li>
<li><a href="#persistent-volume-pv-and-persistent-volume-claim-pvc">Persistent Volume (PV) and Persistent Volume Claim (PVC)</a></li>
<li><a href="#namespace">Namespace</a></li>
<li><a href="#daemonset">DaemonSet</a></li>
<li><a href="#job-and-cronjob">Job and CronJob</a></li>
<li><a href="#horizontal-pod-autoscaler-hpa">Horizontal Pod Autoscaler (HPA)</a></li>
<li><a href="#statefulset">StatefulSet</a></li>
<li><a href="#volume-and-storageclass">Volume and StorageClass</a></li>
<li><a href="#networkpolicy">NetworkPolicy</a></li>
<li><a href="#custom-resource-definitions-crds">Custom Resource Definitions (CRDs)</a></li>
<li><a href="#helm-charts">Helm Charts</a></li>
</ul>
<hr>
<p>This guide provides a detailed overview of Kubernetes concepts, examples, use cases, installation YAML examples, and visual representations of the architecture. </p>
<p><a name="cluster"></a></p>
<h2 id="Cluster"><a href="#Cluster" class="headerlink" title="Cluster"></a>Cluster</h2><p>A <strong>Kubernetes Cluster</strong> is a group of nodes (machines) that host and manage containerized applications. Each cluster has at least one master node, which controls the state of the cluster, and multiple worker nodes.</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>A cloud-based cluster with one master node and multiple worker nodes in Google Kubernetes Engine (GKE).</p>
<h3 id="Use-Case"><a href="#Use-Case" class="headerlink" title="Use Case"></a>Use Case</h3><p>An ideal setup for running a production microservices application with high availability.</p>
<h4 id="YAML-Structure-for-Cluster-Creation"><a href="#YAML-Structure-for-Cluster-Creation" class="headerlink" title="YAML Structure for Cluster Creation"></a>YAML Structure for Cluster Creation</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">kind.x-k8s.io/v1alpha4</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Cluster</span></span><br><span class="line"><span class="attr">nodes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">control-plane</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">worker</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">worker</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">worker</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="node"></a></p>
<h2 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h2><p>A <strong>Node</strong> is a single machine within a Kubernetes cluster, capable of running one or more pods.</p>
<h3 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h3><p>In a cloud environment, each node could be a virtual machine instance.</p>
<h3 id="Use-Case-1"><a href="#Use-Case-1" class="headerlink" title="Use Case"></a>Use Case</h3><p>Nodes distribute workloads across the infrastructure.</p>
<h4 id="YAML-Snippet"><a href="#YAML-Snippet" class="headerlink" title="YAML Snippet"></a>YAML Snippet</h4><p>The node configuration is usually specified by the cluster management tool (e.g., GKE or EKS) rather than in YAML, as it pertains to the infrastructure layer.</p>
<hr>
<p><a name="pod"></a></p>
<h2 id="Pod"><a href="#Pod" class="headerlink" title="Pod"></a>Pod</h2><p>A <strong>Pod</strong> is the smallest deployable unit in Kubernetes, which can contain one or more containers.</p>
<h3 id="Example-2"><a href="#Example-2" class="headerlink" title="Example"></a>Example</h3><p>A pod running a web server container and a logging container.</p>
<h3 id="Use-Case-2"><a href="#Use-Case-2" class="headerlink" title="Use Case"></a>Use Case</h3><p>Running tightly coupled applications together within the same lifecycle.</p>
<h4 id="YAML-Structure-for-Pod"><a href="#YAML-Structure-for-Pod" class="headerlink" title="YAML Structure for Pod"></a>YAML Structure for Pod</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">web-server-pod</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">web-server</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">logger</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">fluentd</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="deployment"></a></p>
<h2 id="Deployment"><a href="#Deployment" class="headerlink" title="Deployment"></a>Deployment</h2><p>A <strong>Deployment</strong> is a Kubernetes object for managing a group of identical pods. It provides capabilities like rolling updates and rollback.</p>
<h3 id="Example-3"><a href="#Example-3" class="headerlink" title="Example"></a>Example</h3><p>A deployment with three replicas of a web server pod.</p>
<h3 id="Use-Case-3"><a href="#Use-Case-3" class="headerlink" title="Use Case"></a>Use Case</h3><p>Maintaining a stable version of an application by managing pod replicas.</p>
<h4 id="YAML-Structure-for-Deployment"><a href="#YAML-Structure-for-Deployment" class="headerlink" title="YAML Structure for Deployment"></a>YAML Structure for Deployment</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">web-deployment</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">web</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">web</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">nginx:1.17.4</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="service"></a></p>
<h2 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h2><p>A <strong>Service</strong> provides a stable endpoint for accessing a set of pods.</p>
<h3 id="Example-4"><a href="#Example-4" class="headerlink" title="Example"></a>Example</h3><p>A service that exposes an application to the public internet.</p>
<h3 id="Use-Case-4"><a href="#Use-Case-4" class="headerlink" title="Use Case"></a>Use Case</h3><p>Load balancing traffic to an application across multiple pods.</p>
<h4 id="YAML-Structure-for-Service"><a href="#YAML-Structure-for-Service" class="headerlink" title="YAML Structure for Service"></a>YAML Structure for Service</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">web-service</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">LoadBalancer</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">web</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="ingress"></a></p>
<h2 id="Ingress"><a href="#Ingress" class="headerlink" title="Ingress"></a>Ingress</h2><p><strong>Ingress</strong> manages external access to services, typically using HTTP.</p>
<h3 id="Example-5"><a href="#Example-5" class="headerlink" title="Example"></a>Example</h3><p>An ingress with rules to route traffic to different services based on URL paths.</p>
<h3 id="Use-Case-5"><a href="#Use-Case-5" class="headerlink" title="Use Case"></a>Use Case</h3><p>Routing <code>/api</code> to backend services and <code>/static</code> to frontend services on the same domain.</p>
<h4 id="YAML-Structure-for-Ingress"><a href="#YAML-Structure-for-Ingress" class="headerlink" title="YAML Structure for Ingress"></a>YAML Structure for Ingress</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">example-ingress</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">example.com</span></span><br><span class="line">    <span class="attr">http:</span></span><br><span class="line">      <span class="attr">paths:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">path:</span> <span class="string">/api</span></span><br><span class="line">        <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">        <span class="attr">backend:</span></span><br><span class="line">          <span class="attr">service:</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">api-service</span></span><br><span class="line">            <span class="attr">port:</span></span><br><span class="line">              <span class="attr">number:</span> <span class="number">80</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">path:</span> <span class="string">/static</span></span><br><span class="line">        <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">        <span class="attr">backend:</span></span><br><span class="line">          <span class="attr">service:</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">static-service</span></span><br><span class="line">            <span class="attr">port:</span></span><br><span class="line">              <span class="attr">number:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="configmap"></a></p>
<h2 id="ConfigMap"><a href="#ConfigMap" class="headerlink" title="ConfigMap"></a>ConfigMap</h2><p>A <strong>ConfigMap</strong> stores non-sensitive configuration data.</p>
<h3 id="Example-6"><a href="#Example-6" class="headerlink" title="Example"></a>Example</h3><p>A ConfigMap for environment-specific variables.</p>
<h3 id="Use-Case-6"><a href="#Use-Case-6" class="headerlink" title="Use Case"></a>Use Case</h3><p>Keeping configuration separate from the application code.</p>
<h4 id="YAML-Structure-for-ConfigMap"><a href="#YAML-Structure-for-ConfigMap" class="headerlink" title="YAML Structure for ConfigMap"></a>YAML Structure for ConfigMap</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ConfigMap</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">config-demo</span></span><br><span class="line"><span class="attr">data:</span></span><br><span class="line">  <span class="attr">DATABASE_URL:</span> <span class="string">&quot;jdbc:mysql://dbhost:3306/mydatabase&quot;</span></span><br><span class="line">  <span class="attr">DEBUG_LEVEL:</span> <span class="string">&quot;3&quot;</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="secret"></a></p>
<h2 id="Secret"><a href="#Secret" class="headerlink" title="Secret"></a>Secret</h2><p>A <strong>Secret</strong> stores sensitive information, like passwords and tokens.</p>
<h3 id="Example-7"><a href="#Example-7" class="headerlink" title="Example"></a>Example</h3><p>A secret containing API keys for external services.</p>
<h3 id="Use-Case-7"><a href="#Use-Case-7" class="headerlink" title="Use Case"></a>Use Case</h3><p>Securing sensitive data without exposing it in the code.</p>
<h4 id="YAML-Structure-for-Secret"><a href="#YAML-Structure-for-Secret" class="headerlink" title="YAML Structure for Secret"></a>YAML Structure for Secret</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Secret</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">api-key-secret</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">Opaque</span></span><br><span class="line"><span class="attr">data:</span></span><br><span class="line">  <span class="attr">api-key:</span> <span class="string">c29tZS1yYW5kb20ta2V5Cg==</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="persistent-volume-pv-and-persistent-volume-claim-pvc"></a></p>
<h2 id="Persistent-Volume-PV-and-Persistent-Volume-Claim-PVC"><a href="#Persistent-Volume-PV-and-Persistent-Volume-Claim-PVC" class="headerlink" title="Persistent Volume (PV) and Persistent Volume Claim (PVC)"></a>Persistent Volume (PV) and Persistent Volume Claim (PVC)</h2><p>A <strong>Persistent Volume</strong> provides storage, while a <strong>Persistent Volume Claim</strong> is a request for that storage.</p>
<h3 id="Example-8"><a href="#Example-8" class="headerlink" title="Example"></a>Example</h3><p>A PV representing cloud disk storage and a PVC used by a database pod.</p>
<h3 id="Use-Case-8"><a href="#Use-Case-8" class="headerlink" title="Use Case"></a>Use Case</h3><p>Ensuring data persistence for applications that require durable storage.</p>
<h4 id="YAML-Structure-for-PV-and-PVC"><a href="#YAML-Structure-for-PV-and-PVC" class="headerlink" title="YAML Structure for PV and PVC"></a>YAML Structure for PV and PVC</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolume</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pv-storage</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">capacity:</span></span><br><span class="line">    <span class="attr">storage:</span> <span class="string">10Gi</span></span><br><span class="line">  <span class="attr">accessModes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ReadWriteOnce</span></span><br><span class="line">  <span class="attr">hostPath:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">&quot;/mnt/data&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolumeClaim</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pvc-storage</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">accessModes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ReadWriteOnce</span></span><br><span class="line">  <span class="attr">resources:</span></span><br><span class="line">    <span class="attr">requests:</span></span><br><span class="line">      <span class="attr">storage:</span> <span class="string">8Gi</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="namespace"></a></p>
<h2 id="Namespace"><a href="#Namespace" class="headerlink" title="Namespace"></a>Namespace</h2><p>A <strong>Namespace</strong> is a way to divide cluster resources among multiple users.</p>
<h3 id="Example-9"><a href="#Example-9" class="headerlink" title="Example"></a>Example</h3><p>Separate namespaces for development, staging, and production environments.</p>
<h3 id="Use-Case-9"><a href="#Use-Case-9" class="headerlink" title="Use Case"></a>Use Case</h3><p>Organizing resources for different environments or teams.</p>
<h4 id="YAML-Structure-for-Namespace"><a href="#YAML-Structure-for-Namespace" class="headerlink" title="YAML Structure for Namespace"></a>YAML Structure for Namespace</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Namespace</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">dev-environment</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="daemonset"></a></p>
<h2 id="DaemonSet"><a href="#DaemonSet" class="headerlink" title="DaemonSet"></a>DaemonSet</h2><p>A <strong>DaemonSet</strong> ensures that specific pods run on each node.</p>
<h3 id="Example-10"><a href="#Example-10" class="headerlink" title="Example"></a>Example</h3><p>Running a logging agent on every node in the cluster.</p>
<h3 id="Use-Case-10"><a href="#Use-Case-10" class="headerlink" title="Use Case"></a>Use Case</h3><p>Managing node-wide services like logging or monitoring.</p>
<h4 id="YAML-Structure-for-DaemonSet"><a href="#YAML-Structure-for-DaemonSet" class="headerlink" title="YAML Structure for DaemonSet"></a>YAML Structure for DaemonSet</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">DaemonSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">logger</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">logger</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">logger</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">fluentd</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">fluent/fluentd</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="job-and-cronjob"></a></p>
<h2 id="Job-and-CronJob"><a href="#Job-and-CronJob" class="headerlink" title="Job and CronJob"></a>Job and CronJob</h2><p><strong>Job</strong> runs a one-time task, while <strong>CronJob</strong> schedules a recurring task.</p>
<h3 id="Example-11"><a href="#Example-11" class="headerlink" title="Example"></a>Example</h3><p>A Job to back up a database once and a CronJob to clean up logs daily.</p>
<h3 id="Use-Case-11"><a href="#Use-Case-11" class="headerlink" title="Use Case"></a>Use Case</h3><p>Automating scheduled tasks or batch processing.</p>
<h4 id="YAML-Structure-for-Job-and-CronJob"><a href="#YAML-Structure-for-Job-and-CronJob" class="headerlink" title="YAML Structure for Job and CronJob"></a>YAML Structure for Job and CronJob</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">batch/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Job</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">backup-job</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">backup</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">backup-tool</span></span><br><span class="line">      <span class="attr">restartPolicy:</span> <span class="string">OnFailure</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">batch/v1beta1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">CronJob</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">daily-cleanup</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">schedule:</span> <span class="string">&quot;0 0 * * *&quot;</span></span><br><span class="line">  <span class="attr">jobTemplate:</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">template:</span></span><br><span class="line">        <span class="attr">spec:</span></span><br><span class="line">          <span class="attr">containers:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">cleanup</span></span><br><span class="line">            <span class="attr">image:</span> <span class="string">cleanup-tool</span></span><br><span class="line">          <span class="attr">restartPolicy:</span> <span class="string">OnFailure</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="horizontal-pod-autoscaler-hpa"></a></p>
<h2 id="Horizontal-Pod-Autoscaler-HPA"><a href="#Horizontal-Pod-Autoscaler-HPA" class="headerlink" title="Horizontal Pod Autoscaler (HPA)"></a>Horizontal Pod Autoscaler (HPA)</h2><p>The <strong>HPA</strong> scales pod replicas automatically based on resource utilization.</p>
<h3 id="Example-12"><a href="#Example-12" class="headerlink" title="Example"></a>Example</h3><p>Scaling web server pods based on CPU usage.</p>
<h3 id="Use-Case-12"><a href="#Use-Case-12" class="headerlink" title="Use Case"></a>Use Case</h3><p>Scaling applications to handle variable workloads.</p>
<h4 id="YAML-Structure-for-HPA"><a href="#YAML-Structure-for-HPA" class="headerlink" title="YAML Structure for HPA"></a>YAML Structure for HPA</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">autoscaling/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">HorizontalPodAutoscaler</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">web-hpa</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="string">scaleTarget</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Ref:</span></span><br><span class="line">    <span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line">    <span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">web-deployment</span></span><br><span class="line">  <span class="attr">minReplicas:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">maxReplicas:</span> <span class="number">10</span></span><br><span class="line">  <span class="attr">targetCPUUtilizationPercentage:</span> <span class="number">70</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="statefulset"></a></p>
<h2 id="StatefulSet"><a href="#StatefulSet" class="headerlink" title="StatefulSet"></a>StatefulSet</h2><p>A <strong>StatefulSet</strong> manages stateful applications with unique and persistent storage.</p>
<h3 id="Example-13"><a href="#Example-13" class="headerlink" title="Example"></a>Example</h3><p>A StatefulSet for a MongoDB replica set.</p>
<h3 id="Use-Case-13"><a href="#Use-Case-13" class="headerlink" title="Use Case"></a>Use Case</h3><p>Managing stateful applications where each instance requires its own storage.</p>
<h4 id="YAML-Structure-for-StatefulSet"><a href="#YAML-Structure-for-StatefulSet" class="headerlink" title="YAML Structure for StatefulSet"></a>YAML Structure for StatefulSet</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StatefulSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">mongo</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">serviceName:</span> <span class="string">&quot;mongo&quot;</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">mongo</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">mongo</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mongo</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">mongo</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">27017</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">mongo</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="volume-and-storageclass"></a></p>
<h2 id="Volume-and-StorageClass"><a href="#Volume-and-StorageClass" class="headerlink" title="Volume and StorageClass"></a>Volume and StorageClass</h2><p><strong>Volumes</strong> provide storage to pods, while <strong>StorageClass</strong> defines types of storage.</p>
<h3 id="Example-14"><a href="#Example-14" class="headerlink" title="Example"></a>Example</h3><p>SSD-based storage for a database application.</p>
<h3 id="Use-Case-14"><a href="#Use-Case-14" class="headerlink" title="Use Case"></a>Use Case</h3><p>Choosing storage for applications based on performance requirements.</p>
<h4 id="YAML-Structure-for-StorageClass-and-Volume"><a href="#YAML-Structure-for-StorageClass-and-Volume" class="headerlink" title="YAML Structure for StorageClass and Volume"></a>YAML Structure for StorageClass and Volume</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">storage.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StorageClass</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">fast</span></span><br><span class="line"><span class="attr">provisioner:</span> <span class="string">kubernetes.io/aws-ebs</span></span><br><span class="line"><span class="attr">parameters:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">gp2</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolume</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">fast-pv</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">storageClassName:</span> <span class="string">fast</span></span><br><span class="line">  <span class="attr">capacity:</span></span><br><span class="line">    <span class="attr">storage:</span> <span class="string">50Gi</span></span><br><span class="line">  <span class="attr">accessModes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ReadWriteOnce</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="networkpolicy"></a></p>
<h2 id="NetworkPolicy"><a href="#NetworkPolicy" class="headerlink" title="NetworkPolicy"></a>NetworkPolicy</h2><p><strong>NetworkPolicy</strong> defines network access rules between pods.</p>
<h3 id="Example-15"><a href="#Example-15" class="headerlink" title="Example"></a>Example</h3><p>Restricting access to specific pods.</p>
<h3 id="Use-Case-15"><a href="#Use-Case-15" class="headerlink" title="Use Case"></a>Use Case</h3><p>Securing inter-service communication.</p>
<h4 id="YAML-Structure-for-NetworkPolicy"><a href="#YAML-Structure-for-NetworkPolicy" class="headerlink" title="YAML Structure for NetworkPolicy"></a>YAML Structure for NetworkPolicy</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">NetworkPolicy</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">deny-all</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">podSelector:</span> &#123;&#125;</span><br><span class="line">  <span class="attr">policyTypes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Ingress</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Egress</span></span><br><span class="line">  <span class="attr">ingress:</span> []</span><br><span class="line">  <span class="attr">egress:</span> []</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="custom-resource-definitions-crds"></a></p>
<h2 id="Custom-Resource-Definitions-CRDs"><a href="#Custom-Resource-Definitions-CRDs" class="headerlink" title="Custom Resource Definitions (CRDs)"></a>Custom Resource Definitions (CRDs)</h2><p><strong>CRDs</strong> extend Kubernetes by allowing users to create custom resources.</p>
<h3 id="Example-16"><a href="#Example-16" class="headerlink" title="Example"></a>Example</h3><p>A custom resource to manage database schema migrations.</p>
<h3 id="Use-Case-16"><a href="#Use-Case-16" class="headerlink" title="Use Case"></a>Use Case</h3><p>Adding domain-specific resources for applications.</p>
<h4 id="YAML-Structure-for-CRD"><a href="#YAML-Structure-for-CRD" class="headerlink" title="YAML Structure for CRD"></a>YAML Structure for CRD</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apiextensions.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">CustomResourceDefinition</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">migrations.mycompany.com</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">group:</span> <span class="string">mycompany.com</span></span><br><span class="line">  <span class="attr">versions:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">v1</span></span><br><span class="line">    <span class="attr">served:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">storage:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">scope:</span> <span class="string">Namespaced</span></span><br><span class="line">  <span class="attr">names:</span></span><br><span class="line">    <span class="attr">plural:</span> <span class="string">migrations</span></span><br><span class="line">    <span class="attr">singular:</span> <span class="string">migration</span></span><br><span class="line">    <span class="attr">kind:</span> <span class="string">Migration</span></span><br></pre></td></tr></table></figure>

<hr>
<p><a name="helm-charts"></a></p>
<h2 id="Helm-Charts"><a href="#Helm-Charts" class="headerlink" title="Helm Charts"></a>Helm Charts</h2><p><strong>Helm</strong> is a package manager for Kubernetes, and <strong>Helm Charts</strong> are pre-configured packages.</p>
<h3 id="Example-17"><a href="#Example-17" class="headerlink" title="Example"></a>Example</h3><p>A Helm chart for deploying a WordPress site.</p>
<h3 id="Use-Case-17"><a href="#Use-Case-17" class="headerlink" title="Use Case"></a>Use Case</h3><p>Simplifying application deployment and management.</p>
<h4 id="Example-Helm-Command"><a href="#Example-Helm-Command" class="headerlink" title="Example Helm Command"></a>Example Helm Command</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">helm install my-wordpress bitnami/wordpress</span><br></pre></td></tr></table></figure>

<hr>
<p>These concepts are essential for understanding and operating Kubernetes in production, allowing you to deploy, manage, and scale applications effectively. Each example and YAML configuration highlights the power and flexibility Kubernetes offers in a variety of scenarios.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/27/Deep-Dive-into-Spring-Boot-and-Quarkus/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/27/Deep-Dive-into-Spring-Boot-and-Quarkus/" class="post-title-link" itemprop="url">Deep Dive into Spring Boot and Quarkus</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-10-27 23:38:08 / Modified: 23:46:51" itemprop="dateCreated datePublished" datetime="2024-10-27T23:38:08-04:00">2024-10-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/" itemprop="url" rel="index"><span itemprop="name">Deep Dive</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/Spring-Boot/Quarkus/" itemprop="url" rel="index"><span itemprop="name">Quarkus</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#architecture">Architecture</a><ul>
<li><a href="#21-overview">2.1 Overview</a><ul>
<li><a href="#spring-boot">Spring Boot</a></li>
<li><a href="#quarkus">Quarkus</a></li>
</ul>
</li>
<li><a href="#22-microservices">2.2 Microservices</a><ul>
<li><a href="#spring-boot-1">Spring Boot</a></li>
<li><a href="#quarkus-1">Quarkus</a></li>
</ul>
</li>
<li><a href="#23-dependency-injection">2.3 Dependency Injection</a><ul>
<li><a href="#spring-boot-2">Spring Boot</a></li>
<li><a href="#quarkus-2">Quarkus</a></li>
</ul>
</li>
<li><a href="#24-reactive-programming">2.4 Reactive Programming</a><ul>
<li><a href="#spring-boot-3">Spring Boot</a></li>
<li><a href="#quarkus-3">Quarkus</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#performance">Performance</a><ul>
<li><a href="#31-startup-time">3.1 Startup Time</a><ul>
<li><a href="#spring-boot-4">Spring Boot</a></li>
<li><a href="#quarkus-4">Quarkus</a></li>
</ul>
</li>
<li><a href="#32-memory-usage">3.2 Memory Usage</a><ul>
<li><a href="#spring-boot-5">Spring Boot</a></li>
<li><a href="#quarkus-5">Quarkus</a></li>
</ul>
</li>
<li><a href="#33-runtime-efficiency">3.3 Runtime Efficiency</a><ul>
<li><a href="#spring-boot-6">Spring Boot</a></li>
<li><a href="#quarkus-6">Quarkus</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ecosystem-and-community">Ecosystem and Community</a><ul>
<li><a href="#41-spring-ecosystem">4.1 Spring Ecosystem</a></li>
<li><a href="#42-quarkus-ecosystem">4.2 Quarkus Ecosystem</a></li>
<li><a href="#43-community-support">4.3 Community Support</a><ul>
<li><a href="#spring-boot-7">Spring Boot</a></li>
<li><a href="#quarkus-7">Quarkus</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sample-code">Sample Code</a><ul>
<li><a href="#51-spring-boot-example">5.1 Spring Boot Example</a></li>
<li><a href="#52-quarkus-example">5.2 Quarkus Example</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Spring Boot and Quarkus are two of the most popular frameworks for building Java applications. Both frameworks aim to simplify the development process and provide robust solutions for modern application development. However, they have different philosophies and approaches. This article will provide a detailed comparison of Spring Boot and Quarkus, exploring their architecture, performance, ecosystem, and community support.</p>
<p><a name="architecture"></a></p>
<h2 id="Architecture"><a href="#Architecture" class="headerlink" title="Architecture"></a>Architecture</h2><p><a name="21-overview"></a></p>
<h3 id="2-1-Overview"><a href="#2-1-Overview" class="headerlink" title="2.1 Overview"></a>2.1 Overview</h3><h4 id="Spring-Boot"><a href="#Spring-Boot" class="headerlink" title="Spring Boot"></a>Spring Boot</h4><p>Spring Boot is built on top of the Spring framework and provides a streamlined way to create stand-alone, production-grade Spring-based applications. It leverages the Spring ecosystem to offer a wide range of features out of the box.</p>
<h4 id="Quarkus"><a href="#Quarkus" class="headerlink" title="Quarkus"></a>Quarkus</h4><p>Quarkus is a Kubernetes-native Java framework designed for OpenJDK HotSpot and GraalVM. It is optimized for low memory usage and fast startup times, making it ideal for cloud-native applications.</p>
<p><a name="22-microservices"></a></p>
<h3 id="2-2-Microservices"><a href="#2-2-Microservices" class="headerlink" title="2.2 Microservices"></a>2.2 Microservices</h3><h4 id="Spring-Boot-1"><a href="#Spring-Boot-1" class="headerlink" title="Spring Boot"></a>Spring Boot</h4><p>Spring Boot is well-suited for building microservices. It provides built-in support for service discovery, configuration management, and circuit breakers through Spring Cloud Kubernetes, which integrates with Kubernetes’ native service discovery mechanisms.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+       +-------------------+       +----------------------------------+</span><br><span class="line">| Spring Boot       |       | Spring Cloud      |       | Kubernetes                       |</span><br><span class="line">| Microservice      |       | Kubernetes        |       | (Service Discovery and Config    |</span><br><span class="line">+-------------------+       +-------------------+       +----------------------------------+</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (1) Service Discovery     |                           |</span><br><span class="line">        |--------------------------&gt;|                           |</span><br><span class="line">        |                           | (2) Configuration Fetch   |</span><br><span class="line">        |                           |--------------------------&gt;|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (3) Circuit Breaker       |                           |</span><br><span class="line">        |&lt;--------------------------|                           |</span><br><span class="line">        |                           |                           |</span><br><span class="line">+-------------------+       +-------------------+       +--------------------------------+</span><br><span class="line">| Spring Boot       |       | Spring Cloud      |       | Kubernetes                     |</span><br><span class="line">| Microservice      |       | Kubernetes        |       | (Service Discovery and Config  |</span><br><span class="line">+-------------------+       +-------------------+       +--------------------------------+</span><br></pre></td></tr></table></figure>

<h4 id="Quarkus-1"><a href="#Quarkus-1" class="headerlink" title="Quarkus"></a>Quarkus</h4><p>Quarkus also supports microservices with extensions for service discovery, configuration management, and fault tolerance. It integrates well with Kubernetes and provides native support for GraalVM.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| Quarkus           |       | Kubernetes        |       | GraalVM           |</span><br><span class="line">| Microservice      |       | (Service Discovery|       | (Native Image)    |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (1) Service Discovery     |                           |</span><br><span class="line">        |--------------------------&gt;|                           |</span><br><span class="line">        |                           | (2) Configuration Fetch  |</span><br><span class="line">        |                           |--------------------------&gt;|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (3) Native Image Build    |                           |</span><br><span class="line">        |&lt;--------------------------|                           |</span><br><span class="line">        |                           |                           |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| Quarkus           |       | Kubernetes        |       | GraalVM           |</span><br><span class="line">| Microservice      |       | (Service Discovery|       | (Native Image)    |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br></pre></td></tr></table></figure>

<p><a name="23-dependency-injection"></a></p>
<h3 id="2-3-Dependency-Injection"><a href="#2-3-Dependency-Injection" class="headerlink" title="2.3 Dependency Injection"></a>2.3 Dependency Injection</h3><h4 id="Spring-Boot-2"><a href="#Spring-Boot-2" class="headerlink" title="Spring Boot"></a>Spring Boot</h4><p>Spring Boot uses the Spring Framework’s dependency injection mechanism, which is based on the Inversion of Control (IoC) principle.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, Spring Boot!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MyService myService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/message&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> myService.getMessage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Quarkus-2"><a href="#Quarkus-2" class="headerlink" title="Quarkus"></a>Quarkus</h4><p>Quarkus uses the Contexts and Dependency Injection (CDI) standard for dependency injection, which is part of the Java EE specification.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApplicationScoped</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, Quarkus!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Path(&quot;/message&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyResource</span> &#123;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    MyService myService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GET</span></span><br><span class="line">    <span class="meta">@Produces(MediaType.TEXT_PLAIN)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> myService.getMessage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="24-reactive-programming"></a></p>
<h3 id="2-4-Reactive-Programming"><a href="#2-4-Reactive-Programming" class="headerlink" title="2.4 Reactive Programming"></a>2.4 Reactive Programming</h3><h4 id="Spring-Boot-3"><a href="#Spring-Boot-3" class="headerlink" title="Spring Boot"></a>Spring Boot</h4><p>Spring Boot supports reactive programming through Spring WebFlux, which is built on top of Project Reactor.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyReactiveController</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/reactive-message&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;String&gt; <span class="title function_">getReactiveMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Mono.just(<span class="string">&quot;Hello, Reactive Spring Boot!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Quarkus-3"><a href="#Quarkus-3" class="headerlink" title="Quarkus"></a>Quarkus</h4><p>Quarkus supports reactive programming through its Reactive Streams Operators and integrates well with frameworks like Vert.x.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Path(&quot;/reactive-message&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyReactiveResource</span> &#123;</span><br><span class="line">    <span class="meta">@GET</span></span><br><span class="line">    <span class="meta">@Produces(MediaType.TEXT_PLAIN)</span></span><br><span class="line">    <span class="keyword">public</span> Uni&lt;String&gt; <span class="title function_">getReactiveMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Uni.createFrom().item(<span class="string">&quot;Hello, Reactive Quarkus!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="performance"></a></p>
<h2 id="Performance"><a href="#Performance" class="headerlink" title="Performance"></a>Performance</h2><p><a name="31-startup-time"></a></p>
<h3 id="3-1-Startup-Time"><a href="#3-1-Startup-Time" class="headerlink" title="3.1 Startup Time"></a>3.1 Startup Time</h3><h4 id="Spring-Boot-4"><a href="#Spring-Boot-4" class="headerlink" title="Spring Boot"></a>Spring Boot</h4><p>Spring Boot applications typically have a longer startup time due to the extensive initialization of the Spring framework.</p>
<h4 id="Quarkus-4"><a href="#Quarkus-4" class="headerlink" title="Quarkus"></a>Quarkus</h4><p>Quarkus applications have a much faster startup time, especially when using GraalVM to build native images.</p>
<p><a name="32-memory-usage"></a></p>
<h3 id="3-2-Memory-Usage"><a href="#3-2-Memory-Usage" class="headerlink" title="3.2 Memory Usage"></a>3.2 Memory Usage</h3><h4 id="Spring-Boot-5"><a href="#Spring-Boot-5" class="headerlink" title="Spring Boot"></a>Spring Boot</h4><p>Spring Boot applications generally consume more memory due to the heavyweight nature of the Spring framework.</p>
<h4 id="Quarkus-5"><a href="#Quarkus-5" class="headerlink" title="Quarkus"></a>Quarkus</h4><p>Quarkus applications consume less memory, making them more efficient for containerized environments.</p>
<p><a name="33-runtime-efficiency"></a></p>
<h3 id="3-3-Runtime-Efficiency"><a href="#3-3-Runtime-Efficiency" class="headerlink" title="3.3 Runtime Efficiency"></a>3.3 Runtime Efficiency</h3><h4 id="Spring-Boot-6"><a href="#Spring-Boot-6" class="headerlink" title="Spring Boot"></a>Spring Boot</h4><p>Spring Boot applications are optimized for traditional Java runtime environments.</p>
<h4 id="Quarkus-6"><a href="#Quarkus-6" class="headerlink" title="Quarkus"></a>Quarkus</h4><p>Quarkus applications are optimized for modern, cloud-native environments and can take advantage of GraalVM for native execution.</p>
<p><a name="ecosystem-and-community"></a></p>
<h2 id="Ecosystem-and-Community"><a href="#Ecosystem-and-Community" class="headerlink" title="Ecosystem and Community"></a>Ecosystem and Community</h2><p><a name="41-spring-ecosystem"></a></p>
<h3 id="4-1-Spring-Ecosystem"><a href="#4-1-Spring-Ecosystem" class="headerlink" title="4.1 Spring Ecosystem"></a>4.1 Spring Ecosystem</h3><p>Spring Boot benefits from the extensive Spring ecosystem, which includes Spring Data, Spring Security, Spring Cloud Kubernetes, and many other modules.</p>
<p><a name="42-quarkus-ecosystem"></a></p>
<h3 id="4-2-Quarkus-Ecosystem"><a href="#4-2-Quarkus-Ecosystem" class="headerlink" title="4.2 Quarkus Ecosystem"></a>4.2 Quarkus Ecosystem</h3><p>Quarkus has a growing ecosystem with extensions for various technologies, including databases, messaging systems, and cloud services.</p>
<p><a name="43-community-support"></a></p>
<h3 id="4-3-Community-Support"><a href="#4-3-Community-Support" class="headerlink" title="4.3 Community Support"></a>4.3 Community Support</h3><h4 id="Spring-Boot-7"><a href="#Spring-Boot-7" class="headerlink" title="Spring Boot"></a>Spring Boot</h4><p>Spring Boot has a large and active community, with extensive documentation, tutorials, and third-party libraries.</p>
<h4 id="Quarkus-7"><a href="#Quarkus-7" class="headerlink" title="Quarkus"></a>Quarkus</h4><p>Quarkus has a rapidly growing community, with increasing support from Red Hat and other contributors.</p>
<p><a name="sample-code"></a></p>
<h2 id="Sample-Code"><a href="#Sample-Code" class="headerlink" title="Sample Code"></a>Sample Code</h2><p><a name="51-spring-boot-example"></a></p>
<h3 id="5-1-Spring-Boot-Example"><a href="#5-1-Spring-Boot-Example" class="headerlink" title="5.1 Spring Boot Example"></a>5.1 Spring Boot Example</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringBootExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(SpringBootExample.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, Spring Boot!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="52-quarkus-example"></a></p>
<h3 id="5-2-Quarkus-Example"><a href="#5-2-Quarkus-Example" class="headerlink" title="5.2 Quarkus Example"></a>5.2 Quarkus Example</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.quarkus.runtime.Quarkus;</span><br><span class="line"><span class="keyword">import</span> io.quarkus.runtime.annotations.QuarkusMain;</span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.GET;</span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.Path;</span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.Produces;</span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.core.MediaType;</span><br><span class="line"></span><br><span class="line"><span class="meta">@QuarkusMain</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QuarkusExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Quarkus.run(args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Path(&quot;/hello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloResource</span> &#123;</span><br><span class="line">    <span class="meta">@GET</span></span><br><span class="line">    <span class="meta">@Produces(MediaType.TEXT_PLAIN)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, Quarkus!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Both Spring Boot and Quarkus are powerful frameworks for building Java applications, each with its own strengths and weaknesses. Spring Boot offers a mature and feature-rich ecosystem, making it a great choice for a wide range of applications. Quarkus, on the other hand, is optimized for modern, cloud-native environments and provides excellent performance and efficiency.</p>
<p>Choosing between Spring Boot and Quarkus depends on the specific requirements of your project, including performance, ecosystem, and community support. By understanding the differences and capabilities of both frameworks, you can make an informed decision that best suits your needs.</p>
<p><a name="references"></a></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://spring.io/projects/spring-boot">Spring Boot Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://quarkus.io/guides/">Quarkus Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://www.baeldung.com/spring-boot-vs-quarkus">Spring Boot vs Quarkus: A Comprehensive Comparison</a></li>
</ul>
<hr>
<p>This article provides a comprehensive comparison of Spring Boot and Quarkus, covering their architecture, performance, ecosystem, and community support. By understanding these frameworks, developers can choose the best tool for their projects and build efficient and scalable applications.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/27/Deep-Dive-into-Keycloak/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/27/Deep-Dive-into-Keycloak/" class="post-title-link" itemprop="url">Deep Dive into Keycloak</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-10-27 23:31:11 / Modified: 23:32:50" itemprop="dateCreated datePublished" datetime="2024-10-27T23:31:11-04:00">2024-10-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/" itemprop="url" rel="index"><span itemprop="name">Deep Dive</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/Keycloak/" itemprop="url" rel="index"><span itemprop="name">Keycloak</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#keycloak-architecture">Keycloak Architecture</a><ul>
<li><a href="#21-overview">2.1 Overview</a></li>
<li><a href="#22-key-components">2.2 Key Components</a></li>
<li><a href="#23-authentication-flows">2.3 Authentication Flows</a></li>
<li><a href="#24-authorization-services">2.4 Authorization Services</a></li>
<li><a href="#25-user-federation">2.5 User Federation</a></li>
<li><a href="#26-identity-brokering">2.6 Identity Brokering</a></li>
<li><a href="#27-admin-console">2.7 Admin Console</a></li>
</ul>
</li>
<li><a href="#practical-applications">Practical Applications</a><ul>
<li><a href="#31-single-sign-on-sso">3.1 Single Sign-On (SSO)</a></li>
<li><a href="#32-api-security">3.2 API Security</a></li>
<li><a href="#33-user-management">3.3 User Management</a></li>
<li><a href="#34-custom-extensions">3.4 Custom Extensions</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Keycloak is an open-source Identity and Access Management (IAM) solution that provides authentication, authorization, and user management for modern applications and services. It is designed to be easy to integrate with existing systems and supports a wide range of protocols and standards, including OAuth 2.0, OpenID Connect, and SAML. This article will delve into the architecture of Keycloak, exploring its components, features, and practical applications.</p>
<p><a name="keycloak-architecture"></a></p>
<h2 id="Keycloak-Architecture"><a href="#Keycloak-Architecture" class="headerlink" title="Keycloak Architecture"></a>Keycloak Architecture</h2><p><a name="21-overview"></a></p>
<h3 id="2-1-Overview"><a href="#2-1-Overview" class="headerlink" title="2.1 Overview"></a>2.1 Overview</h3><p>Keycloak is built on a modular architecture that allows for flexibility and extensibility. It consists of several key components that work together to provide a comprehensive IAM solution. The architecture can be divided into the following main areas:</p>
<ul>
<li><strong>Authentication</strong>: Handles user authentication and session management.</li>
<li><strong>Authorization</strong>: Provides fine-grained access control and permissions management.</li>
<li><strong>User Federation</strong>: Integrates with external user stores.</li>
<li><strong>Identity Brokering</strong>: Allows users to authenticate using external identity providers.</li>
<li><strong>Admin Console</strong>: Provides a web-based interface for managing Keycloak.</li>
</ul>
<p><a name="22-key-components"></a></p>
<h3 id="2-2-Key-Components"><a href="#2-2-Key-Components" class="headerlink" title="2.2 Key Components"></a>2.2 Key Components</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| Client Application|       | Keycloak Server   |       | External Identity |</span><br><span class="line">| (e.g., Web App)   |       | (Auth Server)     |       | Provider (e.g.,   |</span><br><span class="line">|                   |       |                   |       | Google, Facebook)|</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (1) Authentication Request|                           |</span><br><span class="line">        |--------------------------&gt;|                           |</span><br><span class="line">        |                           | (2) Redirect to Auth Server|</span><br><span class="line">        |                           |--------------------------&gt;|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        |                           | (3) User Authentication  |</span><br><span class="line">        |                           |&lt;--------------------------|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        |                           | (4) Authorization Grant  |</span><br><span class="line">        |                           |&lt;--------------------------|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        |                           | (5) Access Token Request  |</span><br><span class="line">        |                           |--------------------------&gt;|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        |                           | (6) Access Token Response|</span><br><span class="line">        |                           |&lt;--------------------------|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (7) Access Resource       |                           |</span><br><span class="line">        |&lt;--------------------------|                           |</span><br><span class="line">        |                           |                           |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| Resource Server   |       | Keycloak Server   |       | External Identity |</span><br><span class="line">| (e.g., API)       |       | (Auth Server)     |       | Provider (e.g.,   |</span><br><span class="line">|                   |       |                   |       | Google, Facebook)|</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br></pre></td></tr></table></figure>

<p><a name="23-authentication-flows"></a></p>
<h3 id="2-3-Authentication-Flows"><a href="#2-3-Authentication-Flows" class="headerlink" title="2.3 Authentication Flows"></a>2.3 Authentication Flows</h3><p>Keycloak supports various authentication flows, including:</p>
<ul>
<li><strong>Standard Flow</strong>: The default flow where the client redirects the user to the Keycloak server for authentication.</li>
<li><strong>Implicit Flow</strong>: Suitable for client-side applications where the access token is returned directly to the client.</li>
<li><strong>Direct Access Grants</strong>: Allows clients to obtain an access token using the resource owner’s credentials.</li>
<li><strong>Client Credentials</strong>: Used for machine-to-machine communication.</li>
</ul>
<p><a name="24-authorization-services"></a></p>
<h3 id="2-4-Authorization-Services"><a href="#2-4-Authorization-Services" class="headerlink" title="2.4 Authorization Services"></a>2.4 Authorization Services</h3><p>Keycloak provides fine-grained authorization services, including:</p>
<ul>
<li><strong>Role-Based Access Control (RBAC)</strong>: Assigns roles to users and defines permissions based on those roles.</li>
<li><strong>Policy-Based Access Control (PBAC)</strong>: Uses policies to define complex access control rules.</li>
<li><strong>Permission Management</strong>: Allows administrators to manage permissions for resources and users.</li>
</ul>
<p><a name="25-user-federation"></a></p>
<h3 id="2-5-User-Federation"><a href="#2-5-User-Federation" class="headerlink" title="2.5 User Federation"></a>2.5 User Federation</h3><p>Keycloak supports user federation, allowing integration with external user stores such as LDAP and Active Directory. This enables organizations to manage users in their existing user stores while leveraging Keycloak for authentication and authorization.</p>
<p><a name="26-identity-brokering"></a></p>
<h3 id="2-6-Identity-Brokering"><a href="#2-6-Identity-Brokering" class="headerlink" title="2.6 Identity Brokering"></a>2.6 Identity Brokering</h3><p>Keycloak supports identity brokering, allowing users to authenticate using external identity providers such as Google, Facebook, and GitHub. This enables organizations to provide a seamless authentication experience for users who prefer to use their existing accounts.</p>
<p><a name="27-admin-console"></a></p>
<h3 id="2-7-Admin-Console"><a href="#2-7-Admin-Console" class="headerlink" title="2.7 Admin Console"></a>2.7 Admin Console</h3><p>Keycloak provides a web-based admin console that allows administrators to manage users, roles, clients, and other Keycloak entities. The admin console is a powerful tool for configuring and managing Keycloak.</p>
<p><a name="practical-applications"></a></p>
<h2 id="Practical-Applications"><a href="#Practical-Applications" class="headerlink" title="Practical Applications"></a>Practical Applications</h2><p><a name="31-single-sign-on-sso"></a></p>
<h3 id="3-1-Single-Sign-On-SSO"><a href="#3-1-Single-Sign-On-SSO" class="headerlink" title="3.1 Single Sign-On (SSO)"></a>3.1 Single Sign-On (SSO)</h3><p>Keycloak enables Single Sign-On (SSO), allowing users to authenticate once and access multiple applications without re-entering their credentials. This is particularly useful in enterprise environments where users need to access multiple internal applications.</p>
<p><a name="32-api-security"></a></p>
<h3 id="3-2-API-Security"><a href="#3-2-API-Security" class="headerlink" title="3.2 API Security"></a>3.2 API Security</h3><p>Keycloak is widely used to secure APIs by providing access tokens that grant limited access to resources. This is essential for building secure microservices architectures.</p>
<p><a name="33-user-management"></a></p>
<h3 id="3-3-User-Management"><a href="#3-3-User-Management" class="headerlink" title="3.3 User Management"></a>3.3 User Management</h3><p>Keycloak provides comprehensive user management features, including user registration, profile management, and password management. It also supports user federation, allowing integration with external user stores.</p>
<p><a name="34-custom-extensions"></a></p>
<h3 id="3-4-Custom-Extensions"><a href="#3-4-Custom-Extensions" class="headerlink" title="3.4 Custom Extensions"></a>3.4 Custom Extensions</h3><p>Keycloak is highly extensible, allowing developers to create custom extensions to meet specific requirements. This includes custom authentication flows, custom user federation providers, and custom identity providers.</p>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Keycloak is a powerful and flexible Identity and Access Management solution that provides comprehensive authentication, authorization, and user management capabilities. Its modular architecture and support for various protocols and standards make it a popular choice for securing modern applications and services.</p>
<p>Understanding the architecture and features of Keycloak is essential for developers and administrators who want to leverage its capabilities to build secure and scalable applications. By leveraging Keycloak, organizations can provide a seamless and secure authentication and authorization experience for their users.</p>
<p><a name="references"></a></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.keycloak.org/documentation">Keycloak Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/keycloak/keycloak">Keycloak GitHub Repository</a></li>
<li><a target="_blank" rel="noopener" href="https://www.keycloak.org/getting-started">Keycloak: A Comprehensive Guide</a></li>
</ul>
<hr>
<p>This article provides a comprehensive overview of Keycloak, covering its architecture, components, and practical applications. By understanding Keycloak, developers and administrators can build secure and scalable applications that meet the demands of today’s digital landscape.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/27/Deep-Dive-into-OAuth-2-0-and-OpenID-Connect/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/27/Deep-Dive-into-OAuth-2-0-and-OpenID-Connect/" class="post-title-link" itemprop="url">Deep Dive into OAuth 2.0 and OpenID Connect</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-10-27 23:23:58 / Modified: 23:28:14" itemprop="dateCreated datePublished" datetime="2024-10-27T23:23:58-04:00">2024-10-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/" itemprop="url" rel="index"><span itemprop="name">Deep Dive</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/OAuth/" itemprop="url" rel="index"><span itemprop="name">OAuth</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#oauth-20-the-authorization-framework">OAuth 2.0: The Authorization Framework</a><ul>
<li><a href="#11-overview">1.1 Overview</a></li>
<li><a href="#12-key-components">1.2 Key Components</a></li>
<li><a href="#13-authorization-grant-types">1.3 Authorization Grant Types</a></li>
<li><a href="#14-access-tokens-and-refresh-tokens">1.4 Access Tokens and Refresh Tokens</a></li>
<li><a href="#15-security-considerations">1.5 Security Considerations</a></li>
</ul>
</li>
<li><a href="#openid-connect-the-authentication-layer">OpenID Connect: The Authentication Layer</a><ul>
<li><a href="#21-overview">2.1 Overview</a></li>
<li><a href="#22-key-components">2.2 Key Components</a></li>
<li><a href="#23-authentication-flows">2.3 Authentication Flows</a></li>
<li><a href="#24-claims-and-scopes">2.4 Claims and Scopes</a></li>
<li><a href="#25-security-considerations">2.5 Security Considerations</a></li>
</ul>
</li>
<li><a href="#practical-applications">Practical Applications</a><ul>
<li><a href="#31-single-sign-on-sso">3.1 Single Sign-On (SSO)</a></li>
<li><a href="#32-api-authorization">3.2 API Authorization</a></li>
<li><a href="#33-mobile-and-iot-applications">3.3 Mobile and IoT Applications</a></li>
<li><a href="#34-federated-identity">3.4 Federated Identity</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>In the modern web ecosystem, securing user data and managing authentication and authorization are critical tasks. OAuth 2.0 and OpenID Connect (OIDC) are two widely adopted standards that help developers achieve these goals. OAuth 2.0 focuses on authorization, while OpenID Connect extends OAuth 2.0 to provide authentication. This article will delve into the intricacies of both protocols, exploring their architecture, components, and practical applications.</p>
<p><a name="oauth-20-the-authorization-framework"></a></p>
<h2 id="OAuth-2-0-The-Authorization-Framework"><a href="#OAuth-2-0-The-Authorization-Framework" class="headerlink" title="OAuth 2.0: The Authorization Framework"></a>OAuth 2.0: The Authorization Framework</h2><p><a name="11-overview"></a></p>
<h3 id="1-1-Overview"><a href="#1-1-Overview" class="headerlink" title="1.1 Overview"></a>1.1 Overview</h3><p>OAuth 2.0 is an authorization framework that enables third-party applications to obtain limited access to a user’s resources without exposing the user’s credentials. It is designed to work across different platforms and environments, including web applications, mobile apps, and APIs.</p>
<p><a name="12-key-components"></a></p>
<h3 id="1-2-Key-Components"><a href="#1-2-Key-Components" class="headerlink" title="1.2 Key Components"></a>1.2 Key Components</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| Resource Owner    |       | Client            |       | Authorization    |</span><br><span class="line">| (User)            |       | (Application)     |       | Server            |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (1) Authorization Request |                           |</span><br><span class="line">        |--------------------------&gt;|                           |</span><br><span class="line">        |                           | (2) Redirect to Auth Server|</span><br><span class="line">        |                           |--------------------------&gt;|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        |                           | (3) User Authentication  |</span><br><span class="line">        |                           |&lt;--------------------------|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        |                           | (4) Authorization Grant  |</span><br><span class="line">        |                           |&lt;--------------------------|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        |                           | (5) Access Token Request  |</span><br><span class="line">        |                           |--------------------------&gt;|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        |                           | (6) Access Token Response|</span><br><span class="line">        |                           |&lt;--------------------------|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (7) Access Resource       |                           |</span><br><span class="line">        |&lt;--------------------------|                           |</span><br><span class="line">        |                           |                           |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| Resource Server   |       | Client            |       | Authorization    |</span><br><span class="line">| (API)             |       | (Application)     |       | Server            |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br></pre></td></tr></table></figure>

<p><a name="13-authorization-grant-types"></a></p>
<h3 id="1-3-Authorization-Grant-Types"><a href="#1-3-Authorization-Grant-Types" class="headerlink" title="1.3 Authorization Grant Types"></a>1.3 Authorization Grant Types</h3><p>OAuth 2.0 defines several grant types, each suited for different use cases:</p>
<ul>
<li><strong>Authorization Code</strong>: Used for server-side web applications. The client receives an authorization code from the authorization server and exchanges it for an access token.</li>
<li><strong>Implicit</strong>: Used for client-side web applications. The access token is returned directly to the client.</li>
<li><strong>Resource Owner Password Credentials</strong>: Used when the client has a trusted relationship with the resource owner (e.g., a mobile app).</li>
<li><strong>Client Credentials</strong>: Used for machine-to-machine communication where the client itself is the resource owner.</li>
<li><strong>Device Code</strong>: Used for devices with limited input capabilities (e.g., smart TVs).</li>
</ul>
<p><a name="14-access-tokens-and-refresh-tokens"></a></p>
<h3 id="1-4-Access-Tokens-and-Refresh-Tokens"><a href="#1-4-Access-Tokens-and-Refresh-Tokens" class="headerlink" title="1.4 Access Tokens and Refresh Tokens"></a>1.4 Access Tokens and Refresh Tokens</h3><ul>
<li><strong>Access Token</strong>: A credential that the client uses to access the resource server. It has a limited lifetime and is typically short-lived.</li>
<li><strong>Refresh Token</strong>: A long-lived token that the client can use to obtain a new access token when the current one expires.</li>
</ul>
<p><a name="15-security-considerations"></a></p>
<h3 id="1-5-Security-Considerations"><a href="#1-5-Security-Considerations" class="headerlink" title="1.5 Security Considerations"></a>1.5 Security Considerations</h3><ul>
<li><strong>Token Storage</strong>: Access tokens should be stored securely, especially in client-side applications.</li>
<li><strong>Token Expiry</strong>: Access tokens should have a short expiration time to minimize the risk of misuse.</li>
<li><strong>Token Revocation</strong>: Mechanisms should be in place to revoke tokens if they are compromised.</li>
</ul>
<p><a name="openid-connect-the-authentication-layer"></a></p>
<h2 id="OpenID-Connect-The-Authentication-Layer"><a href="#OpenID-Connect-The-Authentication-Layer" class="headerlink" title="OpenID Connect: The Authentication Layer"></a>OpenID Connect: The Authentication Layer</h2><p><a name="21-overview"></a></p>
<h3 id="2-1-Overview"><a href="#2-1-Overview" class="headerlink" title="2.1 Overview"></a>2.1 Overview</h3><p>OpenID Connect (OIDC) is an authentication layer built on top of OAuth 2.0. It allows clients to verify the identity of the end-user based on the authentication performed by an authorization server. OIDC adds an ID token, which contains information about the authenticated user.</p>
<p><a name="22-key-components"></a></p>
<h3 id="2-2-Key-Components"><a href="#2-2-Key-Components" class="headerlink" title="2.2 Key Components"></a>2.2 Key Components</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| Resource Owner    |       | Client            |       | Authorization    |</span><br><span class="line">| (User)            |       | (Application)     |       | Server            |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (1) Authorization Request |                           |</span><br><span class="line">        |--------------------------&gt;|                           |</span><br><span class="line">        |                           | (2) Redirect to Auth Server|</span><br><span class="line">        |                           |--------------------------&gt;|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        |                           | (3) User Authentication  |</span><br><span class="line">        |                           |&lt;--------------------------|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        |                           | (4) Authorization Grant  |</span><br><span class="line">        |                           |&lt;--------------------------|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        |                           | (5) Access Token Request  |</span><br><span class="line">        |                           |--------------------------&gt;|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        |                           | (6) Access Token Response|</span><br><span class="line">        |                           |&lt;--------------------------|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (7) Access Resource       |                           |</span><br><span class="line">        |&lt;--------------------------|                           |</span><br><span class="line">        |                           |                           |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| Resource Server   |       | Client            |       | Authorization    |</span><br><span class="line">| (API)             |       | (Application)     |       | Server            |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">        |                           |                           |</span><br><span class="line">        |                           | (8) ID Token             |</span><br><span class="line">        |                           |&lt;--------------------------|</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (9) UserInfo Request      |                           |</span><br><span class="line">        |&lt;--------------------------|                           |</span><br><span class="line">        |                           |                           |</span><br><span class="line">        | (10) UserInfo Response    |                           |</span><br><span class="line">        |&lt;--------------------------|                           |</span><br><span class="line">        |                           |                           |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br><span class="line">| Resource Server   |       | Client            |       | Authorization    |</span><br><span class="line">| (API)             |       | (Application)     |       | Server            |</span><br><span class="line">+-------------------+       +-------------------+       +-------------------+</span><br></pre></td></tr></table></figure>

<p><a name="23-authentication-flows"></a></p>
<h3 id="2-3-Authentication-Flows"><a href="#2-3-Authentication-Flows" class="headerlink" title="2.3 Authentication Flows"></a>2.3 Authentication Flows</h3><ul>
<li><strong>Authorization Code Flow</strong>: Similar to OAuth 2.0’s authorization code grant, but with the addition of the ID token.</li>
<li><strong>Implicit Flow</strong>: Similar to OAuth 2.0’s implicit grant, but with the addition of the ID token.</li>
<li><strong>Hybrid Flow</strong>: Combines aspects of both the authorization code and implicit flows.</li>
</ul>
<p><a name="24-claims-and-scopes"></a></p>
<h3 id="2-4-Claims-and-Scopes"><a href="#2-4-Claims-and-Scopes" class="headerlink" title="2.4 Claims and Scopes"></a>2.4 Claims and Scopes</h3><ul>
<li><strong>Claims</strong>: Information about the authenticated user, such as name, email, and profile picture.</li>
<li><strong>Scopes</strong>: Permissions requested by the client, such as <code>openid</code>, <code>profile</code>, <code>email</code>, and <code>address</code>.</li>
</ul>
<p><a name="25-security-considerations"></a></p>
<h3 id="2-5-Security-Considerations"><a href="#2-5-Security-Considerations" class="headerlink" title="2.5 Security Considerations"></a>2.5 Security Considerations</h3><ul>
<li><strong>Token Validation</strong>: Clients must validate ID tokens to ensure they are authentic and have not been tampered with.</li>
<li><strong>Scope Management</strong>: Clients should request only the scopes necessary for their functionality.</li>
<li><strong>Session Management</strong>: Mechanisms should be in place to manage user sessions and handle logout.</li>
</ul>
<p><a name="practical-applications"></a></p>
<h2 id="Practical-Applications"><a href="#Practical-Applications" class="headerlink" title="Practical Applications"></a>Practical Applications</h2><p><a name="31-single-sign-on-sso"></a></p>
<h3 id="3-1-Single-Sign-On-SSO"><a href="#3-1-Single-Sign-On-SSO" class="headerlink" title="3.1 Single Sign-On (SSO)"></a>3.1 Single Sign-On (SSO)</h3><p>OAuth 2.0 and OpenID Connect enable Single Sign-On (SSO), allowing users to authenticate once and access multiple applications without re-entering their credentials. This is particularly useful in enterprise environments where users need to access multiple internal applications.</p>
<p><a name="32-api-authorization"></a></p>
<h3 id="3-2-API-Authorization"><a href="#3-2-API-Authorization" class="headerlink" title="3.2 API Authorization"></a>3.2 API Authorization</h3><p>OAuth 2.0 is widely used to secure APIs by providing access tokens that grant limited access to resources. This is essential for building secure microservices architectures.</p>
<p><a name="33-mobile-and-iot-applications"></a></p>
<h3 id="3-3-Mobile-and-IoT-Applications"><a href="#3-3-Mobile-and-IoT-Applications" class="headerlink" title="3.3 Mobile and IoT Applications"></a>3.3 Mobile and IoT Applications</h3><p>OAuth 2.0’s device code grant type is particularly useful for devices with limited input capabilities, such as smart TVs and IoT devices. It allows users to authenticate on a secondary device (e.g., a smartphone) and grant access to the primary device.</p>
<p><a name="34-federated-identity"></a></p>
<h3 id="3-4-Federated-Identity"><a href="#3-4-Federated-Identity" class="headerlink" title="3.4 Federated Identity"></a>3.4 Federated Identity</h3><p>OpenID Connect enables federated identity, allowing users to authenticate using their existing credentials from a trusted identity provider (e.g., Google, Facebook). This reduces the need for users to create new accounts and manage multiple sets of credentials.</p>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>OAuth 2.0 and OpenID Connect are powerful tools for securing modern web applications. OAuth 2.0 provides a flexible framework for authorization, while OpenID Connect adds an authentication layer on top of it. Together, they enable secure, scalable, and user-friendly authentication and authorization solutions.</p>
<p>Understanding the intricacies of these protocols is essential for developers building secure applications in today’s interconnected world. By leveraging OAuth 2.0 and OpenID Connect, developers can ensure that their applications are both secure and user-friendly.</p>
<p><a name="references"></a></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc6749">OAuth 2.0 Specification</a></li>
<li><a target="_blank" rel="noopener" href="https://openid.net/specs/openid-connect-core-1_0.html">OpenID Connect Core 1.0</a></li>
<li><a target="_blank" rel="noopener" href="https://www.oauth.com/">OAuth 2.0 and OpenID Connect: A Comprehensive Guide</a></li>
</ul>
<p>This article provides a comprehensive overview of OAuth 2.0 and OpenID Connect, covering their architecture, components, and practical applications. By understanding these protocols, developers can build secure and scalable applications that meet the demands of today’s digital landscape.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/27/Deep-Dive-into-MapStruct-A-Java-Bean-Mapping-Framework/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/27/Deep-Dive-into-MapStruct-A-Java-Bean-Mapping-Framework/" class="post-title-link" itemprop="url">Deep Dive into MapStruct: A Java Bean Mapping Framework</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-10-27 22:41:24 / Modified: 22:57:33" itemprop="dateCreated datePublished" datetime="2024-10-27T22:41:24-04:00">2024-10-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/" itemprop="url" rel="index"><span itemprop="name">Deep Dive</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Deep-Dive/MapStruct/" itemprop="url" rel="index"><span itemprop="name">MapStruct</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ol>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#why-use-mapstruct">Why Use MapStruct?</a></li>
<li><a href="#how-to-use-mapstruct-in-spring-boot">How to Use MapStruct in Spring Boot</a></li>
<li><a href="#benefits-and-advantages">Benefits and Advantages</a></li>
<li><a href="#textual-diagram">Textual Diagram</a></li>
<li><a href="#sample-code">Sample Code</a></li>
<li><a href="#generated-mapper-code">Generated Mapper Code</a></li>
<li><a href="#excluding-certain-attributes">Excluding Certain Attributes</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ol>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>MapStruct is a Java annotation processor for the generation of type-safe and performant bean mapping code. It simplifies the mapping between different Java bean types by automatically generating the necessary mapping code at compile time. This article will explore why and how to use MapStruct in a Spring Boot application, its benefits and advantages, and provide detailed sample code.</p>
<hr>
<p><a name="why-use-mapstruct"></a></p>
<h2 id="Why-Use-MapStruct"><a href="#Why-Use-MapStruct" class="headerlink" title="Why Use MapStruct?"></a>Why Use MapStruct?</h2><h3 id="Manual-Mapping"><a href="#Manual-Mapping" class="headerlink" title="Manual Mapping"></a>Manual Mapping</h3><p>Manual mapping between Java beans can be tedious and error-prone. It often involves writing repetitive and boilerplate code, which can lead to maintenance issues.</p>
<h3 id="Reflection-Based-Mapping"><a href="#Reflection-Based-Mapping" class="headerlink" title="Reflection-Based Mapping"></a>Reflection-Based Mapping</h3><p>Frameworks like Dozer use reflection to map beans, which can be slow and difficult to debug. Reflection-based mapping also lacks type safety and can lead to runtime errors.</p>
<h3 id="MapStruct"><a href="#MapStruct" class="headerlink" title="MapStruct"></a>MapStruct</h3><p>MapStruct generates mapping code at compile time, ensuring type safety and performance. It reduces boilerplate code and makes the mapping process more maintainable and easier to debug.</p>
<hr>
<p><a name="how-to-use-mapstruct-in-spring-boot"></a></p>
<h2 id="How-to-Use-MapStruct-in-Spring-Boot"><a href="#How-to-Use-MapStruct-in-Spring-Boot" class="headerlink" title="How to Use MapStruct in Spring Boot"></a>How to Use MapStruct in Spring Boot</h2><h3 id="Step-1-Add-Dependencies"><a href="#Step-1-Add-Dependencies" class="headerlink" title="Step 1: Add Dependencies"></a>Step 1: Add Dependencies</h3><p>Add the necessary dependencies to your <code>pom.xml</code> file. Note that we are using the latest version of MapStruct.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Spring Boot Starter --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- MapStruct --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mapstruct<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapstruct<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.3.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- MapStruct Processor --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mapstruct<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapstruct-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.3.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Step-2-Define-Mapping-Interface"><a href="#Step-2-Define-Mapping-Interface" class="headerlink" title="Step 2: Define Mapping Interface"></a>Step 2: Define Mapping Interface</h3><p>Create a mapping interface using the <code>@Mapper</code> annotation.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.mapstruct.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.Mapping;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.factory.Mappers;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"><span class="keyword">import</span> java.time.format.DateTimeFormatter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">    <span class="type">UserMapper</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Mapping(source = &quot;emailAddress&quot;, target = &quot;email&quot;)</span></span><br><span class="line">    <span class="meta">@Mapping(source = &quot;birthDate&quot;, target = &quot;birthDate&quot;, dateFormat = &quot;yyyyMMdd&quot;)</span></span><br><span class="line">    <span class="meta">@Mapping(target = &quot;password&quot;, ignore = true)</span> <span class="comment">// Exclude password attribute</span></span><br><span class="line">    UserDTO <span class="title function_">userToUserDTO</span><span class="params">(User user)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Mapping(source = &quot;email&quot;, target = &quot;emailAddress&quot;)</span></span><br><span class="line">    <span class="meta">@Mapping(target = &quot;birthDate&quot;, expression = &quot;java(LocalDate.parse(userDTO.getBirthDate(), DateTimeFormatter.ofPattern(\&quot;yyyyMMdd\&quot;)))&quot;)</span></span><br><span class="line">    <span class="meta">@Mapping(target = &quot;password&quot;, ignore = true)</span> <span class="comment">// Exclude password attribute</span></span><br><span class="line">    User <span class="title function_">userDTOToUser</span><span class="params">(UserDTO userDTO)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Step-3-Use-the-Mapper"><a href="#Step-3-Use-the-Mapper" class="headerlink" title="Step 3: Use the Mapper"></a>Step 3: Use the Mapper</h3><p>Inject the mapper into your service or controller and use it to map between beans.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">UserMapper</span> <span class="variable">userMapper</span> <span class="operator">=</span> UserMapper.INSTANCE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> UserDTO <span class="title function_">getUserDTO</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.userToUserDTO(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">(UserDTO userDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.userDTOToUser(userDTO);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="benefits-and-advantages"></a></p>
<h2 id="Benefits-and-Advantages"><a href="#Benefits-and-Advantages" class="headerlink" title="Benefits and Advantages"></a>Benefits and Advantages</h2><h3 id="Type-Safety"><a href="#Type-Safety" class="headerlink" title="Type Safety"></a>Type Safety</h3><p>MapStruct generates type-safe mapping code at compile time, reducing the risk of runtime errors.</p>
<h3 id="Performance"><a href="#Performance" class="headerlink" title="Performance"></a>Performance</h3><p>Since the mapping code is generated at compile time, it avoids the performance overhead associated with reflection-based mapping.</p>
<h3 id="Maintainability"><a href="#Maintainability" class="headerlink" title="Maintainability"></a>Maintainability</h3><p>MapStruct reduces boilerplate code, making the mapping process more maintainable and easier to understand.</p>
<h3 id="Customization"><a href="#Customization" class="headerlink" title="Customization"></a>Customization</h3><p>MapStruct allows for easy customization of mappings through annotations and configuration options.</p>
<hr>
<p><a name="textual-diagram"></a></p>
<h2 id="Textual-Diagram"><a href="#Textual-Diagram" class="headerlink" title="Textual Diagram"></a>Textual Diagram</h2><pre><code class="highlight mermaid">graph TD
    A[User Entity] --&gt;|MapStruct| B[User DTO]
    B --&gt;|MapStruct| C[User Entity]
    D[User Service] --&gt;|Uses| A
    D --&gt;|Uses| B
    E[User Controller] --&gt;|Uses| D</code></pre>

<h3 id="Explanation"><a href="#Explanation" class="headerlink" title="Explanation"></a>Explanation</h3><ol>
<li><strong>User Entity</strong>: Represents the domain object.</li>
<li><strong>User DTO</strong>: Represents the data transfer object.</li>
<li><strong>MapStruct</strong>: Generates mapping code between User Entity and User DTO.</li>
<li><strong>User Service</strong>: Uses the MapStruct-generated mapper to convert between User Entity and User DTO.</li>
<li><strong>User Controller</strong>: Uses the User Service to handle requests and responses.</li>
</ol>
<hr>
<p><a name="sample-code"></a></p>
<h2 id="Sample-Code"><a href="#Sample-Code" class="headerlink" title="Sample Code"></a>Sample Code</h2><h3 id="User-Entity"><a href="#User-Entity" class="headerlink" title="User Entity"></a>User Entity</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String emailAddress;</span><br><span class="line">    <span class="keyword">private</span> LocalDate birthDate;</span><br><span class="line">    <span class="keyword">private</span> String password; <span class="comment">// Password attribute to be excluded</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Getters and Setters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="User-DTO"><a href="#User-DTO" class="headerlink" title="User DTO"></a>User DTO</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDTO</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> String birthDate;</span><br><span class="line">    <span class="keyword">private</span> String password; <span class="comment">// Password attribute to be excluded</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Getters and Setters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="User-Mapper"><a href="#User-Mapper" class="headerlink" title="User Mapper"></a>User Mapper</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.mapstruct.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.Mapping;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.factory.Mappers;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"><span class="keyword">import</span> java.time.format.DateTimeFormatter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">    <span class="type">UserMapper</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Mapping(source = &quot;emailAddress&quot;, target = &quot;email&quot;)</span></span><br><span class="line">    <span class="meta">@Mapping(source = &quot;birthDate&quot;, target = &quot;birthDate&quot;, dateFormat = &quot;yyyyMMdd&quot;)</span></span><br><span class="line">    <span class="meta">@Mapping(target = &quot;password&quot;, ignore = true)</span> <span class="comment">// Exclude password attribute</span></span><br><span class="line">    UserDTO <span class="title function_">userToUserDTO</span><span class="params">(User user)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Mapping(source = &quot;email&quot;, target = &quot;emailAddress&quot;)</span></span><br><span class="line">    <span class="meta">@Mapping(target = &quot;birthDate&quot;, expression = &quot;java(LocalDate.parse(userDTO.getBirthDate(), DateTimeFormatter.ofPattern(\&quot;yyyyMMdd\&quot;)))&quot;)</span></span><br><span class="line">    <span class="meta">@Mapping(target = &quot;password&quot;, ignore = true)</span> <span class="comment">// Exclude password attribute</span></span><br><span class="line">    User <span class="title function_">userDTOToUser</span><span class="params">(UserDTO userDTO)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="User-Service"><a href="#User-Service" class="headerlink" title="User Service"></a>User Service</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">UserMapper</span> <span class="variable">userMapper</span> <span class="operator">=</span> UserMapper.INSTANCE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> UserDTO <span class="title function_">getUserDTO</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.userToUserDTO(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">(UserDTO userDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.userDTOToUser(userDTO);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="User-Controller"><a href="#User-Controller" class="headerlink" title="User Controller"></a>User Controller</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/users&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> UserDTO <span class="title function_">getUserDTO</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(); <span class="comment">// Assume this is fetched from a repository</span></span><br><span class="line">        <span class="keyword">return</span> userService.getUserDTO(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">createUser</span><span class="params">(<span class="meta">@RequestBody</span> UserDTO userDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userService.getUser(userDTO);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="generated-mapper-code"></a></p>
<h2 id="Generated-Mapper-Code"><a href="#Generated-Mapper-Code" class="headerlink" title="Generated Mapper Code"></a>Generated Mapper Code</h2><p>After compiling the project, MapStruct will generate the following mapper implementation:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"><span class="keyword">import</span> java.time.format.DateTimeFormatter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserMapperImpl</span> <span class="keyword">implements</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> UserDTO <span class="title function_">userToUserDTO</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (user == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">UserDTO</span> <span class="variable">userDTO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDTO</span>();</span><br><span class="line">        userDTO.setId(user.getId());</span><br><span class="line">        userDTO.setName(user.getName());</span><br><span class="line">        userDTO.setEmail(user.getEmailAddress());</span><br><span class="line">        userDTO.setBirthDate(user.getBirthDate().format(DateTimeFormatter.ofPattern(<span class="string">&quot;yyyyMMdd&quot;</span>)));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> userDTO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">userDTOToUser</span><span class="params">(UserDTO userDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (userDTO == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setId(userDTO.getId());</span><br><span class="line">        user.setName(userDTO.getName());</span><br><span class="line">        user.setEmailAddress(userDTO.getEmail());</span><br><span class="line">        user.setBirthDate(LocalDate.parse(userDTO.getBirthDate(), DateTimeFormatter.ofPattern(<span class="string">&quot;yyyyMMdd&quot;</span>)));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="excluding-certain-attributes"></a></p>
<h2 id="Excluding-Certain-Attributes"><a href="#Excluding-Certain-Attributes" class="headerlink" title="Excluding Certain Attributes"></a>Excluding Certain Attributes</h2><h3 id="Exclude-Attribute-Example"><a href="#Exclude-Attribute-Example" class="headerlink" title="Exclude Attribute Example"></a>Exclude Attribute Example</h3><p>In the <code>UserMapper</code> interface, we use the <code>@Mapping</code> annotation with <code>ignore = true</code> to exclude the <code>password</code> attribute from the mapping.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">    <span class="type">UserMapper</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Mapping(source = &quot;emailAddress&quot;, target = &quot;email&quot;)</span></span><br><span class="line">    <span class="meta">@Mapping(source = &quot;birthDate&quot;, target = &quot;birthDate&quot;, dateFormat = &quot;yyyyMMdd&quot;)</span></span><br><span class="line">    <span class="meta">@Mapping(target = &quot;password&quot;, ignore = true)</span> <span class="comment">// Exclude password attribute</span></span><br><span class="line">    UserDTO <span class="title function_">userToUserDTO</span><span class="params">(User user)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Mapping(source = &quot;email&quot;, target = &quot;emailAddress&quot;)</span></span><br><span class="line">    <span class="meta">@Mapping(target = &quot;birthDate&quot;, expression = &quot;java(LocalDate.parse(userDTO.getBirthDate(), DateTimeFormatter.ofPattern(\&quot;yyyyMMdd\&quot;)))&quot;)</span></span><br><span class="line">    <span class="meta">@Mapping(target = &quot;password&quot;, ignore = true)</span> <span class="comment">// Exclude password attribute</span></span><br><span class="line">    User <span class="title function_">userDTOToUser</span><span class="params">(UserDTO userDTO)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Generated-Mapper-Code-with-Exclusion"><a href="#Generated-Mapper-Code-with-Exclusion" class="headerlink" title="Generated Mapper Code with Exclusion"></a>Generated Mapper Code with Exclusion</h3><p>The generated mapper code will exclude the <code>password</code> attribute from the mapping.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"><span class="keyword">import</span> java.time.format.DateTimeFormatter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserMapperImpl</span> <span class="keyword">implements</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> UserDTO <span class="title function_">userToUserDTO</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (user == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">UserDTO</span> <span class="variable">userDTO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDTO</span>();</span><br><span class="line">        userDTO.setId(user.getId());</span><br><span class="line">        userDTO.setName(user.getName());</span><br><span class="line">        userDTO.setEmail(user.getEmailAddress());</span><br><span class="line">        userDTO.setBirthDate(user.getBirthDate().format(DateTimeFormatter.ofPattern(<span class="string">&quot;yyyyMMdd&quot;</span>)));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> userDTO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">userDTOToUser</span><span class="params">(UserDTO userDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (userDTO == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setId(userDTO.getId());</span><br><span class="line">        user.setName(userDTO.getName());</span><br><span class="line">        user.setEmailAddress(userDTO.getEmail());</span><br><span class="line">        user.setBirthDate(LocalDate.parse(userDTO.getBirthDate(), DateTimeFormatter.ofPattern(<span class="string">&quot;yyyyMMdd&quot;</span>)));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>MapStruct is a powerful and efficient Java bean mapping framework that simplifies the process of mapping between different Java bean types. By generating type-safe and performant mapping code at compile time, MapStruct reduces boilerplate code, improves maintainability, and enhances the overall quality of your Spring Boot applications. Whether you are working on a small project or a large enterprise application, MapStruct is a valuable tool that can significantly streamline your development process.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/27/Understanding-Object-Types-in-Application-Development/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/27/Understanding-Object-Types-in-Application-Development/" class="post-title-link" itemprop="url">Understanding Object Types in Application Development</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-10-27 22:27:41 / Modified: 22:31:28" itemprop="dateCreated datePublished" datetime="2024-10-27T22:27:41-04:00">2024-10-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Theory/" itemprop="url" rel="index"><span itemprop="name">Theory</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#object-types">Object Types</a><ul>
<li><a href="#value-object-vo">Value Object (VO)</a></li>
<li><a href="#plain-old-java-object-pojo">Plain Old Java Object (POJO)</a></li>
<li><a href="#data-transfer-object-dto">Data Transfer Object (DTO)</a></li>
<li><a href="#entity">Entity</a></li>
<li><a href="#model">Model</a></li>
<li><a href="#persistent-object-po">Persistent Object (PO)</a></li>
<li><a href="#business-object-bo">Business Object (BO)</a></li>
<li><a href="#data-access-object-dao">Data Access Object (DAO)</a></li>
</ul>
</li>
<li><a href="#transition-diagram">Transition Diagram</a><ul>
<li><a href="#explanation">Explanation</a></li>
</ul>
</li>
<li><a href="#scenarios">Scenarios</a><ul>
<li><a href="#value-object-vo-1">Value Object (VO)</a></li>
<li><a href="#plain-old-java-object-pojo-1">Plain Old Java Object (POJO)</a></li>
<li><a href="#data-transfer-object-dto-1">Data Transfer Object (DTO)</a></li>
<li><a href="#entity-1">Entity</a></li>
<li><a href="#model-1">Model</a></li>
<li><a href="#persistent-object-po-1">Persistent Object (PO)</a></li>
<li><a href="#business-object-bo-1">Business Object (BO)</a></li>
<li><a href="#data-access-object-dao-1">Data Access Object (DAO)</a></li>
</ul>
</li>
<li><a href="#sample-code">Sample Code</a><ul>
<li><a href="#value-object-vo-2">Value Object (VO)</a></li>
<li><a href="#plain-old-java-object-pojo-2">Plain Old Java Object (POJO)</a></li>
<li><a href="#data-transfer-object-dto-2">Data Transfer Object (DTO)</a></li>
<li><a href="#entity-2">Entity</a></li>
<li><a href="#model-2">Model</a></li>
<li><a href="#persistent-object-po-2">Persistent Object (PO)</a></li>
<li><a href="#business-object-bo-2">Business Object (BO)</a></li>
<li><a href="#data-access-object-dao-2">Data Access Object (DAO)</a></li>
<li><a href="#transition-example">Transition Example</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>In application development, different types of objects serve various purposes. Understanding these objects and their roles is crucial for designing scalable and maintainable systems. This article will explain common object types such as Value Object (VO), Plain Old Java Object (POJO), Data Transfer Object (DTO), Entity, Model, Persistent Object (PO), Business Object (BO), and Data Access Object (DAO). We will also provide a textual diagram to illustrate the transition between these objects and sample code to demonstrate their usage.</p>
<hr>
<p><a name="object-types"></a></p>
<h2 id="Object-Types"><a href="#Object-Types" class="headerlink" title="Object Types"></a>Object Types</h2><h3 id="Value-Object-VO"><a href="#Value-Object-VO" class="headerlink" title="Value Object (VO)"></a><a name="value-object-vo"></a>Value Object (VO)</h3><p>A Value Object is an object that represents a simple entity whose equality is not based on identity but on the value of its properties. VOs are immutable and typically used to represent concepts that are naturally comparable by value.</p>
<h3 id="Plain-Old-Java-Object-POJO"><a href="#Plain-Old-Java-Object-POJO" class="headerlink" title="Plain Old Java Object (POJO)"></a><a name="plain-old-java-object-pojo"></a>Plain Old Java Object (POJO)</h3><p>A POJO is a simple Java object that does not require any specific framework or library. It is a plain Java object that follows basic Java conventions and does not extend or implement any special classes or interfaces.</p>
<h3 id="Data-Transfer-Object-DTO"><a href="#Data-Transfer-Object-DTO" class="headerlink" title="Data Transfer Object (DTO)"></a><a name="data-transfer-object-dto"></a>Data Transfer Object (DTO)</h3><p>A DTO is an object used to transfer data between different layers of an application, such as between the service layer and the presentation layer. DTOs are typically simple objects that contain data but do not contain any business logic.</p>
<h3 id="Entity"><a href="#Entity" class="headerlink" title="Entity"></a><a name="entity"></a>Entity</h3><p>An Entity is an object that represents a persistent domain object, typically mapped to a database table. Entities have a unique identity and are often used to represent business concepts.</p>
<h3 id="Model"><a href="#Model" class="headerlink" title="Model"></a><a name="model"></a>Model</h3><p>A Model represents the data and business logic of an application. It encapsulates the state and behavior of the application’s domain. Models are often used in the service layer to perform business operations.</p>
<h3 id="Persistent-Object-PO"><a href="#Persistent-Object-PO" class="headerlink" title="Persistent Object (PO)"></a><a name="persistent-object-po"></a>Persistent Object (PO)</h3><p>A Persistent Object is an object that is mapped to a database table. It is similar to an Entity but is often used in older or specific frameworks where the term Entity is not used.</p>
<h3 id="Business-Object-BO"><a href="#Business-Object-BO" class="headerlink" title="Business Object (BO)"></a><a name="business-object-bo"></a>Business Object (BO)</h3><p>A Business Object encapsulates the business logic of an application. It is responsible for performing business operations and often interacts with DAOs to persist data.</p>
<h3 id="Data-Access-Object-DAO"><a href="#Data-Access-Object-DAO" class="headerlink" title="Data Access Object (DAO)"></a><a name="data-access-object-dao"></a>Data Access Object (DAO)</h3><p>A DAO is an object that provides an abstract interface to some type of database or other persistence mechanism. It allows the application to access and manipulate data without exposing the underlying data source.</p>
<hr>
<p><a name="transition-diagram"></a></p>
<h2 id="Transition-Diagram"><a href="#Transition-Diagram" class="headerlink" title="Transition Diagram"></a>Transition Diagram</h2><pre><code class="highlight mermaid">graph TD
    A[Entity] --&gt;|Map to Database| B[Repository]
    B --&gt;|Fetch Data| C[Service Layer]
    C --&gt;|Transform| D[DTO]
    D --&gt;|Transfer Data| E[Controller]
    E --&gt;|Present Data| F[View]
    C --&gt;|Business Logic| G[Model]
    G --&gt;|Represent Value| H[Value Object]
    C --&gt;|Business Logic| I[Business Object]
    I --&gt;|Access Data| J[DAO]
    J --&gt;|Map to Database| K[Persistent Object]</code></pre>

<h3 id="Explanation"><a href="#Explanation" class="headerlink" title="Explanation"></a>Explanation</h3><ol>
<li><strong>Entity</strong>: Represents a persistent domain object.</li>
<li><strong>Repository</strong>: Manages the persistence of entities.</li>
<li><strong>Service Layer</strong>: Contains business logic and transforms entities into DTOs.</li>
<li><strong>DTO</strong>: Transfers data between layers.</li>
<li><strong>Controller</strong>: Handles HTTP requests and responses.</li>
<li><strong>View</strong>: Presents data to the user.</li>
<li><strong>Model</strong>: Contains business logic and encapsulates state.</li>
<li><strong>Value Object</strong>: Represents a simple, immutable value.</li>
<li><strong>Business Object</strong>: Encapsulates business logic.</li>
<li><strong>DAO</strong>: Provides an abstract interface to the database.</li>
<li><strong>Persistent Object</strong>: Mapped to a database table.</li>
</ol>
<hr>
<p><a name="scenarios"></a></p>
<h2 id="Scenarios"><a href="#Scenarios" class="headerlink" title="Scenarios"></a>Scenarios</h2><h3 id="Value-Object-VO-1"><a href="#Value-Object-VO-1" class="headerlink" title="Value Object (VO)"></a>Value Object (VO)</h3><ul>
<li><strong>Scenario</strong>: Representing a monetary value or a date range.</li>
<li><strong>Usage</strong>: Used in business logic to ensure immutability and value-based equality.</li>
</ul>
<h3 id="Plain-Old-Java-Object-POJO-1"><a href="#Plain-Old-Java-Object-POJO-1" class="headerlink" title="Plain Old Java Object (POJO)"></a>Plain Old Java Object (POJO)</h3><ul>
<li><strong>Scenario</strong>: Simple data structures without any framework dependencies.</li>
<li><strong>Usage</strong>: Used in any layer of the application where a simple data structure is needed.</li>
</ul>
<h3 id="Data-Transfer-Object-DTO-1"><a href="#Data-Transfer-Object-DTO-1" class="headerlink" title="Data Transfer Object (DTO)"></a>Data Transfer Object (DTO)</h3><ul>
<li><strong>Scenario</strong>: Transferring data between different layers of the application.</li>
<li><strong>Usage</strong>: Used in the service layer to transfer data to the presentation layer.</li>
</ul>
<h3 id="Entity-1"><a href="#Entity-1" class="headerlink" title="Entity"></a>Entity</h3><ul>
<li><strong>Scenario</strong>: Representing a persistent domain object.</li>
<li><strong>Usage</strong>: Used in the persistence layer to map to database tables.</li>
</ul>
<h3 id="Model-1"><a href="#Model-1" class="headerlink" title="Model"></a>Model</h3><ul>
<li><strong>Scenario</strong>: Representing the business logic and state of the application.</li>
<li><strong>Usage</strong>: Used in the service layer to perform business operations.</li>
</ul>
<h3 id="Persistent-Object-PO-1"><a href="#Persistent-Object-PO-1" class="headerlink" title="Persistent Object (PO)"></a>Persistent Object (PO)</h3><ul>
<li><strong>Scenario</strong>: Mapping to a database table in older or specific frameworks.</li>
<li><strong>Usage</strong>: Used in the persistence layer to represent database records.</li>
</ul>
<h3 id="Business-Object-BO-1"><a href="#Business-Object-BO-1" class="headerlink" title="Business Object (BO)"></a>Business Object (BO)</h3><ul>
<li><strong>Scenario</strong>: Encapsulating business logic.</li>
<li><strong>Usage</strong>: Used in the service layer to perform business operations.</li>
</ul>
<h3 id="Data-Access-Object-DAO-1"><a href="#Data-Access-Object-DAO-1" class="headerlink" title="Data Access Object (DAO)"></a>Data Access Object (DAO)</h3><ul>
<li><strong>Scenario</strong>: Providing an abstract interface to the database.</li>
<li><strong>Usage</strong>: Used in the persistence layer to access and manipulate data.</li>
</ul>
<hr>
<p><a name="sample-code"></a></p>
<h2 id="Sample-Code"><a href="#Sample-Code" class="headerlink" title="Sample Code"></a>Sample Code</h2><h3 id="Value-Object-VO-2"><a href="#Value-Object-VO-2" class="headerlink" title="Value Object (VO)"></a>Value Object (VO)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Money</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">double</span> amount;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String currency;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Money</span><span class="params">(<span class="type">double</span> amount, String currency)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.amount = amount;</span><br><span class="line">        <span class="built_in">this</span>.currency = currency;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getAmount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> amount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getCurrency</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> currency;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span> == o) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="literal">null</span> || getClass() != o.getClass()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">Money</span> <span class="variable">money</span> <span class="operator">=</span> (Money) o;</span><br><span class="line">        <span class="keyword">return</span> Double.compare(money.amount, amount) == <span class="number">0</span> &amp;&amp;</span><br><span class="line">                currency.equals(money.currency);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Objects.hash(amount, currency);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Plain-Old-Java-Object-POJO-2"><a href="#Plain-Old-Java-Object-POJO-2" class="headerlink" title="Plain Old Java Object (POJO)"></a>Plain Old Java Object (POJO)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Data-Transfer-Object-DTO-2"><a href="#Data-Transfer-Object-DTO-2" class="headerlink" title="Data Transfer Object (DTO)"></a>Data Transfer Object (DTO)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDTO</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Entity-2"><a href="#Entity-2" class="headerlink" title="Entity"></a>Entity</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserEntity</span> &#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Model-2"><a href="#Model-2" class="headerlink" title="Model"></a>Model</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserModel</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">validateAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (age &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Age cannot be negative&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Persistent-Object-PO-2"><a href="#Persistent-Object-PO-2" class="headerlink" title="Persistent Object (PO)"></a>Persistent Object (PO)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserPO</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Business-Object-BO-2"><a href="#Business-Object-BO-2" class="headerlink" title="Business Object (BO)"></a>Business Object (BO)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserBO</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> UserDAO userDAO;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserBO</span><span class="params">(UserDAO userDAO)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userDAO = userDAO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> UserDTO <span class="title function_">getUserById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="type">UserPO</span> <span class="variable">userPO</span> <span class="operator">=</span> userDAO.findById(id);</span><br><span class="line">        <span class="type">UserDTO</span> <span class="variable">userDTO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDTO</span>();</span><br><span class="line">        userDTO.setName(userPO.getName());</span><br><span class="line">        userDTO.setAge(userPO.getAge());</span><br><span class="line">        <span class="keyword">return</span> userDTO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createUser</span><span class="params">(UserDTO userDTO)</span> &#123;</span><br><span class="line">        <span class="type">UserPO</span> <span class="variable">userPO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserPO</span>();</span><br><span class="line">        userPO.setName(userDTO.getName());</span><br><span class="line">        userPO.setAge(userDTO.getAge());</span><br><span class="line">        userDAO.save(userPO);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Data-Access-Object-DAO-2"><a href="#Data-Access-Object-DAO-2" class="headerlink" title="Data Access Object (DAO)"></a>Data Access Object (DAO)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDAO</span> &#123;</span><br><span class="line">    UserPO <span class="title function_">findById</span><span class="params">(Long id)</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">save</span><span class="params">(UserPO userPO)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDAOImpl</span> <span class="keyword">implements</span> <span class="title class_">UserDAO</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> UserPO <span class="title function_">findById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="comment">// Implementation to fetch user from database</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">UserPO</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">(UserPO userPO)</span> &#123;</span><br><span class="line">        <span class="comment">// Implementation to save user to database</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Transition-Example"><a href="#Transition-Example" class="headerlink" title="Transition Example"></a>Transition Example</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> UserBO userBO;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserService</span><span class="params">(UserBO userBO)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userBO = userBO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> UserDTO <span class="title function_">getUserById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userBO.getUserById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createUser</span><span class="params">(UserDTO userDTO)</span> &#123;</span><br><span class="line">        userBO.createUser(userDTO);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Understanding the different types of objects in application development is crucial for designing robust and maintainable systems. Each object type serves a specific purpose and is used in different scenarios. By following best practices and adhering to design principles, developers can create applications that are easier to extend, test, and maintain.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/27/The-SOLID-Principles-in-Software-Design-and-Development/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/27/The-SOLID-Principles-in-Software-Design-and-Development/" class="post-title-link" itemprop="url">The SOLID Principles in Software Design and Development</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-10-27 21:56:31 / Modified: 22:12:17" itemprop="dateCreated datePublished" datetime="2024-10-27T21:56:31-04:00">2024-10-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Theory/" itemprop="url" rel="index"><span itemprop="name">Theory</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#single-responsibility-principle-srp">Single Responsibility Principle (SRP)</a><ul>
<li><a href="#definition">Definition</a></li>
<li><a href="#broken-example">Broken Example</a></li>
<li><a href="#correct-example">Correct Example</a></li>
</ul>
</li>
<li><a href="#openclosed-principle-ocp">Open&#x2F;Closed Principle (OCP)</a><ul>
<li><a href="#definition-1">Definition</a></li>
<li><a href="#broken-example-1">Broken Example</a></li>
<li><a href="#correct-example-1">Correct Example</a></li>
</ul>
</li>
<li><a href="#liskov-substitution-principle-lsp">Liskov Substitution Principle (LSP)</a><ul>
<li><a href="#definition-2">Definition</a></li>
<li><a href="#broken-example-2">Broken Example</a></li>
<li><a href="#correct-example-2">Correct Example</a></li>
</ul>
</li>
<li><a href="#interface-segregation-principle-isp">Interface Segregation Principle (ISP)</a><ul>
<li><a href="#definition-3">Definition</a></li>
<li><a href="#broken-example-3">Broken Example</a></li>
<li><a href="#correct-example-3">Correct Example</a></li>
</ul>
</li>
<li><a href="#dependency-inversion-principle-dip">Dependency Inversion Principle (DIP)</a><ul>
<li><a href="#definition-4">Definition</a></li>
<li><a href="#broken-example-4">Broken Example</a></li>
<li><a href="#explanation">Explanation</a></li>
<li><a href="#why-high-level-module-depends-on-low-level-module">Why High-Level Module Depends on Low-Level Module</a></li>
<li><a href="#correct-example-4">Correct Example</a></li>
<li><a href="#explanation-of-correct-example">Explanation of Correct Example</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References:</a></li>
</ul>
<hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>The SOLID principles are a set of five design principles intended to make software designs more understandable, flexible, and maintainable. These principles were introduced by Robert C. Martin (also known as Uncle Bob) and are widely accepted in the software development community. The acronym SOLID stands for:</p>
<ul>
<li><strong>S</strong>ingle Responsibility Principle (SRP)</li>
<li><strong>O</strong>pen&#x2F;Closed Principle (OCP)</li>
<li><strong>L</strong>iskov Substitution Principle (LSP)</li>
<li><strong>I</strong>nterface Segregation Principle (ISP)</li>
<li><strong>D</strong>ependency Inversion Principle (DIP)</li>
</ul>
<p><img src="/images/The-SOLID-Principles-in-Software-Design-and-Development/SOLID_Principles.png" alt="SOLID Principles"><br>This article will explain each principle, provide examples of how they can be broken, and show the correct implementation to fix them.</p>
<hr>
<p><a name="single-responsibility-principle-srp"></a></p>
<h2 id="Single-Responsibility-Principle-SRP"><a href="#Single-Responsibility-Principle-SRP" class="headerlink" title="Single Responsibility Principle (SRP)"></a>Single Responsibility Principle (SRP)</h2><h3 id="Definition"><a href="#Definition" class="headerlink" title="Definition"></a>Definition</h3><p>The Single Responsibility Principle states that a class should have only one reason to change, meaning it should have only one job or responsibility.</p>
<h3 id="Broken-Example"><a href="#Broken-Example" class="headerlink" title="Broken Example"></a>Broken Example</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> salary;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Employee</span><span class="params">(String name, <span class="type">double</span> salary)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.salary = salary;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// Code to save employee data to the database</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Employee saved to database: &quot;</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">calculateSalary</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// Code to calculate salary</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Salary calculated: &quot;</span> + salary);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Correct-Example"><a href="#Correct-Example" class="headerlink" title="Correct Example"></a>Correct Example</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> salary;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Employee</span><span class="params">(String name, <span class="type">double</span> salary)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.salary = salary;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">calculateSalary</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// Code to calculate salary</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Salary calculated: &quot;</span> + salary);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EmployeeRepository</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">(Employee employee)</span> &#123;</span><br><span class="line">        <span class="comment">// Code to save employee data to the database</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Employee saved to database: &quot;</span> + employee.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="openclosed-principle-ocp"></a></p>
<h2 id="Open-Closed-Principle-OCP"><a href="#Open-Closed-Principle-OCP" class="headerlink" title="Open&#x2F;Closed Principle (OCP)"></a>Open&#x2F;Closed Principle (OCP)</h2><h3 id="Definition-1"><a href="#Definition-1" class="headerlink" title="Definition"></a>Definition</h3><p>The Open&#x2F;Closed Principle states that software entities (classes, modules, functions, etc.) should be open for extension but closed for modification.</p>
<h3 id="Broken-Example-1"><a href="#Broken-Example-1" class="headerlink" title="Broken Example"></a>Broken Example</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">    String type;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Shape</span><span class="params">(String type)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.type = type;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AreaCalculator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">calculateArea</span><span class="params">(Shape shape)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (shape.type.equals(<span class="string">&quot;circle&quot;</span>)) &#123;</span><br><span class="line">            <span class="comment">// Calculate area for circle</span></span><br><span class="line">            <span class="keyword">return</span> Math.PI * Math.pow(<span class="number">5</span>, <span class="number">2</span>); <span class="comment">// Assuming radius is 5</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (shape.type.equals(<span class="string">&quot;rectangle&quot;</span>)) &#123;</span><br><span class="line">            <span class="comment">// Calculate area for rectangle</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">10</span> * <span class="number">5</span>; <span class="comment">// Assuming width is 10 and height is 5</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Correct-Example-1"><a href="#Correct-Example-1" class="headerlink" title="Correct Example"></a>Correct Example</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">    <span class="type">double</span> <span class="title function_">calculateArea</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Circle</span> <span class="keyword">implements</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> radius;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Circle</span><span class="params">(<span class="type">double</span> radius)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.radius = radius;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">calculateArea</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.PI * Math.pow(radius, <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Rectangle</span> <span class="keyword">implements</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> width;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> height;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Rectangle</span><span class="params">(<span class="type">double</span> width, <span class="type">double</span> height)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.width = width;</span><br><span class="line">        <span class="built_in">this</span>.height = height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">calculateArea</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> width * height;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AreaCalculator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">calculateArea</span><span class="params">(Shape shape)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> shape.calculateArea();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="liskov-substitution-principle-lsp"></a></p>
<h2 id="Liskov-Substitution-Principle-LSP"><a href="#Liskov-Substitution-Principle-LSP" class="headerlink" title="Liskov Substitution Principle (LSP)"></a>Liskov Substitution Principle (LSP)</h2><h3 id="Definition-2"><a href="#Definition-2" class="headerlink" title="Definition"></a>Definition</h3><p>The Liskov Substitution Principle states that objects of a superclass should be replaceable with objects of a subclass without affecting the correctness of the program.</p>
<h3 id="Broken-Example-2"><a href="#Broken-Example-2" class="headerlink" title="Broken Example"></a>Broken Example</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fly</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Flying...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Ostrich</span> <span class="keyword">extends</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fly</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UnsupportedOperationException</span>(<span class="string">&quot;Ostriches cannot fly&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Correct-Example-2"><a href="#Correct-Example-2" class="headerlink" title="Correct Example"></a>Correct Example</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Eating...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FlyingBird</span> <span class="keyword">extends</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fly</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Flying...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Ostrich</span> <span class="keyword">extends</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="comment">// Ostriches do not fly, so no fly method here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="interface-segregation-principle-isp"></a></p>
<h2 id="Interface-Segregation-Principle-ISP"><a href="#Interface-Segregation-Principle-ISP" class="headerlink" title="Interface Segregation Principle (ISP)"></a>Interface Segregation Principle (ISP)</h2><h3 id="Definition-3"><a href="#Definition-3" class="headerlink" title="Definition"></a>Definition</h3><p>The Interface Segregation Principle states that clients should not be forced to depend on interfaces they do not use.</p>
<h3 id="Broken-Example-3"><a href="#Broken-Example-3" class="headerlink" title="Broken Example"></a>Broken Example</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Worker</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">work</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Robot</span> <span class="keyword">implements</span> <span class="title class_">Worker</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">work</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Robot working...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UnsupportedOperationException</span>(<span class="string">&quot;Robots do not eat&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Correct-Example-3"><a href="#Correct-Example-3" class="headerlink" title="Correct Example"></a>Correct Example</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Workable</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">work</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Eatable</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Robot</span> <span class="keyword">implements</span> <span class="title class_">Workable</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">work</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Robot working...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span> <span class="keyword">implements</span> <span class="title class_">Workable</span>, Eatable &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">work</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Human working...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Human eating...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="dependency-inversion-principle-dip"></a></p>
<h2 id="Dependency-Inversion-Principle-DIP"><a href="#Dependency-Inversion-Principle-DIP" class="headerlink" title="Dependency Inversion Principle (DIP)"></a>Dependency Inversion Principle (DIP)</h2><h3 id="Definition-4"><a href="#Definition-4" class="headerlink" title="Definition"></a>Definition</h3><p>The Dependency Inversion Principle states that high-level modules should not depend on low-level modules. Both should depend on abstractions. Additionally, abstractions should not depend on details. Details should depend on abstractions.</p>
<h3 id="Broken-Example-4"><a href="#Broken-Example-4" class="headerlink" title="Broken Example"></a>Broken Example</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LightBulb</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">turnOn</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;LightBulb turned on&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">turnOff</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;LightBulb turned off&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Switch</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> LightBulb bulb;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Switch</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bulb = <span class="keyword">new</span> <span class="title class_">LightBulb</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">operate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isOn) &#123;</span><br><span class="line">            bulb.turnOff();</span><br><span class="line">            isOn = <span class="literal">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            bulb.turnOn();</span><br><span class="line">            isOn = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">isOn</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Explanation"><a href="#Explanation" class="headerlink" title="Explanation"></a>Explanation</h3><p>In the broken example, the <code>Switch</code> class directly depends on the <code>LightBulb</code> class. This creates a tight coupling between the <code>Switch</code> (high-level module) and the <code>LightBulb</code> (low-level module). Here’s why this violates the Dependency Inversion Principle:</p>
<ol>
<li><p><strong>Direct Dependency</strong>: The <code>Switch</code> class directly creates an instance of <code>LightBulb</code> within its constructor. This means that the <code>Switch</code> class is tightly coupled to the <code>LightBulb</code> class. If you want to change the type of device that the <code>Switch</code> controls (e.g., a fan instead of a light bulb), you would need to modify the <code>Switch</code> class itself.</p>
</li>
<li><p><strong>Lack of Abstraction</strong>: There is no abstraction layer between the <code>Switch</code> and the <code>LightBulb</code>. The <code>Switch</code> class is directly aware of the implementation details of the <code>LightBulb</code> class. This makes the <code>Switch</code> class less flexible and harder to extend or modify.</p>
</li>
<li><p><strong>Rigidity</strong>: The <code>Switch</code> class is rigid because it can only operate on a <code>LightBulb</code>. If you want to add support for other devices (e.g., a <code>Fan</code>), you would need to create a new <code>Switch</code> class or modify the existing one, which is not ideal.</p>
</li>
</ol>
<h3 id="Why-High-Level-Module-Depends-on-Low-Level-Module"><a href="#Why-High-Level-Module-Depends-on-Low-Level-Module" class="headerlink" title="Why High-Level Module Depends on Low-Level Module"></a>Why High-Level Module Depends on Low-Level Module</h3><ul>
<li><strong>Direct Instantiation</strong>: The <code>Switch</code> class directly instantiates the <code>LightBulb</code> class within its constructor. This means that the <code>Switch</code> class is directly dependent on the <code>LightBulb</code> class.</li>
<li><strong>No Abstraction Layer</strong>: There is no interface or abstract class that both the <code>Switch</code> and <code>LightBulb</code> classes implement. This lack of abstraction means that the <code>Switch</code> class is tightly coupled to the specific implementation of the <code>LightBulb</code> class.</li>
</ul>
<h3 id="Correct-Example-4"><a href="#Correct-Example-4" class="headerlink" title="Correct Example"></a>Correct Example</h3><p>To adhere to the Dependency Inversion Principle, we introduce an abstraction (an interface) that both the <code>Switch</code> and the <code>LightBulb</code> classes depend on.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Switchable</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">turnOn</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">turnOff</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LightBulb</span> <span class="keyword">implements</span> <span class="title class_">Switchable</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">turnOn</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;LightBulb turned on&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">turnOff</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;LightBulb turned off&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Switch</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Switchable device;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Switch</span><span class="params">(Switchable device)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.device = device;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">operate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isOn) &#123;</span><br><span class="line">            device.turnOff();</span><br><span class="line">            isOn = <span class="literal">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            device.turnOn();</span><br><span class="line">            isOn = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">isOn</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Explanation-of-Correct-Example"><a href="#Explanation-of-Correct-Example" class="headerlink" title="Explanation of Correct Example"></a>Explanation of Correct Example</h3><ol>
<li><strong>Abstraction Layer</strong>: The <code>Switchable</code> interface acts as an abstraction layer. Both the <code>Switch</code> and the <code>LightBulb</code> classes depend on this abstraction.</li>
<li><strong>Dependency Injection</strong>: The <code>Switch</code> class now takes a <code>Switchable</code> object as a parameter in its constructor. This allows the <code>Switch</code> class to operate on any device that implements the <code>Switchable</code> interface, not just a <code>LightBulb</code>.</li>
<li><strong>Flexibility</strong>: This design makes the <code>Switch</code> class flexible and easier to extend. You can now create other classes that implement the <code>Switchable</code> interface (e.g., <code>Fan</code>) and pass them to the <code>Switch</code> class without modifying the <code>Switch</code> class itself.</li>
</ol>
<p>By adhering to the Dependency Inversion Principle, we ensure that high-level modules (like <code>Switch</code>) do not depend on low-level modules (like <code>LightBulb</code>). Instead, both depend on abstractions (like the <code>Switchable</code> interface), making the system more modular, flexible, and easier to maintain.</p>
<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>The SOLID principles are fundamental to writing clean, maintainable, and scalable software. By adhering to these principles, developers can create code that is easier to understand, extend, and refactor. Each principle addresses a specific aspect of software design, and understanding how to apply them correctly can significantly improve the quality of your code.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References:"></a>References:</h2><p><a target="_blank" rel="noopener" href="https://blog.bytebytego.com/p/mastering-design-principles-solid">https://blog.bytebytego.com/p/mastering-design-principles-solid</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/27/Troubleshooting-High-Currency-Issues-in-Kubernetes-Continued/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/27/Troubleshooting-High-Currency-Issues-in-Kubernetes-Continued/" class="post-title-link" itemprop="url">Troubleshooting High Currency Issues in Kubernetes - Continued</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-10-27 21:30:37 / Modified: 21:31:42" itemprop="dateCreated datePublished" datetime="2024-10-27T21:30:37-04:00">2024-10-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Kubernetes/Troubleshooting/" itemprop="url" rel="index"><span itemprop="name">Troubleshooting</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#pod-restart-crashloopbackoff-loop-due-to-high-concurrency-continued">Pod Restart <code>CrashLoopBackOff</code> Loop Due to High Concurrency (Continued)</a><ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#problem-background">Problem Background</a></li>
<li><a href="#cause-analysis">Cause Analysis</a></li>
<li><a href="#verification-of-previous-fixes">Verification of Previous Fixes</a></li>
<li><a href="#exploring-additional-causes">Exploring Additional Causes</a></li>
<li><a href="#identifying-file-descriptor-limits">Identifying File Descriptor Limits</a></li>
<li><a href="#solution">Solution</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
<hr>
<h1 id="Pod-Restart-CrashLoopBackOff-Loop-Due-to-High-Concurrency-Continued"><a href="#Pod-Restart-CrashLoopBackOff-Loop-Due-to-High-Concurrency-Continued" class="headerlink" title="Pod Restart CrashLoopBackOff Loop Due to High Concurrency (Continued)"></a>Pod Restart <code>CrashLoopBackOff</code> Loop Due to High Concurrency (Continued)</h1><hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Following the previous issue, the environment experienced another instance of Harbor and Calico pods restarting due to failed health checks. Additionally, using <code>kubectl</code> commands to enter the pods was extremely slow or timed out. This article continues the troubleshooting process to identify and resolve the root cause.</p>
<hr>
<p><a name="problem-background"></a></p>
<h2 id="Problem-Background"><a href="#Problem-Background" class="headerlink" title="Problem Background"></a>Problem Background</h2><p>After a period, the environment again faced issues with Harbor and Calico pods restarting due to failed health checks. Using <code>kubectl</code> commands to enter the pods was slow or timed out.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# kubectl <span class="built_in">exec</span> -it -n system node1-59c9475bc6-zkhq5 bash</span><br><span class="line">^</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="cause-analysis"></a></p>
<h2 id="Cause-Analysis"><a href="#Cause-Analysis" class="headerlink" title="Cause Analysis"></a>Cause Analysis</h2><p>The root cause of the repeated restarts was previously identified as health check timeouts, with TCP connections stuck in the <code>SYN_SENT</code> phase.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# netstat -anp | grep 23380</span><br><span class="line">tcp        0      0 127.0.0.1:23380         0.0.0.0:*               LISTEN      38914/kubelet</span><br><span class="line">tcp        0      0 127.0.0.1:38983         127.0.0.1:23380         SYN_SENT    -</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="verification-of-previous-fixes"></a></p>
<h2 id="Verification-of-Previous-Fixes"><a href="#Verification-of-Previous-Fixes" class="headerlink" title="Verification of Previous Fixes"></a>Verification of Previous Fixes</h2><p>First, check if the previous kernel parameter adjustments are still in place.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# <span class="built_in">cat</span> /etc/sysctl.conf</span><br><span class="line">net.ipv4.tcp_max_syn_backlog = 32768</span><br><span class="line">net.core.somaxconn = 32768</span><br></pre></td></tr></table></figure>

<p>Verify if the changes have taken effect.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# ss -lnt</span><br><span class="line">State      Recv-Q   Send-Q     Local Address:Port      Peer Address:Port          </span><br><span class="line">LISTEN     0        32768      127.0.0.1:23380         *:*</span><br></pre></td></tr></table></figure>

<p>Despite the parameters being correctly set, the issue persisted.</p>
<hr>
<p><a name="exploring-additional-causes"></a></p>
<h2 id="Exploring-Additional-Causes"><a href="#Exploring-Additional-Causes" class="headerlink" title="Exploring Additional Causes"></a>Exploring Additional Causes</h2><p>Given the global impact of the issue, it was likely due to a system-level performance bottleneck. High business load affects CPU, memory, disk, and connection counts. Since the connections were long-lived, the file descriptor limit could be a factor.</p>
<hr>
<p><a name="identifying-file-descriptor-limits"></a></p>
<h2 id="Identifying-File-Descriptor-Limits"><a href="#Identifying-File-Descriptor-Limits" class="headerlink" title="Identifying File Descriptor Limits"></a>Identifying File Descriptor Limits</h2><p>Check the number of open file descriptors.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# lsof -p 45775 | <span class="built_in">wc</span> -l</span><br><span class="line">17974</span><br><span class="line"></span><br><span class="line">[root@node01 ~]# lsof -p 45775 | grep <span class="string">&quot;sock&quot;</span> | <span class="built_in">wc</span> -l</span><br><span class="line">12051</span><br></pre></td></tr></table></figure>

<p>The process had over 10,000 open sockets, exceeding the default limit of 1024.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# <span class="built_in">ulimit</span> -n</span><br><span class="line">1024</span><br></pre></td></tr></table></figure>

<p>Despite exceeding the limit, the business pod did not report “too many open files” errors.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# kubectl logs -n system node1-59c9475bc6-zkhq5</span><br><span class="line">start config</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="solution"></a></p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>Temporarily increase the file descriptor limit.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# <span class="built_in">ulimit</span> -n 65535</span><br><span class="line">[root@node01 ~]# <span class="built_in">ulimit</span> -n</span><br><span class="line">65535</span><br></pre></td></tr></table></figure>

<p>After the adjustment, <code>kubectl</code> commands responded normally, and the <code>SYN_SENT</code> phase issue was resolved.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# kubectl <span class="built_in">exec</span> -it -n system node1-59c9475bc6-zkhq5 bash</span><br><span class="line">[root@node1-59c9475bc6-zkhq5]# <span class="built_in">exit</span></span><br><span class="line">[root@node01 ~]# kubectl <span class="built_in">exec</span> -it -n system node1-59c9475bc6-zkhq5 bash</span><br><span class="line">[root@node1-59c9475bc6-zkhq5]# <span class="built_in">exit</span></span><br><span class="line">[root@node01 ~]# kubectl <span class="built_in">exec</span> -it -n system node1-59c9475bc6-zkhq5 bash</span><br><span class="line">[root@node1-59c9475bc6-zkhq5]# <span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line">[root@node01 ~]# netstat -anp | grep 23380</span><br><span class="line">tcp        0      0 127.0.0.1:23380         0.0.0.0:*               LISTEN      38914/kubelet</span><br><span class="line">tcp        0      0 127.0.0.1:56369         127.0.0.1:23380         TIME_WAIT   -</span><br><span class="line">tcp        0      0 127.0.0.1:23380         127.0.0.1:57601         TIME_WAIT   -</span><br><span class="line">tcp        0      0 127.0.0.1:23380         127.0.0.1:57479         TIME_WAIT   -</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>This case study highlights the importance of considering system-level parameters, such as file descriptor limits, in high-concurrency scenarios. Adjusting these parameters can resolve performance bottlenecks and ensure stable operation of Kubernetes environments. For environments with high business load, it is strongly recommended to perform comprehensive operating system-level performance optimizations.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.whereq.com/2024/10/27/Troubleshooting-High-Currency-Issues-in-Kubernetes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dazhi Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WhereQ">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | WhereQ">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/10/27/Troubleshooting-High-Currency-Issues-in-Kubernetes/" class="post-title-link" itemprop="url">Troubleshooting High Currency Issues in Kubernetes</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2024-10-27 21:20:30 / Modified: 21:26:42" itemprop="dateCreated datePublished" datetime="2024-10-27T21:20:30-04:00">2024-10-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Kubernetes/Troubleshooting/" itemprop="url" rel="index"><span itemprop="name">Troubleshooting</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><a href="#pod-restart-crashloopbackoff-loop-due-to-high-concurrency">Pod Restart <code>CrashLoopBackOff</code> Loop Due to High Concurrency</a><ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#problem-background">Problem Background</a></li>
<li><a href="#analysis-process">Analysis Process</a></li>
<li><a href="#investigating-the-issue">Investigating the Issue</a></li>
<li><a href="#tcp-connection-timeout">TCP Connection Timeout</a></li>
<li><a href="#understanding-cpu-load">Understanding CPU Load</a></li>
<li><a href="#kernel-parameter-tuning">Kernel Parameter Tuning</a><ul>
<li><a href="#tcp-state-transition-diagram">TCP State Transition Diagram</a></li>
<li><a href="#adjusting-kernel-parameters">Adjusting Kernel Parameters</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
<hr>
<h1 id="Pod-Restart-CrashLoopBackOff-Loop-Due-to-High-Concurrency"><a href="#Pod-Restart-CrashLoopBackOff-Loop-Due-to-High-Concurrency" class="headerlink" title="Pod Restart CrashLoopBackOff Loop Due to High Concurrency"></a>Pod Restart <code>CrashLoopBackOff</code> Loop Due to High Concurrency</h1><hr>
<p><a name="introduction"></a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>In a Kubernetes cluster environment, a business operation involving extensive configuration distribution (lasting several hours or more) led to repeated restarts of Calico pods. This article details the troubleshooting process, focusing on identifying the root cause and implementing a solution.</p>
<hr>
<p><a name="problem-background"></a></p>
<h2 id="Problem-Background"><a href="#Problem-Background" class="headerlink" title="Problem Background"></a>Problem Background</h2><p>During a high-concurrency operation, Calico pods in the Kubernetes cluster began to restart repeatedly.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@node02 ~]# kubectl get pod -n kube-system -owide | grep node01</span><br><span class="line">calico-kube-controllers-6f59b8cdd8-8v2qw   1/1     Running            0          4h45m   10.10.119.238    node01   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">calico-node-b8w2b                          1/1     CrashLoopBackOff   43         3d19h   10.10.119.238    node01   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">coredns-795cc9c45c-k7qpb                   1/1     Running            0          4h45m   177.177.237.42    node01   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="analysis-process"></a></p>
<h2 id="Analysis-Process"><a href="#Analysis-Process" class="headerlink" title="Analysis Process"></a>Analysis Process</h2><p>Upon observing the <code>CrashLoopBackOff</code> state of the pods, the first step was to use <code>kubectl describe</code> to gather more information.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@node02 ~]# kubectl describe pod -n kube-system calico-node-b8w2b</span><br><span class="line">...</span><br><span class="line">Events:</span><br><span class="line">  Type     Reason     Age                      From               Message</span><br><span class="line">  ----     ------     ----                     ----               -------</span><br><span class="line">  Warning  Unhealthy  58m (x111 over 3h12m)    kubelet, node01  (combined from similar events): Liveness probe failed: Get http://localhost:9099/liveness: net/http: request canceled <span class="keyword">while</span> waiting <span class="keyword">for</span> connection (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">  Normal   Pulled     43m (x36 over 3d19h)     kubelet, node01  Container image <span class="string">&quot;calico/node:v3.15.1&quot;</span> already present on machine</span><br><span class="line">  Warning  Unhealthy  8m16s (x499 over 3h43m)  kubelet, node01  Liveness probe failed: Get http://localhost:9099/liveness: net/http: request canceled <span class="keyword">while</span> waiting <span class="keyword">for</span> connection (Client.Timeout exceeded <span class="keyword">while</span> awaiting headers)</span><br><span class="line">  Warning  BackOff    3m31s (x437 over 3h3m)   kubelet, node01  Back-off restarting failed container</span><br></pre></td></tr></table></figure>

<p>The events indicated that the liveness probe was failing due to a connection timeout.</p>
<hr>
<p><a name="investigating-the-issue"></a></p>
<h2 id="Investigating-the-Issue"><a href="#Investigating-the-Issue" class="headerlink" title="Investigating the Issue"></a>Investigating the Issue</h2><p>Manual execution of the health check command revealed slow response times, which were significantly higher than the usual millisecond-level response.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# time curl -i http://localhost:9099/liveness</span><br><span class="line">HTTP/1.1 204 No Content</span><br><span class="line">Date: Tue, 15 Jun 2021 06:24:35 GMT</span><br><span class="line">real    0m1.012s</span><br><span class="line">user    0m0.003s</span><br><span class="line">sys     0m0.005s</span><br></pre></td></tr></table></figure>

<p>Logs from Calico’s bird, confd, and felix components did not show any apparent errors. Checking the port status indicated that it was listening correctly.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node02 ~]# netstat -anp | grep 9099</span><br><span class="line">tcp        0      0 127.0.0.1:9099          0.0.0.0:*               LISTEN      1202/calico-node    </span><br><span class="line">tcp        0      0 127.0.0.1:9099          127.0.0.1:56728         TIME_WAIT   -                   </span><br><span class="line">tcp        0      0 127.0.0.1:56546         127.0.0.1:9099          TIME_WAIT   -</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="tcp-connection-timeout"></a></p>
<h2 id="TCP-Connection-Timeout"><a href="#TCP-Connection-Timeout" class="headerlink" title="TCP Connection Timeout"></a>TCP Connection Timeout</h2><p>Given the connection timeout error, the TCP connection state was observed.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# netstat -na | awk <span class="string">&#x27;/^tcp/&#123;s[$6]++&#125;END&#123;for(key in s) print key,s[key]&#125;&#x27;</span></span><br><span class="line">LISTEN 49</span><br><span class="line">ESTABLISHED 284</span><br><span class="line">SYN_SENT 4</span><br><span class="line">TIME_WAIT 176</span><br></pre></td></tr></table></figure>

<p>The <code>top</code> command showed that the business Java process was consuming high CPU, peaking at over 2000%.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# top</span><br><span class="line">top - 14:28:57 up 13 days, 27 min,  2 <span class="built_in">users</span>,  load average: 9.55, 9.93, 9.91</span><br><span class="line">Tasks: 1149 total,   1 running, 1146 sleeping,   0 stopped,   2 zombie</span><br><span class="line">%Cpu(s): 16.0 us,  2.9 sy,  0.0 ni, 80.9 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.1 si,  0.0 st</span><br><span class="line">KiB Mem : 15249982+total, 21419184 free, 55542588 used, 75538048 buff/cache</span><br><span class="line">KiB Swap:        0 total,        0 free,        0 used. 94226176 avail Mem </span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                        </span><br><span class="line"> 6754 root      20   0   66.8g  25.1g 290100 S 700.0 17.3   2971:49 java                                                                                           </span><br><span class="line">25214 root      20   0 6309076 179992  37016 S  36.8  0.1 439:06.29 kubelet                                                                                        </span><br><span class="line">20331 root      20   0 3196660 172364  24908 S  21.1  0.1 349:56.64 dockerd</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="understanding-cpu-load"></a></p>
<h2 id="Understanding-CPU-Load"><a href="#Understanding-CPU-Load" class="headerlink" title="Understanding CPU Load"></a>Understanding CPU Load</h2><p>Checking the total number of CPU cores and comparing it with the load average and CPU usage indicated that the load was not excessively high.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# <span class="built_in">cat</span> /proc/cpuinfo | grep <span class="string">&quot;physical id&quot;</span> | <span class="built_in">sort</span> | <span class="built_in">uniq</span> | <span class="built_in">wc</span> -l</span><br><span class="line">48</span><br><span class="line">[root@node01 ~]# <span class="built_in">cat</span> /proc/cpuinfo | grep <span class="string">&quot;cpu cores&quot;</span> | <span class="built_in">uniq</span></span><br><span class="line">cpu cores: 1</span><br></pre></td></tr></table></figure>

<p>Given the high concurrency, the issue was likely related to the TCP connection setup. Understanding the TCP connection phases helped pinpoint the problem.</p>
<hr>
<p><a name="kernel-parameter-tuning"></a></p>
<h2 id="Kernel-Parameter-Tuning"><a href="#Kernel-Parameter-Tuning" class="headerlink" title="Kernel Parameter Tuning"></a>Kernel Parameter Tuning</h2><p>The issue was traced to the <code>SYN_SENT</code> phase of TCP connections. Adjusting kernel parameters related to TCP connections resolved the problem.</p>
<h3 id="TCP-State-Transition-Diagram"><a href="#TCP-State-Transition-Diagram" class="headerlink" title="TCP State Transition Diagram"></a>TCP State Transition Diagram</h3><pre><code class="highlight mermaid">graph TD
    CLOSED --&gt;|Client sends SYN| SYN_SENT
    SYN_SENT --&gt;|Server responds with SYN+ACK| SYN_RECV
    SYN_RECV --&gt;|Client sends ACK| ESTABLISHED
    ESTABLISHED --&gt;|Connection closed by either party| FIN_WAIT_1
    FIN_WAIT_1 --&gt;|ACK received| FIN_WAIT_2
    FIN_WAIT_2 --&gt;|FIN received| TIME_WAIT
    TIME_WAIT --&gt;|Timeout| CLOSED
    FIN_WAIT_1 --&gt;|FIN received| CLOSING
    CLOSING --&gt;|ACK received| TIME_WAIT
    SYN_RECV --&gt;|Server sends FIN| LAST_ACK
    LAST_ACK --&gt;|Client sends ACK| CLOSED</code></pre>

<h3 id="Adjusting-Kernel-Parameters"><a href="#Adjusting-Kernel-Parameters" class="headerlink" title="Adjusting Kernel Parameters"></a>Adjusting Kernel Parameters</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# <span class="built_in">cat</span> /etc/sysctl.conf </span><br><span class="line">...</span><br><span class="line">net.ipv4.tcp_max_syn_backlog = 32768</span><br><span class="line">net.core.somaxconn = 32768</span><br><span class="line"></span><br><span class="line">[root@node01 ~]# sysctl -p</span><br><span class="line">...</span><br><span class="line">net.ipv4.tcp_max_syn_backlog = 32768</span><br><span class="line">net.core.somaxconn = 32768</span><br></pre></td></tr></table></figure>

<p>After applying these changes, the health check commands executed without delay, and the pods returned to normal.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# time curl -i http://localhost:9099/liveness</span><br><span class="line">HTTP/1.1 204 No Content</span><br><span class="line">Date: Tue, 15 Jun 2021 14:48:38 GMT</span><br><span class="line">real    0m0.011s</span><br><span class="line">user    0m0.004s</span><br><span class="line">sys     0m0.004s</span><br></pre></td></tr></table></figure>

<hr>
<p><a name="conclusion"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>This case study highlights the importance of understanding and tuning kernel parameters in high-concurrency scenarios. By adjusting parameters related to TCP connection handling, the issue of repeated pod restarts due to high CPU load and connection timeouts was resolved. This approach can be applied to similar issues in Kubernetes environments to ensure stable and efficient operation.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Dazhi Zhang</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.1/mermaid.min.js","integrity":"sha256-YbM1pG3wWnzhyYN49g5fPnen+2CKEFaZfopkkwSpNtY="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  





</body>
</html>
